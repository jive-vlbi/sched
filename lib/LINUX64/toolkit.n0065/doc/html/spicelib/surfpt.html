
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>surfpt</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>surfpt</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      SURFPT ( Surface point on an ellipsoid )
 
      SUBROUTINE SURFPT ( POSITN, U, A, B, C, POINT, FOUND )

      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Determine the intersection of a line-of-sight vector with the
     surface of an ellipsoid.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSOID,  GEOMETRY
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION    POSITN ( 3 )
      DOUBLE PRECISION    U      ( 3 )
      DOUBLE PRECISION    A
      DOUBLE PRECISION    B
      DOUBLE PRECISION    C
      DOUBLE PRECISION    POINT  ( 3 )
      LOGICAL             FOUND
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     POSITN     I   Position of the observer in body-fixed frame.
     U          I   Vector from the observer in some direction.
     A          I   Length of ellipsoid semi-axis along the x-axis.
     B          I   Length of ellipsoid semi-axis along the y-axis.
     C          I   Length of ellipsoid semi-axis along the z-axis.
     POINT      O   Point on the ellipsoid pointed to by U.
     FOUND      O   Flag indicating if U points at the ellipsoid.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     POSITN     3-vector giving the position of an observer with
                respect to the center of an ellipsoid. The vector is
                expressed in a body-fixed reference frame. The
                semi-axes of the ellipsoid are aligned with the x, y,
                and z-axes of the body-fixed frame.

     U          Pointing vector emanating from the observer.

     A          Length of the semi-axis of the ellipsoid that is
                parallel to the x-axis of the body-fixed reference
                frame.

     B          Length of the semi-axis of the ellipsoid that is
                parallel to the y-axis of the body-fixed reference
                frame.

     C          Length of the semi-axis of the ellipsoid that is
                parallel to the z-axis of the body-fixed reference
                frame.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     POINT      If the ray with direction vector U emanating from
                POSITN intersects the ellipsoid, POINT will be
                returned with the body-fixed coordinates of the point
                where the ray first meets the ellipsoid.  Otherwise,
                POINT will be returned as (0, 0, 0).

     FOUND      A logical flag indicating whether or not the ray from
                POSITN with direction U actually intersects the
                ellipsoid.  If the ray does intersect the ellipsoid,
                FOUND will be returned as .TRUE. If the ray misses the
                ellipsoid, FOUND will be returned as .FALSE.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
      None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the input vector is the zero vector, the error
        SPICE(ZEROVECTOR) is signaled.

     2) If any of the body's axes is zero, the error
        SPICE(BADAXISLENGTH) is signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
      This routine assumes that an ellipsoid having semi-axes of
      length A, B and C is given.  Moreover, it is assumed that these
      axes are parallel to the x-, y-, and z-axes of a reference frame
      whose origin is the geometric center of the ellipsoid---this is
      called the body-fixed reference frame. 
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
      A typical use of <b>SURFPT</b> would be to obtain the planetocentric
      coordinates of the point at which the optic axis of a
      spacecraft-mounted instrument intersects the surface of a target
      body, given the following items.

         1) The epoch (ET) of observation, and the inertial
            pointing (VPNT) of the instrument at this epoch.

         2) The apparent position (VTARG) of the center of the
            target body as seen from the spacecraft at the epoch
            of observation, and the one-way light time (TAU)
            from the target to the spacecraft.

      In order to find the point of intersection, the following
      items are also needed.

         3) The transformation (TIBF) from inertial
            to body-fixed coordinates at epoch ET-TAU.

         4) The radii (R) of the tri-axial ellipsoid
            used to model the target body.

      These may be obtained from the kernel pool via calls to <a href="pxform.html">PXFORM</a>
      and <a href="bodvrd.html">BODVRD</a> or <a href="bodvcd.html">BODVCD</a> respectively.

      The position of the observer is just the negative of the
      spacecraft-target vector, VTARG, computed using the <a href="vminus.html">VMINUS</a>
      module. (Note that this is NOT the same as the apparent position
      of the spacecraft as seen from the target!) Both vectors must be
      specified in the body-fixed reference frame. The point of
      intersection is found as follows:

          CALL <a href="vminus.html">VMINUS</a> ( VTARG, VPOS )
          CALL <a href="mxv.html">MXV</a>    ( TIBF,  VPOS,  VPOS )
          CALL <a href="mxv.html">MXV</a>    ( TIBF,  VPNT,  VPNT )

          CALL <b>SURFPT</b> ( VPOS, VPNT, R(1), R(2), R(3), VSURF, FOUND )

      Note that VSURF may or may not be a point of intersection,
      depending on whether FOUND is .TRUE. or .FALSE. Note also that
      VSURF is a vector from the center to the surface of the
      target, in body-fixed coordinates, which may be converted
      directly to planetocentric latitude, longitude, and radius:

          CALL <a href="reclat.html">RECLAT</a> ( VSURF, RADIUS, LONG, LAT )

      To get the inertial vector from the spacecraft to the
      surface point, you must subtract VPOS from VSURF, and rotate
      the resulting vector back to inertial coordinates:

          CALL <a href="vsub.html">VSUB</a> ( VSURF, VPOS,  VSURF )
          CALL <a href="mtxv.html">MTXV</a> ( TIBF,  VSURF, VSURF )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     C.H. Acton     (JPL)
     N.J. Bachman    (JPL)
     W.L. Taber      (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.3.0, 03-APR-2006 (NJB)

        Bug fix:  intercept point is now always set to the
        ray's vertex when the vertex is on the ellipsoid's 
        surface.  This routine now uses discovery check-in.

    SPICELIB Version 1.2.2, 24-OCT-2005 (NJB)

        Updated header to refer to <a href="bodvrd.html">BODVRD</a> and <a href="bodvcd.html">BODVCD</a> instead of
        <a href="bodvar.html">BODVAR</a>.

    SPICELIB Version 1.2.1, 27-JUL-2003 (NJB) (CHA)

        Various header corrections were made.  The example program
        was upgraded to use real kernels, and the program's output is
        shown.

    SPICELIB Version 1.2.0, 28-NOV-2002 (NJB)

        Re-implemented intercept computation to reduce loss of
        precision.

        Changed SAVE statement to save only the error message.
        Previously all local variables were saved.

    SPICELIB Version 1.1.0, 07-AUG-1996 (WLT)

        Added a SAVE statement so that the error message will
        not be lost between separate invocations of the routine.
         
    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 31-JAN-1990 (WLT)</PRE>
<h4>Link to routine SURFPT source file <a href='../../../src/spicelib/surfpt.f'>surfpt.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:25:13 2014</pre>

</body>
</html>

