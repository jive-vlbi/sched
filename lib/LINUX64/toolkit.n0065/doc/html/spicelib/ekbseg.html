
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>ekbseg</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>ekbseg</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      EKBSEG ( EK, start new segment )
 
      SUBROUTINE EKBSEG ( HANDLE, TABNAM, NCOLS, CNAMES, DECLS, SEGNO )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Start a new segment in an E-kernel.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ek.html">EK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EK
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
 
      INCLUDE 'ekbool.inc'
      INCLUDE 'ekcoldsc.inc'
      INCLUDE 'ekcnamsz.inc'
      INCLUDE 'ekdatpag.inc'
      INCLUDE 'ekfilpar.inc'
      INCLUDE 'ekglimit.inc'
      INCLUDE 'ekpage.inc'
      INCLUDE 'ekrecptr.inc'
      INCLUDE 'eksegdsc.inc'
      INCLUDE 'ektnamsz.inc'
      INCLUDE 'ektype.inc'
 
      INTEGER               HANDLE
      CHARACTER*(*)         TABNAM
      INTEGER               NCOLS
      CHARACTER*(*)         CNAMES ( * )
      CHARACTER*(*)         DECLS  ( * )
      INTEGER               SEGNO
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     HANDLE     I   File handle.
     TABNAM     I   Table name.
     NCOLS      I   Number of columns in the segment.
     CNAMES     I   Names of columns.
     DECLS      I   Declarations of columns.
     SEGNO      O   Segment number.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE         the handle of an EK file that is open for writing.

     TABNAM         is the name of the EK table to which the current
                    segment belongs.  All segments in the EK file
                    designated by HANDLE must have identical column
                    attributes. TABNAM must not exceed 32 characters
                    in length.  Case is not significant.  Table names
                    must start with a letter and contain only
                    characters from the set {A-Z,a-z,0-9,$,_}.

     NCOLS          is the number of columns in a new segment.

     CNAMES,
     DECLS          are, respectively, and array of column names and
                    their corresponding declarations:  the Ith element
                    of CNAMES and the Ith element of DECLS apply to
                    the Ith column in the segment.

                    Column names must not exceed CNAMSZ (32) characters
                    in length.  Case is not significant.  Column names
                    must start with a letter and contain only
                    characters from the set {A-Z,a-z,0-9,$,_}.

                    The declarations are strings that contain
                    `keyword=value' assignments that define the
                    attributes of the columns to which they apply.  The
                    column attributes that are defined by a column
                    declaration are:

                       DATATYPE
                       SIZE
                       &lt;is the column indexed?&gt;
                       &lt;does the column allow null values?&gt;

                    The form of a declaration is

                       'DATATYPE  = &lt;type&gt;,
                        SIZE      = &lt;size&gt;,
                        INDEXED   = &lt;boolean&gt;,
                        NULLS_OK  = &lt;boolean&gt;'

                    For example, an indexed, scalar, integer column
                    that allows null values would have the declaration

                       'DATATYPE  = INTEGER,
                        SIZE      = 1,
                        INDEXED   = TRUE,
                        NULLS_OK  = TRUE'

                    Commas are required to separate the assignments
                    within declarations; white space is optional;
                    case is not significant.

                    The order in which the attribute keywords are
                    listed in declaration is not significant.

                    Every column in a segment must be declared.

                    Each column entry is effectively an array, each
                    element of which has the declared data type.  The
                    SIZE keyword indicates how many elements are in
                    each entry of the column in whose declaration the
                    keyword appears.  Note that only scalar-valued
                    columns (those for which SIZE = 1) may be
                    referenced in query constraints.  A size
                    assignment has the syntax

                       SIZE = &lt;integer&gt;

                    or
                       SIZE = VARIABLE

                    The size value defaults to 1 if omitted.

                    The DATATYPE keyword defines the data type of
                    column entries.  The DATATYPE assignment syntax
                    has any of the forms

                       DATATYPE = CHARACTER*(&lt;length&gt;)
                       DATATYPE = CHARACTER*(*)
                       DATATYPE = DOUBLE PRECISION
                       DATATYPE = INTEGER
                       DATATYPE = TIME

                    As the datatype declaration syntax suggests,
                    character strings may have fixed or variable
                    length.  Variable-length strings are allowed only
                    in columns of size 1.

                    Optionally, scalar-valued columns may be indexed.
                    To create an index for a column, use the assignment

                       INDEXED = TRUE

                    By default, columns are not indexed.

                    Optionally, any column can allow null values.  To
                    indicate that a column may allow null values, use
                    the assigment

                       NULLS_OK = TRUE

                    in the column declaration.  By default, null
                    values are not allowed in column entries.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     SEGNO          is the number of the segment created by this
                    routine.  Segment numbers are used as unique
                    identifiers by other EK access routines.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If HANDLE is invalid, the error will be diagnosed by routines
         called by this routine.

     2)  If TABNAM is more than TNAMSZ characters long, the error
         is diagnosed by routines called by this routine.

     3)  If TABNAM contains any nonprintable characters, the error
         is diagnosed by routines called by this routine.

     4)  If NCOLS is non-positive or greater than the maximum allowed
         number MXCLSG, the error SPICE(INVALIDCOUNT) is signalled.

     5)  If any column name exceeds CNAMSZ characters in length, the
         error is diagnosed by routines called by this routine.

     6)  If any column name contains non-printable characters, the
         error is diagnosed by routines called by this routine.

     7)  If a declaration cannot be understood by this routine, the
         error is diagnosed by routines called by this routine.

     8)  If an non-positive string length or element size is specified,
         the error is diagnosed by routines called by this routine.

     9)  If an I/O error occurs while reading or writing the indicated
         file, the error will be diagnosed by routines called by this
         routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     See the EK Required Reading for a discussion of the EK file
     format.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine operates by side effects:  it prepares an EK for
     the addition of a new segment.  It is not necessary to take
     any special action to `complete' a segment; segments are readable
     after the completion of any record insertion, deletion, write,
     or update operation.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  Suppose we have an E-kernel named ORDER_DB.EK which contains
         records of orders for data products.  The E-kernel has a
         table called DATAORDERS that consists of the set of columns
         listed below:

            DATAORDERS

               Column Name     Data Type
               -----------     ---------
               ORDER_ID        INTEGER
               CUSTOMER_ID     INTEGER
               LAST_NAME       CHARACTER*(*)
               FIRST_NAME      CHARACTER*(*)
               ORDER_DATE      TIME
               COST            DOUBLE PRECISION

         The order database also has a table of items that have been
         ordered.  The columns of this table are shown below:

            DATAITEMS

               Column Name     Data Type
               -----------     ---------
               ITEM_ID         INTEGER
               ORDER_ID        INTEGER
               ITEM_NAME       CHARACTER*(*)
               DESCRIPTION     CHARACTER*(*)
               PRICE           DOUBLE PRECISION


         We'll suppose that the file ORDER_DB.EK contains two segments,
         the first containing the DATAORDERS table and the second
         containing the DATAITEMS table.

         Below, we show how we'd open a new EK file and start the
         first of the segments described above.


            C
            C     Open a new EK file.  For simplicity, we will not
            C     reserve any space for the comment area, so the
            C     number of reserved comment characters is zero.
            C     The variable IFNAME is the internal file name.
            C
                  NRESVC  =  0
                  IFNAME  =  'Test EK/Created 20-SEP-1995'

                  CALL <a href="ekopn.html">EKOPN</a> ( 'ORDER_DB.EK', IFNAME, NRESVC, HANDLE )

            C
            C     Set up the table and column names and declarations
            C     for the DATAORDERS segment.  We'll index all of
            C     the columns.  All columns are scalar, so we omit
            C     the size declaration.  Only the COST column may take
            C     null values.
            C
                  TABLE     =  'DATAORDERS'
                  NCOLS     =  6

                  CNAMES(1) =  'ORDER_ID'
                  CDECLS(1) =  'DATATYPE = INTEGER, INDEXED = TRUE'

                  CNAMES(2) =  'CUSTOMER_ID'
                  CDECLS(2) =  'DATATYPE = INTEGER, INDEXED = TRUE'

                  CNAMES(3) =  'LAST_NAME'
                  CDECLS(3) =  'DATATYPE = CHARACTER*(*),' //
                 .             'INDEXED  = TRUE'

                  CNAMES(4) =  'FIRST_NAME'
                  CDECLS(4) =  'DATATYPE = CHARACTER*(*),' //
                 .             'INDEXED  = TRUE'

                  CNAMES(5) =  'ORDER_DATE'
                  CDECLS(5) =  'DATATYPE = TIME, INDEXED  = TRUE'

                  CNAMES(6) =  'COST'
                  CDECLS(6) =  'DATATYPE = DOUBLE PRECISION,' //
                 .             'INDEXED  = TRUE'           //
                 .             'NULLS_OK = TRUE'

            C
            C     Start the segment.
            C
                  CALL <b>EKBSEG</b> ( HANDLE,  TABNAM,  NCOLS,
                 .              CNAMES,  CDECLS,  SEGNO  )

            C
            C     Add data to the segment.  No special action
            C     is required to finish the segment.
            C
                  [Data is added via calls to <a href="ekappr.html">EKAPPR</a> and the
                   <a href="ekacec.html">EKACEC</a>, <a href="ekaced.html">EKACED</a>, and <a href="ekacei.html">EKACEI</a> routines.  See any
                   of these routines for examples.]

            C
            C     At this point, the second segment could be
            C     created by an analogous process.  In fact, the
            C     second segment could be created at any time; it is
            C     not necessary to populate the first segment with
            C     data before starting the second segment.
            C

            C
            C     The file must be closed by a call to <a href="ekcls.html">EKCLS</a>.
            C
                  CALL <a href="ekcls.html">EKCLS</a> ( HANDLE )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 07-JUL-1996 (NJB)

        Erroneous error message for invalid column names was fixed.
        Previous version line was changed from &quot;Beta&quot; to &quot;SPICELIB.&quot; 
 
    SPICELIB Version 1.0.0, 06-NOV-1995 (NJB)</PRE>
<h4>Link to routine EKBSEG source file <a href='../../../src/spicelib/ekbseg.f'>ekbseg.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:15 2014</pre>

</body>
</html>

