
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>inedpl</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>inedpl</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      INEDPL ( Intersection of ellipsoid and plane )
 
      SUBROUTINE INEDPL ( A, B, C, PLANE, ELLIPS, FOUND )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find the intersection of a triaxial ellipsoid and a plane.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ellipses.html">ELLIPSES</a>
     <a href="../req/planes.html">PLANES</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSE
     ELLIPSOID
     GEOMETRY
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               UBEL
      PARAMETER           ( UBEL = 9 )
 
      INTEGER               UBPL
      PARAMETER           ( UBPL = 4 )
 
      DOUBLE PRECISION      A
      DOUBLE PRECISION      B
      DOUBLE PRECISION      C
      DOUBLE PRECISION      PLANE  ( UBPL )
      DOUBLE PRECISION      ELLIPS ( UBEL )
      LOGICAL               FOUND
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     A          I   Length of ellipsoid semi-axis lying on the x-axis.
     B          I   Length of ellipsoid semi-axis lying on the y-axis.
     C          I   Length of ellipsoid semi-axis lying on the z-axis.
     PLANE      I   Plane that intersects ellipsoid.
     ELLIPS     O   Intersection ellipse, when FOUND is .TRUE.
     FOUND      O   Flag indicating whether ellipse was found.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     A,
     B,
     C              are the lengths of the semi-axes of a triaxial
                    ellipsoid.  The ellipsoid is centered at the
                    origin and oriented so that its axes lie on the
                    x, y and z axes.  A, B, and C are the lengths of
                    the semi-axes that point in the x, y, and z
                    directions respectively.

     PLANE          is a SPICELIB plane.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     ELLIPS         is the SPICELIB ellipse formed by the intersection
                    of the input plane and ellipsoid.  ELLIPS will
                    represent a single point if the ellipsoid and
                    plane are tangent.

                    If the intersection of the ellipsoid and plane is
                    empty, ELLIPS is not modified.


     FOUND          is .TRUE. if and only if the intersection of the
                    ellipsoid and plane is non-empty.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If any of the lengths of the semi-axes of the input ellipsoid
         are non-positive, the error SPICE(DEGENERATECASE) is
         signaled.  ELLIPS is not modified.  FOUND is set to .FALSE.

     2)  If the input plane in invalid, in other words, if the input
         plane as the zero vector as its normal vector, the error
         SPICE(INVALIDPLANE) is signaled. ELLIPS is not modified.
         FOUND is set to .FALSE.

     3)  If the input plane and ellipsoid are very nearly tangent,
         roundoff error may cause this routine to give unreliable
         results.

     4)  If the input plane and ellipsoid are precisely tangent, the
         intersection is a single point.  In this case, the output
         ellipse is degenerate, but FOUND will still have the value
         .TRUE.  You must decide whether this output makes sense for
         your application.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     An ellipsoid and a plane can intersect in an ellipse, a single
     point, or the empty set.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  Suppose we wish to find the limb of a body, as observed from
         location LOC in body-fixed coordinates.  The SPICELIB routine
         <a href="edlimb.html">EDLIMB</a> solves this problem.  Here's how <b>INEDPL</b> is used in
         that solution.

         We assume LOC is outside of the body. The body is modelled as
         a triaxial ellipsoid with semi-axes of length A, B, and C.
         The notation

            &lt; X, Y &gt;

         indicates the inner product of the vectors X and Y.

         The limb lies on the plane defined by

            &lt; X,  N &gt;  =  1,

         where the vector N is defined as

            ( LOC(1) / A**2,   LOC(2) / B**2,   LOC(3) / C**2 ).

         The assignments

            N(1) = LOC(1) / A**2
            N(2) = LOC(2) / B**2
            N(3) = LOC(3) / C**2

         and the calls

            CALL <a href="nvc2pl.html">NVC2PL</a> ( N,  1.0D0,  PLANE )

            CALL <b>INEDPL</b> ( A,  B,  C,  PLANE,  LIMB,  FOUND )

            CALL <a href="el2cgv.html">EL2CGV</a> ( LIMB, CENTER, SMAJOR, SMINOR )

         will return the center and semi-axes of the limb.


         How do we know that  &lt; X, N &gt; = 1  for all X on the limb?
         This is because all limb points X satisfy

            &lt; LOC - X, <a href="surfnm.html">SURFNM</a>(X) &gt;  =  0,

         where <a href="surfnm.html">SURFNM</a>(X) is a surface normal at X.  <a href="surfnm.html">SURFNM</a>(X) is
         parallel to the vector

            V = (  X(1) / A**2,   X(2) / B**2,   X(3) / C**2  )

         so we have

            &lt; LOC - X, V &gt;  =  0,

            &lt; LOC, V &gt;      =  &lt; X, V &gt;  =  1  (from the original
                                                ellipsoid
                                                equation);
         and finally

            &lt; X,   N &gt;      =  1,

         where the vector N is defined as

            (  LOC(1) / A**2,    LOC(2) / B**2,   LOC(3) / C**2  ).


     2)  Suppose we wish to find the terminator of a body.  We can
         make a fair approximation to the location of the terminator
         by finding the limb of the body as seen from the vertex of
         the umbra; then the problem is essentially the same as in
         example 1.  Let VERTEX be this location.  We make the
         assignments

            P(1) =   VERTEX(1) / A**2
            P(2) =   VERTEX(2) / B**2
            P(3) =   VERTEX(3) / C**2

         and then make the calls

            CALL <a href="nvc2pl.html">NVC2PL</a> ( P,  1.0D0,  PLANE )

            CALL <b>INEDPL</b> ( A,  B,  C,  PLANE,  TERM,  FOUND )

         The SPICELIB ellipse TERM represents the terminator of the
         body.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.2.0, 16-NOV-2005 (NJB)

        Bug fix:  error detection for case of invalid input plane was
        added.

        Updated to remove non-standard use of duplicate arguments
        in <a href="vscl.html">VSCL</a> calls.

    SPICELIB Version 1.1.0, 11-JUL-1995 (KRG)

        Removed potential numerical precision problems that could be 
        caused by using a REAL constant in a double precision 
        computation. The value 1.0 was repaced with the value 1.0D0 in 
        the following three lines:

           DSTORT(1) = 1.0 / A
           DSTORT(2) = 1.0 / B
           DSTORT(3) = 1.0 / C

        Also changed was a numeric constant from 1.D0 to the 
        equivalent, but more aesthetically pleasing 1.0D0.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 02-NOV-1990 (NJB)</PRE>
<h4>Link to routine INEDPL source file <a href='../../../src/spicelib/inedpl.f'>inedpl.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:27 2014</pre>

</body>
</html>

