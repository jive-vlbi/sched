
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>dsphdr</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>dsphdr</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      DSPHDR ( Derivative of spherical w.r.t. rectangular )
 
      SUBROUTINE DSPHDR ( X, Y, Z, JACOBI )
      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     This routine computes the Jacobian of the transformation from
     rectangular to spherical coordinates.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     COORDINATES
     DERIVATIVES
     MATRIX
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION      X
      DOUBLE PRECISION      Y
      DOUBLE PRECISION      Z
      DOUBLE PRECISION      JACOBI ( 3, 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     X          I   X-coordinate of point.
     Y          I   Y-coordinate of point.
     Z          I   Z-coordinate of point.
     JACOBI     O   Matrix of partial derivatives.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     X,
     Y,
     Z          are the rectangular coordinates of the point at
                which the Jacobian of the map from rectangular
                to spherical coordinates is desired.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     JACOBI     is the matrix of partial derivatives of the conversion
                between rectangular and spherical coordinates.  It
                has the form

                    .-                                  -.
                    |  DR/DX       DR/DY      DR/DZ      |
                    |  DCOLAT/DX   DCOLAT/DY  DCOLAT/DZ  |
                    |  DLONG/DX    DLONG/DY   DLONG/DZ   |
                    `-                                  -'

               evaluated at the input values of X, Y, and Z.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the input point is on the Z-axis (X and Y = 0), the
        Jacobian is undefined.  The error SPICE(POINTONZAXIS)
        will be signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     When performing vector calculations with velocities it is
     usually most convenient to work in rectangular coordinates.
     However, once the vector manipulations have been performed
     it is often desirable to convert the rectangular representations
     into spherical coordinates to gain insights about phenomena
     in this coordinate frame.

     To transform rectangular velocities to derivatives of coordinates
     in a spherical system, one uses the Jacobian of the
     transformation between the two systems.

     Given a state in rectangular coordinates

          ( x, y, z, dx, dy, dz )

     the corresponding spherical coordinate derivatives are given by
     the matrix equation:

                           t          |                    t
        (dr, dcolat, dlong)   = JACOBI|      * (dx, dy, dz)
                                      |(x,y,z)

     This routine computes the matrix 

              |
        JACOBI|
              |(x, y, z)
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose one is given the bodyfixed rectangular state of an object
     (x(t), y(t), z(t), dx(t), dy(t), dz(t)) as a function of time t.

     To find the derivatives of the coordinates of the object in
     bodyfixed spherical coordinates, one simply multiplies the
     Jacobian of the transformation from rectangular to spherical
     coordinates (evaluated at x(t), y(t), z(t)) by the rectangular 
     velocity vector of the object at time t.

     In code this looks like:

        C
        C     Load the rectangular velocity vector vector RECV.
        C
              RECV(1) = DX_DT ( T )
              RECV(3) = DY_DT ( T )
              RECV(2) = DZ_DT ( T )

        C
        C     Determine the Jacobian of the transformation from
        C     rectangular to spherical coordinates at the given
        C     rectangular coordinates at time T.
        C
              CALL <b>DSPHDR</b> ( X(T), Y(T), Z(T), JACOBI )

        C
        C     Multiply the Jacobian on the right by the rectangular
        C     velocity to obtain the spherical coordinate derivatives
        C     SPHV.
        C
              CALL <a href="mxv.html">MXV</a> ( JACOBI, RECV, SPHV )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     W.L. Taber     (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0, 19-JUL-2001 (WLT)</PRE>
<h4>Link to routine DSPHDR source file <a href='../../../src/spicelib/dsphdr.f'>dsphdr.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:13 2014</pre>

</body>
</html>

