
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>drdsph</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>drdsph</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      DRDSPH ( Derivative of rectangular w.r.t. spherical )
 
      SUBROUTINE DRDSPH ( R, COLAT, LONG, JACOBI )
      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     This routine computes the Jacobian of the transformation from
     spherical to rectangular coordinates.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     COORDINATES
     DERIVATIVES
     MATRIX
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION      R
      DOUBLE PRECISION      COLAT
      DOUBLE PRECISION      LONG
      DOUBLE PRECISION      JACOBI ( 3, 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     R          I   Distance of a point from the origin.
     COLAT      I   Angle of the point from the positive Z-axis.
     LONG       I   Angle of the point from the XY plane.
     JACOBI     O   Matrix of partial derivatives.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     R          Distance of a point from the origin.

     COLAT      Angle between the point and the positive z-axis, in
                radians.

     LONG       Angle of the point from the XZ plane in radians.
                The angle increases in the counterclockwise sense
                about the +Z axis.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     JACOBI     is the matrix of partial derivatives of the conversion
                between spherical and rectangular coordinates, 
                evaluated at the input coordinates.  This matrix has 
                the form

                    .-                                   -.
                    |  DX/DR     DX/DCOLAT     DX/DLONG   |
                    |                                     |
                    |  DY/DR     DY/DCOLAT     DY/DLONG   |
                    |                                     |
                    |  DZ/DR     DZ/DCOLAT     DZ/DLONG   |
                    `-                                   -'

               evaluated at the input values of R, LONG and LAT.
               Here X, Y, and Z are given by the familiar formulae

                   X = R*COS(LONG)*SIN(COLAT)
                   Y = R*SIN(LONG)*SIN(COLAT)
                   Z = R*COS(COLAT)
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     It is often convenient to describe the motion of an object in
     the spherical coordinate system.  However, when performing
     vector computations its hard to beat rectangular coordinates.

     To transform states given with respect to spherical coordinates
     to states with respect to rectangular coordinates, one makes use
     of the Jacobian of the transformation between the two systems.

     Given a state in spherical coordinates

          ( r, colat, long, dr, dcolat, dlong )

     the velocity in rectangular coordinates is given by the matrix
     equation:
                    t          |                                    t
        (dx, dy, dz)   = JACOBI|              * (dr, dcolat, dlong )
                               |(r,colat,long)

     This routine computes the matrix 

              |
        JACOBI|
              |(r,colat,long)
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose that one has a model that gives the radius, colatitude 
     and longitude as a function of time (r(t), colat(t), long(t)), 
     for which the derivatives ( dr/dt, dcolat/dt, dlong/dt ) are
     computable.

     To find the velocity of the object in bodyfixed rectangular
     coordinates, one simply multiplies the Jacobian of the
     transformation from spherical to rectangular coordinates 
     (evaluated at r(t), colat(t), long(t) ) by the vector of 
     derivatives of the spherical coordinates.

     In code this looks like:

        C
        C     Load the derivatives of r, colat, and long into the
        C     spherical velocity vector SPHV.
        C
              SPHV(1) = DR_DT     ( T )
              SPHV(2) = DCOLAT_DT ( T )
              SPHV(3) = DLONG_DT  ( T )

        C
        C     Determine the Jacobian of the transformation from
        C     spherical to rectangular coordinates at the given 
        C     spherical coordinates at time T.
        C
              CALL <b>DRDSPH</b> ( R(T), COLAT(T), LONG(T), JACOBI )

        C
        C     Multiply the Jacobian on the left times the spherical
        C     velocity to obtain the rectangular velocity RECV.
        C
              CALL <a href="mxv.html">MXV</a> ( JACOBI, SPHV, RECV )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     W.L. Taber     (JPL)
     I.M. Underwood (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0, 20-JUL-2001 (WLT) (IMU)</PRE>
<h4>Link to routine DRDSPH source file <a href='../../../src/spicelib/drdsph.f'>drdsph.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:13 2014</pre>

</body>
</html>

