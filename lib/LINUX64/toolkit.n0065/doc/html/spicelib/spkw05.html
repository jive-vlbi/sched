
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spkw05</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spkw05</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
  SPKW05 ( Write SPK segment, type 5 )
 
      SUBROUTINE SPKW05 ( HANDLE, BODY,  CENTER, FRAME,  FIRST, LAST,
     .                    SEGID,  GM,    N,      STATES, EPOCHS      )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Write an SPK segment of type 5 given a time-ordered set of
     discrete states and epochs, and the gravitational parameter
     of a central body.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/spk.html">SPK</a>
     <a href="../req/spc.html">SPC</a>
     <a href="../req/naif_ids.html">NAIF_IDS</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EPHEMERIS
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               HANDLE
      INTEGER               BODY
      INTEGER               CENTER
      CHARACTER*(*)         FRAME
      DOUBLE PRECISION      FIRST
      DOUBLE PRECISION      LAST
      CHARACTER*(*)         SEGID
      DOUBLE PRECISION      GM
      INTEGER               N
      DOUBLE PRECISION      STATES   ( 6, * )
      DOUBLE PRECISION      EPOCHS   (    * )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     HANDLE     I   Handle of an SPK file open for writing.
     BODY       I   Body code for ephemeris object.
     CENTER     I   Body code for the center of motion of the body.
     FRAME      I   The reference frame of the states.
     FIRST      I   First valid time for which states can be computed.
     LAST       I   Last valid time for which states can be computed.
     SEGID      I   Segment identifier.
     GM         I   Gravitational parameter of central body.
     N          I   Number of states and epochs.
     STATES     I   States.
     EPOCHS     I   Epochs.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE      is the file handle of an SPK file
                 opened for writing.

     BODY        is the NAIF ID for the body whose states are
                 to be recorded in an SPK file.

     CENTER      is the NAIF ID for the center of motion associated
                 with BODY.

     FRAME       is the reference frame that states are referenced to,
                 for example 'J2000'.

     FIRST       are the bounds on the ephemeris times, expressed as
     LAST        seconds past J2000, for which the states can be used
                 to interpolate a state for BODY.

     SEGID       is the segment identifier. An SPK segment identifier
                 may contain up to 40 characters.

     GM          is the gravitational parameter of the central body
                 ( in units of kilometers **3 / seconds **2 ).

     N           is the number of states and epochs to be stored
                 in the segment.

     STATES      contains a time-ordered array of geometric states
                 ( x, y, z, dx/dt, dy/dt, dz/dt, in kilometers and
                 kilometers per second ) of the target body with
                 respect to the central body specified in the segment
                 descriptor.

     EPOCHS      contains the epochs (ephemeris seconds past J2000)
                 corresponding to the states in STATES.  Epochs must
                 form a strictly increasing sequence.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.  A type 5 segment is written to the file attached to HANDLE.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If GM is not positive, the error SPICE(NONPOSITIVEMASS)
        signals.

     2) If the input epochs do not form an increasing sequence, the
        error SPICE(UNORDEREDTIMES) will be signalled.

     3) If the number of states and epochs is not positive then the
        error SPICE(NUMSTATESNOTPOS) will be signalled.

     4) If FIRST is greater than LAST then the error
        SPICE(BADDESCRTIMES) will be signalled.

     5) If SEGID is more than 40 characters long, the error
        SPICE(SEGIDTOOLONG) is signalled.

     6) If SEGID contains any nonprintable characters, the error
        SPICE(NONPRINTABLECHARS) is signalled.

     7) Any file I/O problems will be detected and diagnosed by one
        of the DAF routines called by this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     A new type 05 SPK segment is written to the SPK file attached
     to HANDLE.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine writes an SPK type 05 data segment to the open SPK
     file according to the format described in the type 05 section of
     the SPK Required Reading. The SPK file must have been opened with
     write access.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose that you have states and are prepared to produce
     a segment of type 05 in an SPK file.

     The following code fragment could be used to add the new segment
     to a previously opened SPK file attached to HANDLE. The file must
     have been opened with write access.

     C
     C      Create a segment identifier.
     C
            SEGID = 'MY_SAMPLE_SPK_TYPE_5_SEGMENT'

     C
     C      Write the segment.
     C
            CALL <b>SPKW05</b> ( HANDLE, BODY, CENTER, FRAME,  FIRST, LAST,
          .               SEGID,  GM,   N,      STATES, EPOCHS      )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     K.R. Gehringer  (JPL)
     J.M. Lynch      (JPL)
     W.L. Taber      (JPL)
     I.M. Underwood  (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 30-OCT-2006 (BVS)

        Removed restriction that the input reference frame should be
        inertial by changing the routine that determins the frame ID
        from the name from <a href="irfnum.html">IRFNUM</a> to <a href="namfrm.html">NAMFRM</a>.

    SPICELIB Version 1.0.2, 27-JAN-2003 (EDW)

        Added error check to catch non-positive gravitational
        parameter GM.

    SPICELIB Version 1.0.1, 05-OCT-1993 (KRG)

        Removed all references to a specific method of opening the SPK
        file in the $ Brief_I/O, $ Detailed_Input, $ Particulars and
        $ Examples sections of the header. It is assumed that a person
        using this routine has some knowledge of the DAF system and the
        methods for obtaining file handles.

    SPICELIB Version 1.0.0, 01-APR-1992 (JML) (WLT) (IMU)</PRE>
<h4>Link to routine SPKW05 source file <a href='../../../src/spicelib/spkw05.f'>spkw05.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:25:09 2014</pre>

</body>
</html>

