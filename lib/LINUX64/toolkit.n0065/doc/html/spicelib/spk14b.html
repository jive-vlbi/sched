
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spk14b</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spk14b</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      SPK14B ( SPK type 14: Begin a segment.)
 
      SUBROUTINE SPK14B ( HANDLE, SEGID,
     .                    BODY,   CENTER, FRAME,
     .                    FIRST,  LAST,   CHBDEG  )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Begin a type 14 SPK segment in the SPK file associated with
     HANDLE. See also <a href="spk14a.html">SPK14A</a> and <a href="spk14e.html">SPK14E</a>.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/spk.html">SPK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     SPK
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      INCLUDE 'sgparam.inc'
 
      INTEGER               HANDLE
      CHARACTER*(*)         SEGID
      INTEGER               BODY
      INTEGER               CENTER
      CHARACTER*(*)         FRAME
      DOUBLE PRECISION      FIRST
      DOUBLE PRECISION      LAST
      INTEGER               CHBDEG
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     HANDLE     I   The handle of an SPK file open for writing.
     SEGID      I   The string to use for segment identifier.
     BODY       I   The NAIF ID code for the body of the segment.
     CENTER     I   The center of motion for BODY.
     FRAME      I   The reference frame for this segment.
     FIRST      I   The first epoch for which the segment is valid.
     LAST       I   The last epoch for which the segment is valid.
     CHBDEG     I   The degree of the Chebyshev Polynomial used.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE   is the file handle of an SPK file that has been
              opened for writing.

     SEGID    is the segment identifier. An SPK segment identifier
              may contain up to 40 printing ASCII characters.

     BODY     is the SPICE ID for the body whose states are
              to be recorded in an SPK file.

     CENTER   is the SPICE ID for the center of motion associated
              with BODY.

     FRAME    is the reference frame that states are referenced to,
              for example 'J2000'.

     FIRST    is the starting epoch, in seconds past J2000, for
              the ephemeris data to be placed into the segment.

     LAST     is the ending epoch, in seconds past J2000, for
              the ephemeris data to be placed into the segment.

     CHBDEG   is the degree of the Chebyshev Polynomials used to
              represent the ephemeris information stored in the
              segment.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.    The input data is used to create the segment summary for
              the segment being started in the SPK file associated with
              HANDLE.

              See the $ Particulars section for details about the
              structure of a type 14 SPK segment.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     This subroutine makes use of parameters defined in the file
     'sgparam.inc'.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the degree of the Chebyshev Polynomial to be used for this
        segment is negative, the error SPICE(INVALIDARGUMENT) will
        be signaled.

     2) Errors in the structure or content of the inputs other than the
        degree of the Chebyshev Polynomial are diagnosed by routines
        called by this one.

     3) File access errors are diagnosed by routines in the call tree
        of this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
      See HANDLE in the $ Detailed_Input section.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine begins writing a type 14 SPK segment to the open SPK
     file that is associated with HANDLE. The file must have been
     opened with write access.

     This routine is one of a set of three routines for creating and
     adding data to type 14 SPK segments. These routines are:

        <b>SPK14B</b>: Begin a type 14 SPK segment. This routine must be
                called before any data may be added to a type 14
                segment.

        <a href="spk14a.html">SPK14A</a>: Add data to a type 14 SPK segment. This routine may be
                called any number of times after a call to <b>SPK14B</b> to
                add type 14 records to the SPK segment that was
                started.

        <a href="spk14e.html">SPK14E</a>: End a type 14 SPK segment. This routine is called to
                make the type 14 segment a permanent addition to the
                SPK file. Once this routine is called, no further type
                14 records may be added to the segment. A new segment
                must be started.

     A type 14 SPK segment consists of coefficient sets for fixed order
     Chebyshev polynomials over consecutive time intervals, where the
     time intervals need not all be of the same length. The Chebyshev
     polynomials represent the position, X, Y, and Z coordinates, and
     the velocities, dX/dt, dY/dt, and dZ/dt, of BODY relative to
     CENTER.

     The ephemeris data supplied to the type 14 SPK writer is packed
     into an array as a sequence of records,

        -----------------------------------------------------
        | Record 1 | Record 2 | ... | Record N-1 | Record N |
        -----------------------------------------------------

     with each record has the following format.

           ------------------------------------------------
           |  The midpoint of the approximation interval  |
           ------------------------------------------------
           |  The radius of the approximation interval    |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the X coordinate  |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the Y coordinate  |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the Z coordinate  |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the X velocity    |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the Y velocity    |
           ------------------------------------------------
           |  CHBDEG+1 coefficients for the Z velocity    |
           ------------------------------------------------
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Assume we have the following for each of the examples that
     follow.

        HANDLE   is the handle of an SPK file opened with write
                 access.

        SEGID    is a character string of no more than 40 characters
                 which provides a pedigree for the data in the SPK
                 segment we will create.

        BODY     is the SPICE ID code for the body whose ephemeris
                 is to be placed into the file.

        CENTER   is the center of motion for the ephemeris of BODY.

        REFFRM   is the name of the SPICE reference frame for the
                 ephemeris.

        FIRST    is the starting epoch, in seconds past J2000, for
                 the ephemeris data to be placed into the segment.

        LAST     is the ending epoch, in seconds past J2000, for
                 the ephemeris data to be placed into the segment.

     Example 1:

        For this example, we also assume that:

           N        is the number of type 14 records that we want to
                    put into a segment in an SPK file.

           RECRDS   contains N type 14 records packaged for the SPK
                    file.

           ETSTRT   contains the initial epochs for each of the
                    records contained in RECRDS, where

                       ETSTRT(I) &lt; ETSTRT(I+1), I = 1, N-1

                       ETSTRT(1) &lt;= FIRST, ETSTRT(N) &lt; LAST

                       ETSTRT(I+1), I = 1, N-1, is the ending epoch for
                       record I as well as the initial epoch for record
                       I+1.

        Then the following code fragment demonstrates how to create a
        type 14 SPK segment if all of the data for the segment is
        available at one time.

        C
        C     Begin the segment.
        C
              CALL <b>SPK14B</b> ( HANDLE, SEGID, BODY, CENTER, REFFRM,
             .              FIRST,  LAST,  CHBDEG                )
        C
        C     Add the data to the segment all at once.
        C
              CALL <a href="spk14a.html">SPK14A</a> ( HANDLE, N, RECRDS, ETSTRT )
        C
        C     End the segment, making the segment a permanent addition
        C     to the SPK file.
        C
              CALL <a href="spk14e.html">SPK14E</a> ( HANDLE )

     Example 2:

        In this example we want to add type 14 SPK records, as
        described above in the $ Particulars section, to the segment
        being written as they are generated.  The ability to write the
        records in this way is useful if computer memory is limited. It
        may also be convenient from a programming perspective to write
        the records one at a time.

        For this example, assume that we want to generate N type 14 SPK
        records, one for each of N time intervals, writing them all to
        the same segment in the SPK file. Let

           N        be the number of type 14 records that we want to
                    generate and put into a segment in an SPK file.

           RECORD   be an array with enough room to hold a single type
                    14 record, i.e. RECORD should have dimension at
                    least 6 * (CHBDEG + 1 ) + 2.

           START    be an array of N times that are the beginning
                    epochs for each of the intervals of interest. The
                    times should be in increasing order and the start
                    time for the first interval should equal the
                    starting time for the segment.

                       START(I) &lt; START(I+1), I = 1, N-1

                       START(1) = FIRST

           STOP     be an array of N times that are the ending epochs
                    for each of the intervals of interest. The times
                    should be in increasing order and the stop time for
                    interval I should equal the start time for interval
                    I+1, i.e., we want to have continuous coverage in
                    time across all of the records. Also, the stop time
                    for the last interval should equal the ending time
                    for the segment.

                       STOP(I) &lt; STOP(I+1), I = 1, N-1

                       STOP(I) = START(I+1), I = 1, N-1

                       STOP(N) = LAST

           GENREC( TIME1, TIME2, RECORD )

                    be a subroutine that generates a type 14 SPK record
                    for a time interval specified by TIME1 and TIME2.

        Then the following code fragment demonstrates how to create a
        type 14 SPK segment if all of the data for the segment is not
        available at one time.

        C
        C     Begin the segment.
        C
              CALL <b>SPK14B</b> ( HANDLE, SEGID, BODY, CENTER, REFFRM,
             .              FIRST,  LAST,  CHBDEG                )

        C
        C     Generate the records and write them to the segment in the
        C     SPK file one at at time.
        C
              DO I = 1, N

                 CALL GENREC ( START(I), STOP(I), RECORD )
                 CALL <a href="spk14a.html">SPK14A</a> ( HANDLE, 1, RECORD, START(I) )

              END DO

        C
        C     End the segment, making the segment a permanent addition
        C     to the SPK file.
        C
              CALL <a href="spk14e.html">SPK14E</a> ( HANDLE )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     The SPK file must be open with write access.

     Only one segment may be written to a particular SPK file at a
     time. All of the data for the segment must be written and the
     segment must be ended before another segment may be started in
     the file.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
      None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
      K.R. Gehringer      (JPL)
      B.V. Semenov        (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.2, 10-FEB-2014 (BVS)

        Removed comments from the Declarations section.

    SPICELIB Version 1.0.1, 30-OCT-2006 (BVS)

        Deleted &quot;inertial&quot; from the FRAME description in the Brief_I/O
        section of the header.

    SPICELIB Version 1.0.0, 06-MAR-1995 (KRG)</PRE>
<h4>Link to routine SPK14B source file <a href='../../../src/spicelib/spk14b.f'>spk14b.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:25:01 2014</pre>

</body>
</html>

