
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>gfoclt</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>gfoclt</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 GFOCLT ( GF, find occultation )

      SUBROUTINE GFOCLT ( OCCTYP,  FRONT,   FSHAPE,  FFRAME,
     .                    BACK,    BSHAPE,  BFRAME,  ABCORR,
     .                    OBSRVR,  STEP,    CNFINE,  RESULT  )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Determine time intervals when an observer sees one target
     body occulted by, or in transit across, another.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/frames.html">FRAMES</a>
     <a href="../req/gf.html">GF</a>
     <a href="../req/kernel.html">KERNEL</a>
     <a href="../req/naif_ids.html">NAIF_IDS</a>
     <a href="../req/spk.html">SPK</a>
     <a href="../req/time.html">TIME</a>
     <a href="../req/windows.html">WINDOWS</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EVENT
     GEOMETRY
     SEARCH
     WINDOW
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
      IMPLICIT NONE

      INCLUDE               'gf.inc'
      INCLUDE               'zzholdd.inc'

      INTEGER               LBCELL
      PARAMETER           ( LBCELL = -5 )

      CHARACTER*(*)         OCCTYP
      CHARACTER*(*)         FRONT
      CHARACTER*(*)         FSHAPE
      CHARACTER*(*)         FFRAME
      CHARACTER*(*)         BACK
      CHARACTER*(*)         BSHAPE
      CHARACTER*(*)         BFRAME
      CHARACTER*(*)         ABCORR
      CHARACTER*(*)         OBSRVR
      DOUBLE PRECISION      STEP
      DOUBLE PRECISION      CNFINE ( LBCELL : * )
      DOUBLE PRECISION      RESULT ( LBCELL : * )
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     LBCELL     P   SPICE Cell lower bound.
     CNVTOL     P   Convergence tolerance.
     ZZGET      P   ZZHOLDD retrieves a stored DP value.
     GF_TOL     P   ZZHOLDD acts on the GF subsystem tolerance.
     OCCTYP     I   Type of occultation.
     FRONT      I   Name of body occulting the other.
     FSHAPE     I   Type of shape model used for front body.
     FFRAME     I   Body-fixed, body-centered frame for front body.
     BACK       I   Name of body occulted by the other.
     BSHAPE     I   Type of shape model used for back body.
     BFRAME     I   Body-fixed, body-centered frame for back body.
     ABCORR     I   Aberration correction flag.
     OBSRVR     I   Name of the observing body.
     STEP       I   Step size in seconds for finding occultation
                    events.
     CNFINE     I   SPICE window to which the search is restricted.
     RESULT     O   SPICE window containing results.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     OCCTYP     indicates the type of occultation that is to be found.
                Note that transits are considered to be a type of
                occultation.

                Supported values and corresponding definitions are:

                   'FULL'               denotes the full occultation
                                        of the body designated by
                                        BACK by the body designated
                                        by FRONT, as seen from
                                        the location of the observer.
                                        In other words, the occulted
                                        body is completely invisible
                                        as seen from the observer's
                                        location.

                   'ANNULAR'            denotes an annular
                                        occultation: the body
                                        designated by FRONT blocks
                                        part of, but not the limb of,
                                        the body designated by BACK,
                                        as seen from the location of
                                        the observer.

                   'PARTIAL'            denotes a partial,
                                        non-annular occultation: the
                                        body designated by FRONT
                                        blocks part, but not all, of
                                        the limb of the body
                                        designated by BACK, as seen
                                        from the location of the
                                        observer.

                   'ANY'                denotes any of the above three
                                        types of occultations:
                                        'PARTIAL', 'ANNULAR', or
                                        'FULL'.

                                        'ANY' should be used to search
                                        for times when the body
                                        designated by FRONT blocks
                                        any part of the body designated
                                        by BACK.

                                        The option 'ANY' must be used
                                        if either the front or back
                                        target body is modeled as
                                        a point.

                Case and leading or trailing blanks are not
                significant in the string OCCTYP.



     FRONT      is the name of the target body that occults---that is,
                passes in front of---the other. Optionally, you may
                supply the integer NAIF ID code for the body as a
                string. For example both 'MOON' and '301' are
                legitimate strings that designate the Moon.

                Case and leading or trailing blanks are not
                significant in the string FRONT.


     FSHAPE     is a string indicating the geometric model used to
                represent the shape of the front target body. The
                supported options are:

                   'ELLIPSOID'     Use a triaxial ellipsoid model
                                   with radius values provided via the
                                   kernel pool. A kernel variable
                                   having a name of the form

                                      'BODYnnn_RADII'

                                   where nnn represents the NAIF
                                   integer code associated with the
                                   body, must be present in the kernel
                                   pool. This variable must be
                                   associated with three numeric
                                   values giving the lengths of the
                                   ellipsoid's X, Y, and Z semi-axes.

                   'POINT'         Treat the body as a single point.
                                   When a point target is specified,
                                   the occultation type must be
                                   set to 'ANY'.

                At least one of the target bodies FRONT and BACK must
                be modeled as an ellipsoid.

                Case and leading or trailing blanks are not
                significant in the string FSHAPE.


     FFRAME     is the name of the body-fixed, body-centered reference
                frame associated with the front target body. Examples
                of such names are 'IAU_SATURN' (for Saturn) and
                'ITRF93' (for the Earth).

                If the front target body is modeled as a point, FFRAME
                should be left blank.

                Case and leading or trailing blanks bracketing a
                non-blank frame name are not significant in the string
                FFRAME.


     BACK       is the name of the target body that is occulted
                by---that is, passes in back of---the other.
                Optionally, you may supply the integer NAIF ID code
                for the body as a string. For example both 'MOON' and
                '301' are legitimate strings that designate the Moon.

                Case and leading or trailing blanks are not
                significant in the string BACK.


     BSHAPE     is the shape specification for the body designated
                by BACK. The supported options are those for
                FSHAPE. See the description of FSHAPE above for
                details.


     BFRAME     is the name of the body-fixed, body-centered reference
                frame associated with the ``back'' target body.
                Examples of such names are 'IAU_SATURN' (for Saturn)
                and 'ITRF93' (for the Earth).

                If the back target body is modeled as a point, BFRAME
                should be left blank.

                Case and leading or trailing blanks bracketing a
                non-blank frame name are not significant in the string
                BFRAME.


     ABCORR     indicates the aberration corrections to be applied to
                the state of each target body to account for one-way
                light time.  Stellar aberration corrections are
                ignored if specified, since these corrections don't
                improve the accuracy of the occultation determination.

                See the header of the SPICE routine <a href="spkezr.html">SPKEZR</a> for a
                detailed description of the aberration correction
                options. For convenience, the options supported by
                this routine are listed below:

                   'NONE'     Apply no correction.

                   'LT'       &quot;Reception&quot; case:  correct for
                              one-way light time using a Newtonian
                              formulation.

                   'CN'       &quot;Reception&quot; case:  converged
                              Newtonian light time correction.

                   'XLT'      &quot;Transmission&quot; case:  correct for
                              one-way light time using a Newtonian
                              formulation.

                   'XCN'      &quot;Transmission&quot; case:  converged
                              Newtonian light time correction.

                Case and blanks are not significant in the string
                ABCORR.


     OBSRVR     is the name of the body from which the occultation is
                observed. Optionally, you may supply the integer NAIF
                ID code for the body as a string.

                Case and leading or trailing blanks are not
                significant in the string OBSRVR.


     STEP       is the step size to be used in the search. STEP must
                be shorter than any interval, within the confinement
                window, over which the specified occultation condition
                is met. In other words, STEP must be shorter than the
                shortest occultation event that the user wishes to
                detect; STEP must also be shorter than the shortest
                time interval between two occultation events that
                occur within the confinement window (see below).
                However, STEP must not be *too* short, or the search
                will take an unreasonable amount of time.

                The choice of STEP affects the completeness but not
                the precision of solutions found by this routine; the
                precision is controlled by the convergence tolerance.
                See the discussion of the parameter CNVTOL for
                details.

                STEP has units of TDB seconds.


     CNFINE     is a SPICE window that confines the time period over
                which the specified search is conducted. CNFINE may
                consist of a single interval or a collection of
                intervals.

                The endpoints of the time intervals comprising CNFINE
                are interpreted as seconds past J2000 TDB.

                See the Examples section below for a code example
                that shows how to create a confinement window.

                CNFINE must be initialized by the caller via the
                SPICELIB routine <a href="ssized.html">SSIZED</a>.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     RESULT     is a SPICE window representing the set of time
                intervals, within the confinement window, when the
                specified occultation occurs.

                The endpoints of the time intervals comprising RESULT
                are interpreted as seconds past J2000 TDB.

                If RESULT is non-empty on input, its contents
                will be discarded before <b>GFOCLT</b> conducts its
                search.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     LBCELL     is the lower bound for SPICE cell arrays.

     CNVTOL     is the convergence tolerance used for finding
                endpoints of the intervals comprising the result
                window. CNVTOL is used to determine when binary
                searches for roots should terminate: when a root is
                bracketed within an interval of length CNVTOL, the
                root is considered to have been found.

                The accuracy, as opposed to precision, of roots found
                by this routine depends on the accuracy of the input
                data. In most cases, the accuracy of solutions will be
                inferior to their precision.


     See INCLUDE file gf.inc for declarations and descriptions of
     parameters used throughout the GF system.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  In order for this routine to produce correct results,
         the step size must be appropriate for the problem at hand.
         Step sizes that are too large may cause this routine to miss
         roots; step sizes that are too small may cause this routine
         to run unacceptably slowly and in some cases, find spurious
         roots.

         This routine does not diagnose invalid step sizes, except
         that if the step size is non-positive, the error
         SPICE(INVALIDSTEPSIZE) will be signaled.

     2)  Due to numerical errors, in particular,

            - Truncation error in time values
            - Finite tolerance value
            - Errors in computed geometric quantities

         it is *normal* for the condition of interest to not always be
         satisfied near the endpoints of the intervals comprising the
         result window.

         The result window may need to be contracted slightly by the
         caller to achieve desired results. The SPICE window routine
         <a href="wncond.html">WNCOND</a> can be used to contract the result window.

     3)  If name of either target or the observer cannot be translated
         to a NAIF ID code, the error will be diagnosed by a routine
         in the call tree of this routine.

     4)  If the radii of a target body modeled as an ellipsoid cannot
         be determined by searching the kernel pool for a kernel
         variable having a name of the form

            'BODYnnn_RADII'

         where nnn represents the NAIF integer code associated with
         the body, the error will be diagnosed by a routine in the
         call tree of this routine.

     5)  If either of the target bodies FRONT or BACK coincides with
         the observer body OBSRVR, the error will be diagnosed by a
         routine in the call tree of this routine.

     6)  If the body designated by FRONT coincides with that
         designated by BACK, the error will be diagnosed by a routine
         in the call tree of this routine.

     7)  If either of the body model specifiers FSHAPE or BSHAPE
         is not recognized, the error will be diagnosed by a routine
         in the call tree of this routine.

     8)  If both of the body model specifiers FSHAPE and BSHAPE
         specify point targets, the error will be diagnosed by a
         routine in the call tree of this routine.

     9)  If a target body-fixed reference frame associated with a
         non-point target is not recognized, the error will be
         diagnosed by a routine in the call tree of this routine.

     10) If a target body-fixed reference frame is not centered at
         the corresponding target body,  the error will be
         diagnosed by a routine in the call tree of this routine.

     11) If the loaded kernels provide insufficient data to
         compute any required state vector, the deficiency will
         be diagnosed by a routine in the call tree of this routine.

     12) If an error occurs while reading an SPK or other kernel file,
         the error will be diagnosed by a routine in the call tree
         of this routine.

     13) If a point target is specified and the occultation
         type is set to a valid value other than 'ANY', the
         error will be diagnosed by a routine in the call tree
         of this routine.

     14) If the output SPICE window RESULT has insufficient capacity
         to contain the number of intervals on which the specified
         occultation condition is met, the error will be diagnosed
         by a routine in the call tree of this routine. If the result
         window has size less than 2, the error SPICE(WINDOWTOOSMALL)
         will be signaled by this routine.

     15) Invalid occultation types will be diagnosed by a routine in
         the call tree of this routine.

     16) Invalid aberration correction specifications will be
         diagnosed by a routine in the call tree of this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     Appropriate SPICE kernels must be loaded by the calling program
     before this routine is called.

     The following data are required:

        - SPK data: the calling application must load ephemeris data
          for the target, source and observer that cover the time
          period specified by the window CNFINE. If aberration
          corrections are used, the states of the target bodies and of
          the observer relative to the solar system barycenter must be
          calculable from the available ephemeris data. Typically
          ephemeris data
          are made available by loading one or more SPK files via
          <a href="furnsh.html">FURNSH</a>.

        - PCK data: bodies modeled as triaxial ellipsoids must have
          semi-axis lengths provided by variables in the kernel pool.
          Typically these data are made available by loading a text
          PCK file via <a href="furnsh.html">FURNSH</a>.

        - FK data: if either of the reference frames designated by
          BFRAME or FFRAME are not built in to the SPICE system,
          one or more FKs specifying these frames must be loaded.

     Kernel data are normally loaded once per program run, NOT every
     time this routine is called.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine provides a simpler, but less flexible, interface
     than does the SPICELIB routine <a href="gfocce.html">GFOCCE</a> for conducting searches for
     occultation events. Applications that require support for
     progress reporting, interrupt handling, non-default step or
     refinement functions, or non-default convergence tolerance should
     call <a href="gfocce.html">GFOCCE</a> rather than this routine.

     This routine determines a set of one or more time intervals
     within the confinement window when a specified type of
     occultation occurs. The resulting set of intervals is returned as
     a SPICE window.

     Below we discuss in greater detail aspects of this routine's
     solution process that are relevant to correct and efficient
     use of this routine in user applications.


     The Search Process
     ==================

     The search for occultations is treated as a search for state
     transitions: times are sought when the state of the BACK body
     changes from &quot;not occulted&quot; to &quot;occulted&quot; or vice versa.

     Step Size
     =========

     Each interval of the confinement window is searched as follows:
     first, the input step size is used to determine the time
     separation at which the occultation state will be sampled.
     Starting at the left endpoint of the interval, samples of the
     occultation state will be taken at each step. If a state change
     is detected, a root has been bracketed; at that point, the
     &quot;root&quot;--the time at which the state change occurs---is found by a
     refinement process, for example, via binary search.

     Note that the optimal choice of step size depends on the lengths
     of the intervals over which the occultation state is constant:
     the step size should be shorter than the shortest occultation
     duration and the shortest period between occultations, within
     the confinement window.

     Having some knowledge of the relative geometry of the targets and
     observer can be a valuable aid in picking a reasonable step size.
     In general, the user can compensate for lack of such knowledge by
     picking a very short step size; the cost is increased computation
     time.

     Note that the step size is not related to the precision with which
     the endpoints of the intervals of the result window are computed.
     That precision level is controlled by the convergence tolerance.


     Convergence Tolerance
     =====================

     Once a root has been bracketed, a refinement process is used to
     narrow down the time interval within which the root must lie.
     This refinement process terminates when the location of the root
     has been determined to within an error margin called the
     &quot;convergence tolerance.&quot; The default convergence tolerance 
     used by this routine is set by the parameter CNVTOL (defined
     in gf.inc).
 
     The value of CNVTOL is set to a &quot;tight&quot; value so that the
     tolerance doesn't become the limiting factor in the accuracy of
     solutions found by this routine. In general the accuracy of input
     data will be the limiting factor.

     The user may change the convergence tolerance from the default
     CNVTOL value by calling the routine <a href="gfstol.html">GFSTOL</a>, e.g.

        CALL <a href="gfstol.html">GFSTOL</a>( tolerance value )

     Call <a href="gfstol.html">GFSTOL</a> prior to calling this routine. All subsequent
     searches will use the updated tolerance value.

     Setting the tolerance tighter than CNVTOL is unlikely to be 
     useful, since the results are unlikely to be more accurate. 
     Making the tolerance looser will speed up searches somewhat,
     since a few convergence steps will be omitted. However, in most
     cases, the step size is likely to have a much greater effect 
     on processing time than would the convergence tolerance.


     The Confinement Window
     ======================

     The simplest use of the confinement window is to specify a time
     interval within which a solution is sought.

     The confinement window also can be used to restrict a search to
     a time window over which required data (typically ephemeris
     data, in the case of occultation searches) are known to be
     available.

     In some cases, the confinement window be used to make searches
     more efficient. Sometimes it's possible to do an efficient search
     to reduce the size of the time period over which a relatively
     slow search of interest must be performed. See the &quot;CASCADE&quot;
     example program in gf.req for a demonstration.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Find occultations of the Sun by the Moon (that is, solar
        eclipses) as seen from the center of the Earth over the month
        December, 2001.

        Use light time corrections to model apparent positions of Sun
        and Moon. Stellar aberration corrections are not specified
        because they don't affect occultation computations.

        We select a step size of 3 minutes, which means we
        ignore occultation events lasting less than 3 minutes,
        if any exist.

        Use the meta-kernel shown below to load the required SPICE
        kernels.

           KPL/MK

           File name: <a href= "standard.html">standard.tm</a>

           This meta-kernel is intended to support operation of SPICE
           example programs. The kernels shown here should not be
           assumed to contain adequate or correct versions of data
           required by SPICE-based user applications.

           In order for an application to use this meta-kernel, the
           kernels referenced here must be present in the user's
           current working directory.


           \begindata

              KERNELS_TO_LOAD = ( 'de421.bsp',
                                  'pck00008.tpc',
                                  'naif0009.tls'  )

           \begintext


       Example code begins here.


           PROGRAM EX1

           IMPLICIT NONE

           INTEGER               <a href="wncard.html">WNCARD</a>

           CHARACTER*(*)         TIMFMT
           PARAMETER           ( TIMFMT =
          .   'YYYY MON DD HR:MN:SC.###### (TDB)::TDB' )

           INTEGER               MAXWIN
           PARAMETER           ( MAXWIN = 2 * 100 )

           INTEGER               TIMLEN
           PARAMETER           ( TIMLEN = 40 )

           INTEGER               LBCELL
           PARAMETER           ( LBCELL = -5 )

           CHARACTER*(TIMLEN)    WIN0
           CHARACTER*(TIMLEN)    WIN1
           CHARACTER*(TIMLEN)    BEGSTR
           CHARACTER*(TIMLEN)    ENDSTR

           DOUBLE PRECISION      CNFINE ( LBCELL : MAXWIN )
           DOUBLE PRECISION      ET0
           DOUBLE PRECISION      ET1
           DOUBLE PRECISION      LEFT
           DOUBLE PRECISION      RESULT ( LBCELL : MAXWIN )
           DOUBLE PRECISION      RIGHT
           DOUBLE PRECISION      STEP

           INTEGER               I

     C
     C     Load kernels.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( '<a href= "standard.html">standard.tm</a>' )

     C
     C     Initialize the confinement and result windows.
     C
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, CNFINE )
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, RESULT )

     C
     C     Obtain the TDB time bounds of the confinement
     C     window, which is a single interval in this case.
     C
           WIN0 = '2001 DEC 01 00:00:00 TDB'
           WIN1 = '2002 JAN 01 00:00:00 TDB'

           CALL <a href="str2et.html">STR2ET</a> ( WIN0, ET0 )
           CALL <a href="str2et.html">STR2ET</a> ( WIN1, ET1 )

     C
     C     Insert the time bounds into the confinement
     C     window.
     C
           CALL <a href="wninsd.html">WNINSD</a> ( ET0, ET1, CNFINE )

     C
     C     Select a 3-minute step. We'll ignore any occultations
     C     lasting less than 3 minutes. Units are TDB seconds.
     C
           STEP = 180.D0

     C
     C     Perform the search.
     C
           CALL <b>GFOCLT</b> ( 'ANY',
          .              'MOON',  'ellipsoid', 'IAU_MOON',
          .              'SUN',   'ellipsoid', 'IAU_SUN',
          .              'LT',    'EARTH',     STEP,
          .              CNFINE,  RESULT                  )


           IF ( <a href="wncard.html">WNCARD</a>(RESULT) .EQ. 0 ) THEN

              WRITE (*,*) 'No occultation was found.'

           ELSE

              DO I = 1, <a href="wncard.html">WNCARD</a>(RESULT)
     C
     C           Fetch and display each occultation interval.
     C
                 CALL <a href="wnfetd.html">WNFETD</a> ( RESULT, I, LEFT, RIGHT )

                 CALL <a href="timout.html">TIMOUT</a> ( LEFT,  TIMFMT, BEGSTR )
                 CALL <a href="timout.html">TIMOUT</a> ( RIGHT, TIMFMT, ENDSTR )

                 WRITE (*,*) 'Interval ', I
                 WRITE (*,*) '   Start time: '//BEGSTR
                 WRITE (*,*) '   Stop time:  '//ENDSTR

              END DO

           END IF

           END


     When this program was executed on a PC/Linux/g77 platform, the
     output was:

        Interval  1
           Start time: 2001 DEC 14 20:10:14.195952 (TDB)
           Stop time:  2001 DEC 14 21:35:50.317994 (TDB)



     2) Find occultations of Titan by Saturn or of Saturn by
        Titan as seen from the center of the Earth over the
        last four months of 2008. Model both target bodies as
        ellipsoids. Search for every type of occultation.

        Use light time corrections to model apparent positions of
        Saturn and Titan. Stellar aberration corrections are not
        specified because they don't affect occultation computations.

        We select a step size of 15 minutes, which means we
        ignore occultation events lasting less than 15 minutes,
        if any exist.

        Use the meta-kernel shown below to load the required SPICE
        kernels.


           KPL/MK

           File name: gfoclt_ex2.tm

           This meta-kernel is intended to support operation of SPICE
           example programs. The kernels shown here should not be
           assumed to contain adequate or correct versions of data
           required by SPICE-based user applications.

           In order for an application to use this meta-kernel, the
           kernels referenced here must be present in the user's
           current working directory.

           The names and contents of the kernels referenced
           by this meta-kernel are as follows:

              File name                     Contents
              ---------                     --------
              de421.bsp                     Planetary ephemeris
              sat288.bsp                    Satellite ephemeris for
                                            Saturn
              pck00008.tpc                  Planet orientation and
                                            radii
              naif0009.tls                  Leapseconds

           \begindata

              KERNELS_TO_LOAD = ( 'de421.bsp',
                                  'sat286.bsp',
                                  'pck00008.tpc',
                                  'naif0009.tls'  )

           \begintext

           End of meta-kernel


       Example code begins here.


           PROGRAM EX2
           IMPLICIT NONE
     C
     C     SPICELIB functions
     C
           INTEGER               <a href="wncard.html">WNCARD</a>
     C
     C     Local parameters
     C
           CHARACTER*(*)         TIMFMT
           PARAMETER           ( TIMFMT =
          .   'YYYY MON DD HR:MN:SC.###### (TDB)::TDB' )

           INTEGER               MAXWIN
           PARAMETER           ( MAXWIN = 2 * 100 )

           INTEGER               TIMLEN
           PARAMETER           ( TIMLEN = 40 )

           INTEGER               BDNMLN
           PARAMETER           ( BDNMLN = 36 )

           INTEGER               FRNMLN
           PARAMETER           ( FRNMLN = 32 )
     C
     C     Number of occultation types:
     C
           INTEGER               NTYPES
           PARAMETER           ( NTYPES = 4 )
     C
     C     Occultation type name length:
     C
           INTEGER               OCNMLN
           PARAMETER           ( OCNMLN = 10 )
     C
     C     Output line length:
     C
           INTEGER               LNSIZE
           PARAMETER           ( LNSIZE = 80 )

           INTEGER               LBCELL
           PARAMETER           ( LBCELL = -5 )

           CHARACTER*(BDNMLN)    BACK
           CHARACTER*(FRNMLN)    BFRAME
           CHARACTER*(FRNMLN)    FFRAME
           CHARACTER*(BDNMLN)    FRONT
           CHARACTER*(LNSIZE)    LINE
           CHARACTER*(BDNMLN)    OBSRVR
           CHARACTER*(OCNMLN)    OCCTYP ( NTYPES )
           CHARACTER*(LNSIZE)    TEMPLT ( NTYPES )
           CHARACTER*(TIMLEN)    TIMSTR
           CHARACTER*(LNSIZE)    TITLE
           CHARACTER*(TIMLEN)    WIN0
           CHARACTER*(TIMLEN)    WIN1

           DOUBLE PRECISION      CNFINE ( LBCELL : MAXWIN )
           DOUBLE PRECISION      ET0
           DOUBLE PRECISION      ET1
           DOUBLE PRECISION      FINISH
           DOUBLE PRECISION      RESULT ( LBCELL : MAXWIN )
           DOUBLE PRECISION      START
           DOUBLE PRECISION      STEP

           INTEGER               I
           INTEGER               J
           INTEGER               K
     C
     C     Saved variables
     C
     C     The confinement and result windows CNFINE
     C     and RESULT are saved because this practice
     C     helps to prevent stack overflow.
     C
     C     The variables OCCTYP and TEMPLT are
     C     saved to facilitate turning this main program into
     C     a subroutine. In a main program, it's not
     C     necessary to save these variables.
     C
           SAVE                  CNFINE
           SAVE                  OCCTYP
           SAVE                  RESULT
           SAVE                  TEMPLT
     C
     C     Initial values
     C
           DATA                  OCCTYP / 'FULL',
          .                               'ANNULAR',
          .                               'PARTIAL',
          .                               'ANY'     /

           DATA                  TEMPLT /
          .      'Condition: # occultation of # by #',
          .      'Condition: # occultation of # by #',
          .      'Condition: # occultation of # by #',
          .      'Condition: # occultation of # by #'      /

     C
     C     Load kernels.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( 'gfoclt_ex2.tm' )

     C
     C     Initialize the confinement and result windows.
     C
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, CNFINE )
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, RESULT )

     C
     C     Obtain the TDB time bounds of the confinement
     C     window, which is a single interval in this case.
     C
           WIN0 = '2008 SEP 01 00:00:00 TDB'
           WIN1 = '2009 JAN 01 00:00:00 TDB'

           CALL <a href="str2et.html">STR2ET</a> ( WIN0, ET0 )
           CALL <a href="str2et.html">STR2ET</a> ( WIN1, ET1 )
     C
     C     Insert the time bounds into the confinement
     C     window.
     C
           CALL <a href="wninsd.html">WNINSD</a> ( ET0, ET1, CNFINE )
     C
     C     Select a 15-minute step. We'll ignore any occultations
     C     lasting less than 15 minutes. Units are TDB seconds.
     C
           STEP = 900.D0
     C
     C     The observation location is the Earth.
     C
           OBSRVR = 'EARTH'

     C
     C     Loop over the occultation types.
     C
           DO I = 1, NTYPES
     C
     C        For each type, do a search for both transits of
     C        Titan across Saturn and occultations of Titan by
     C        Saturn.
     C
              DO J = 1, 2

                 IF ( J .EQ. 1 ) THEN

                    FRONT  = 'TITAN'
                    FFRAME = 'IAU_TITAN'
                    BACK   = 'SATURN'
                    BFRAME = 'IAU_SATURN'

                 ELSE

                    FRONT  = 'SATURN'
                    FFRAME = 'IAU_SATURN'
                    BACK   = 'TITAN'
                    BFRAME = 'IAU_TITAN'

                 END IF
     C
     C           Perform the search. The target body shapes
     C           are modeled as ellipsoids.
     C
                 CALL <b>GFOCLT</b> ( OCCTYP(I),
          .                    FRONT,  'ELLIPSOID', FFRAME,
          .                    BACK,   'ELLIPSOID', BFRAME,
          .                    'LT',   OBSRVR,      STEP,
          .                    CNFINE, RESULT              )
     C
     C           Display the results.
     C
                 WRITE (*,*) ' '
     C
     C           Substitute the occultation type and target
     C           body names into the title string:
     C
                 CALL <a href="repmc.html">REPMC</a> ( TEMPLT(I), '#', OCCTYP(I), TITLE )
                 CALL <a href="repmc.html">REPMC</a> ( TITLE,     '#', BACK,      TITLE )
                 CALL <a href="repmc.html">REPMC</a> ( TITLE,     '#', FRONT,     TITLE )

                 WRITE (*, '(A)' ) TITLE

                 IF ( <a href="wncard.html">WNCARD</a>(RESULT) .EQ. 0 ) THEN

                    WRITE (*, '(A)' ) ' Result window is empty: '
          .         //                'no occultation was found.'

                 ELSE

                    WRITE (*, '(A)' ) ' Result window start, '
          .         //                'stop times:'

                    DO K = 1, <a href="wncard.html">WNCARD</a>(RESULT)
     C
     C                 Fetch the endpoints of the Kth interval
     C                 of the result window.
     C
                       CALL <a href="wnfetd.html">WNFETD</a> ( RESULT, K, START, FINISH )

                       LINE = '  #  #'

                       CALL <a href="timout.html">TIMOUT</a> ( START, TIMFMT, TIMSTR )

                       CALL <a href="repmc.html">REPMC</a>  ( LINE, '#', TIMSTR, LINE )

                       CALL <a href="timout.html">TIMOUT</a> ( FINISH, TIMFMT, TIMSTR )

                       CALL <a href="repmc.html">REPMC</a>  ( LINE, '#', TIMSTR, LINE )

                       WRITE ( *, '(A)' ) LINE

                    END DO

                 END IF
     C
     C           We've finished displaying the results of the
     C           current search.
     C
              END DO
     C
     C        We've finished displaying the results of the
     C        searches using the current occultation type.
     C
           END DO

           WRITE (*,*) ' '

           END

     When this program was executed on a PC/Linux/g77 platform, the
     output was:


 Condition: FULL occultation of SATURN by TITAN
 Result window is empty: no occultation was found.

 Condition: FULL occultation of TITAN by SATURN
  Result window start, stop times:
   2008 OCT 27 22:08:01.627053 (TDB)  2008 OCT 28 01:05:03.375236 (TDB)
   2008 NOV 12 21:21:59.252262 (TDB)  2008 NOV 13 02:06:05.053051 (TDB)
   2008 NOV 28 20:49:02.402832 (TDB)  2008 NOV 29 02:13:58.986344 (TDB)
   2008 DEC 14 20:05:09.246177 (TDB)  2008 DEC 15 01:44:53.523002 (TDB)
   2008 DEC 30 19:00:56.577073 (TDB)  2008 DEC 31 00:42:43.222909 (TDB)

 Condition: ANNULAR occultation of SATURN by TITAN
  Result window start, stop times:
   2008 OCT 19 21:29:20.599087 (TDB)  2008 OCT 19 22:53:34.518737 (TDB)
   2008 NOV 04 20:15:38.620368 (TDB)  2008 NOV 05 00:18:59.139978 (TDB)
   2008 NOV 20 19:38:59.647712 (TDB)  2008 NOV 21 00:35:26.725908 (TDB)
   2008 DEC 06 18:58:34.073268 (TDB)  2008 DEC 07 00:16:17.647040 (TDB)
   2008 DEC 22 18:02:46.288289 (TDB)  2008 DEC 22 23:26:52.712459 (TDB)

 Condition: ANNULAR occultation of TITAN by SATURN
  Result window is empty: no occultation was found.

 Condition: PARTIAL occultation of SATURN by TITAN
  Result window start, stop times:
   2008 OCT 19 20:44:30.326771 (TDB)  2008 OCT 19 21:29:20.599087 (TDB)
   2008 OCT 19 22:53:34.518737 (TDB)  2008 OCT 19 23:38:26.250580 (TDB)
   2008 NOV 04 19:54:40.339331 (TDB)  2008 NOV 04 20:15:38.620368 (TDB)
   2008 NOV 05 00:18:59.139978 (TDB)  2008 NOV 05 00:39:58.612935 (TDB)
   2008 NOV 20 19:21:46.689523 (TDB)  2008 NOV 20 19:38:59.647712 (TDB)
   2008 NOV 21 00:35:26.725908 (TDB)  2008 NOV 21 00:52:40.604703 (TDB)
   2008 DEC 06 18:42:36.100544 (TDB)  2008 DEC 06 18:58:34.073268 (TDB)
   2008 DEC 07 00:16:17.647040 (TDB)  2008 DEC 07 00:32:16.324244 (TDB)
   2008 DEC 22 17:47:10.776722 (TDB)  2008 DEC 22 18:02:46.288289 (TDB)
   2008 DEC 22 23:26:52.712459 (TDB)  2008 DEC 22 23:42:28.850542 (TDB)

 Condition: PARTIAL occultation of TITAN by SATURN
  Result window start, stop times:
   2008 OCT 27 21:37:16.970175 (TDB)  2008 OCT 27 22:08:01.627053 (TDB)
   2008 OCT 28 01:05:03.375236 (TDB)  2008 OCT 28 01:35:49.266506 (TDB)
   2008 NOV 12 21:01:47.105498 (TDB)  2008 NOV 12 21:21:59.252262 (TDB)
   2008 NOV 13 02:06:05.053051 (TDB)  2008 NOV 13 02:26:18.227357 (TDB)
   2008 NOV 28 20:31:28.522707 (TDB)  2008 NOV 28 20:49:02.402832 (TDB)
   2008 NOV 29 02:13:58.986344 (TDB)  2008 NOV 29 02:31:33.691598 (TDB)
   2008 DEC 14 19:48:27.094229 (TDB)  2008 DEC 14 20:05:09.246177 (TDB)
   2008 DEC 15 01:44:53.523002 (TDB)  2008 DEC 15 02:01:36.360243 (TDB)
   2008 DEC 30 18:44:23.485898 (TDB)  2008 DEC 30 19:00:56.577073 (TDB)
   2008 DEC 31 00:42:43.222909 (TDB)  2008 DEC 31 00:59:17.030568 (TDB)

 Condition: ANY occultation of SATURN by TITAN
  Result window start, stop times:
   2008 OCT 19 20:44:30.326771 (TDB)  2008 OCT 19 23:38:26.250580 (TDB)
   2008 NOV 04 19:54:40.339331 (TDB)  2008 NOV 05 00:39:58.612935 (TDB)
   2008 NOV 20 19:21:46.689523 (TDB)  2008 NOV 21 00:52:40.604703 (TDB)
   2008 DEC 06 18:42:36.100544 (TDB)  2008 DEC 07 00:32:16.324244 (TDB)
   2008 DEC 22 17:47:10.776722 (TDB)  2008 DEC 22 23:42:28.850542 (TDB)

 Condition: ANY occultation of TITAN by SATURN
  Result window start, stop times:
   2008 OCT 27 21:37:16.970175 (TDB)  2008 OCT 28 01:35:49.266506 (TDB)
   2008 NOV 12 21:01:47.105498 (TDB)  2008 NOV 13 02:26:18.227357 (TDB)
   2008 NOV 28 20:31:28.522707 (TDB)  2008 NOV 29 02:31:33.691598 (TDB)
   2008 DEC 14 19:48:27.094229 (TDB)  2008 DEC 15 02:01:36.360243 (TDB)
   2008 DEC 30 18:44:23.485898 (TDB)  2008 DEC 31 00:59:17.030568 (TDB)
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     The kernel files to be used by <b>GFOCLT</b> must be loaded (normally via
     the SPICELIB routine <a href="furnsh.html">FURNSH</a>) before <b>GFOCLT</b> is called.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
    None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
    N. J. Bachman  (JPL)
    L. S. Elson    (JPL)
    E. D. Wright   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0  31-AUG-2010 (EDW)

        Implemented use of ZZHOLDD to allow user to alter convergence
        tolerance.

        Removed the STEP &gt; 0 error check. The <a href="gfsstp.html">GFSSTP</a> call includes
        the check.

    SPICELIB Version 1.0.0  07-APR-2009 (NJB) (LSE) (EDW)</PRE>
<h4>Link to routine GFOCLT source file <a href='../../../src/spicelib/gfoclt.f'>gfoclt.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:24 2014</pre>

</body>
</html>

