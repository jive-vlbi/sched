
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>stlabx</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>stlabx</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      STLABX ( Stellar aberration, transmission case )
 
      SUBROUTINE STLABX ( POBJ, VOBS, CORPOS )
      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Correct the position of a target for the stellar aberration 
     effect on radiation transmitted from a specified observer to 
     the target.  
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
      EPHEMERIS
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION   POBJ   ( 3 )
      DOUBLE PRECISION   VOBS   ( 3 )
      DOUBLE PRECISION   CORPOS ( 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
      VARIABLE  I/O  DESCRIPTION
      --------  ---  --------------------------------------------------
      POBJ       I   Position of an object with respect to the
                     observer.
      VOBS       I   Velocity of the observer with respect to the
                     Solar System barycenter.
      CORPOS     O   Corrected position of the object.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
      POBJ        is the cartesian position vector of an object with
                  respect to the observer, possibly corrected for
                  light time.  Units are km.

      VOBS        is the cartesian velocity vector of the observer
                  with respect to the Solar System barycenter.  Units
                  are km/s.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
      CORPOS      is the  position of the object relative to the 
                  observer, corrected for the stellar aberration
                  effect on radiation directed toward the target.  This
                  correction is the inverse of the usual stellar 
                  aberration correction:  the corrected vector 
                  indicates the direction in which radiation must be
                  emitted from the observer, as seen in an inertial
                  reference frame having velocity equal to that of the
                  observer, in order to reach the position indicated by
                  the input vector POBJ.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the velocity of the observer is greater than or equal
        to the speed of light, the error is diagnosed by a routine
        called by this routine.  The outputs are undefined.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
  
     In order to transmit radiation from an observer to a specified 
     target, the emission direction must be corrected for one way
     light time and for the motion of the observer relative to the 
     solar system barycenter.  The correction for the observer's 
     motion when transmitting to a target is the inverse of the 
     usual stellar aberration correction applied to the light-time 
     corrected position of the target as seen by the observer.
     
     Below is the description of the stellar aberration correction
     used in the SPICELIB routine <a href="stelab.html">STELAB</a> (with the notation changed
     slightly):

        Let r be the vector from the observer to the object, and v be
        the velocity of the observer with respect to the Solar System
        barycenter. Let w be the angle between them. The aberration
        angle phi is given by

           sin(phi) = v sin(w) / c

        Let h be the vector given by the cross product

           h = r X v

        Rotate r by phi radians about h to obtain the apparent position
        of the object.

     This routine applies the inverse correction, so here the rotation 
     about h is by -phi radians.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     In the following example, <b>STLABX</b> is used to correct the position
     of a target body for the stellar aberration effect on radiation
     transmitted to the target.

          [Previous subroutine calls have loaded an SPK file and
           the leapseconds kernel file.  The SPK file contains
           sufficient data to enable computation of observer and
           target states relative to the solar system barycenter.]

      C
      C     Get the geometric state of the observer OBS relative to 
      C     the solar system barycenter.
      C
            CALL <a href="spkssb.html">SPKSSB</a> ( OBS, ET, 'J2000', SOBS )

      C
      C     Get the light-time corrected position TPOS of the target
      C     body TARG as seen by the observer. Normally we would
      C     call <a href="spkpos.html">SPKPOS</a> to obtain this vector, but we already have
      C     the state of the observer relative to the solar system
      C     barycenter, so we can avoid looking up that state twice
      C     by calling <a href="spkapo.html">SPKAPO</a>.
      C
            CALL <a href="spkapo.html">SPKAPO</a> ( TARG, ET, 'J2000', SOBS, 'XLT', TPOS, LT )

      C
      C     Apply the correction for stellar aberration to the
      C     light-time corrected position of the target body.
      C     The corrected position is returned in the argument
      C     PCORR.
      C
            CALL <b>STLABX</b> ( TPOS, SOBS(4), PCORR )


      Note that this example is somewhat contrived. The sequence
      of calls above could be replaced by a single call to <a href="spkezp.html">SPKEZP</a>,
      using the aberration correction flag 'XLT+S'.

      For more information on aberration-corrected states or
      positions, see the headers of any of the routines

         <a href="spkezr.html">SPKEZR</a>
         <a href="spkez.html">SPKEZ</a>
         <a href="spkpos.html">SPKPOS</a>
         <a href="spkezp.html">SPKEZP</a>
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     1) W.M. Owen, Jr., JPL IOM #314.8-524, &quot;The Treatment of
        Aberration in Optical Navigation&quot;, 8 February 1985.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman    (JPL)
     W.L. Taber      (JPL)
     I.M. Underwood  (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.1, 8-JAN-2008 (NJB)

        The header example was updated to remove references
        to <a href="spkapp.html">SPKAPP</a>.

    SPICELIB Version 1.0.0, 02-JAN-2002 (IMU) (WLT) (NJB)</PRE>
<h4>Link to routine STLABX source file <a href='../../../src/spicelib/stlabx.f'>stlabx.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:25:12 2014</pre>

</body>
</html>

