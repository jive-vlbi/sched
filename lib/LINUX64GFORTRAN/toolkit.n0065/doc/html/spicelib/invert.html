
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>invert</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>invert</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      INVERT ( Invert a 3x3 matrix )
 
      SUBROUTINE INVERT ( M1, MOUT )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
      Generate the inverse of a 3x3 matrix.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     MATRIX,  MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION   M1   ( 3,3 )
      DOUBLE PRECISION   MOUT ( 3,3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     M1         I   Matrix to be inverted.
     MOUT       O   Inverted matrix (M1)**-1.  If M1 is singular, then
                    MOUT will be the zero matrix. 
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     M1    An arbitrary 3x3 matrix.  The limits on the size of
           elements of M1 are determined by the process of calculating
           the cofactors of each element of the matrix.  For a 3x3
           matrix this amounts to the differencing of two terms, each
           of which consists of the multiplication of two matrix
           elements.  This multiplication must not exceed the range of
           double precision numbers or else an overflow error will
           occur.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     MOUT  is the inverse of M1 and is calculated explicitly using
           the matrix of cofactors.  MOUT is set to be the zero matrix
           if M1 is singular.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     First the determinant is explicitly calculated using the
     fundamental definition of the determinant.  If this value is less
     that 10**-16 then the matrix is deemed to be singular and the
     output value is filled with zeros.  Otherwise, the output matrix
     is calculated an element at a time by generating the cofactor of
     each element.  Finally, each element in the matrix of cofactors
     is multiplied by the reciprocal of the determinant and the result
     is the inverse of the original matrix.

     NO INTERNAL CHECKING ON THE INPUT MATRIX M1 IS PERFORMED EXCEPT
     ON THE SIZE OF ITS DETERMINANT.  THUS IT IS POSSIBLE TO GENERATE
     A FLOATING POINT OVERFLOW OR UNDERFLOW IN THE PROCESS OF
     CALCULATING THE MATRIX OF COFACTORS.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose that M1 is given by the following matrix equation:

             | 0   -1    0 |
        M1 = | 0.5  0    0 |  
             | 0    0    1 |   

     If <b>INVERT</b> is called according to the FORTRAN code:

        CALL <b>INVERT</b> (M1, M1)

     then M1 will be set to be:

             | 0    2    0 |
        M1 = |-1    0    0 |
             | 0    0    1 |
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     The input matrix must be such that generating the cofactors will
     not cause a floating point overflow or underflow.  The strictness
     of this condition depends, of course, on the computer
     installation and the resultant maximum and minimum values of
     double precision numbers.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     W.M. Owen       (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.2, 22-APR-2010 (NJB)

        Header correction: assertions that the output
        can overwrite the input have been removed.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 31-JAN-1990 (WMO)</PRE>
<h4>Link to routine INVERT source file <a href='../../../src/spicelib/invert.f'>invert.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:29 2014</pre>

</body>
</html>

