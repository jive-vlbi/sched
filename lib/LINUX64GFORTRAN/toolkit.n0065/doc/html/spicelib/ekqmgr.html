
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>ekqmgr</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>ekqmgr</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 EKQMGR  ( EK, query manager )
 
      SUBROUTINE EKQMGR (  CINDEX,  ELMENT,  EQRYC,   EQRYD,   EQRYI,
     .                     FNAME,   ROW,     SELIDX,  COLUMN,  HANDLE,
     .                     N,       TABLE,   ATTDSC,  CCOUNT,  FOUND,
     .                     NELT,    NMROWS,  SEMERR,  ERRMSG,  CDATA,
     .                     DDATA,   IDATA,   NULL                     )
       
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Manage query operations on EK files.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ek.html">EK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EK
     FILES
     SEARCH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
 
      INCLUDE  'ekattdsc.inc'
      INCLUDE  'ekbool.inc'
      INCLUDE  'ekcnamsz.inc'
      INCLUDE  'ekcoldsc.inc'
      INCLUDE  'ekjrs.inc'
      INCLUDE  'ekopcd.inc'
      INCLUDE  'ekqlimit.inc'
      INCLUDE  'ekquery.inc'
      INCLUDE  'eksegdsc.inc'
      INCLUDE  'ektnamsz.inc'
      INCLUDE  'ektype.inc'
 
      INTEGER               FTSIZE
      PARAMETER           ( FTSIZE =   20 )
 
      INTEGER               STSIZE
      PARAMETER           ( STSIZE =  200 )
 
      INTEGER               MXTBLD
      PARAMETER           ( MXTBLD =  100 )
 
      INTEGER               MXCLLD
      PARAMETER           ( MXCLLD =  500 )
 
      INTEGER               LBCELL
      PARAMETER           ( LBCELL = -5 )
 
 
      INTEGER               CINDEX
      INTEGER               ELMENT
      CHARACTER*(*)         EQRYC
      DOUBLE PRECISION      EQRYD  ( * )
      INTEGER               EQRYI  ( LBCELL : * )
      CHARACTER*(*)         FNAME
      INTEGER               ROW
      INTEGER               SELIDX
      CHARACTER*(*)         COLUMN
      INTEGER               HANDLE
      INTEGER               N
      CHARACTER*(*)         TABLE
      INTEGER               ATTDSC ( ADSCSZ )
      INTEGER               CCOUNT
      LOGICAL               FOUND
      INTEGER               NELT
      INTEGER               NMROWS
      LOGICAL               SEMERR
      CHARACTER*(*)         ERRMSG
      CHARACTER*(*)         CDATA
      DOUBLE PRECISION      DDATA
      INTEGER               IDATA
      LOGICAL               NULL
 
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Entry points
     --------  ---  --------------------------------------------------
     CINDEX     I   <a href="ekcii.html">EKCII</a>
     ELMENT     I   <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>
     EQRYC      I   <a href="eksrch.html">EKSRCH</a>
     EQRYD      I   <a href="eksrch.html">EKSRCH</a>
     EQRYI      I   <a href="eksrch.html">EKSRCH</a>
     FNAME      I   <a href="eklef.html">EKLEF</a>
     ROW        I   <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>, <a href="eknelt.html">EKNELT</a>
     SELIDX     I   <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>, <a href="eknelt.html">EKNELT</a>
     COLUMN    I-O  EKCIN, <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>, <a href="eknelt.html">EKNELT</a>, <a href="ekcii.html">EKCII</a>
     HANDLE    I-O  <a href="eklef.html">EKLEF</a>, <a href="ekuef.html">EKUEF</a>
     N         I-O  <a href="ektnam.html">EKTNAM</a>, <a href="ekntab.html">EKNTAB</a>
     TABLE     I-O  <a href="ekccnt.html">EKCCNT</a>, <a href="ekcii.html">EKCII</a>, <a href="ektnam.html">EKTNAM</a>
     ATTDSC     O   <a href="ekcii.html">EKCII</a>, EKCIN
     CCOUNT     O   <a href="ekccnt.html">EKCCNT</a>
     FOUND      O   EKCIN, <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>
     NELT       O   <a href="eknelt.html">EKNELT</a>
     NMROWS     O   <a href="eksrch.html">EKSRCH</a>
     SEMERR     O   <a href="eksrch.html">EKSRCH</a>
     ERRMSG     O   <a href="eksrch.html">EKSRCH</a>
     CDATA      O   <a href="ekgc.html">EKGC</a>
     DDATA      O   <a href="ekgd.html">EKGD</a>
     IDATA      O   <a href="ekgi.html">EKGI</a>
     NULL       O   <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>
     FTSIZE     P   All
     MAXCON     P   All
     MXCLLD     P   All
     STSIZE     P   All
     MAXORD     P   All
     CNAMSZ     P   All
     ITSIZE     P   All
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     See the entry points for descriptions of their inputs.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     See the entry points for descriptions of their outputs.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     FTSIZE         is the maximum number of EK files that may be
                    loaded.  Any other DAS files loaded by the calling
                    program count against this limit.

     STSIZE         is the size of the segment table; this is the
                    maximum number of segments that can be loaded at
                    one time.

     MXTBLD         is the maximum number of tables that can be loaded
                    at any time.  A table can consist of multiple
                    segments.

     MXCLLD         is the maximum number of columns that can be loaded
                    at any time.  A column may be spread across
                    multiple segments; in this case, the portions of
                    the column contained in each segment count against
                    this limit.

     ADSCSZ         is the size of column attribute descriptor.
                    (Defined in ekattdsc.inc.)

     LBCELL         is the SPICELIB cell lower bound.

     Many other parameters are defined in the include files referenced
     above.  See those files for details.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If this routine is called directly, the error
         SPICE(BOGUSENTRY) is signaled.

     See the headers of the entry points for descriptions of exceptions
     specific to those routines.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     This suite of routines reads binary `sequence component' EK files.
     In order for a binary EK file to be accessible to this routine,
     the file must be `loaded' via a call to the entry point <a href="eklef.html">EKLEF</a>.

     Text format EK files cannot be used by this routine; they must
     first be converted by binary format by the NAIF Toolkit utility
     SPACIT.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     <b>EKQMGR</b> is an umbrella routine for its entry points:  all variables
     used by the entry points are declared here.

     <b>EKQMGR</b> supports loading and unloading EK files, executing queries,
     and fetching the results of executed queries.  The entry points
     and their functions are:

        File loading and unloading:

           <a href="eklef.html">EKLEF</a>  ( EK, load event file   )
           <a href="ekuef.html">EKUEF</a>  ( EK, unload event file )

        Query execution:

           <a href="eksrch.html">EKSRCH</a> ( EK, search for events )

        Fetching query results:

           <a href="ekgc.html">EKGC</a>   ( EK, get event data, character        )
           <a href="ekgd.html">EKGD</a>   ( EK, get event data, double precision )
           <a href="ekgi.html">EKGI</a>   ( EK, get event data, integer          )

        Utilities:

           <a href="ekntab.html">EKNTAB</a> ( EK, return the number of loaded tables        )
           <a href="ektnam.html">EKTNAM</a> ( EK, return the names of loaded tables         )
           <a href="ekccnt.html">EKCCNT</a> ( EK, return the column count of a table        )
           <a href="ekcii.html">EKCII</a>  ( EK, look up column info by index              )
           <a href="eknelt.html">EKNELT</a> ( EK, return number of elements in column entry )


     To issue queries to the EK system, users would normally call the
     high-level interface routine <a href="ekfind.html">EKFIND</a>.  <a href="ekfind.html">EKFIND</a> parses queries and
     converts them to the encoded form expected by <a href="eksrch.html">EKSRCH</a>.  It is
     possible to call <a href="eksrch.html">EKSRCH</a> directly, but this should not be attempted
     by others than EK masters.  <a href="ekfind.html">EKFIND</a> is not an entry point of
     <b>EKQMGR</b>, but instead is a separate subroutine.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  Query the EK system and fetch data matching queries.
         The code fragment shown here does not rely on advance
         knowledge of the input query or the contents of any loaded EK
         files.

         To simplify the example, we assume that all data are scalar.
         This assumption relieves us of the need to test the size of
         column entries before fetching them.  In the event that a
         column contains variable-size array entries, the entry point
         <a href="eknelt.html">EKNELT</a> may be called to obtain the size of column entries to
         be fetched.  See <a href="eknelt.html">EKNELT</a> for an example.


            C
            C     Load EK file.  Also load leapseconds file for
            C     time conversion.
            C
                  CALL <a href="eklef.html">EKLEF</a>  ( EK, HANDLE )
                  CALL <a href="furnsh.html">FURNSH</a> ( LEAP       )

            C
            C     Prompt for query.  Parse the SELECT clause using
            C     <a href="ekpsel.html">EKPSEL</a>.
            C
                  CALL PROMPT ( 'Enter query &gt; ', QUERY )

                  CALL <a href="ekpsel.html">EKPSEL</a> ( QUERY,
                                N,
                                XBEGS,
                                XENDS,
                                XBEGS,
                                XTYPES,
                                XCLASS,
                                TABS,
                                COLS,
                                ERROR,
                                ERRMSG )


                  IF ( ERROR ) THEN

                     WRITE (*,*) ERRMSG

                  ELSE
            C
            C        Submit query to the EK query system.
            C
                     CALL <a href="ekfind.html">EKFIND</a> ( QUERY, NMROWS, ERROR, ERRMSG )

                     IF ( ERROR ) THEN

                        WRITE (*,*) ERRMSG

                     ELSE
            C
            C           Fetch the rows that matched the query.
            C
                        DO ROW = 1, NMROWS
            C
            C              Fetch data from the Ith row.
            C
                           WRITE (*,*) ' '
                           WRITE (*,*) 'ROW = ', ROW

                           DO COL = 1, N
            C
            C                 Fetch the data from the Jth selected
            C                 column.
            C
                              IF ( XCLASS(COL) .EQ. 'COL' ) THEN

                                 OUTSTR  =  COLS(COL)
                                 CALL <a href="prefix.html">PREFIX</a> ( '.',       0, OUTSTR )
                                 CALL <a href="prefix.html">PREFIX</a> ( TABS(COL), 0, OUTSTR )
                                 WRITE (*,*) 'COLUMN = ', OUTSTR

                              ELSE

                                 B  =  XBEGS(COL)
                                 E  =  XENDS(COL)
                                 WRITE (*,*) 'ITEM = ', QUERY(B:E)

                              END IF

                              IF ( XTYPES(COL) .EQ. 'CHR' ) THEN

                                 CALL <a href="ekgc.html">EKGC</a> ( COL,   ROW,   1,
                 .                           CDATA, NULL,  FOUND )

                                 IF ( NULL ) THEN
                                    WRITE (*,*) '&lt;Null&gt;'
                                 ELSE
                                    WRITE (*,*) CDATA
                                 END IF


                              ELSE IF ( XTYPES(COL) .EQ. 'DP' ) THEN

                                 CALL <a href="ekgd.html">EKGD</a> ( COL,   ROW,   1,
                 .                           DDATA, NULL,  FOUND )

                                 IF ( NULL ) THEN
                                    WRITE (*,*) '&lt;Null&gt;'
                                 ELSE
                                    WRITE (*,*) DDATA
                                 END IF


                              ELSE IF ( XTYPES(COL) .EQ. 'INT' ) THEN

                                 CALL <a href="ekgi.html">EKGI</a> ( COL,   ROW,   1,
                 .                           IDATA, NULL,  FOUND )

                                 IF ( NULL ) THEN
                                    WRITE (*,*) '&lt;Null&gt;'
                                 ELSE
                                    WRITE (*,*) IDATA
                                 END IF


                              ELSE
            C
            C                    The item is a time value.  Convert it
            C                    to UTC for output.
            C
                                 CALL <a href="ekgd.html">EKGD</a>   ( COL,   ROW,   1,
                 .                             TDATA, NULL,  FOUND )

                                 IF ( NULL ) THEN
                                    WRITE (*,*) '&lt;Null&gt;'
                                 ELSE
                                    CALL <a href="et2utc.html">ET2UTC</a> ( TDATA, 'C', 3, UTC )
                                    WRITE (*,*) UTC
                                 END IF

                              END IF

                           END DO
            C
            C              We're done with the column having index COL.
            C
                        END DO
            C
            C           We're done with the row having index ROW.
            C
                     END IF
            C
            C        We either processed the query or had an error.
            C
                  END IF
            C
            C     We either parsed the SELECT clause or had an error.
            C
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
     B.V. Semenov   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 2.0.3, 10-FEB-2014 (BVS)

        Added descriptions of ADSCSZ and LBCELL to the Parameters
        section of the header.

    SPICELIB Version 2.0.2, 22-AUG-2006 (EDW)

        Replaced references to <a href="ldpool.html">LDPOOL</a> with references 
        to <a href="furnsh.html">FURNSH</a>.

    SPICELIB Version 2.0.1, 22-SEP-2004 (EDW)

        Removed from the header descriptions, all occurrences of the 
        token used to mark the $Procedure section.

    SPICELIB Version 2.0.0, 16-NOV-2001 (NJB)

        Bug fix:   When an already loaded kernel is opened with <a href="ekopr.html">EKOPR</a>,
        it now has its link count reset to 1 via a call to <a href="ekcls.html">EKCLS</a>.
        
    SPICELIB Version 1.3.0, 12-FEB-1999 (NJB)

        Bug fix:  in entry point <a href="eknelt.html">EKNELT</a>, there was a error handling
        branch that called CHKOUT where CHKIN should have been called.
        This has been fixed.

    SPICELIB Version 1.2.0, 21-JUL-1998 (NJB)

        In the entry point <a href="eksrch.html">EKSRCH</a>, a ZZEKJSQZ call was added after 
        the ZZEKJOIN call.  This change reduces the scratch area usage 
        for intermediate results of joins.  It also prevents ZZEKJOIN 
        from being handed a join row set containing a segment vector 
        having no corresponding row vectors.

    SPICELIB Version 1.1.0, 07-JUL-1996 (NJB)

        Code fixes were made in routines

           <a href="eknelt.html">EKNELT</a>, <a href="ekgc.html">EKGC</a>, <a href="ekgd.html">EKGD</a>, <a href="ekgi.html">EKGI</a>

        Version lines were fixed in all routines:  versions were 
        changed from &quot;Beta&quot; to &quot;SPICELIB.&quot;

    SPICELIB Version 1.0.0, 23-OCT-1995 (NJB)</PRE>
<h4>Link to routine EKQMGR source file <a href='../../../src/spicelib/ekqmgr.f'>ekqmgr.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:17 2014</pre>

</body>
</html>

