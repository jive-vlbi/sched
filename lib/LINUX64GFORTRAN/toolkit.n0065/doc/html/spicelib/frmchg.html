
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>frmchg</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>frmchg</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      FRMCHG (Frame Change)
 
      SUBROUTINE FRMCHG ( FRAME1, FRAME2, ET, XFORM )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Return the state transformation matrix from one
     frame to another.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     FRAMES
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      INCLUDE              'errhnd.inc'
      INCLUDE              'frmtyp.inc'

      INTEGER               FRAME1
      INTEGER               FRAME2
      DOUBLE PRECISION      ET
      DOUBLE PRECISION      XFORM ( 6, 6 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     FRAME1     I   the frame id-code for some reference frame
     FRAME2     I   the frame id-code for some reference frame
     ET         I   an epoch in TDB seconds past J2000.
     XFORM      O   a state transformation matrix
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     FRAME1      is the frame id-code in which some states are known.

     FRAME2      is the frame id-code for some frame in which you
                 would like to represent states.

     ET          is the epoch at which to compute the state
                 transformation matrix.  This epoch should be
                 in TDB seconds past the ephemeris epoch of J2000.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     XFORM       is a 6 x 6 state transformation matrix that can
                 be used to transform states relative to the frame
                 corresponding to frame FRAME2 to states relative
                 to the frame FRAME2.  More explicitly, if STATE
                 is the state of some object relative to the reference
                 frame of FRAME1 then STATE2 is the state of the
                 same object relative to FRAME2 where STATE2 is
                 computed via the subroutine call below

                    CALL <a href="mxvg.html">MXVG</a> ( XFORM, STATE, 6, 6, STATE2 )
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If either of the reference frames is unrecognized, the error
        SPICE(UNKNOWNFRAME) will be signaled.

     2) If the auxiliary information needed to compute a non-inertial
        frame is not available an error will be diagnosed and signaled
        by a routine in the call tree of this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine allows you to compute the state transformation matrix
     between two reference frames.

     The currently supported reference frames are IAU bodyfixed frames
     and inertial reference frames.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Example 1.  Suppose that you have a state STATE1 at epoch ET
     relative to  FRAME1 and wish to determine its representation
     STATE2 relative to FRAME2.  The following subroutine calls
     would suffice to make this transformation.

        CALL <b>FRMCHG</b> ( FRAME1, FRAME2, ET,   XFORM )
        CALL <a href="mxvg.html">MXVG</a>   ( XFORM,  STATE1, 6, 6, STATE2 )



     Example 2.  Suppose that you have the angular velocity, W, of some
     rotation relative to FRAME1 at epoch ET and that you wish to
     express this angular velocity with respect to FRAME2.  The
     following subroutines will suffice to perform this computation.

        CALL <b>FRMCHG</b> ( FRAME1, FRAME2, ET, STXFRM )

     Recall that a state transformation matrix has the following form.


            -               -
           |                 |
           |    R        0   |
           |                 |
           |                 |
           |   dR            |
           |   --        R   |
           |   dt            |
           |                 |
            -               -


     The velocity of an arbitrary point P undergoing rotation with the
     angular velocity W is W x P

     Thus the velocity of P in FRAME2 is:


        dR
        --  P    +    R*(W x P )
        dt

           dR  t
     =  (  -- R  R P   +  R*(W x P)  )            ( 1 )
           dt


           dR  t                                              t
     But   -- R  is skew symmetric  (simply differentiate  R*R to see
           dt
                    dR  t
     this ).  Hence -- R R P  can be written as Ax(R*P) for some fixed
                    dt

     vector A.  Moreover the vector A can be read from the upper

                            dR  t
     triangular portion of  -- R  .  So that equation (1) above can
                            dt

     be re-written as

         dR  t
     = ( -- R  R*P   +  R*(WxP)  )
         dt

     = Ax(R*P) + R*W x R*P

     = ( [A+R*W] x R*P )


     From this final expression it follows that in FRAME2 the angular
     velocity vector is given by [A+R*W].

     The code below implements these ideas.

        CALL <b>FRMCHG</b> ( FRAME1, FRAME2, ET, STXFRM )


        DO I = 1, 3
           DO J = 1, 3

              RT  ( I, J ) = STXFRM ( I,   J )
              DRDT( I, J ) = STXFRM ( I+3, J )

           END DO
        END DO

        CALL <a href="mxmt.html">MXMT</a> ( DRDT, R, AMATRIX )

        Read the angular velocity of R from the skew symmetric matrix

         dR  t
         -- R
         dt

        Recall that if A has components A1, A2, A3 then the matrix
        corresponding to the cross product linear mapping is:

            -               -
           |   0  -A3    A2  |
           |                 |
           |  A3   0    -A1  |
           |                 |
           | -A2   A1    0   |
            -               -

        A(1) = -AMATRIX(2,3)
        A(2) =  AMATRIX(1,3)
        A(3) = -AMATRIX(1,2)

        CALL <a href="mxv.html">MXV</a>  ( R, W1,  W  )
        CALL <a href="vadd.html">VADD</a> ( A, W,   W2 )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     W.L. Taber      (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 2.0.1, 16-JAN-2014 (NJB)

        Corrected equation 1 in header comments. Corrected
        numerous spelling errors in comments.
        
    SPICELIB Version 2.0.0, 14-DEC-2008 (NJB)

        Upgraded long error message associated with frame
        connection failure.

    SPICELIB Version 1.1.0, 25-JUL-1996 (WLT)

        Bug Fix:

        The previous edition of the routine had a bug in the
        first pass of the DO WHILE that looks for a frame
        in the chain of frames associated with FRAME2 that is
        in common with the chain of frames for FRAME1.

        On machines where variables are created as static
        variables, this error could lead to finding a frame
        when a legitimate path between FRAME1 and FRAME2
        did not exist.

    SPICELIB Version 1.0.1, 06-MAR-1996 (WLT)

        An typo was fixed in the Brief I/O section. It used
        to say TDT instead of the correct time system TDB.

    SPICELIB Version 1.0.0, 28-SEP-1994 (WLT)</PRE>
<h4>Link to routine FRMCHG source file <a href='../../../src/spicelib/frmchg.f'>frmchg.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:22 2014</pre>

</body>
</html>

