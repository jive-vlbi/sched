
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>npedln</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>npedln</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
    NPEDLN ( Nearest point on ellipsoid to line )
 
      SUBROUTINE NPEDLN ( A, B, C, LINEPT, LINEDR, PNEAR, DIST )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find nearest point on a triaxial ellipsoid to a specified line,
     and the distance from the ellipsoid to the line.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ellipses.html">ELLIPSES</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSOID
     GEOMETRY
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               UBEL
      PARAMETER           ( UBEL = 9 )
 
      INTEGER               UBPL
      PARAMETER           ( UBPL = 4 )
 
      DOUBLE PRECISION      A
      DOUBLE PRECISION      B
      DOUBLE PRECISION      C
      DOUBLE PRECISION      LINEPT ( 3 )
      DOUBLE PRECISION      LINEDR ( 3 )
      DOUBLE PRECISION      PNEAR  ( 3 )
      DOUBLE PRECISION      DIST
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     A          I   Length of ellipsoid's semi-axis in the x direction
     B          I   Length of ellipsoid's semi-axis in the y direction
     C          I   Length of ellipsoid's semi-axis in the z direction
     LINEPT     I   Point on line
     LINEDR     I   Direction vector of line
     PNEAR      O   Nearest point on ellipsoid to line
     DIST       O   Distance of ellipsoid from line
     UBEL       P   Upper bound of array containing SPICELIB ellipse.
     UBPL       P   Upper bound of array containing SPICELIB plane.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     A,
     B,
     C              are the lengths of the semi-axes of a triaxial
                    ellipsoid which is centered at the origin and
                    oriented so that its axes lie on the x-, y- and
                    z- coordinate axes.  A, B, and C are the lengths of
                    the semi-axes that point in the x, y, and z
                    directions respectively.

     LINEPT
     LINEDR         are, respectively, a point and a direction vector
                    that define a line.  The line is the set of vectors

                       LINEPT   +   t * LINEDR

                    where t is any real number.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     PNEAR          is the point on the ellipsoid that is closest to
                    the line, if the line doesn't intersect the
                    ellipsoid.

                    If the line intersects the ellipsoid, PNEAR will
                    be a point of intersection.  If LINEPT is outside
                    of the ellipsoid, PNEAR will be the closest point
                    of intersection.  If LINEPT is inside the
                    ellipsoid, PNEAR will not necessarily be the
                    closest point of intersection.


     DIST           is the distance of the line from the ellipsoid.
                    This is the minimum distance between any point on
                    the line and any point on the ellipsoid.

                    If the line intersects the ellipsoid, DIST is zero.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     UBEL           is the upper bound of the array used to contain
                    a SPICELIB ellipse.  See the ELLIPSES Required
                    Reading for details.

     UBPL           is the upper bound of the array used to contain
                    a SPICELIB plane.  See the PLANES Required Reading
                    for details.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     If this routine detects an error, the output arguments NEARP and
     DIST are not modified.

     1)  If the length of any semi-axis of the ellipsoid is
         non-positive, the error SPICE(INVALIDAXISLENGTH) is signalled.

     2)  If the line's direction vector is the zero vector, the error
         SPICE(ZEROVECTOR) is signalled.

     3)  If the length of any semi-axis of the ellipsoid is zero after
         the semi-axis lengths are scaled by the reciprocal of the
         magnitude of the longest semi-axis and then squared, the error
         SPICE(DEGENERATECASE) is signalled.

     4)  If the input ellipsoid is extremely flat or needle-shaped
         and has its shortest axis close to perpendicular to the input
         line, numerical problems could cause this routine's algorithm
         to fail, in which case the error SPICE(DEGENERATECASE) is
         signalled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     For any ellipsoid and line, if the line does not intersect the
     ellipsoid, there is a unique point on the ellipsoid that is
     closest to the line.  Therefore, the distance DIST between
     ellipsoid and line is well-defined.  The unique line segment of
     length DIST that connects the line and ellipsoid is normal to
     both of these objects at its endpoints.

     If the line intersects the ellipsoid, the distance between the
     line and ellipsoid is zero.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)   We can find the distance between an instrument optic axis ray
          and the surface of a body modelled as a tri-axial ellipsoid
          using this routine.  If the instrument position and pointing
          unit vector in body-fixed coordinates are

             LINEPT = ( 1.0D6,  2.0D6,  3.0D6 )

          and

             LINEDR = ( -4.472091234D-1
                        -8.944182469D-1,
                        -4.472091234D-3  )

          and the body semi-axes lengths are

             A = 7.0D5
             B = 7.0D5
             C = 6.0D5,

          then the call to <b>NPEDLN</b>

             CALL <b>NPEDLN</b> ( A,      B,      C,
            .              LINEPT, LINEDR,
            .              PNEAR,  DIST        )

          yields a value for PNEAR, the nearest point on the body to
          the optic axis ray, of


             (  -1.6333110792340931E+03,
                -3.2666222157820771E+03,
                 5.9999183350006724E+05  )

          and a value for DIST, the distance to the ray, of

             2.3899679338299707E+06

          (These results were obtained on a PC-Linux system under g77.)

          In some cases, it may not be clear that the closest point
          on the line containing an instrument boresight ray is on
          the boresight ray itself; the point may lie on the ray
          having the same vertex as the boresight ray and pointing in
          the opposite direction.  To rule out this possibility, we
          can make the following test:

             C
             C     Find the difference vector between the closest point
             C     on the ellpsoid to the line containing the boresight
             C     ray and the boresight ray's vertex.  Find the
             C     angular separation between this difference vector
             C     and the boresight ray.  If the angular separation
             C     does not exceed pi/2, we have the nominal geometry.
             C     Otherwise, we have an error.
             C
                   CALL  <a href="vsub.html">VSUB</a> ( PNEAR,  LINEPT,  DIFF )
                   SEP = <a href="vsep.html">VSEP</a> ( DIFF,   LINEDR        )

                   IF (  SEP .LE. <a href="halfpi.html">HALFPI</a>()  ) THEN

                      [ perform normal processing ]

                   ELSE

                      [ handle error case ]

                   END IF
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.3.0, 15-NOV-2005 (NJB)

        Updated to remove non-standard use of duplicate arguments
        in <a href="vscl.html">VSCL</a> calls.  Changed exponents to DOUBLE PRECISION type
        in the test for underflow of squared, scaled axis lengths.

    SPICELIB Version 1.2.1, 06-DEC-2002 (NJB)

        Outputs shown in header example have been corrected to 
        be consistent with those produced by this routine.

    SPICELIB Version 1.2.0, 25-NOV-1992 (NJB)

        Bug fix:  in the intercept case, PNEAR is now properly
        re-scaled prior to output.  Also, an error in the $Examples
        section was corrected.

    SPICELIB Version 1.1.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.1.0, 04-DEC-1990 (NJB)

        Error message and description changed for non-positive
        axis length error.

    SPICELIB Version 1.0.0, 02-NOV-1990 (NJB)</PRE>
<h4>Link to routine NPEDLN source file <a href='../../../src/spicelib/npedln.f'>npedln.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:40 2014</pre>

</body>
</html>

