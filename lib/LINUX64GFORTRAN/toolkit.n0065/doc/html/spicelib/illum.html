
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>illum</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>illum</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 ILLUM ( Illumination angles )
 
      SUBROUTINE ILLUM ( TARGET,  ET,     ABCORR,  OBSRVR,  
     .                   SPOINT,  PHASE,  SOLAR,   EMISSN )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Deprecated: This routine has been superseded by the SPICELIB
     routine <a href="ilumin.html">ILUMIN</a>. This routine is supported for purposes of
     backward compatibility only.

     Find the illumination angles at a specified surface point of a
     target body.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/kernel.html">KERNEL</a>
     <a href="../req/naif_ids.html">NAIF_IDS</a>
     <a href="../req/spk.html">SPK</a>
     <a href="../req/time.html">TIME</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     GEOMETRY
     MOSPICE
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      INCLUDE               'zzctr.inc'

      CHARACTER*(*)         TARGET
      DOUBLE PRECISION      ET
      CHARACTER*(*)         ABCORR
      CHARACTER*(*)         OBSRVR
      DOUBLE PRECISION      SPOINT ( 3 )
      DOUBLE PRECISION      PHASE
      DOUBLE PRECISION      SOLAR
      DOUBLE PRECISION      EMISSN
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     TARGET     I   Name of target body.
     ET         I   Epoch in ephemeris seconds past J2000.
     ABCORR     I   Desired aberration correction.
     OBSRVR     I   Name of observing body.
     SPOINT     I   Body-fixed coordinates of a target surface point.
     PHASE      O   Phase angle at the surface point.
     SOLAR      O   Solar incidence angle at the surface point.
     EMISSN     O   Emission angle at the surface point.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     TARGET         is the name of the target body.  TARGET is
                    case-insensitive, and leading and trailing blanks
                    in TARGET are not significant. Optionally, you may
                    supply a string containing the integer ID code for
                    the object.  For example both 'MOON' and '301' are
                    legitimate strings that indicate the moon is the
                    target body.

     ET             is the epoch, specified in ephemeris seconds past
                    J2000, at which the apparent illumination angles at
                    the specified surface point on the target body, as
                    seen from the observing body, are to be computed.

     ABCORR         is the aberration correction to be used in
                    computing the location and orientation of the
                    target body and the location of the Sun.  Possible
                    values are:

                       'NONE'        No aberration correction.

                       'LT'          Correct the position and
                                     orientation of target body for
                                     light time, and correct the
                                     position of the Sun for light
                                     time.

                       'LT+S'        Correct the observer-target vector
                                     for light time and stellar
                                     aberration, correct the
                                     orientation of the target body
                                     for light time, and correct the
                                     target-Sun vector for light time
                                     and stellar aberration.

                       'CN'          Converged Newtonian light time
                                     correction. In solving the light
                                     time equation, the 'CN'
                                     correction iterates until the
                                     solution converges (three
                                     iterations on all supported
                                     platforms). Whether the 'CN+S'
                                     solution is substantially more
                                     accurate than the 'LT' solution
                                     depends on the geometry of the
                                     participating objects and on the
                                     accuracy of the input data. In
                                     all cases this routine will
                                     execute more slowly when a
                                     converged solution is computed.
                                     See the Particulars section of
                                     <a href="spkezr.html">SPKEZR</a> for a discussion of
                                     precision of light time
                                     corrections.

                                     Both the state and rotation of
                                     the target body are corrected for
                                     light time.

                          'CN+S'     Converged Newtonian light time
                                     correction and stellar aberration
                                     correction.

                                     Both the state and rotation of
                                     the target body are corrected for
                                     light time.

     OBSRVR         is the name of the observing body, typically a
                    spacecraft, the earth, or a surface point on the
                    earth.  OBSRVR is case-insensitive, and leading
                    and trailing blanks in OBSRVR are not significant.
                    Optionally, you may supply a string containing the
                    integer ID code for the object.  For example both
                    'EARTH' and '399' are legitimate strings that
                    indicate the earth is the observer.

                    OBSRVR may be not be identical to TARGET.

     SPOINT         is a surface point on the target body, expressed
                    in rectangular body-fixed (body equator and prime
                    meridian) coordinates.  SPOINT need not be visible
                    from the observer's location at time ET.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     PHASE          is the phase angle at SPOINT, as seen from OBSRVR
                    at time ET.  This is the angle between the
                    SPOINT-OBSRVR vector and the SPOINT-Sun vector.
                    Units are radians.  The range of  PHASE is [0, pi].
                    See Particulars below for a detailed discussion of
                    the definition.

     SOLAR          is the solar incidence angle at SPOINT, as seen
                    from OBSRVR at time ET.  This is the angle
                    between the surface normal vector at SPOINT and the
                    SPOINT-Sun vector.  Units are radians.  The range
                    of SOLAR is [0, pi]. See Particulars below for a
                    detailed discussion of the definition.

     EMISSN         is the emission angle at SPOINT, as seen from
                    OBSRVR at time ET.  This is the angle between the
                    surface normal vector at SPOINT and the
                    SPOINT-observer vector.  Units are radians.  The
                    range of EMISSN is [0, pi]. See Particulars below
                    for a detailed discussion of the definition.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If TARGET and OBSRVR are not distinct, the error
         SPICE(BODIESNOTDISTINCT) will be signaled.

     2)  If no SPK (ephemeris) data are available for the observer,
         target, and Sun at the time specified by ET, the error will
         be diagnosed by routines called by this routine.  If light
         time corrections are used, SPK data for the target body must
         be available at the time ET - LT, where LT is the one-way
         light time from the target to the observer at ET.
         Additionally, SPK data must be available for the Sun at the
         time ET - LT - LT2, where LT2 is the light time from the Sun
         to the target body at time ET - LT.

     3)  If PCK data defining the orientation or shape of the target
         body are unavailable, the error will be diagnosed by routines
         called by this routine.

     4)  If no body-fixed frame is associated with the target body,
         the error SPICE(NOFRAME) is signaled.

     5) If name of target or observer cannot be translated to its
        NAIF ID code, the error SPICE(IDCODENOTFOUND) is signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     No files are input to this routine.  However, <b>ILLUM</b> expects
     that the appropriate SPK and PCK files have been loaded via
     <a href="furnsh.html">FURNSH</a>.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     The term &quot;illumination angles&quot; refers to following set of
     angles:


        solar incidence angle    Angle between the surface normal at
                                 the specified surface point and the
                                 vector from the surface point to the
                                 Sun.

        emission angle           Angle between the surface normal at
                                 the specified surface point and the
                                 vector from the surface point to the
                                 observer.

        phase angle              Angle between the vectors from the
                                 surface point to the observing body's
                                 location and from the surface point
                                 to the Sun.

 
     The diagram below illustrates the geometrical relationships
     defining these angles.  The labels for the solar incidence,
     emission, and phase angles are &quot;s.i.&quot;, &quot;e.&quot;, and &quot;phase&quot;.


                                                      *
                                                     Sun

                    surface normal vector
                              ._                 _.
                              |\                 /|  Sun vector
                                \    phase      /
                                 \   .    .    /
                                 .            .
                                   \   ___   /
                              .     \/     \/
                                    _\ s.i./
                             .    /   \   /
                             .   |  e. \ /
         *             &lt;--------------- *  surface point on
      viewing            vector            target body
      location           to viewing
      (observer)         location


     Note that if the target-observer vector, the target normal vector
     at the surface point, and the target-sun vector are coplanar,
     then phase is the sum of incidence and emission.  This is rarely
     true; usually

        phase angle  &lt;  solar incidence angle + emission angle

     All of the above angles can be computed using light time
     corrections, light time and stellar aberration corrections, or
     no aberration corrections.  The way aberration corrections
     are used is described below.

     Care must be used in computing light time corrections.  The
     guiding principle used here is &quot;describe what appears in
     an image.&quot;  We ignore differential light time; the light times
     from all points on the target to the observer are presumed to be
     equal.


        Observer-target body vector
        ---------------------------

        Let ET be the epoch at which an observation or remote
        sensing measurement is made, and let ET - LT (&quot;LT&quot; stands
        for &quot;light time&quot;) be the epoch at which the photons received
        at ET were emitted from the body (we use the term &quot;emitted&quot;
        loosely here).

        The correct observer-target vector points from the observer's
        location at ET to the target body's location at ET - LT.
        The target-observer vector points in the opposite direction.

        Since light time corrections are not symmetric, the correct
        target-observer vector CANNOT be found by computing the light
        time corrected position of the observer as seen from the
        target body.


        Target body's orientation
        -------------------------

        Using the definitions of ET and LT above, the target
        body's orientation at ET - LT is used.  The surface
        normal is dependent on the target body's orientation, so
        the body's orientation model must be evaluated for the correct
        epoch.


        Target body -- Sun vector
        -------------------------

        All surface features on the target body will appear in
        a measurement made at ET as they were at ET-LT.  In
        particular, lighting on the target body is dependent on
        the apparent location of the Sun as seen from the target
        body at ET-LT.  So, a second light time correction is used
        in finding the apparent location of the Sun.


     Stellar aberration corrections, when used, are applied as follows:


        Observer-target body vector
        ---------------------------

        In addition to light time correction, stellar aberration is
        used in computing the apparent target body position as seen
        from the observer's location at time ET.  This apparent
        position defines the observer-target body vector.


        Target body-Sun vector
        ----------------------

        The target body-Sun vector is the apparent position of the Sun,
        corrected for light time and stellar aberration, as seen from
        the target body at time ET-LT.  Note that the target body's
        position is not affected by the stellar aberration correction
        applied in finding its apparent position as seen by the
        observer.


     Once all of the vectors, as well as the target body's
     orientation, have been computed with the proper aberration
     corrections, the element of time is eliminated from the
     computation.  The problem becomes a purely geometrical one,
     and is described by the diagram above.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms.  The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine 
     specific arithmetic implementation. 

     In the following example program, the file

        spk_m_031103-040201_030502.bsp

     is a binary SPK file containing data for Mars Global Surveyor,
     Mars, and the Sun for a time interval bracketing the date 

         2004 JAN 1 12:00:00 UTC. 

     pck00007.tpc is a planetary constants kernel file containing
     radii and rotation model constants.  naif0007.tls is a
     leapseconds kernel.

     Find the phase, solar incidence, and emission angles at the
     sub-solar and sub-spacecraft points on Mars as seen from the
     Mars Global Surveyor spacecraft at a specified UTC time.
     Use light time and stellar aberration corrections.

           PROGRAM ANGLES
           IMPLICIT NONE
     C
     C     SPICELIB functions
     C
           DOUBLE PRECISION      <a href="dpr.html">DPR</a>

     C
     C     Local parameters
     C
           INTEGER               NAMLEN
           PARAMETER           ( NAMLEN = 32 )

           INTEGER               TIMLEN
           PARAMETER           ( TIMLEN = 25 )

     C
     C     Local variables
     C
           CHARACTER*(NAMLEN)    OBSRVR
           CHARACTER*(NAMLEN)    TARGET
           CHARACTER*(TIMLEN)    UTC

           DOUBLE PRECISION      ALT
           DOUBLE PRECISION      ET
           DOUBLE PRECISION      SSCEMI
           DOUBLE PRECISION      SSCPHS
           DOUBLE PRECISION      SSCSOL
           DOUBLE PRECISION      SSLEMI
           DOUBLE PRECISION      SSLPHS
           DOUBLE PRECISION      SSLSOL
           DOUBLE PRECISION      SSOLPT ( 3 )
           DOUBLE PRECISION      SSCPT  ( 3 )

     C
     C     Load kernel files.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( 'naif0007.tls'                   )
           CALL <a href="furnsh.html">FURNSH</a> ( 'pck00007.tpc'                   )
           CALL <a href="furnsh.html">FURNSH</a> ( 'spk_m_031103-040201_030502.bsp' )


     C
     C     Convert our UTC time to ephemeris seconds past J2000.
     C
           UTC = '2004 JAN 1 12:00:00'

           CALL <a href="utc2et.html">UTC2ET</a> ( UTC, ET )

     C
     C     Assign observer and target names.  The acronym MGS 
     C     indicates Mars Global Surveyor.  See NAIF_IDS for a
     C     list of names recognized by SPICE.
     C
           TARGET = 'Mars'
           OBSRVR = 'MGS'

     C
     C     Find the sub-solar point on the Earth as seen from
     C     the MGS spacecraft at ET.  Use the &quot;surface intercept&quot; 
     C     style of sub-point definition. This makes it easy
     C     to verify the solar incidence angle.
     C
           CALL <a href="subsol.html">SUBSOL</a> ( 'Near point', TARGET,  ET,
          .              'LT+S',       OBSRVR,  SSOLPT  )

     C
     C     Now find the sub-spacecraft point.  Use the 
     C     &quot;nearest point&quot; definition of the sub-point 
     C     here---this makes it easy to verify the emission angle.
     C
           CALL <a href="subpt.html">SUBPT</a> ( 'Near point',  TARGET,  ET,
          .             'LT+S',        OBSRVR,  SSCPT,  ALT )

     C
     C     Find the phase, solar incidence, and emission
     C     angles at the sub-solar point on the Earth as seen
     C     from Mars Observer at time ET.
     C
           CALL <b>ILLUM</b> ( TARGET, ET,     'LT+S', OBSRVR, 
          .             SSOLPT, SSLPHS, SSLSOL, SSLEMI )

     C
     C     Do the same for the sub-spacecraft point.
     C
           CALL <b>ILLUM</b> ( TARGET, ET,     'LT+S', OBSRVR, 
          .             SSCPT,  SSCPHS, SSCSOL, SSCEMI )

     C
     C     Convert the angles to degrees and write them out.
     C
           SSLPHS = <a href="dpr.html">DPR</a>() * SSLPHS
           SSLSOL = <a href="dpr.html">DPR</a>() * SSLSOL
           SSLEMI = <a href="dpr.html">DPR</a>() * SSLEMI

           SSCPHS = <a href="dpr.html">DPR</a>() * SSCPHS
           SSCSOL = <a href="dpr.html">DPR</a>() * SSCSOL
           SSCEMI = <a href="dpr.html">DPR</a>() * SSCEMI

           WRITE (*,*) ' '
           WRITE (*,*) 'UTC epoch is ', UTC
           WRITE (*,*) ' '
           WRITE (*,*) 'Illumination angles at the sub-solar point:'
           WRITE (*,*) ' '
           WRITE (*,*) 'Phase angle           (deg.): ', SSLPHS
           WRITE (*,*) 'Solar incidence angle (deg.): ', SSLSOL
           WRITE (*,*) 'Emission angle        (deg.): ', SSLEMI
           WRITE (*,*) ' '
           WRITE (*,*) 'The solar incidence angle should be 0.'
           WRITE (*,*) 'The emission and phase angles should be equal.'

           WRITE (*,*) ' '
           WRITE (*,*) 'Illumination angles at the sub-s/c point:'
           WRITE (*,*) ' '
           WRITE (*,*) 'Phase angle           (deg.): ', SSCPHS
           WRITE (*,*) 'Solar incidence angle (deg.): ', SSCSOL
           WRITE (*,*) 'Emission angle        (deg.): ', SSCEMI
           WRITE (*,*) ' '
           WRITE (*,*) 'The emission angle should be 0.'
           WRITE (*,*) 'The solar incidence and phase angles should '//
          .            'be equal.'

           END


     When this program is executed, the output will be: 


        UTC epoch is 2004 JAN 1 12:00:00

        Illumination angles at the sub-solar point:

        Phase angle           (deg.):   150.210714
        Solar incidence angle (deg.):   6.3735213E-15
        Emission angle        (deg.):   150.210714

        The solar incidence angle should be 0.
        The emission and phase angles should be equal.

        Illumination angles at the sub-s/c point:

        Phase angle           (deg.):   123.398202
        Solar incidence angle (deg.):   123.398202
        Emission angle        (deg.):   6.36110936E-15

        The emission angle should be 0.
        The solar incidence and phase angles should be equal.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     C.H. Acton     (JPL)
     B.V. Semenov   (JPL)
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.3.0, 04-JUL-2014 (NJB) (BVS)

        Discussion of light time corrections was updated. Assertions
        that converged light time corrections are unlikely to be
        useful were removed.

     Last update was 19-SEP-2013 (BVS)

        Updated to save the input body names and ZZBODTRN state
        counters and to do name-ID conversions only if the counters
        have changed.

    SPICELIB Version 1.2.2, 18-MAY-2010 (BVS) 

        Index lines now state that this routine is deprecated.

    SPICELIB Version 1.2.1, 07-FEB-2008 (NJB) 

        Abstract now states that this routine is deprecated.

    SPICELIB Version 1.2.0, 23-OCT-2005 (NJB)

        Updated to remove non-standard use of duplicate arguments
        in <a href="vsub.html">VSUB</a> calls.  Replaced call to <a href="bodvar.html">BODVAR</a> with call to <a href="bodvcd.html">BODVCD</a>.

    SPICELIB Version 1.1.0, 22-JUL-2004 (NJB) 

        Updated to support representations of integers in the input
        arguments TARGET and OBSRVR.  

    SPICELIB Version 1.0.2, 27-JUL-2003 (NJB) (CHA)

        Various header corrections were made.  The example program
        was upgraded to use real kernels, and the program's output is
        shown.

    SPICELIB Version 1.0.1, 10-JUL-2002 (NJB)

        Updated Index_Entries header section.

    SPICELIB Version 1.0.0, 21-MAR-1999 (NJB)

        Adapted from the MGSSPICE version dated 10-MAR-1992.</PRE>
<h4>Link to routine ILLUM source file <a href='../../../src/spicelib/illum.f'>illum.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:27 2014</pre>

</body>
</html>

