<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2K.1beta (1.50)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Configuration Studies</TITLE>
<META NAME="description" CONTENT="Configuration Studies">
<META NAME="keywords" CONTENT="sched">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sched.css">

<LINK REL="next" HREF="node48.html">
<LINK REL="previous" HREF="node46.html">
<LINK REL="up" HREF="node13.html">
<LINK REL="next" HREF="node48.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html834"
  HREF="node48.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html830"
  HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html824"
  HREF="node46.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html832"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html835"
  HREF="node48.html">Satellite Tracking</A>
<B> Up:</B> <A NAME="tex2html831"
  HREF="node13.html">INFORMATION AND ADVICE ON</A>
<B> Previous:</B> <A NAME="tex2html825"
  HREF="node46.html">Single Dish VLBA Observing</A>
 &nbsp <B>  <A NAME="tex2html833"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION003100000000000000000"></A><A NAME="SEC:CONFIG"></A>
<BR>
Configuration Studies
</H1>

<P>
SCHED&nbsp; has capabilities, added in 2002, that are useful in array
configuration studies.  These are tied to the
<A HREF="node11.html#SEC:PLOT">plotting</A> capabilities.  If <A HREF="node124.html#MP:OBSTYPE"><TT>OBSTYPE =
CONFIG</TT></A> is specified and a UV plot is requested from the
interactive plotting menu with more than one requested source, a map
of the station locations is plotted first.  It is possible to adjust
station selection by clicking on this map, and it is even possible to
move stations.  Also, the station selection can be used to set up a
configuration optimization that uses, as a quality measure, some
statistic about the sampled cells in a grid.  Alternatively, a contour
plot of the quality measure around a selected station can be made.
The effect of multifrequency synthesis can be examined with the help
of the <A HREF="node185.html#MP:UVMFS"><TT>UVMFS</TT></A> parameter.  This all makes for
a rather interactive way of examining possible configurations.  The
style is much like that used for the VLBA configuration search, but is
far more modern and interactive.  The optimizer is fast enough that a
1.8 GHz Pentium IV under Linux, optimizing arrays of 20 stations using
12 hour tracks of 10 minute scans on 4 sources can process over 50
different configurations per second.  To describe the capabilities,
the steps involved in using them will be described.

<P>
First, start with a planning type schedule such as is described in the
<A HREF="node14.html#SEC:PLANNING">schedule planning section</A>.  The scan
characteristics can be adjusted at will.  The examples are good for
``hunt and peck'' configuration examinations.  For the optimizer,
which looks at the uv points at the beginning and end of scans, it is
useful to use something like <A HREF="node82.html#MP:DUR"><TT>DUR = 10:00</TT></A> and
<A HREF="node97.html#MP:GAP"><TT>GAP = 10:00</TT></A> to evenly space these points.
Recall that setting the frequency to 0.3 MHz (the default for uv plots
when no setup is given) gives a one kilometer wavelength so the UV
coverage is in km.

<P>
There are two ways to look at alternative arrays.  One is to specify a
lot of stations up to the maximum that SCHED&nbsp; will accept.  Then the
ones to include in the uv plots can be selected from the sources menu
or interactively from the map.  This allows rapid trials of many
options.  As and alternative, or in addition, any station can be moved
interactively.  Note that you can use <A HREF="node132.html#MP:OPTMODE"><TT>OPTMODE=PLAN</TT></A> to get continuous tracks on each source, or
you can give an actual schedule.  The author has found it useful to
invoke two instances of SCHED&nbsp; and carefully align the plot windows
(most easily by expanding them to full screen).  Then the window
manager can be used to blink back and forth to see differences easily.
Of course, selecting the station of interest to highlight (plot uv
points in red) helps distinguish differences too.

<P>
Note that, you can adjust the maximum number of stations by setting
the FORTRAN parameters <TT>MAXSTA</TT> in <I>sched.inc</I>, and <TT>PSTMAX</TT> in <I>plot.inc</I>.  You might also have to increase <TT>MK</TT> in
<I>schin.f</I> to increase the allowed number of input parameters.  If
you just change <TT>MAXSTA</TT>, SCHED&nbsp; should complain about other
changes that are needed.  Be warned that, as these parameters are
increased, the size of SCHED&nbsp; increases significantly since they
affect several 2D arrays with <TT>MCHAN</TT>, which is rather large, on
the other axis.  Average users are not expected to do this sort of
thing, but if you are doing serious configuration studies, you are
probably not an average user.

<P>
The latitude and longitude range to set for the map should be set
using <A HREF="node116.html#MP:MAPLIM"><TT>MAPLIM</TT></A>.  SCHED&nbsp; will examine these
ranges and look for vector files that provide useful geographic
information.  If the region is large, country and ocean boundaries are
plotted.  If the US is included, state boundaries are also plotted.
Finally, if New Mexico is of significant size, the roads in New Mexico
will be plotted (this facility is being used for New Mexico Array - a
part of the EVLA - configuration studies).  For now, the map file
names are hardwired to be <I>$PLANET_DATA/wdbtemp4.e00</I> for the
world map, <I>$PLANET_DATA/states.e00</I> for the US states map, and
<I>$PLANET_DATA/tra0003-2.dat</I> for the NM roads map.  <I>$PLANET_DATA</I> is an environment variable used locally to point to the
directory where the planetary ephemeris is kept.  The maps will not
be distributed with SCHED&nbsp; (they are much larger than all the rest
of SCHED&nbsp; put together), but can be made available to interested
users.

<P>
Start SCHED&nbsp; in the manner for plotting (specify <A HREF="node144.html#MP:PLOT"><TT>PLOT</TT></A> and the schedule file).  Once the menu comes up, set various
things.  Under Options, it is useful to decrease the default line
widths.  Under AXIS, select UV Plot and set the desired scale.  It
is useful to reverse the signs of the X axis so that the UV tracks
can be easily associated with stations on the map.  Under files,
select <TT>Both stations selected</TT> so that any unselected stations
are left out of the plot.  Also select the sources you wish to use.
I have defined several sources at different declinations and at ra=0
for these studies and like to use the ones at 44, 18, -6 and -30 degrees
as a representative sample.  Then it is a good idea to save all this in
a parameter file from the FILES page.  On the next run, loading that
parameter file can save all the other setups.  Finally, click on PLOT.

<P>
At this point, a map will appear with selected stations in blue or red
and unselected stations in yellow or yellow with a red central dot.
You can right click on the map and the uv coverage for your sources
will be plotted.  You can drag the corners of the pgplot window to
make it larger, if you wish, or let the window manager expand it to
full screen.  The next plot (click <TT>PLOT</TT> again) will then be
larger.  In the uv plots, any baseline involving a highlighted (red)
station will be plotted in red.  Others will be plotted in blue.  Left
clicking on the map will toggle the selection status of the nearest
station to the cursor.  Middle clicking on the map will flag the
nearest station to be moved.  The next left click (maybe others too)
will put that station at the cursor position.  Note that you cannot
return a station to its original position without restarting the
program.  Once a station has been moved, its symbol will be surrounded
by a green ring and, in the station list printed with the uv plots
(right click), the position will be in green.  Checking configurations
involves clicking stations on and off and running the uv plots.

<P>
The map can be zoomed in and out with <TT>'Z'</TT> and <TT>'z'</TT>
respectively.  The zoomed image will be centered at the location
of the cursor when the letter was typed.  The zoom out is by
a factor of 1.5, in by a factor of 1.0/1.5.

<P>
The optimizer is triggered by typing the letter <TT>O</TT> (not case
sensitive) while the cursor is on the map.  What it does is count all
the highlighted stations, then it tries all combinations of that many
stations, choosing from all stations shown either in red or yellow
with a red dot.  Thus you can use the toggle operation to select that
stations that will be tried with the optimizer.  Be warned that the
number of arrays to try can get very large if you try to optimize too
many stations at once.  SCHED&nbsp; will inform the user of the number it
plans to try and then tells about its progress so he/she can decide
whether to wait and watch, go get a cup of coffee, go to bed, or abort
the process (kill the job - I suppose some day this should be made
friendlier).

<P>
The optimizer calculates a quality measure for each array and ranks
the resulting arrays accordingly.  The quality measure is based on
statistics of sampled cells in a special grid.  There are two options,
one is to simply count the number of sampled cells.  The other is to
look at the rms scatter of the number of samples per cell.  Other
quality measure options could be added without a lot of trouble.  Some
details are written to the <I>nnnn.opt</I> file (<I>nnnn</I> is the
project code), including the results for the top 200 arrays.

<P>
The optimizing grid is a polar with a radial cell size that scales
with the root sum of the radius squared plus a constant squared.  If
the constant is small, this ends up scaling with radius (a logarithmic
grid) which is useful for large arrays that cannot be reconfigured to
adjust the resolution.  For a large constant, the cells are evenly
spaced in radius, which places more importance on the longer spacings.
With an intermediate constant (the constant is in the units of the UV
plot), the cells have even spacing in the middle and go toward scaling
with radius on the outside.  This has been found to be the most useful
case, which is why this complexity is included.  If the constant is
too small, arrays that are excessively centrally condensed are
generated.  If too large, there can be poor short spacing coverage.
You will need to experiment with the values.  Also, you will need to
experiment with the number of cells to use in the radial and azimuthal
directions.  If the cells are too small, you will not distinguish
between arrays very well (each track is effectively isolated).  If too
large, all arrays will fill most or all cells so again this will not
be a good test.  After an optimization, there will be a faint
representation of the grid plotted under the UV coverage plots.

<P>
The parameters of the grid are set with <A HREF="node104.html#MP:GRIDNR"><TT>GRIDNR</TT></A> (the number of radial cells), <A HREF="node105.html#MP:GRIDNT"><TT>GRIDNT</TT></A> (the number of azimuthal cells), <A HREF="node101.html#MP:GRIDMIN"><TT>GRIDMIN</TT></A> (the inner radius of the grid), <A HREF="node102.html#MP:GRIDMAX"><TT>GRIDMAX</TT></A> (the outer radius of the grid - which can bias
the resulting size of the array), <A HREF="node108.html#MP:GRIDW0"><TT>GRIDW0</TT></A>
(the constant discussed above), <A HREF="node103.html#MP:GRIDMEAS"><TT>GRIDMEAS</TT></A>
(select the quality measure), <A HREF="node106.html#MP:GRIDSTEP"><TT>GRIDSTEP</TT></A>
(select the spacing of latitude and longitude points calculated for
making the contour plot of quality -- see below), and <A HREF="node107.html#MP:GRIDVLA"><TT>GRIDVLA</TT></A> (restrict the quality measure calculation to
only baselines involing a VLA station).

<P>
In addition to optimization, SCHED&nbsp; can plot contours of the quality
measure around a selected station.  To invoke this, toggle the station
selections until only one is red (if more are red, only one will be
used), then type <TT>S</TT>.  Sched will calculate the quality measure
with the selected station at points on a latitude and longitude grid,
spaced by <A HREF="node106.html#MP:GRIDSTEP"><TT>GRIDSTEP</TT></A> arc minutes, and then
present a contour plot of the results.  This can be useful for finding
directions to move a station to improve coverage and for finding
the area over which a station can be moved to account for logistical
considerations.  The contours will remain until the map is replotted,
so if you repeat the process, multiple versions can end up on the
plot.  On replot, the contours will be replotted unless some other
action, like station selection or moving, has been taken.  This allows
hard copies including the contours invoked from the files menu to be made
for printing or whatever.

<P>
When the station map first appears, it is in full screen
mode.  But when you right click to get the uv plots, it is replotted
in one of the panels.

<P>
If one clicks <TT>'K'</TT> on the map, two postscript files are produced
that are useful for VLA centered SKA configuration studies.  These
are highly specific outputs with many parameters hardwired, so they
are not expected to be useful to the general user.  Someday, they
may be generalized.

<P>
Note that it would not be hard for a user willing to do a bit of
FORTRAN programming to cause other maps to be plotted or to add other
optimization quality measures.  If you want to do so, please let Craig
Walker know (cwalker@nrao.edu) so we can integrate a way to choose the
modes and input parameters and keep from having multiple versions of
SCHED.  It is also just a matter of changing a few parameter statements
to increase the number of allowed stations.  This is kept down for
the released version of SCHED&nbsp; because that dimension is combined
with other large ones, like the maximum number of scans, to set the
size of some arrays and not everyone has huge memory computers.

<P>
These facilities were added by Craig Walker in early 2002.  Putting
them in SCHED&nbsp; was the easiest way to obtain facilities long wanted
for UV studies.  This scheme for UV optimization is especially useful
for arrays of relatively small numbers of antennas with strong
geographic constraints, as opposed to large arrays laid out on an open
plain.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html834"
  HREF="node48.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html830"
  HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html824"
  HREF="node46.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html832"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html835"
  HREF="node48.html">Satellite Tracking</A>
<B> Up:</B> <A NAME="tex2html831"
  HREF="node13.html">INFORMATION AND ADVICE ON</A>
<B> Previous:</B> <A NAME="tex2html825"
  HREF="node46.html">Single Dish VLBA Observing</A>
 &nbsp <B>  <A NAME="tex2html833"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Craig Walker
2005-06-29
</ADDRESS>
</BODY>
</HTML>
