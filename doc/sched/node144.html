<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002-2-1 (1.70) JA patch-2.0
patched version by:  Kenshi Muto, Debian Project.
* modified by:  Shige TAKENO
LaTeX2HTML 2002-2-1 (1.70),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>OPTMODE</TITLE>
<META NAME="description" CONTENT="OPTMODE">
<META NAME="keywords" CONTENT="sched">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="jLaTeX2HTML v2002-2-1 JA patch-2.0">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sched.css">

<LINK REL="next" HREF="node145.html">
<LINK REL="previous" HREF="node143.html">
<LINK REL="up" HREF="node52.html">
<LINK REL="next" HREF="node145.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html2327"
  HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2323"
  HREF="node52.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2317"
  HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2325"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2328"
  HREF="node145.html">OPTLOWT</A>
<B> Up:</B> <A NAME="tex2html2324"
  HREF="node52.html">Details of SCHED&nbsp; Parameters</A>
<B> Previous:</B> <A NAME="tex2html2318"
  HREF="node143.html">OPSLEWWT</A>
 &nbsp; <B>  <A NAME="tex2html2326"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION004129200000000000000"></A><A NAME="MP:OPTMODE"></A>
<BR>
<TT>OPTMODE</TT>
</H3>

<P>
<TT>OPTMODE</TT> sets the optimization mode.  The valid modes are:

<P>
<DL>
<DT><STRONG><TT>NONE</TT>.</STRONG></DT>
<DD>This is the default.  The input schedule will
be used as specified.

<P>
</DD>
<DT><STRONG><TT>SCANS</TT>.</STRONG></DT>
<DD>For this mode, the schedule will be followed as
specified.  However only scans with more than <A HREF="node138.html#MP:OPMINANT"><TT>OPMINANT</TT></A> antennas with the source up (above the horizon
and within the slew limits) and above <TT>OPMINEL</TT> will be accepted.
For each accepted scan only those antennas that are up and above <TT>OPMINEL</TT> will be scheduled unless <TT>OPNOSUB</TT> is specified.  <TT>DWELL</TT> would normally be specified to allow for slews.  Subarraying
will happen if two successive souces can only be seen by different
antennas since the optimization keeps track of the previous scan on a
per-antenna basis.

<P>
The usual way to use this mode is to specify a loop containing all
the desired sources (and frequencies etc.) and lasting longer than
the desired total time.  Then the optimization will pick the scans
that make sense and will quit after <TT>OPDUR</TT>.  This mode is
especially useful for scheduling pointing observations.

<P>
There is a trick available, triggered by <TT>OPSKIP</TT>, that is an
attempt to emphasize scans in desirable elevation ranges (set by
<TT>OPELPRIO</TT>.  If a loop is used, this will cause scans to be
skipped <TT>OPSKIP</TT> times before they are used again unless they
are in the desired elevation ranges.

<P>
There is another trick to give low priority to some scans using
<A HREF="node136.html#MP:OPMISS"><TT>OPMISS</TT></A>.  The current scan will only
be accepted if at least <TT>OPMISS</TT> preceeding scans in a row
have been missed.  If, for example, you have a loop of scans,
as is typical in pointing schedules, and you have one that you
only want to have used if all others are unacceptable (eg too low),
then set <TT>OPMISS</TT> to the length of the loop.

<P>
</DD>
<DT><STRONG><TT>CELLS</TT>.</STRONG></DT>
<DD>For this mode, the input scan list is treated
as a pool of possible scans.  The sky over each antenna is divided
into 9 cells (3 X 3 in Az and El) and the time that each cell
was sampled is recorded.  For each output scan, all input scans
are checked for which cells they sample and a weight is calculated
based on the time since the last time that cell was sampled.  The
weight is adjusted to discourage long slews with the characteristic
time scale of that discouragement set by <TT>OPTSLEW</TT> in minutes.
Also, if some low elevation cells for a station have not been
sampled in a long time (characteristic time scale set by <TT>OPTLOWT</TT>,
the weight for other low elevation cells will be increased.  This
tries to compensate for edge stations that have no mutual visibility
with the rest of the array for sources at low elevation in certain
directions.  The input scan to use is then selected based on the
adjusted weights.

<P>
This mode is an attempt to provide a mechanism for scheduling
geodetic type observations.  Parameters <TT>OPMINANT, OPMINEL,
OPDUR,</TT> and <TT>OPNOSUB</TT> have the same meanings for <TT>CELLS</TT>
mode as for <TT>SCANS</TT>.  The <TT>CSUB</TT> mode is able to do almost
the same thing as this mode plus it handles subarraying.  It may
eventually completely replace the <TT>CELLS</TT> mode.

<P>
</DD>
<DT><STRONG><TT>CSUB</TT>.</STRONG></DT>
<DD>This mode is much like the <TT>CELLS</TT> mode except
that it uses subarrays.  The sky over each antenna is divided into 9
cells.  For each possible pair or sources, a scan is constructed with
each antenna observing the source for which the priority is highest.
The priority is the result of the time since the cell the source is in
was sampled adjusted to downweight long slews (<TT>OPTSLEW</TT>) and
upweight low elevation scans when other low elevation cells are not
being sampled (<TT>OPTLOWT</TT>).  If the minimum number of antennas per
scan (<A HREF="node138.html#MP:OPMINANT"><TT>OPMINANT</TT></A>) is not satisfied, some
are shifted so that it is.  Then the subarrayed scan is compared with
single source scans with each of the two sources and the best option
chosen.  There is a weighting factor which favors the single source
cases and has been adjusted so that something less than half the scans
include all stations.  Some day this should be made an input
parameter.  Finally, if there are more than 2 antennas left over, they
are put in a third subarray with an optimized source.

<P>
Like the <TT>CELLS</TT> mode, this mode is for geodetic type
observations.  Various parameters have the same meaning here as for
the other modes except that OPNOSUB is not allowed since it doesn't
make sense.  Also, <A HREF="node138.html#MP:OPMINANT"><TT>OPMINANT</TT></A> is a goal.
The third subarray can have less as can one of the other two under
certain very special circumstances.

<P>
</DD>
<DT><STRONG><TT>UPTIME</TT>.</STRONG></DT>
<DD>This mode is designed for experiment planning.
For each input scan, it creates a string of scans of duration
<A HREF="node83.html#MP:DUR"><TT>DUR</TT></A> or <A HREF="node84.html#MP:DWELL"><TT>DWELL</TT></A>, spaced
by <A HREF="node98.html#MP:GAP"><TT>GAP</TT></A> (helps interpret UV plots), and lasting
for total time <A HREF="node126.html#MP:OPDUR"><TT>OPDUR</TT></A>.  All such series of
scans start at the start time of the first scan.  Usually (<TT>OPDUR=24:00:00</TT>) would be used to examine a whole day or the actual
start time and total duration of allocated time would be used.  Each
input scan would normally be on a different source.  Note that this
mode gives a backward time jump at the first scan based on each input
scan.  For this reason, writing telescope control files based on this
optimization mode is not allowed.

<P>
</DD>
<DT><STRONG><TT>HAS</TT>.</STRONG></DT>
<DD>For this mode, the user provides the scans that
should be observed.  All parameters of the scans are retained, except
the times.  As SCHED runs, once one scan is processed, the next is
chosen from those that remain based on an attempt to come close to the
desired reference station hour angle.  The user can specify the
desired hour angle, or can take the default which is to spread the
scans on each source evenly over the time interval during which it can
be observed with enough stations above a specified elevation limit.
The scan is chosen based on a weight which is the sum of a weight
based on deviation from the desired time, a weight based on the slew
time from the previous scan (to help try to minimize time lost to
slewing), and weights based on proximity to the start and end of the
time the source can be observed.  There is an example schedule among
the sched examples called <I>eghas.key</I> that shows a way of using
this mode for survey type observations where there is a desire to
observe many sources, each over a wide hour angle range to get good UV
coverage.

<P>
<TT>OPTMODE=HAS</TT> should not be used to schedule projects longer than
24 hours.  In that case, hour angles can be ambiguous.  Note that for
normal schedules the 4 minute difference between the sidereal and solar
days will not be important partly because only scan start times are
considered.  However there is just a chance of weird behavior for an
observation of 24 hours UT duration and short scans.

<P>
There are a number of input parameters to help guide the <TT>HAS</TT>
mode in it's selection of scans.  Important parameter include
<A HREF="node126.html#MP:OPDUR"><TT>OPDUR</TT></A>, which sets the total length of the
observations, <A HREF="node138.html#MP:OPMINANT"><TT>OPMINANT</TT></A>, which sets the
minimum number of stations that must be up for a scan to be chosen and
<A HREF="node137.html#MP:OPMINEL"><TT>OPMINEL</TT></A>, which sets the minimum elevation
a station must be above to be considered to be up.  Note that to be
considered to be up, a station must also be above the local horizon as
specified in the station catalog.

<P>
<A HREF="node132.html#MP:OPHASTA"><TT>OPHASTA</TT></A> sets the reference station for
this mode.  This is the station at which the hour angles will be
measured.  Either the full name or the station code, if unique, can be
used.  <A HREF="node128.html#MP:OPHA"><TT>OPHA</TT></A> sets the desired hour angle (at
the reference station) for this scan.  <A HREF="node130.html#MP:OPHAWID"><TT>OPHAWID</TT></A> sets a normalization time interval relative to
the desired hour angle over which the scan weight increases.
<A HREF="node131.html#MP:OPHAWT"><TT>OPHAWT</TT></A> is a normalization factor for
weights related to time offset from the desired hour angle.  This and
other weight normalization factors mentioned below help adjust the
relative importance of the different factors such as offset from the
desired time, slew time, and proximity to other scans on the same
source.  <A HREF="node132.html#MP:OPHASTA"><TT>OPHASTA</TT></A> is used to set the
station for which the desired hour angles apply.  <A HREF="node135.html#MP:OPMINSEP"><TT>OPMINSEP</TT></A> sets the minimum separation of scans on a
source as a fraction of the spacing of scans that would be used if
they were spread evenly across the available time for that source.
<A HREF="node142.html#MP:OPSLEWTI"><TT>OPSLEWTI</TT></A> and <A HREF="node143.html#MP:OPSLEWWT"><TT>OPSLEWWT</TT></A> set the reference time and the normalization
factor for the weights related to slew time.  The slew weight is <TT>OPSLEWWT * ( 1 - (slew time))</TT>/<TT>OPSLEWTI</TT>).
<A HREF="node133.html#MP:OPLIMTI"><TT>OPLIMTI</TT></A> and
<A HREF="node134.html#MP:OPLIMWT"><TT>OPLIMWT</TT></A> set a similar normalization and
weight for the proximity to the extreme times at which a source can be
observed.  This latter is used to encourage a scan on the source, for
example, before it sets.  <A HREF="node129.html#MP:OPHMAXDT"><TT>OPHMAXDT</TT></A> sets
the maximum deviation from the desired hour angle at which a scan will
be considered.  This prevents using very inappropriate scans when no
other scans are available.  Most of the above parameter can have
different values for different scans.

<P>
The equations for the various weights are given in the descriptions
for the parameters <A HREF="node128.html#MP:OPHA"><TT>OPHA</TT></A>, <A HREF="node142.html#MP:OPSLEWTI"><TT>OPSLEWTI</TT></A>, and <A HREF="node133.html#MP:OPLIMTI"><TT>OPLIMTI</TT></A>.  For
the most accurate information on how weights are set, look at the code
in <I>$SCHED/src/Sched/opthas.f</I>.

<P>
When the <TT>HAS</TT> mode is used, a lot of information from the guts of
the algorithm can appear in the <I>sched.runlog</I> depending on the
setting of the parameter <A HREF="node140.html#MP:OPPRTLEV"><TT>OPPRTLEV</TT></A>.  For
each output scan, some details of the weights etc for each possible
choice from among the input scans are given (<TT>OPPRTLEV=3</TT>) or just
a summary for the scan can be given (<TT>OPPRTLEV=2</TT> or higher).  At
the end, for <TT>OPPRTLEV=1</TT> or higher, the properties (like
available observing time) and fate of each input scan are given in a
table.  Also a number of summary parameters are given for any <TT>OPPRTLEV</TT>.  All this information, while bulky, should help a user
figure out how to drive the program -- how to set set the related
input parameters.  But beware that, for <TT>OPPRTLEV=3</TT>, the <I>sched.runlog</I> can be very large.

<P>
While constructing a schedule using this mode, it is very useful to
use the plotting capability of SCHED.  The UPTIME and UV Plot capabilities
are especially useful in understanding what you have.  Also note that
when SCHED&nbsp; runs, it creates an output file with the extension <TT>.sch</TT>
that could be used as the scan input section for another run of SCHED.
So if the optimization mode comes close, but you wish to make a small change,
it is possible.  This is an old but little used capability and has not
actually received any maintenance for a long time as of late 2005.

<P>
In its early form, the <TT>HAS</TT> mode is meant to be useful particularly for
scheduling surveys.  But at the moment, there is no way to associate scans
so it would be difficult to use it for phase referencing.  Also it would
be awkward to use to schedule blocks of scans around the sky for atmospheric
solutions (for aips task DELZN).  These limitations should be removed
in future versions.

<P>
</DD>
</DL>

<P>
In all optimizing modes, SCHED&nbsp; will not schedule a scan that crosses
0 hr UT.  This is also true for dwell time scheduling.

<P>
<I>Note that the optimization modes are somewhat experimental.  If
they are used, the output schedule should be checked carefully.</I>

<P>

  </TT>
<UL>
<LI><B>Argument:</B> A mode.
</LI>
<LI><B>Options:</B>  <TT>'NONE', 'SCANS', 'CELLS', 'CSUB',</TT> and <TT>'UPTIME'</TT>
</LI>
<LI><B>Default:</B>  <TT>NONE
</LI>
<LI><B>Usage:</B>    Only one used in schedule -- the last.
</LI>
<LI><B>Example:</B>  <TT>OPTMODE 'CELLS'</TT>
  
</LI>
</UL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2327"
  HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2323"
  HREF="node52.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2317"
  HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2325"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2328"
  HREF="node145.html">OPTLOWT</A>
<B> Up:</B> <A NAME="tex2html2324"
  HREF="node52.html">Details of SCHED&nbsp; Parameters</A>
<B> Previous:</B> <A NAME="tex2html2318"
  HREF="node143.html">OPSLEWWT</A>
 &nbsp; <B>  <A NAME="tex2html2326"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Craig Walker
2006-03-27
</ADDRESS>
</BODY>
</HTML>
