%  The SCHED User Manual latex file.

% To make an html version of this manual:
%  Be sure $SCHED/doc/sched is present.  Then type:
%  htlatex sched.tex "html,3,sec-filename" " " "-dsched/"
%  To $SCHED/doc/sched/sched.css, add the line 
%  h5.subsubsectionHead{font-size:150%;}
%  Delete the html files in $SCHED/doc
%  In $SCHED/doc/, do:  ln -s sched.html index.html if needed.
%    
%  Complete instructions are in the Release Instructions section.
%
% The "html,3" chunks the file to 3 levels which chunks it to
% about 50 html files.
% The "-d sched" puts the output in a sched subdirectory.
% Unfortunately that means that the html files are copied to
% the subdirectory but not deleted from the original.  So you
% will likely want to run /usr/bin rm *.html on $SCHED/doc.

% To make a pdf file instead of html versions, use

% pdflatex sched_pdflatex.tex

%  ---------  Legacy --------------------
% Below is for use of latex2html.  But much has been changed
% to switch to pdflatex and htlatex.
% To convert to html with limited depth to the top index and
% node names based on the section headings: 
%   latex2html -local_icons -link 2 -long_titles 5 sched.tex
% after it works well with latex.
%  ---------  End legacy  ---------------------

% Note that the $SCHED/doc/sched subdirectories should contain
% links on unix systems generated with:
% ln -s ../../examples
% ln -s ../../catalogs
% ln -s ../../setups
% Other OS's require some equivalent, or create those directories and
% put copies of the required files in them.  This allows links
% inside the manual to access files in those directories.  The 'makelinks'
% script will establish the links.

\documentclass{report}

%--Shipman start
%%%%\usepackage{html,verbatim}
\usepackage{verbatim}
\usepackage{color}
\definecolor{darkgreen}{rgb}{0,0.6,0}
%  RCW htlatex was tripping and a page found on the net suggested that
%  the pdftex was not needed.  \usepackage[pdftex,
\usepackage[bookmarks,
  bookmarksopen, bookmarksopenlevel=0,
  colorlinks, linkcolor=darkgreen, citecolor=darkgreen,
  urlcolor=blue,
  bookmarksnumbered,
]
{hyperref}
%--Shipman end

% \documentstyle[11pt,html]{report}
% \special{psfile=logo.ps hoffset=0 voffset=-30}
\renewcommand{\textfraction}{0.0}
\renewcommand{\topfraction}{1.0}
\renewcommand{\bottomfraction}{1.0}
\oddsidemargin 0.3in
\topmargin -0.5in
\textheight 8.5in
\textwidth 5.8in
\sloppy
\raggedright

%
%  This file is set up for insertion of examples using verbatiminput.
%  For those commands, the examples are expected to be in ../examples
%  so the processing of this file should be done from a SCHED distribution
%  or equivalent.
%
%  This scheme for including examples replaced the use of the private
%  program RCWINCLUDE on Sept. 26, 2011.
%
% fonts
% {\sc SMALL CAPS} - computer programs names
% {\sl emphatic}   - file names
% {\tt typewriter} - Keyin input parameter names.
%
\setcounter{tocdepth}{2}
\newcommand{\sched}{{\sc SCHED}}
\newcommand{\schedb}{{\sc SCHED~}}
\newcommand{\rcwbox}[5]{
  \begin{list}{}{\parsep 1ex  \itemsep 0em
                 \leftmargin 8em  \itemindent -5em }
    \item {\bf Argument:} #1
    \item {\bf Options:}  #2
    \item {\bf Default:}  #3
    \item {\bf Usage:}    #4
    \item {\bf Example:}  #5
  \end{list}
}

%--Shipman start
%%%%\newcommand{\htlm}[2]{\item \htmlref{{\tt #1:}}{MP:#1}{\tt #2}}
%%%%\newcommand{\htln}[3]{\item \htmlref{{\tt #1:}}{MP:#2}{\tt #3}}
%%%%\newcommand{\htls}[2]{\item \htmlref{{\tt #1:}}{SP:#1}{\tt #2}}
%%%%\newcommand{\htlt}[3]{\item \htmlref{{\tt #1:}}{SP:#2}{\tt #3}}
%%%%\newcommand{\htlu}[2]{\item \htmlref{{\tt #1:}}{TP:#1}{\tt #2}}
%%%%\newcommand{\htfr}[2]{\item \htmlref{{\tt #1:}}{FR:#1}{\tt #2}}
\newcommand{\htlm}[2]%
{\item
  \hyperref[MP:#1]{{\tt #1:}}{\tt #2}%
}
\newcommand{\htln}[3]%
{\item
  \hyperref[MP:#2]{{\tt #1:}}{\tt #3}%
}
\newcommand{\htls}[2]%
{\item
  \hyperref[SP:#1]{{\tt #1:}}{\tt #2}%
}
\newcommand{\htlt}[3]%
{\item
  \hyperref[SP:#2]{{\tt #1:}}{\tt #3}%
}
\newcommand{\htlu}[2]%
{\item
  \hyperref[TP:#1]{{\tt #1:}}{\tt #2}%
}
\newcommand{\htfr}[2]%
{\item
  \hyperref[FR:#1]{{\tt #1:}}{\tt #2}%
}
%--Shipman end

%  ===================  Begin actual text =====================

\begin{document}
\title{THE SCHED USER MANUAL \protect\\ Version 11.4,  Release of March 14, 2015}
\author{R.C. Walker}
\date{\today}
\maketitle

% *****   Update important notes item on state of the conversion

\schedb is a program for planning and scheduling Very Long Baseline
Array (VLBA), High Sensitivity Array (HSA), Global Very Long Baseline
Interferometry (Global VLBI), European VLBI Network (EVN), Long
Baseline Array (LBA; Australia), Korean VLBI Network (KVN), VLBI on
the Karl G. Jansky Very Large Array (VLA) and other VLBI observations.
It writes VEX files that describe the details of an observation and
are becoming the near universal format for distribution of schedules
to VLBI telescopes and correlators.

This manual describes how to use the program, provides extensive
information on all possible inputs, and gives considerable information
and advice on many aspects of scheduling VLBI observations.  The
{\hyperref[CHP:INTRO]{INTRODUCTION}} gives an overview of the program and
is the only chapter that a new user should read before starting to use
the program.  The rest of the manual can be treated as a reference to
be consulted to answer questions.

Scheduling with \schedb involves creating an input file with a text
editor, and then running the program on that file.  \schedb creates a
variety of 
{\hyperref[SEC:FILES]{output files}} that provide summary and
detailed information to the scheduler and telescope control
information for the VLBI station.  The easiest way to create an input
file is to copy one of the 
{\hyperref[SEC:EXAMPLES]{examples}} and
modify it for your particular project.  All of the examples are
complete, working files.  \schedb is not interactive unless
{\hyperref[SEC:PLOT]{plots}} are being made, in which case there is a
convenient, interactive interface to control the plotting.  The
plotting capabilities should be very useful, especially during
proposal writing and while planning observations.

This edition of the manual corresponds to the \schedb version as
indicated in the title.  Please be sure that you have the latest major
version of the code and catalogs to be sure your schedule files are
valid.  Please check the 
{\hyperref[SEC:CURRENT]{notes on the current release}}
to be sure that you don't need a more recent
minor release than the one you have (these are usually bug fixes).
The distribution files for the latest releases are available on
anonymous ftp at 
{\href{ftp://ftp.aoc.nrao.edu/pub/sched}{{\sl ftp.aoc.nrao.edu}}} in directory {\sl pub/sched}.

In several places in this manual, there are links to text files that
come with the manual.  Some browsers just display those files without 
issue.  But, since the files typically don't have a {\sl .txt} extension, 
sometimes the browser won't display them natively and won't give an
option to do so.  I encountered this with Firefox on a Mac.  It thinks
the {\sl .key} files are Keynote files.  I found an add-on called ``open 
in Browser'' that deals with the situation.  You can find it with a 
search.

For general, and NRAO specific, comments and questions, please contact
the help desk (helpdesk@nrao.edu) or Amy Mioduszewski.  For EVN, Mark
IV and non-VLBA VEX format issues, contact Des Small at small@jive.nl.
\schedb was written by Craig Walker of NRAO with significant
contributions from Huib van Langevelde, Cormac Reynolds, Antonios
Polatidis, Friso Olnon, and Des Small of JIVE, and Franco Tinarelli of
CNR in Bologna.  Craig Walker retired at the end of 2014 and Amy
Mioduszewski is now the main NRAO based \schedb supporter.  Des Small
and Cormac Reynolds are the main active non-NRAO supporters.  Craig
will continue a low level of involvement but should not be the first
person to contact with issues.  The manual is long and has been
supported mainly by one person, so, in this period of rapid changes in
hardware, please excuse occasional sections that are not entirely up
to date.

\tableofcontents
% \listoftables
% \listoffigures

\section{\label{SEC:NOTES} Important Notes - Please check these}

\begin{list}{}{\parsep 0.5em \itemsep 0.5em }

\item The world of VLBI has mostly converted from the traditional
backends to the newer digital backends such as the RDBE and the DBBC
and to newer recording systems such as the MARK5C.  \schedb supports
many of the digital backends and new recorders.  You may encounter
some legacy information in the manual and examples that relate to
the old systems.  

\item The MARK5A recorders were removed from the VLBA in December
2013.  All projects must now use the RDBE.  All VLBA stations have
two RDBE units for a total of 8 channels with the DDC.  Most MARK5A
setups can be duplicated with this system.  Most of the standard 
setups with names like v6cm... will work with the DDC.  As of April,
2014, half of the BBCs in the legacy system will be unplugged.  The
remaining ones are still used to collect pointing data and some old
style calibration data, mainly for test purposes.

\item Mark IV users please see the 
{\hyperref[SSEC:MKIV]{Mark~IV Section}}
for information about mode and mode change restrictions.

\item If you are using B1950 coordinates, you should worry
about the ``observe'' date to use for precession.  Please see the
discussion of the input parameter 
{\hyperref[MP:PRECDATE]{{\tt PRECDATE}}}.
But you really should not be using B1950 coordinates!

\item Please note that all setup files intended to be used for
spectral line observations using 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}
must have all channels distinguished, in the setup file, by frequency
and polarization.  In the past, it was common practice to set all
channels to the same frequency, and let the Doppler calculations
separate them.  But the requirement to deal reasonably with single
polarization sites in dual polarization observations forced \schedb
to be able to relate channels from each station to channels from
other stations within the setup file.  This is mentioned here because
it has proven to be the source of considerable confusion.

\item Try the plot capability (UV, El vs time etc).  It's easy to
use and should help with planning and with understanding what your
schedule will provide.  See the 
{\hyperref[SEC:PLOT]{plotting section}}
for details.

\item This manual is written with LaTeX and converted to html using
htlatex.  It is meant to be read using a browser.  A postscript or pdf
version could be generated for printing.  But it is over 300 pages
long and should be updated with each release.  Printing it would be
considered unfriendly to the world's forests.  The authors have not
printed it in many years.

\end{list}

\section{\label{SEC:LINKS}Links to Manual Sections and to
External Information.}

{\bf New users --- please read:}

\begin{list}{}{\parsep 0em  \itemsep 0em }
\item 
{\hyperref[SEC:INTRO]{Introduction:}} General information about \sched.

\item 
{\hyperref[SEC:KEYIN]{Keyin Free-Format Input:}} The data input format
common to all files.

\item 
{\hyperref[SEC:FILES]{Input and Output Files:}} Brief descriptions
of \sched's files.

\item 
{\hyperref[SEC:RUNSCHED]{Running \sched:}} How to get it to execute.

\item 
{\hyperref[SEC:EXAMPLES]{Getting started:}} Some examples which can be
used as templates.

\item 
{\hyperref[SSEC:STRATEGY]{Observing strategy:}} Some tips.

\item 
{\hyperref[SEC:INSTALL]{Installing \sched:}} If \schedb is not yet on your
computer.

\end{list}


{\bf The \sched\ input files and their input parameters:}

\begin{list}{}{\parsep 0em  \itemsep 0em }
\item 
{\hyperref[SEC:SCHPAR]{The main input schedule.}}

\item 
{\hyperref[SEC:STACAT]{The Station Catalog.}}

\item 
{\hyperref[SEC:SRCCAT]{The Source Catalog.}}

\item 
{\hyperref[SEC:SETUPS]{The Setup Files.}}

\item 
{\hyperref[SEC:FRQCAT]{The Frequency Catalog.}}

\item 
{\hyperref[SEC:TPINI]{The Tape Initialization File.}}

\item 
{\hyperref[SEC:LINE]{Spectral Line Frequencies.}}

\end{list}


{\bf Different types of VLBI observations:}

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item VLBA observing:  Most of this manual.

\item 
{\hyperref[SEC:VLA]{VLA observing for VLBI.}}

\item 
{\hyperref[SEC:RECSYS]{General information on non-VLBA systems.}}

\item 
{\hyperref[SSEC:MKIV]{Mark IV (and VLBA4) VLBI observing.}}

\item 
{\hyperref[SSEC:FS9VLBA]{Non-VLBA telescopes with VLBA recorders.}}

\item 
{\hyperref[SSEC:S2]{S2 VLBI observing.}}  Obsolete.

\item 
{\hyperref[SEC:SPECIALVLBA]{VLBA Single-Dish observing}} (mostly
test observations).

\end{list}


{\bf Detailed advice and information:}

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item 
{\hyperref[SEC:PLANNING]{Project Planning:}} How to use \schedb while
writing proposals and while designing an observation.

\item 
{\hyperref[SEC:PLOT]{Making plots:}} UV coverage, elevation vs time etc.

\item 
{\hyperref[SSEC:SCANTIMES]{Scan times:}}  The many ways to specify when
to observe.

\item 
{\hyperref[SSEC:TAPEMANAGEMENT]{Tape management:}}  Obsolete since the
advent of disk recordings.

\item 
{\hyperref[APP:HEAD]{Head positions and track assignments:}} Some gory
details for the masochistic.

\item 
{\hyperref[SEC:INDIV]{Special concerns for specific observartories}}.

\item 
{\hyperref[SEC:DISFIL]{Distribution of \schedb files:}}  Where to send the output files.

\item 
{\hyperref[SEC:RELATEDPROGRAMS]{Related programs:}} Where does \schedb fit
in.

\item 
{\hyperref[APP:STACODES]{Station codes:}} A list, a bit dated.

\item 
{\hyperref[CHP:CHANG]{Changes to \sched:}} A list of recent \schedb changes.

\item 
{\hyperref[SEC:HIST]{A history of \sched:}} A brief history.

\end{list}


{\bf Some links to other sources of information:}

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item 
{\href{http://www.nrao.edu/}{NRAO Home Page:}}  General
information on NRAO and links to most NRAO resources.

\item 
{\href{https://science.nrao.edu/facilities/vlba}{VLBA Home Page:}}
VLBA information and links
including much of importance to someone scheduling VLBI.

\item 
{\href{https://science.nrao.edu/facilities/vla/docs/manuals/obsguide/modes/vlbi}
{VLBI at the VLA.}}
Extensive information on VLBI observations with the VLA.

\item 
{\href{http://www.gb.nrao.edu/~fghigo/gbtdoc/vlbinfo.html\#hifreq}{VLBI on the GBT:}}
Information about using the GBT for VLBI.  Please consult this
if you are using the GBT.  There are special concerns, such as temperature
dependent slew rates and many others, that can significantly affect
scheduling.

\item 
{\href{http://www.naic.edu/science/generalinfo_set.htm}{VLBI at Arecibo:}}
Information about VLBI at Arecibo.  You will need to follow a couple
of links from the above page - somehow the URL doesn't change going
down the links.


\item 
{\href{http://www.jive.nl/}{JIVE Home Page:}}  A good
place to start for information on European and Global VLBI.

\end{list}



\newpage

\chapter{\label{CHP:INTRO}INTRODUCTION}

\section{\label{SEC:INTRO}Overview}

\schedb is a program for scheduling Very Long Baseline Interferometer
(VLBI) Observations.  It can be used to schedule any observations on
antennas that use the VLBA real time control software and to schedule
Mark IV/VLBA(4)/S2/Mark5 observations on any stations that can read
VEX format schedules.  \schedb is the program used to schedule
essentially all non-geodetic VLBA projects and has been adopted by the
European VLBI Network (EVN) as the standard scheduling program for the
EVN.  \schedb is also a useful tool for planning observations, both at
proposal writing time and before making detailed schedules.  The
plotting capabilities are especially useful for this.

To use \sched, one normally creates an input file, using any text
editor, that describes the schedule.  Then \schedb is run on that
file.  A number of 
{\hyperref[SEC:EXAMPLES]{examples}} are distributed
with \sched.  The usual and recommended way to make a schedule is to
copy one of the examples and modify it according to your specific
needs.  When developing a schedule, it is likely that \schedb will be
run several times before everything is to the scheduler's
satisfaction.  The various output files, especially the summary file
and the optional 
{\hyperref[SEC:PLOT]{plots}}, provide a lot of
information about the schedule that can be used to help the user with
optimization.

\schedb gets a lot of information, including station locations and
equipment, source positions, and frequency setups, from a number of
catalogs.  Most catalogs can be imbedded in the schedule, but it is
much more common to use the standard ones provided with the \schedb
distribution.  An effort has been made to put as much information as
possible in the catalogs so that the user only need provide very
generic information specific to the particular project.  But if the
user wants to do something special, it is possible to specify the
parameters of an observation in great detail.  Documenting all these
capabilities partially explains the large size of this manual, most
of which is not needed by the average user.

\schedb writes several different types of output files, some of which
are useful for the scheduler and some of which are meant for the
computers at the antennas.  An outline of the files used by \schedb
can be found in
\hyperref[SEC:FILES]{the section on files.}
The summary file is the most important one for
the user.  It gives the details of the equipment setups at each
station and a summary of various items about the individual scans.

The beginning user might start by looking at one or more of the
{\hyperref[SEC:EXAMPLES]{example files}} to get a sense of what they look
like.  Then read some of the sections that cover important details,
without which it might be difficult to understand what is going on.
The section on
\hyperref[SEC:KEYIN]{KEYIN Free Format Input}
covers the capabilities and limitations
of the parser used to read all input files.  The section on
\hyperref[SEC:FILES]{Inpuut and Output files}
gives an overview of the information that \schedb
requires.
\hyperref[SEC:RUNSCHED]{The Running \schedb section}
has instructions on how to start the program.  And
\hyperref[SEC:EXAMPLES]{the Examples section}
contains 2 examples of \schedb input files and quick descriptions of,
and links to, most of the rest provided with the distribution.

After reading the sections recommended above, it would probably be
best to use one of the examples to experiment with the program.  The
examples are complete, working files.  In fact, they are all used
regularly to test \schedb modifications.  They will work as is, and
it can be modified to try other features.  The easiest way to make a
schedule for your project will usually be to select the example that
is closest to what you are trying to do and modify it to your needs.
It is not strictly necessary to read the rest of the manual.  It can
be treated as a reference to help answer questions.

The files needed to run \schedb are in various subdirectories under
the base directory used for the \schedb installation.  That base
directory, on unix systems, should be assigned by you or your system
administrators to the environment variable {\sl SCHED}.  The key
subdirectories are {\sl examples}, {\sl setups}, {\sl catalogs}, {\sl
doc}, {\sl src}, and {\sl bin} and can be referred to, on unix systems,
using paths such as {\sl \$SCHED/catalogs}.  For most the contents are
obvious from the names.  {\sl src} contains the code and {\sl bin}
contains the executables, perhaps in architecture dependent
subdirectories.  The user should work in a private directory and only
refer to files in the \schedb standard areas, not modify them.  All
\schedb output files are written in the current working directory.

There is a lot of information about \schedb and about the process of
scheduling VLBI observations in the descriptions of the
\hyperref[SEC:SCHPAR]{input parameters}
and of the
\hyperref[SSEC:SETLST]{parameters for the setup files}.
There are detailed discussions of
some specific areas of concern in the
\hyperref[SEC:TIPS]{Scheduling Tips Section }.
This section will be expanded significantly in the future.  All of these
sections are worth reading through on some slow day for those serious
about scheduling.

VLBI projects can also be produced using the NASA Goddard program {\sc
SKED} and VLBA control files can be produced using {\sc DRUDG}.  That
is the standard path used by the geodesy community, but is rare among
astronomers.

\schedb may be obtained by anonymous ftp from {\sl ftp.aoc.nrao.edu}
under directory {\sl pub/sched}.  For more information, see the
section on
\hyperref[SEC:INSTALL]{Installing \sched}.
Users are encouraged to obtained the current release
of \schedb before attempting to make schedules.  The program is
continually evolving to support new features and to make it harder
to write schedules that won't work.  It is in your own best interests
to have the current version.  For most users, installing a new
version should involve little more than copying and unpacking the tar
files and copying the executable for their type of machine.

A note on notation: the names of computer programs will be given in
{\sc SMALL CAPS} font, the names of files will appear in {\sl slant}
font, and the names of \schedb and setup file parameters will
appear in {\tt typewriter} font. Some parameters may be abbreviated;
where both compulsory and optional characters are displayed, the
compulsory ones will be shown in {\tt UPPER-CASE TYPEWRITER} font and
the optional ones shown in {\tt lower-case typewriter} font.



\section{\label{SEC:KEYIN}Keyin Free-format Input}

All input parameters to \schedb are in the keyin free format, named
after Tim Pearson's subroutine that is used to read it. The important
features of that format for \schedb are described here. This
description is not complete and users of the Caltech package
should refer to other documentation for useful capabilities of keyin
input that are not normally used for \sched.

Input via keyin format is of the form {\tt keyword = value}. Different
sets of {\tt keywords} and {\tt values} are separated by spaces or line
breaks. The equal sign is optional as long as its absence does not
lead to ambiguity.  The input {\tt keywords} are not case sensitive.
Most of the {\tt values} required by \sched, except for file
names in case sensitive systems like unix, are also not case
sensitive.  {\tt keywords} are, in all cases, limited to 8 characters
in length.  Character string {\tt values} can be much longer.

A few \schedb {\tt keywords} may be abbreviated.  In the parameter
descriptions in this manual, the required characters will be shown in
upper case while the optional ones will be shown in lower case.  Any
characters beyond the required ones must match the optional ones.  As
an example, the {\tt keyword DURation} can be typed as {\tt DUR, dur,
DURATION, duration, durat, Dur ....}.

A {\tt value} can be an array, with elements of the array separated by
commas. If the last character on a line is a comma, the input array is
assumed to continue on the next line.

The {\tt value} can be a number or a character string.  Quotation
marks are required for a character string if it can be mistaken for a
number or if it contains blanks or commas.  Also, because of possible
ambiguity with other {\tt keywords}, character string {\tt values}
must be in quotes if the equal sign is left out.

If the {\tt value} is a number, the decimal point and fractional part are
optional.  The parser converts all numbers to double precision real so
the program will not know if you specify ``5'' or ``5.0'' etc.  The
value can be an arithmetic expression enclosed in parentheses.  An
example would be {\tt (5.5*4)}.  The expression cannot contain
blanks or the parser will get confused.

If {\tt value} is a time or angle, it can be written in {\tt
hh:mm:ss.ss} or {\tt dd:mm:ss.ss} format. Each colon causes all values
to the left to be multiplied by 60, giving a result to the program
that is in seconds. Values less than an hour or degree can be written
{\tt mm:ss.ss} or just {\tt ss.ss}. The decimal and fractional seconds
are optional.  However, even hours or degrees require the colons; for
example, 2 degrees is written as 2:0:0. Numbers larger then 60 are
allowed for the minutes and seconds; for example, 2:40 and 160 are
equivalent.  No imbedded blanks or signs are allowed.  A negative
or positive sign is allowed in front and applies to the final total
number of seconds (i.e., -1:20 is returned as -80).

A {\tt keyword} can be specified without a value. This is equivalent,
as far as the program knows, to specifying a value of zero. Some {\tt
keywords} are used in this way as logical switches to cause something
to happen. {\tt DOVEX}, {\tt DOPPLER}, and {\tt PTVLBA} are examples from
\sched. Usually the effect of such a switch can be reversed by
specifying a non-zero value.  For several such switches, \schedb
has a corresponding variable {\tt keyword} that has the opposite effect
(for example: 
{\hyperref[MP:RECORD]{{\tt RECord}}} and 
{\hyperref[MP:RECORD]{{\tt NORECord}}}).

An exclamation mark (``!'') causes all items on the rest of the line
to be ignored. This is useful for adding comments.

The parser collects all input, regardless of how many lines it is on,
up to the line on which it finds the ``Endmark'', which in the case of
\schedb and most other programs is a ``/'' .  For \sched, these
groups correspond to scans in the main input, or a station or a source
in the main catalogs.

Some examples of valid, if not very consistent, \schedb input are:

\begin{verbatim}
  SOURCE='0235+164'  YEar = 1988  day 67  Stat = 'OVRO',NRAO,
   vla,vlba_pt  stop 03:35:00  dur = 15:00
  comment 'Quotes are needed for more than one word.'  /
\end{verbatim}

When a program that uses keyin is run interactively, the user can
obtain a list of inputs by typing ``{\tt HELP /}'' and can obtain a list of
the current values of all input variables by typing ``{\tt SHOW /}''.
The input of \schedb is rarely, if ever, given interactively.

Keyin values can be mathematical statements in parenthesis; for
example,
\begin{verbatim}
  dur = 15
  rep = (4*5)
\end{verbatim}
This example shows the most likely way in which this capability might
be used in \schedb input files.  These two commands mean that
the scan, which is 15 seconds long, should be repeated 20 times.
By using the {\tt (4*5)}, it makes it clear that the repetition
lasts for 5 minutes since there are 4 scans per minute.

\section{\label{SEC:FILES} SCHED Input and Output Files}

\schedb takes input from several types of files in addition to any
interactive input.  All of these files can be separate, as long as
\schedb can find them, or most of them can be imbedded in the main
input file.  The former is more convenient.  But, when the input file
is to be sent somewhere else to be run again, it may be safer to imbed
the catalog information in the main file.  All input to \schedb is in
the
\hyperref[SEC:KEYIN]{keyin free format}
section.
This is the same format as is used by all Caltech VLBI
package programs.  The input file types are:

\begin{description}

\item[
{\hyperref[SEC:SCHPAR]{Main Schedule Input File}}:] This is the
file that contains the details of the particular project.  It can have
the most of the other files imbedded in it.  This file must be created
by the user.  This file should be given a name like {\sl bv016.key}
for project BV016.  See 
{\href{examples}{the /schedb examples}} for numerous samples.



\item[ {\hyperref[SEC:SRCCAT]{Source Catalog}}:] These files contain
the information about the sources, especially names, positions, and,
for line sources, velocities.  There are standard source catalogs,
although the user may need to add non-standard sources.  Source
catalog entries can be included in the {\hyperref[SEC:SCHPAR]{Main
Schedule Input File}}.  There are two standard source catalogs which
are {\href{catalogs/sources.gsfc}{{\sl
\$SCHED/catalogs/sources.gsfc}}}, and
{\href{catalogs/sources.petrov}{{\sl
\$SCHED/catalogs/sources.petrov}}}, which contains sources
respectively from from the Goddard geodesy group and from Leonid
Petrov.  The links above are actually to symbolic links to the latest
catalog from each source as of the time of the \schedb release.  These
catalogs contain thousands of sources (near 10,000 in Petrov's case),
so the old catalog that contained a few sources from elsewhere has
been abandoned.  Two external catalogs can be specified if one wishes,
for example, to use the standard one for calibrators and another for
multiple phase centers.

Please note that this source catalog, along with the locations catalog, is
updated approximately annually.  It cannot be relied upon to maintain
constant positions for a multi-year project.  If you need constant
positions, include your own set in your schedule.  Otherwise, include
a step in processing that accounts for changes in the assumed
calibrator position.  Note that the Earth orientation and station
locations actually change with time (plate tectonics etc) so
exact repeats of the observing geometry are not possible.

\item[
{\hyperref[SEC:STACAT]{Station Catalog}}:] This file contains
information about the antennas including names, positions, slew
limits, horizons etc.  There is a standard station catalog that should
suffice for nearly all users.  If not, entries can be included in the
{\hyperref[SEC:SCHPAR]{Main Schedule Input File}}.  Station positions may
stored separately in the 
{\hyperref[SEC:STACAT]{Location Catalog}}.  The
standard station catalog is 
{\href{catalogs/stations\_RDBE.dat}{{\sl \$SCHED/catalogs/stations\_RDBE.dat}}}.
The old version for use with the legacy VLBA systems is still 
{\href{catalogs/stations.dat}{{\sl \$SCHED/catalogs/stations.dat}}}.
By the next \schedb release, it is likely that
{\sl stations.dat} will be the RDBE version
and the legacy version will be renamed or removed.

\item[
{\hyperref[SEC:STACAT]{Location Catalog}}:] This file contains
station locations.  The standard version reflects the locations and
velocities used on the VLBA correlator.  It is documented along with
the 
{\hyperref[SEC:STACAT]{Station Catalog}} because they are tightly
coupled.  The Locations Catalog is optional since it is not needed if
the station locations are specified in the Station Catalog.  It exists
separately for ease of maintenance.  The standard
location catalog is 
{\href{catalogs/locations.dat}{{\sl \$SCHED/catalogs/locations.dat}}}.

\item[
{\hyperref[SEC:SETUPS]{Setup Files}}:] These files contain the
details required to configure the hardware at the stations.  Different
projects using the same hardware configuration can use the same setup
files.  There are many standard setup files are located in
{\sl \$SCHED/setups}.

\item[
{\hyperref[SEC:FRQCAT]{Frequency Catalog}}:] This file contains
information about valid frequency setups at the stations.  The RF
ranges that can be covered and the local oscillator and polarization
of each IF are given.  \schedb can use this information to provide
good defaults for many parameters in the setup files.  The standard
file should be used.  Any non-standard information can be in the setup
files.  This file cannot be imbedded in the main input file.  The standard
frequency catalog, for use with the RDBE systems, is 
{\href{catalogs/freq\_RDBE.dat}{{\sl \$SCHED/catalogs/freq\_RDBE.dat}}}.
The legacy version is still available.  It is 
{\href{catalogs/freq.dat}{{\sl \$SCHED/catalogs/freq.dat}}}
The main difference is that the VLBA IFs are assumed to be between 512
and 1024 MHz in the RDBE version, not 500 and 1000 MHz as in the legacy
version.  By the next \schedb release, the RDBE version will likely become
{\sl \$SCHED/catalogs/freq.dat} and the legacy version will be renamed or
removed.

\item[
{\hyperref[SEC:TPINI]{Tape Initialization File}}:] This file tells
\schedb the properties of the tape systems at the stations and where
to start on each tape.  Since tapes are no longer in use, this file
is mostly obsolete.  However it can be used to specify use of a
recording system at a station that is different from what is given
as the default in the station catalog.  This is generally only useful
during periods when stations are transitioning between different
recording systems.  Note that many old files, often used as templates,
contain tape initialization sections.  These should be removed.

\item[
{\hyperref[SEC:REFPOINT]{Reference Pointing Control File}}:]
\schedb can insert scans for reference pointing at high frequencies on
the VLBA and VLA.  This file contains information needed to control
that function.  It will only be of interest for observations above 15 GHz
on the VLA and at 86 GHz on the VLBA.  The standard reference pointing
control file is at 
{\href{catalogs/peak.cmd}{{\sl \$SCHED/catalogs/peak.cmd}}}
There is a special version related to reference pointing when using the
new wideband (RDBE/MARK5C) system on the VLBA.  It is 
{\href{catalogs/peak\_RDBE.cmd}{{\sl \$SCHED/catalogs/peak\_RDBE.cmd}}}.

\item[
{\hyperref[SEC:LINE]{Spectral Line Rest Frequencies}}:] \schedb can
adjust the observing frequency to remove the Doppler shifts due to the
motions of the Earth around the Sun and to the Sun with respect to a
desired reference frame.  To do this, \schedb needs to know the rest
frequency of the line being observed.  This is given in a {\tt
lineinit} section imbedded either in the main file or in the reference
pointing control file.  There is a file, 
{\href{catalogs/linefreqs.dat}{{\sl \$SCHED/catalogs/linefreqs.dat}}},
distributed with \sched,
that gives the rest frequencies for many of the maser
lines commonly observed with VLBI.

\item[
{\hyperref[MP:EPHFILE]{Ephemeris file}}:] \schedb can be used to
schedule observations of planets.  To do so, it obtains positions from
a JPL ephemeris file.  Mostly this is used for single-dish calibration
observations.

\item[
{\hyperref[SEC:SATEL]{Satellite file}}:] \schedb can also be used
to schedule observations of satellites.  To do so, it obtains orbital
elements from the {\tt SATFILE} or {\tt TLEFILE} which are specified
in the {\hyperref[SEC:SATINIT]{\tt SATINIT}} section.  This is used for
holography and for spacecraft navigation projects.  Satellite tracking
is discussed in the {\hyperref[SEC:SATEL]{Satellite tracking section}}

\end{description}

\schedb processes the input files and creates several output
files.  Most follow a naming convention that starts with
the project code (bv016 will be used in the examples here) followed
by a file type indicator, then a period, then a two letter station
code (pt for Pie Town in the examples below).  The experiment code
is read by \schedb in the 
{\hyperref[MP:EXPCODE]{{\tt EXPCODE}}} parameter
in the main schedule input.  The station code comes from the
{\hyperref[SEC:STACAT]{station catalog}} and a list if given in
Appendix \ref{APP:STACODES}. The output files are:

\begin{description}

\item[Summary File:] This file gives a rather extensive summary of the
setups and observations.  This is the most useful output file for the
user as it shows how \schedb has interpreted the input commands.  The
file will be called, for example, {\sl bv016.sum}.  The items displayed
for each scan can be controlled with the parameter 
{\hyperref[MP:SUMITEM]{{\tt SUMITEM}}}.

\item[sched.runlog:] This file reflects most of what you see on the
screen when \schedb is running, plus may contain additional messages
that help debug problems should they occur.

\item[Operator Schedule Files:] These files, of which there is one per
antenna, give much more information about the schedule than can be
included in the summary file and are useful when that level of detail
is needed.  They were originally meant for the use of operators of
manually controlled antennas, but now most antennas are computer
controlled and these files are more useful for the scheduler.  The
files are named, for example, {\sl bv016sch.pt}.

\item[VLBA type Antenna Control Files ({\sl crd} files):] These files
provide the legacy on-line control systems of the type found at VLBA
antennas with the information they need to control the observations.
There is one file per antenna that uses a VLBA control computer for
either full control of the station or for control of just the data
acquisition system (data recorders, baseband converters etc.).  The
files are named, for example, {\sl bv016crd.pt}.  Note that the
VLBA antennas currently are in transition with some items controlled
by the legacy system and some by the new control system which is
commanded using the VEX file.

% \item[Other Antenna Control Files:]  These files are
% antenna control files in VLA observe deck format, Green Bank Card
% format, or SNAP (Mark III style, but \schedb can make them
% for Mark II only).  The files are named, for example, {\sl
% bv016obs.y} for the VLA file.  All of these format types have been
% abandoned and SCHED no longer produces them.

\item[VEX file:] This is the main output file needed by the stations
for antenna and recording system control and by the correlators to
process observations.  It is now used by most VLBI systems around the
world, not just the Goddard ``Field System''.  For the VLBA, it is
used to control the RDBE, MARK5C, and some antenna data path switches.
The legacy system, commanded by the crd files described above, still
controls the antenna pointing among various functions.  Both are
needed.  A single VEX file describes the observations for all
antennas.

\item[V2D file:] This is a template correlator setup file for the
(VLBA) DiFX correlator.  Information that needs to be modified from what
is in the VEX file can be specified by the analysts in this file.
It is also the path to transmit information about multiple phase
centers per pointing to the correlator.

\item[Flag file:] \schedb writes a file with the {\sl .flag} extension
that can be helpful in data processing.  It contains flag entries, in
the format appropriate for the AIPS task UVFLG, that cover the times
when data are being recorded, but the antenna is expected to be
slewing.  For the VLBA, the monitor flags would usually take care of
such times, but for other types of stations, such information is not
always available from the logs.

\item[Preempt file:] Starting in Oct. 2011, the VLBA will be providing
observations of up to 1.5 hours on the Pie Town to Mauna Kea baseline
to the USNO for EOP determination.  This is in return for financial
support for operations.  These observations will preempt the scheduled
project on the two stations.  There is some flexibility to choose the
exact time of the preemption so the user has been given some ability
to guide the choice.  Important scans can be protected using the
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}} parameter.  Information in the
preempt file, which is also in the summary file, is used by operations
when picking the time for the EOP observations.

\item[Plots:] Sched can make plots of u-v coverage and of various
combinations of azimuth, elevation, paralactic angle, hour angle, UT,
and GST against each other.  Plots can be made of the time antennas
are up.  Plots can be made of beams.  The plot capability can be used
to plot the distribution of your sources, and of the all sources in
the catalog, on the sky.  This is useful for looking for calibrators.
In advanced modes, stations can be moved around to explore UV
coverages in array configuration design projects.  Also quality
factors can be calculated and plotted with contours over a map of the
stations.  There is interactive control over the plotting, the only
interactive part of SCHED.  Much of this capability is mainly useful
in experiment planning.

\item[DiFX configuration file:]  When making jobs for the DiFX
correlator, especially as used for the VLBA, a {\sl .v2d} file is
used to give information not readily deduced from the {\sl .vex}
file.  \schedb now writes a template for that file.  That file is
also be used to pass lists of phase centers when utilizing the DiFX
multiple phase center capability.

\item[Optimized Schedule:] When one of \sched's optimization modes is
turned on, or geodetic segments are requested, the program writes out
a file, such as {\sl bv016.sch} containing the basic scan inputs for a
new main schedule file.  If desired, the user can use this to
construct, and perhaps modify, a new optimized main schedule input.
This used to be the way all optimized schedules were constructed, but
now that \schedb fully processes an optimized schedule, it is rarely
used or needed.  The newer use is to make it easy to reproduce
geodetic segments when something else is changed that would otherwise
change the results of the optimization.

\item[{\sl frequencies.list}:]  If the user specifies the parameter
{\hyperref[MP:FREQLIST]{{\tt FREQLIST}}}, \schedb will read the
frequency catalog and make a table of all known setups which can
be used to make observations in the specified frequency range.  Then
\schedb will quit without doing further processing.  This is useful
for planning and for information while making setup files.

\end{description}



\section{\label{SEC:EXAMPLES}Examples}

There are a number of example \schedb input files distributed with the
program.  They are in the {\sl examples} subdirectory ({\sl
\$SCHED/examples} if the environment variable is set on unix systems).
Any can be consulted for information on how to run \schedb or for use
as templates from which to create your own schedule.  All should
produce valid schedules if run as is.  In fact, all are used in the
{\sl Verify} script that is used to check new installations and new
versions of \sched.  All of the examples are described briefly and
linked here.  As of Dec. 2013, there were 52 examples.  Some
consolidation is on the agenda for future releases, partly from purging
ones most appropriate for the legacy systems no longer in use.

The two examples in subsections below show a typical, reasonably
simple, schedule and a minimal schedule of the type one might use for
experiment planning.  The latter is likely to be useful when writing
proposals or doing other conceptual work.

Note that the example suite has grown up over many years and is in
some considerable need up updating.  All are valid schedules that run
and could be used.  But many features used are dated and new features
and currently preferred styles are still only seen in a few.  Some
with recent (After late 2010) modifications that are especially current are
{\sl manual\_1.key}, {\sl egdelzn.key}, {\sl egrdbe.key}, 
{\sl egrdbe2.key}, {\sl egddc.key}, and {\sl egcent.key} which target 
certain new features, but also show decent scheduling style.

See the section of this manual on
\hyperref[SEC:INSTALL]{installation}
if \schedb is not yet installed on your computer and if your login
is not set up to run \sched.  Also see
\hyperref[SEC:RUNSCHED]{the Running \schedb section}
for instructions on how to start the program.

If your version of \schedb is linked with the {\sc PGPLOT} libraries
(has plotting capability) and you are on a unix system, you will need
to set the environment variables {\tt PGPLOT\_DIR} to the location of
the {\sc PGPLOT} libraries and {\tt PGPLOT\_FONT} to the location of
the {\sc PGPLOT} font files, if that is not the same as {\tt PGPLOT\_DIR}.

\begin{description}

\item[
{\href{examples/manual\_2.key}{{\sl manual\_2.key}}}] This
file is shown below as 
{\hyperref[SSEC:EXAMPLE1]{the first example}}.  It
is a fairly typical \schedb input file for a VLBA plus the GBT
observation.  It uses defaults where it can and is relatively
simple.  This example is a good file to use as a template for making
new schedules. This file has not been updated from MARK5A to MARK5C.

\item[
{\href{examples/manual\_1.key}{{\sl manual\_1.key}}}]
This file will produce the same schedule as the
first example.  However, for demonstration purposes, far more
parameters are actually specified in the input file.  This includes
having at least parts of all auxiliary input files (catalogs etc)
imbedded.  It is fairly complicated and contains a lot of comments in
an attempt to show many \schedb features and give some advice on
scheduling strategy.  It has been updated to use the RDBE/DDC system
on the VLBA and the WIDAR on the VLA.

\item[
{\href{examples/manual\_simp.key}{{\sl manual\_simp.key}}}]
is {\hyperref[SSEC:EXAMPLE3]{the second example}} below.
It is a very simple file that can be
used to make plots for experiment planning purposes.  Because of the
lack of cover information and because of the special optimization mode
used, it cannot be used to produce telescope control files.

\item[
{\href{examples/egplan.key}{{\sl egplan.key}}}] is
much like [{\sl manual\_simp.key}].  It is a simple schedule to assist
in experiment planning.  It is a bit more complete than {\sl
manual\_simp.key}.

\item[
{\href{examples/eglst.key}{{\sl eglst.key}}}] is a
sample schedule using LST in the way requested for dynamic scheduling
projects on the VLBA.

\item[
{\href{examples/egvlba.key}{{\sl egvlba.key}}}] is a
sample schedule for VLBA observations.  It demonstrates band switching
and some recording control procedures not in 
{\href{examples/manual\_2.key}{{\sl manual\_2.key}}}.
It also demonstrates 
providing {\tt PREEMPT=EXTRA} scans on the ends of the project so
that operations might be able to provide extra data if there is a gap
that cannot otherwise be filled between projects.

\item[
{\href{examples/eg24.key}{{\sl eg24.key}}}] is a
sample schedule of a simple project on the VLBA, but one that goes
for 24 hours.  For dynamic scheduling, it is useful to be able to
wrap such schedules to use a different start time.  This shows how
to put in comments for the schedulers to aid that process and shows
how the schedulers can use parameters {\tt WRAP24 and DOSCANS} to
simplify the wrapping process.  Note, this has not yet been updated
from MARK5A to MARK5C.

\item[
{\href{examples/egOH.key}{{\sl egOH.key}}}] is a
sample spectral line file for VLBA
observations of several OH masers transitions.

\item[
{\href{examples/egcent.key}{{\sl egcent.key}}}] is
a sample showing how to specify multiple phase centers for a pointing
center for the DiFX correlator.

\item[
{\href{examples/egdelzn.key}{{\sl egdelzn.key}}}]
demonstrates how to use the capability in \schedb to add automatically
short geodetic segments for the purpose of atmospheric calibration
delay.  Note that similar segments, with very short scans, can be added
for tropospheric opacity calibration.  This example also shows the use
of the 
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}} parameter to protect
specific scans from preemption at Pie Town and Mauna Kea for daily
EOP observations of up to 1.5 hr.

\item[
{\href{examples/dqhiel.key}{{\sl dqhiel.key}}}]
demonstrates how to use the {\tt HIGHEL} optimization mode which can
pick the scan with the highest elevations across the array from among
a group of suggested scans.  It is useful for testing but also can be
useful for picking fringe finders etc.  This schedule is based on 
the regular data quality tests.

\item[
{\href{examples/egrdbe2.key}{{\sl egrdbe2.key}}}]
demonstrates a \schedb file for use with the new digital backend and
Mark5C recorders being deployed on the VLBA and elsewhere.  This one
is relatively simple and uses the PFB personality which gives many
channels of fixed frequency and bandwidth.  It does exercise the
mode where one station (GBT) has to observe in the opposite sideband
from others.

\item[
{\href{examples/rdbepfb.key}{{\sl rdbepfb.key}}}]
is a stripped down version of {\sl egrdbe2.key} that shows a rather
basic schedule for the VLBA only using the RDBE with the PFB personality.
It uses a \schedb standard setup so the user doesn't need to set
the configuration information.

\item[
{\href{examples/egcwide.key}{{\sl egcwide.key}}}]
Example sched input for a VLBA using the RDBE with the PFB personality
and the wideband 6 cm receiver.  Setups are given that use dual
polarization in one pair of IFs and that use single polarization in
two IFs at very different frequencies.

\item[
{\href{examples/egddc.key}{{\sl egddc.key}}}]
demonstrates a \schedb file for use with the new digital backend
and Mark5C recorders being deployed on the VLBA and elsewhere.
This one allows flexible baseband frequencies and bandwidths, but provides
fewer channels than the PFB personality.

\item[
{\href{examples/egddc2.key}{{\sl egddc2.key}}}]
demonstrates a \schedb file for use with 2 RDBE's and 8 channels
from the DDC personality.  Otherwise it is a fairly simple VLBA
schedule.  The deployment of 2 RDBE's is expected in early 2013.

\item[
{\href{examples/manual\_line.key}{{\sl manual\_line.key}}}]
is the example that is included in the 
{\hyperref[SEC:LINE]{spectral line section}} of this
manual.  It is for VLBA and GBT observations of 7mm SiO lines.  It
is more complicated than 
{\href{examples/egOH.key}{{\sl egOH.key}}}
and also demonstrates setting GBT
frequencies and many other setup parameters that were defaulted
in {\sl egOH.key}.  This file has not been updated from MARK5A to 
MARK5C.

\item[
{\href{examples/eg512.key}{{\sl eg512.key}}}] is a
sample schedule for the VLBA that uses the 512 Mbps mode.

\item[
{\href{examples/eg512g.key}{{\sl eg512g.key}}}] is a
sample schedule for the a global observation that uses 512 Mbps with
the RDBE.

\item[
{\href{examples/eg1024.key}{{\sl eg1024.key}}}] is a
sample schedule for the EVN that uses the 1024 Mbps mode with DBBC,
VLBA4, and MKIV systems.

\item[
{\href{examples/eg2head.key}{{\sl eg2head.key}}}] is
a sample schedule for an EVN observation that uses the 512 Mbps mode.
This uses 2 heads on one tape drive on Mark IV stations.  VLBA4 and
DBBC stations are included.  Note that it is possible to do 512 Mbps
on the VLBA and Mark IV stations simultaneously.  The VLBA uses 2
drives while the Mark IV systems use 2 heads.  This is actually based
on a network monitoring observation.

\item[
{\href{examples/egglobal.key}{{\sl egglobal.key}}}]
is a sample file for simple continuum observations involving the VLBA,
the EVN,and the GBT.  The VLA has been removed because this example
uses the legacy recording system which is no longer supported at the
VLA. This file has not been updated from MARK5A to MARK5C.

\item[
{\href{examples/egglobalOH.key}{{\sl egglobalOH.key}}}]
is a sample file for line observations involving the VLBA,
the EVN,and the GBT.

\item[
{\href{examples/egvsop.key}{{\sl egvsop.key}}}] is a
sample schedule for Mark~IV / VLBA observations specifically using
modes appropriate for observations with the Japanese VLBI satellite,
VSOP.  It will produce VEX format schedules for stations that use the
field system and VLBA format files for those stations that need them.
VSOP (HALCA) is no longer operational, but the VSOP-2 project has started
so this example has been retained.  It will be modified for VSOP-2
when that project is far enough along to make it clear what is needed.
This file has not been updated from MARK5A to MARK5C.

\item[
{\href{examples/eg3mma.key}{{\sl eg3mma.key}}}] is a
VLBA schedule for observations at 86 GHz.  There is special emphasis
on 
{\hyperref[SEC:REFPOINT]{reference pointing}}, which is done
explicitly in this file.   This file uses the RDBE\_DDC at 2 Gbps
using 8 channels of 64 MHz each.

\item[
{\href{examples/eg3mmb.key}{{\sl eg3mmb.key}}}] is another 2Gbps
VLBA schedule for observations at 86 GHz.  There is special emphasis
on 
{\hyperref[SEC:REFPOINT]{reference pointing}}, which is done
automatically in this file based on information in the {\sl peak.cmd}
file. 

\item[
{\href{examples/eg3mmc.key}{{\sl eg3mmc.key}}}] is
yet a third VLBA 3mm schedule, again using automatic insertion of
pointing scans.  But this time, the file with the commands controlling
that insertion is inserted in the main schedule file and is somewhat
simplified from that in 
{\href{examples/eg3mmb.key}{{\sl eg3mmb.key}}}
This file does not create the separate new and old system files needed
for reference pointing on masers while observing with the new RDBE wide
band system with the PFB personality.  For instructions on how to do 
that, please see 
{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}}.
This file has not been updated from MARK5A to MARK5C.

\item[
{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}}]
is similar to {\sl eg3mmb.key}, but shows how to make reference
pointing observations, when using the RDBE wide band system with the
PFB personality which uses fixed 32 MHz channels and cannot be fine
tuned.  It uses the crd parameters to specify the allowed bandwidth
and frequency, including using Doppler calculations, to set the legacy
system as desired.


\item[
{\href{examples/vips11.key}{{\sl vips11.key}}}]
shows use of 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE=HAS}}} for automatic
scheduling.  This mode tries to obtain a requested number of scans on
each source and spread them reasonably evenly over the time available.
It pays some attention to minimizing slew times.  It is meant to
simplify scheduling of projects that try to image a number, perhaps
large, of sources using multiple snap-shots on each.  It was
originally provided for the VIPS project but should be useful for many
other programs.

\item[
{\href{examples/evn\_cont\_strong.key}{{\sl evn\_cont\_strong.key}}}]
is an example of EVN observations at
18cm.  The observing pattern is an 11 minute cycle with 2 minutes on
a calibrator and 9 minutes on a target source.  This observation is at
128 Mbps.

\item[
{\href{examples/evn\_cont\_strong\_pol.key}{{\sl evn\_cont\_strong\_pol.key}}}]
is essentially the same schedule as 
{\href{examples/evn\_cont\_strong.key}{{\sl evn\_cont\_strong.key}}},
but with a D
term calibrator and a polarization position angle calibrator added.

\item[
{\href{examples/evn\_cont\_weak\_256.key}{{\sl evn\_cont\_weak\_256.key}}}]
is phase referencing schedule for
the EVN with a 5 minute cycle time using 256 Mbps.

\item[
{\href{examples/evn\_cont\_weak\_512.key}{{\sl evn\_cont\_weak\_512.key}}}]
is a similar phase referencing schedule
for the EVN, but uses 512 Mbps which requires 2 headstacks.

\item[
{\href{examples/evn\_cont\_weak\_snap.key}{{\sl evn\_cont\_weak\_snap.key}}}]
is an EVN schedule for 256 Mbps
observations of multiple snapshots using phase referencing.

\item[
{\href{examples/evn\_line\_hi.key}{{\sl evn\_line\_hi.key}}}]
is for EVN observations of an extragalactic
21-cm HI source.

\item[
{\href{examples/evn\_line\_meth.key}{{\sl evn\_line\_meth.key}}}]
is for EVN only observations of the
6.7 GHz line of methanol in a galactic source.

\item[
{\href{examples/eg5cm.key}{{\sl eg5cm.key}}}] is a
sample schedule for the EVN and EVLA that observes near 6.7 GHz.  It
is the same as {\sl evn\_line\_meth.key}, but with the EVLA added.

\item[
{\href{examples/egmk5vex.key}{{\sl egmk5vex.key}}}]
is for EVN only observations using the Mark5 system.  It is based on
a Network Monitoring schedule.
Note that it is a bit dated in that it uses the Mark5A system for 
a VLBA station which no longer has that option.

\item[
{\href{examples/hsa1cm.key}{{\sl hsa1cm.key}}}] is a
sample schedule for the High Sensitivity Array (HSA - VLBA + GBT +
Effelsberg) at 1cm.  This file does not include the
VLA and Arecibo.

\item[
{\href{examples/hsa21cm.key}{{\sl hsa21cm.key}}}] is a
sample schedule for the High Sensitivity Array (HSA = VLBA + GBT +
Effelsberg + Arecibo (VLA removed)) at 21cm.  The schedule uses the
legacy system which is not available at the VLA so the VLA has been taken
out for now.

\item[
{\href{examples/hsaddc.key}{{\sl hsaddc.key}}}] is
a rather complex example that uses the RDBE with the DDC personality
on the VLBA, VLA, GBT, and Effelsberg.  There are segments
at 6cm, 1cm, and 3mm.  It exercises array phasing 
at the VLA, reference pointing at all of the telescopes, and Doppler 
tracking.

\item[
{\href{examples/lba.key}{{\sl lba.key}}}] is a
sample schedule for the Long Baseline Array in Australia.

\item[
{\href{examples/lba\_h2o.key}{{\sl lba\_h20.key}}}] is a
sample schedule for the Long Baseline Array in Australia
using LBA DAS/Recorder only.  Observations are at the 22 GHz
water line.

\item[
{\href{examples/lba\_oh.key}{{\sl lba\_oh.key}}}] is a
sample schedule for the Long Baseline Array in Australia
using LBA DAS/Recorder only.  Observations are at the 1.8 GHz
OH line.

\item[
{\href{examples/lba\_mk5.key}{{\sl lba\_mk5.key}}}] is a
sample schedule for the Long Baseline Array in Australia when some
MARK5 stations are included.

\item[
{\href{examples/planvla.key}{{\sl planvla.key}}}] is a
planning file similar to the other VLBA planning files, but has
all 27 stations of the VLA A configuration.  You can use this to
explore VLA uv coverage etc.  It should still work despite the current
(2014) inability to schedule the VLA for other than VLBI.  It doesn't
actually create observing files.

\item[
{\href{examples/doptg.com}{{\sl doptg.com}}}] is a
script that creates and runs VLBA pointing observations.  It exercises
one of the optimization modes to allow the same script to be used for
any time slot for any time of year.  This example will not be run by
the {\sl Verify} script if the site is not at NRAO because the
ephemeris routines used for pointing at planets will not generally be
available.  It is also not of much interest beyond the staff
responsible for maintaining the VLBA.

\item[
{\href{examples/doptg2.com}{{\sl doptg2.com}}}] is a
script that creates and runs VLBA pointing observations.  It is very
much like {\sl doptg.com} except that it uses the 
{\hyperref[MP:DOSTA]{{\tt DOSTA}}}
parameter to allow the same script to be used for stations
with 3mm and stations without 3mm.

\item[
{\href{examples/egsat.key}{{\sl egsat.key}}}]
demonstrates scheduling a satellite observation using both MER-B and
Stardust.  It also includes Mars to exercise the planet option.  These
capabilities are unlikely to be of interest outside of the AOC.  In
fact, the required NAIF software libraries would hugely increase the
size of the SCHED distribution and are not normally included.  This
file has not been updated from MARK5A to MARK5C.

\item[
{\href{examples/dq415.key}{{\sl dq415.key}}}] is
a data quality test file from early 2014 that uses the RDBE and MARK5C.
It samples most of the RF bands available on the VLBA.

\item[
{\href{examples/mt506.key}{{\sl mt506.key}}}] is one
of the weekly VLBA integrity check observations from the MARK5A era.
It is here mainly to exercise SCHED in a mode that uses lots of setup
files.  It is similar to the more modern {\sl dq415.key} but uses the
outdated recording system.  It should probably be removed soon.

\item[
{\href{examples/jvla.key}{{\sl jvla.key}}}] is
an example covering use of the VLA as a phased array for VLBI.  This
version uses the 32 MHz output baseband bandwidths of the WIDAR to
create recordings that can be played against 4 of the 16 channels
created by the PFB personality of the RDBE on the VLBA.

\item[
{\href{examples/n2227.key}{{\sl n2227.key}}}] is a
sample USNO Earth Orientation observation using PT and MK.

\item[
{\href{examples/pfbsettst.key}{{\sl pfbsettst.key}}}] is a
vehicle for testing all the new RDBE/MARK5C standard setup files that
use the pfb personality.  These are the setups that start with 
{\sl rdbe\_pfb}.

\item[
{\href{examples/egsat.key}{{\sl egsat.key}}}] is a
sample VLBA observation of spacecraft with bsp ephemeris files.  Note
that the satellite tracking in \schedb uses the NAIF software from JPL.
The object libraries for linux g77 and gfortran are included with SCHED, but
may not be usable on all machines.  The code is not exported.  Normally,
other than in the AOC, the stub routines are used and \schedb cannot 
deal with satellites.  Also, \schedb does not have a way to pass the 
necessary site dependent, moving source positions to non-VLBA stations.

\item[
{\href{examples/tlesat.key}{{\sl tlesat.key}}}] is a sample VLBA observation
of spacecraft using TLE ephemeris files.  See the note above (egsat.key) about 
the satellite tracking software.  It applies here too.

\item[
{\href{examples/newsyn.key}{{\sl newsyn.key}}}] is a VLBA test observation
to check the performance of the new front end synthesizers being designed
in 2013-2015.  Those synthesizers have finer tuning steps than the current
ones (10kHz vs 200 or 300 MHz).  They are not yet deployed except at a 
couple of sites so this example is not yet of interest to users.

\item[
{\href{examples/tstsets.key}{{\sl tstsets.key}}}] is a VLBA test observation
that tests the standard setups used with the RDBE/DDC.  Only bit rates under
512 Mbps are tested.  This is not a maintenance schedule, not one users 
would likely want to emulate.

\item[
{\href{examples/piggyback.key}{{\sl piggyback.key}}}] is a VLBA test observation
that observes with both the Mark5A and Mark5C systems.  As of early 2015, only
two VLBA stations even have Mark5A so this is only of interest to VLBA
testers.




\end{description}

\subsection{\label{SSEC:EXAMPLE1}A Basic VLBA Schedule.}

The following example gives a fairly typical schedule that relies on
\sched's defaulting schemes and standard catalogs to get most of the
required information.  The cover and correlator information cannot be
reduced nor can the individual scan information.  All of those inputs
are unique to the observation.  This example is probably the most
useful one for users to use as a template for making their own VLBA
schedules, including for observations that include the
VLA.  It used to produce the same schedule as 
{\href{examples/manual\_1.key}{{\sl manual\_1.key}}}
but that example actually
shows how many items, that are defaulted or taken from standard
catalogs here, can be specified in the schedule file.  More recently
(late 2012), {\sl manual\_1.key} was converted to use the wideband
RDBE system.  Note that {\sl manual\_2.key} has not yet been updated
from MARK5A to MARK5C.

\verbatiminput{../examples/manual_2.key}


\subsection{\label{SSEC:EXAMPLE3}A Minimal Schedule for Planning.}

\schedb input files can be simple for simple situations.  The
following file is about as simple as a \schedb file can get.  It is
set up for exploring the u-v and sky coverage, and times of
availability, of a list of sources using the plotting abilities of
\schedb and using the 
{\hyperref[MP:OPTMODE]{{\tt UPTIME}}} optimization
mode to give overlapping 24 hour schedules for each source.

\verbatiminput{../examples/manual_simp.key}

If the above file were named {\sl uvcov.key}, it could be run with the
commands:
\begin{verbatim}
sched
plot sch=uvcov.key /
\end{verbatim}
When the plot section is reached, a graphical interface will appear
that is reasonably obvious how to use.



\section{\label{SEC:PLOT}Plotting}


\schedb has the ability to plot the u-v coverage and beam of sources in a
schedule and to plot azimuth, elevation, hour angle, or paralactic
angle against any of those quantities or against UT or GST for one to
all stations in a schedule.  These plots are useful for assessing the
quality of the schedule.  \schedb can also plot the positions of the
sources in a schedule in RA and DEC and plot the positions of all
other sources in the specified catalog.  The latter is useful for
identifying candidate calibrators.  The plots can be very useful
for planning observations, both at the proposal stage and as the
schedule is prepared.  For this use, see the section on
\hyperref[SEC:PLANNING]{planning}
and for a
very simple example schedule for obtaining plots of hypothetical
schedules, see the 
{\hyperref[SSEC:EXAMPLE3]{second example}} in the
\hyperref[SEC:EXAMPLES]{Examples section}.
Some of the other examples are also
oriented toward planning VLBA and VLA observations.

To cause \schedb to make plots, specify 
{\hyperref[MP:PLOT]{{\tt PLOT}}}
somewhere in the input.  Since it is unlikely that this will be
desired in the final run of the program, it is best to start a
plotting session interactively and then specify {\tt PLOT} and use
{\hyperref[MP:SCHEDULE]{{\tt SCHedule}}} to specify the input file.
Thus, you would type (on a unix box, anyway):

\begin{verbatim}
sched
plot  schedule=bv016d.key /
\end{verbatim}

(substituting your file for the {\tt bv016d.key}.

The plotting utilizes the 
{\href{http://www.astro.caltech.edu/~tjp/pgplot/}{{\sc PGPLOT} subroutine library}}
written by Tim
Pearson used by the other Caltech Package programs and in wide use in
astronomy.  Be sure that the environment variables {\tt PGPLOT\_DIR}
is set to the location of the {\sc PGPLOT} libraries on your system
and that {\tt PGPLOT\_FONT} is set the the location of the {\sc
PGPLOT} font files if that is different from {\tt PGPLOT\_DIR}.

If {\tt PLOT} has been invoked, \schedb will proceed to read all of
the input files, check the schedule, and do any requested optimization
normally.  It will write the summary file, but will not write the
antenna specific files, at least until later.  The summary file will
be closed and can be examined while in the plotting session.  This may
be useful in studying details of what is being plotted.

When the plotting session begins, \schedb opens a control panel with a
variety of buttons that can be clicked with the mouse.  It also writes
some instructions to the window in which \schedb is being run.  On the
control panel, the left most column has buttons that either select
different control functions (items to the right will change) or cause
something to happen.  The latter options include actually drawing a
plot ({\tt PLOT}), closing the plot ({\tt CLOSE}), restarting the
program to read a new input file ({\tt RESTART}), continuing to ({\tt
FINISH}) the rest of \schedb (only allowed if neither {\tt RESTART} or
{\tt OPTMODE=UPTIME} were used), exit the program ({\tt EXIT}), or
revert the the older style terminal input ({\tt TERM}) described
below.  The {\tt FILES} options allows changing output from the
terminal to postscript or other files and allows restriction of plots
to scans with specific setup files.  The {\tt OPTIONS} button allows
selection of colors and line widths.  The {\tt AXIS} button allows
selection plot type and axis scales.  The {\tt SOURCES} button
(default on wakeup) allows selection of antennas and sources.
Antennas can be selected both for plotting at all and for highlighting
in red.  The use of the buttons should be fairly intuitive and won't
be documented extensively here.  Some information included in the
descriptions of the terminal input below also applies to interactive
operation so it is worth reading through the documentation quickly.

Many thanks to Franco Tinarelli of Bologna for providing the code
for the plot control.

Note that, if elevation is plotted against azimuth, the horizon, as
specified in the stations catalog, will be plotted in addition to the
tracks followed by the sources.

If the RD Plot option is selected, the location on the sky of each
source in the schedule is shown.  This particular plot option has
acquired a number of interactive capabilities.  It is possible to
zoom in on a region, to look for calibrators around a target location,
to show (as calibrators) all sources in the catalog, not just those
listed in the schedule, and to label the source and catalog names.
These capabilities should be useful in attempts to locate calibrators
near reference sources.  Currently, a rectangular coordinate system
is used for the displays, but a more general projection scheme is
under development.

Plots are made, of whatever quantities are specified, by drawing
a line from the value at the beginning of each scan to the value
at the end of the scan.  Thus, if you have very long scans, the
individual line segments may become apparent and the plot will not
be an exact representation of the data that will be collected.

The {\tt RESTART} option is especially interesting for experiment
planning.  It causes \schedb to return to the beginning of the
program, read and process the input file again, and return to the plot
section, remembering the current plot inputs.  If the input file has
been changed in any way, those changes will be reflected in the new
plots.  Thus scan times can be changed, new sources specified etc.
This is useful, for example, in exploring the u-v coverage for various
sources (much like the Caltech program {\sl HAZI}) or determining the
times that various sources are visible (like the Caltech program {\sl
UPTIME}).  It is more flexible than the other programs because you
have full control of the schedule so, for example, the u-v coverage
from multiple snapshots can be explored.  Because it is possible, by
deleting some parameters from the input file, to cause \schedb to get
confused about the value of some of the parameters for which only one
value per project is accepted, the {\tt FINISH} option is locked out
after a {\tt RESTART}.  If a {\tt RESTART} option has been used, it
will be necessary to rerun the program from scratch to get final
output schedules.  Since you have been modifying the input file on
each restart, this should not be a problem.

In older versions of \schedb or if the {\tt TERMINAL} button is pressed,
the plot control is from the terminal window using KEYIN input as
described below.  This form of input will probably be removed eventually
unless there is demand to keep it.

\subsection{Keyin Input for Plotting (obsolete)}

This section describes the use of Keyin inputs to control the plotting
functions.  This has been superceded by the control panel scheme
of inputs, but the documentation will be retained until the capability
is removed.

If the {\tt TERMINAL} button is pressed on the plot control panel,
\schedb reverts to Keyin style input from the main window in which it
is running to control the plots.  First, \schedb writes a description
of the possible input parameters, which are also described below, and
then prompts for KEYIN style input.  The user should specify any
desired quantities and then type a ``/''.  If the user is on a machine
with X windows graphics, simply taking all the defaults will cause a
u-v plot of all sources and scans in the project to appear on the
screen.

The inputs can be used to choose between u-v plots, xy, and Ra-Dec
plots.  For u-v plots, the scale can be specified and a station can be
selected for which, on color displays, the baselines to that station
will be highlighted (displayed in red).  Also the source to be plotted
can be specified.  XY plots are a bit more complicated because they
are more flexible.  The quantity to plot on each axis can be selected,
the scales specified and the station and source chosen to be one or
all.  See the details of the input parameters below.  In addition, the
plot can be restricted to scans that use one of the setup files.  This
can be useful for assessing band switching observations.

The input parameters are not reset between runs of the plotting.  Thus
the user need only specify those items that he/she wishes to change.
Some of the built in KEYIN capabilities can be useful here.  If you
type {\tt SHOW}, KEYIN will list the input variables and their current
values.  {\tt HELP} generates a list of the variables.  Also you can
type {\tt SAVE filename} and KEYIN will write a file with name {\tt
filename} in the default area containing the current parameter
settings.  Later, perhaps in another run of \sched, you can type {\tt
@filename} to recover those parameters.  The parameter file can be
edited --- it is a normal KEYIN input file (actually any file can be
read with the {\tt @filename} construct, although only up to the first
``/'').

Plotting Input Parameters (Terminal):

The KEYIN inputs to the plotting section of \schedb are:

{\tt PLotfile}

{\tt PLOTfile} gives the output specification for the plot.  As with
any {\sc PGPLOT} programs, it is in the form {\tt filename/device}.
For interactive devices, the filename need not be specified.  The
default device is {\tt /xs} which is a good choice for X windows systems.
Other devices most likely to be of interest are {\tt /ps} for a postscript
file and {\tt /cps} for a color postscript file.  See
{\href{http://www.astro.caltech.edu/~tjp/pgplot/}{{\sc PGPLOT} documentation}}
{\sc PGPLOT}
documentation for other options (more will be listed here in the future).
The device can be changed at any time.
If it is changed, the old one will be closed and the new one opened.  This
allows the plot to be set up interactively, and then put out in postscript
for printing.

{\tt SEtnum}

When the plotting section is entered the first time, information is written
to the screen about possible input options.  Among the information presented
is a numbered list of the setup files encountered in the input.  With
{\tt SEtnum}, one of those setup files can be selected by number (avoids
lots of typing since setup file names often include full paths and can
be quite long).  Then the plot will only show scans which use that setup
file.

{\tt TYpe}

{\tt TYpe} is used to specify the type of plot.  The option are {\tt UV},
which is the default, {\tt XY}, and {\tt RD}.  {\tt UV} causes a plot of the
spatial frequency coverage to be plotted.  For now, the scale on the
plot is km.  An expected enhancement eventually is for this to optionally
be in wavelengths.  For {\tt XY} plots, there are a variety of options
which are specified with {\tt XAxis} and {\tt YAxis}, which independently
specify the quantity plotted on each axis.  {\tt RD} requests that the
locations of the sources in the schedule be plotted in Ra and Dec.

{\tt XAxis}

{\tt XAxis} specifies the quantity to be plotted on the horizontal axis
in a {\tt TYPE=XY} plot.  The options are {\tt el} for elevation, {\tt
az} for azimuth, {\tt pa} for paralactic angle (for polarization),
{\tt ha} for hour angle, {\tt ut} for universal time, and {\tt gst} for
Greenwich Sidereal time.

{\tt YAxis}

{\tt YAxis} specifies the quantity to be plotted on the vertical axis
in a {\tt TYPE=XY} plot. The options are {\tt el} for elevation, {\tt
az} for azimuth, {\tt pa} for paralactic angle, and {\tt ha} for hour
angle.  If {\tt xaxis=az} and {\tt yaxis=el}, the antenna horizons
will be plotted along with the source tracks.

{\tt XLeft} and {\tt XRight}

{\tt XLeft} and {\tt XRight} specify the minimum and maximum for the
X axis plot scale.  If they are not set, or are set to -9999., the axis will
be autoscaled.  For u-v plots, it is only necessary to specify one
value, say {\tt XMax}, and it will be used for all 4 limits.  If more
than one are specified, they are used which allows off center plots.
For {\tt XY} plots, the limits should be specified in the units of
the plots.  For the time axis, the limits should be in the form
{\tt hh:mm:ss} where this is the time offset since the beginning of the
first day of the experiment for {\tt UT} or is the GST.  Note for u-v
plots, traditionally, the plot has positive to the left so {\tt XLeft} will
be greater than {\tt XRight}.  For Ra-Dec plots, {\tt XLeft} and {\tt XRight}
specify the RA range and should be in the form {\tt hh:mm:ss} (eg.
{\tt XL = 5:30:00}).

{\tt YBottom} and {\tt YTop}

{\tt YBottom} and {\tt YTop} specify the minimum and maximum for the Y
axis plot scale.  If they are not set, or are set to -9999., the axis will
be autoscaled.  For Ra-Dec plots, {\tt YBottom} and {\tt YTop} specify
the declination limits and should be in the form {\tt dd:mm:ss} (eg.
{\tt YB = -12:15:00}).

{\tt SOurce}

{\tt SOurce} can be used to restrict the plots to a single source.  The
default, which can be specified at any time is {\tt ALL}, which will
cause all sources to be plotted.

{\tt STation}

{\tt STation} can be used to restrict {\tt TYPE=XY} plots to one station.
For {\tt TYPE=UV} plots, all stations will be plotted, but all baselines
to the specified station will be plotted in a contrasting color.
The default, which may be specified at any time, is {\tt ALL}, which
will cause all stations to be plotted or not highlighted.

{\tt REstart}

See the discussion above for details of the effect of {\tt REstart}.  In
short, it causes the program to return to the beginning and reread the
input, which may have changed.

{\tt FInish}

{\tt FInish} tells \schedb to close the plot files and produce the
station specific output files.  {\tt FInish} is locked out after a
{\tt REstart} to make absolutely sure that the output files really
correspond to what is in the schedule file.  If {\tt REstart} has
been used, it will be necessary to {\tt EXit} and rerun \schedb from
scratch to get the station output files.

{\tt EXit}

{\tt EXIT} tells \schedb to close the plot files and exit.  Antenna
specific files will not be produced.


\chapter{\label{CHP:ADVICE}INFORMATION AND ADVICE ON SPECIFIC TOPICS}

\section{\label{SEC:PLANNING}Using SCHED for Project Planning}

The plotting and summary capabilities of \schedb make it useful for
experiment planning.  When writing a proposal, it can be used to
determine the appropriate GST ranges for a source and to explore the
u-v coverage available.  While designing a schedule, it can be used
for the same purposes and to experiment with various detailed
schedules.  It is also possible to plot the distribution on the sky of
sources, either just the sources in the schedule, or, in addition, all
of the sources in the catalog.  This might be useful for selecting
calibrators.

The most effective use of \schedb for planning involves using 5
windows on a windowing system.  The first is the one in which \schedb
was started.  The second is the plot control panel brought up by
\sched.  The third is the actual plot window used by \sched.  The
fourth is your favorite editor in which changes to the main \schedb
input are being made between {\tt REstart}s.  The fifth has some sort
of listing tool, such as {\sc more} or {\sc less} in unix, which can
be used to examine the summary file.

The schedule to use for planning can be very simple.  In fact the
{\hyperref[SSEC:EXAMPLE3]{simple example}} at the end of the 
{\hyperref[SEC:EXAMPLES]{Examples}}
section is designed exactly for this purpose.
One of the other examples, {\sl egplan.key} is also well set up for this.
Multiple sources can be specified, or a {\tt REstart}
can be done after editing in each source that is to be examined.  The
{\hyperref[MP:OPTMODE]{optimization mode}} {\tt UPTIME} is especially useful
for planning.  Also, if you are trying hypothetical stations, or stations
for which you don't have setup information and which are not in the
frequency file, you may wish to use 
{\hyperref[MP:NOSETUP]{{\tt NOSETUP}}}
to completely turn off all need for setup information (of course, you
cannot then write telescope control files with {\tt NOSETUP} active).

\section{\label{SEC:TIPS}Scheduling Tips}

This section contains subsections with detailed discussions and
advice on various aspects of scheduling.  It surely is not complete, but
much basic advice is available.

\subsection{\label{SSEC:STRATEGY}Observing Strategy}

A tremendous amount could be said about observing strategy.  See the
article by Joan Wrobel in the book ``Very Long Baseline Interferometry
and the VLBA'' (1995: ASP) for a good discussion.  That book also
contains a lot of information about VLBI and is a good reference for
all observers to have.  Other important sources of information are the
``VLBA Observational Status Summary'' and ``General Instructions on
Observation Preparation'' (which is sent to scheduled users).  These
and many other useful documents can be accessed on the Internet from
the 
{\href{http://www.vlba.nrao.edu/astro}{``VLBA Information for Astronomers''}}
page.  This section of the \schedb
Manual will be limited to a few important concepts to keep in mind
while scheduling.  It is assumed that the observer already has a
reasonable idea of how much time is needed per source, what
frequencies to observe, etc.  The suggestions here are more oriented
toward smooth observing, processing, and calibration.

\begin{list}{}{\parsep .5em  \itemsep .5em }

\item {\bf Fringe finders:} In order for the staff at a VLBI
correlator to tell if the correlation has gone well, it is necessary
to have occasional scans on sources that will provide strong fringes.
A minimum of two such scans should be provided and, for longer
projects, there should be one every 4-6 hours at a minimum.  The
``VLBA Observational Status Summary'' and ``General Instructions on
How to Prepare for Observing'' documents mentioned above have lists of
appropriate sources.

The fringe finders can also be used for ``manual phase cal''.  This is
the process of aligning the phases and delays on all individual IFs.
This is simply done by running the fringe fitting program on the
calibrator and applying the results to all data.  For this purpose, it
helps to have a scan with all antennas at reasonably high elevations
simultaneously.

Finally the fringe finders typically make good bandpass calibrators
because then have good SNR in each spectral channel.

\item {\bf Setting the flux scale:} Setting the flux scale of VLBI
images is not trivial.  Ideally, one would have a compact source of
known flux density that could be used, as 3C286 and 3C48 are on the
VLA, to calibrate the flux densities.  However, by their nature, sources
that are compact to VLBI (essentially none are unresolved) are variable
and, therefore, do not make good flux calibrators.  There are two ways
to deal with this.

One is to try to obtain the flux density of a compact calibrator at a
close enough time to the VLBI observations that variations will not be
significant.  At the time of the VLBI observations, some of the larger
antennas can be asked to measure flux densities of sources being
observed (see the 
{\hyperref[MP:TANT1]{{\tt TANT}}} command.  Better yet,
if you have a phased array, such as the VLA, or can get an hour or so of
VLA test time, accurate flux densities of your VLBI calibrators can be
measured.  In order to do this, be sure to include a VLA flux calibrator
(usually 3C286 or 3C48) in the VLA schedule.  You don't need to
record VLBI data on it.  This method can go awry if the calibrator has
intermediate scale structure that is compact to the interferometer but 
resolved out by VLBI.

It is also possible, and perhaps preferable, to rely on the apriori
calibration of the VLBI antennas.  For this, it is best to look
carefully at your data and determine which subset of antennas is
giving consistent calibration.  With the VLBA at intermediate
frequencies, it is possible to get the flux scale right to within a
few percent this way.  You just have to be sure not to let any
antennas with bad weather or other problems contribute to the flux
scale.  In the AIPS calibration task CALIB, use ANTUSE to limit the
gain normalization to the antennas whose gains you trust.  Also
specify a generous minimum elevation, such as 30 degrees, for the gain
normalization.

When using the apriori gains for absolute flux calibration, care must
be taken with bandpass calibration and channel selection.  The gains
are measured using the full bandwidth of the baseband channel - they
are based on total power measurements from the baseband converters.
Such gains apply to the average across the full baseband.  If you
attempt to apply such gains to a data set with the edge channels
removed, there will be an error of a few percent because those edge
channels typically have lower gain (which is probably why you removed
them) and the average for the remaining channels will be higher.  You
can deal with this either by doing the calibration including all edge
channels, or by doing a bandpass calibration based on all channels.
Bandpass calibration brings all channels to the average level.

If you are going to rely on apriori calibration, be sure to obtain
some data at close to the frequencies at which antenna gains have been
measured.  These frequencies are given in the {\sl vlba\_gains.key}
available by anonymous ftp to ftp.aoc.nrao.edu.  This is the file that
you will need for VLBA calibration.  At those frequencies, the Tsys
used in calibration and the gain are based on the same values of Tcal
so the Tcal value cancels out.  If you observe at other frequencies,
you will be depending on the Tcal values being correct (or at least
having the right ratio) at your frequency and the frequency where the
gains are measured.  That is not assured.

For any of these methods to work, it is best to include a strong,
compact calibrator and to observe it several times to check
consistency.

There appears to be an offset of on the order of 6.5\% between Tsys
values measured with the legacy VLBA system's baseband converters and
Tsys measured with the new, wide-band RDBE. The cause of that offset
is not yet understood, but is thought to be some issue with the old
system.  During the transition, the gains distributed are for the old
system.  An adjustment appears to be required to for data data
calibrated using Tsys measured either by the RDBE or by DiFX and gains
derived from the old system (all gains distributed so far as of July
2012).  For a discussion of this effect, see /htmladdnormallink{VLBA
Senesitivity Upgrade Memo 34}{
https://science.nrao.edu/facilities/vlba/publications/memos/sensitivity-upgrade/index.sensimemo34.pdf}.
Stay tuned on developments in this area.

{\href{http://www.vlba.nrao.edu/astro}{``VLBA Information for Astronomers''}}

\item {\bf Setting the relative gains of antennas:}  Another invaluable
use of a strong, compact calibrator is to help ensure that all antennas
and all IFs have consistent calibration.  After apriori calibration
and setting of the flux scale has been done, a model of the calibrator
can be used to derive whatever additional gain adjustments are needed.
These can be applied to the whole observation to obtain the best possible
calibration, short of self-cal.


\item {\bf Scan Gaps, ``Readback tests'', and module-swap gaps:}  Before
the Mark5C era, one had to be very careful about scan gaps to avoid
data loss due to resync times, but also not to put the data at risk
through excessively long record scans (period of no media stoppage).  With
the Mark5C, most of these issues go away.  The media are stopped from
the end of one scan to the expected time of good data at that station
in the next scan.  Resyncs don't take time with the software correlator.

With the older media (including currently (2012) in use Mark5B and
VLBA disk recording), the recording media should be stopped
occasionally to help prevent major amounts of data loss if something
should go wrong and, on non-VLBA controlled stations, to allow disk
bank changes.  Two minute gaps every hour or two used to be used for
readback tests with the tape systems.  Tape is no longer used, but an
equivalent data integrity test is likely to be built into the disk
based systems in the future.  Also, if the disks are not stopped, all
the data ends up in one file. If there are problems closing the file,
the data can become unreadable.  As of early 2008, it is recommended
that a gap of 30s or more be inserted every hour or two.  In fact, any
pause in recording will start a new recording scan, but beware that
\schedb prevents gaps of less than 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}
seconds.  For field system controlled
stations, (most non-VLBA stations) gaps should also be inserted to
allow bank changes.  The VLBA can switch between mounted disk banks
(modules) on the fly, but the field systems need a pause in the data
recording.  Such gaps should be inserted every 22 minutes for
recordings at 1 Gbps and proportionally less often at lower bit rates.
These gaps need to be more than 10s long.


\item {\bf Phased VLA:} The phased VLA has special calibration needs.
If the target source is either too weak or too resolved to be used for
phasing up the array, special scans on a calibrator must be inserted
for this purpose.  This can be done with \schedb.  Or it might be
possible to do it with the VLA scheduling software, but it is probably
better to explicitly include the calibrators in the \schedb files.  
(see
\hyperref[SEC:VLA]{the section on VLBI at the VLA}
for details).

Also, the effective beam of the phased VLA (or any other phased
interferometer such as Westerbork) is the synthesized beam.  This
can be less than an arcsecond in the worst cases.  This places far
greater demands on source positions required for observing than
is typical at single antennas.  Be sure to provide positions
of sufficient accuracy, which can mean 0.1 arcsecond.

Anyone using the VLA for VLBI should consult the
{\href{http://www.vla.nrao.edu/astro/guides/vlbivla/current/}{VLBI at the VLA guide}}.

\item{\bf Calibrator scans:} Except for phase or fringe reference
calibrators, there will typically be only 2 or a few more scans on
each calibrator of the types discussed above.  It is tempting to put
these scans at the beginning and end of the scheduled observing time.
However this is quite risky as those are the time periods most likely
to experience problems.  The beginning is especially risky because, if
there are any problems at a site, they may not have been fixed yet.
The end is ok, except at sites where the main target source has been
down for a while and the antenna has been idle.  It may not wake up
again cleanly for the calibration scans.  It is best to take time (a
few minutes on each calibrator) out of the middle of the schedule a
couple of times to get the calibration data.

\item{\bf Protected scans:} Starting in Oct. 2011, ongoing VLBA
observations will be preempted at the Pie Town and Mauna Kea stations
once per day for up to 1.5 hours for Earth Orientation Observations.
This is in return for operations funding from the USNO.  There is some
flexibility in the exact times of the preemption. \schedb parameter
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}} can be used to protect key scans such
as special calibrators or geodetic segments.  See the writeup for that
parameter for more details.

\item{\bf 24 hour schedules:} With dynamic scheduling, it is useful if
24 hour schedules can be ``wrapped'' by starting part way through,
then picking up the first scans at the end.  If you have a 24 hour
schedule, it would help the process if you insert a unique
{\hyperref[MP:COMMENT]{{\tt COMMENT}}} at the logical places for wrapping
the schedule.  The scheduler will use the 
{\hyperref[MP:WRAP24]{{\tt WRAP24}}}
switch to cause \schedb to copy the scans onto the
end of the schedule to create a 48 hour schedule.  He/she will then
use 
{\hyperref[MP:COMMENT]{{\tt DOSCANS}}} to select the desired 24 hour
block.  Unique comments help find the same place in the two copies of
the schedule.  Example 
{\href{examples/eg24.key}{{\sl eg24.key}}}
demonstrates such a schedule.

\item{\bf Set-and-remember:} Both the VLBA (RDBE) and the VLA new
systems require the power levels for the analog signals to be set
before the wide band samplers.  Changing the attenuators can cause
phase errors, but there is a lot of dynamic range in the allowed
levels.  Therefore the attenuators are only set once for each
frequency setup per observation.  Time needs to be left for that
operation.  The RDBE needs 5 seconds.  The VLA needs 60 seconds.
\schedb will warn when inadequate time is provided.  Also, \schedb
will schedule in the required time automatically using the numbers in
the station catalog parameter {\tt TLEVSET} when using dwell time
scheduling when the scan itself is a recording scan, a pointing scan,
or a phasing scan (VLA) or is not long enough.  After the first scan
with a setup, the RDBE/PFB needs about 2 seconds at the start of each
scan to set the levels for the final down-sampler to 2 bits.  That
time will be provided automatically for if the station file parameter
{\tt TSETTLE} is higher, which it normally is for other reasons.  For
the DDC personality, the level setting will be adjusted regularly
during the scan.  The VLA doesn't need extra time for that, although
that operation is done.


\end{list}



\subsection{\label{SSEC:SCANTIMES}Scan Times}

Scans have a nominal start time and a stop time that may be set
explicitly by the user or derived by \schedb based on a variety of
criteria.  Scans have a separate start time, often offset from the
nominal start time, that \schedb assigns for the start of recording.
\schedb also has a reasonably good idea of when good data will start
to be available after any required slews and setup times are
completed.  Throughout most of \sched, the scan times presented to the
user are the nominal start and stop times.  On the other hand, the
recording start time is what will be given in the files sent to the
telescopes and correlators.  The VEX file, which is becoming dominant
as the telescope and correlator control file, uses the recorder start
time as the scan time, but contains the offset from that to the good
data start.  Some systems, including the VLBA and VLA now use the good
data start as the time to start recording or correlation.  This
section describes how all this is controlled using a number of \schedb
input parameters.

There are a variety of ways to set the nominal times of a scan.  A
{\hyperref[MP:START]{{\tt START}}} time must always be set for the first
scan of a schedule --- \schedb obviously has to know when to start.
After that, the ways to set the nominal scan times are:

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item Set the 
{\hyperref[MP:START]{{\tt START}}} time and the
{\hyperref[MP:STOP]{{\tt STOP}}} time.  This is uncommon except with
\schedb inputs derived automatically from other sorts of schedules.

\item Set just the 
{\hyperref[MP:STOP]{{\tt STOP}}} time.  \schedb will
use the previous scan's stop time plus any gap as this scan's start
time.

\item Set the 
{\hyperref[MP:START]{{\tt START}}} time and the
{\hyperref[MP:DUR]{{\tt DURation}}}.  Sched will set the start time as
requested and the stop time to the start time plus the duration.

\item Set a duration using 
{\hyperref[MP:DUR]{{\tt DURation}}}.  \schedb
will set the start time to the previous scan's stop time pus any
{\hyperref[MP:GAP]{{\tt GAP}}} and the stop time to the start time 
plus the duration.

\item Set a duration using 
{\hyperref[MP:DWELL]{{\tt DWELL}}}.  \schedb
will set the start time to the previous scan's stop time plus the time
it takes to get the antennas on source and observing.  Then it will
set the stop time to the start time plus the requested dwell time.
Note that this option does not yet take into account the time to
switch between frequency bands (say 7mm to 2cm).  There is an option,
with a second argument to {\tt DWELL}, to not wait for the last, or
last few antennas.  This can be useful when there is a slow antenna
involved or when some antenna is too close to the zenith.  A third
argument can be used to insure that the slow antennas get some time on
source. 
{\hyperref[MP:GAP]{{\tt GAP}}} can be used to set the minimum
interval between the scans.  This is the most recommended scan
scheduling scheme.

\item Use any of the above to set the start and stop times, and then
offset the resulting start time with 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}.
Only the start time, not the stop time, is
affected by {\tt PRESCAN}.  If {\tt PRESCAN} is positive, the start
time is delayed.  If {\tt PRESCAN} is negative, the start time is
moved earlier by the requested amount, although it will not be moved
into the previous scan.  This used to be the primary scheme for
controlling time provided for media acceleration and correlator
synchronization, but has been superceded by 
{\hyperref[MP:GAP]{{\tt GAP}}}, 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}, and
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}.  A still-useful function is
to delay the start of scans scheduled with {\tt DWELL} somewhat to
be more sure that the first recorded data will be good.

\end{list}

The calculation of the time required for an antenna to start delivering
good data is based on on information in the
{\hyperref[SEC:STACAT]{station catalog}}.  See the section on that catalog
for details of the parameters mentioned here.  The slew time is calculated
based on the pointing direction at the previous and next sources along
with the slew rates and accelerations for the antenna.  An additional
time {\tt TSETTLE} is added to the slew time for
the antenna to settle and the electronics to get ready.  Additional
time might be added for digital systems to set power levels based
on {\tt TLEVSET} for the first time a setup is seen (VLBA and VLA).
The total time to be ready will not be less than {\tt MINSETUP}, even if
the slew is fast and the settling time ({\tt TSETTLE}) is short.  

The slew time calculator tries to take into account the need for cable
wraps.  The algorithm is simply --- the shortest path to the next
source will be taken even if that turns out not to be optimal later.
Early VLBA experience suggested that a simple, predictable algorithm
was preferred over a more optimal, but hard to predict, algorithm.

After the nominal times are determined, the recording start time is
adjusted as described in the 
{\hyperref[SSSEC:Starttime]{Adjusting the Scan or Recording Start Time section}}
below using 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}, and 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}.
Such adjustments were used to allow time for the recording media to
get up to speed, formatters to reconfigure between scans with different
setups, and for playback to synchronize on correlation.  These were
significant issues with the old tape systems, and to a lesser extent
with the MARK5A system.  The newer MARK5C recording system and DiFX
correlators, and perhaps others, are able to record and correlate data
beginning right at the assigned start time so such adjustments are
not required.

The date specification for a scan is for the scan stop time,
regardless of how the scan times are specified.  If there is a scan
that crosses midnight, this can cause some confusion, especially if it
is the first scan of the experiment and the date is being specified
along with 
{\hyperref[MP:START]{{\tt START}}}.  If a schedule crosses a
day boundary and {\tt START} or {\tt STOP} times are being specified,
the new day should be specified.  However, if midnight is crossed
during any form of duration scheduling, the day will be incremented
automatically.

All scans for a given station must be specified in time order.
However, it is not necessary for scans for different stations to be in
time order.  This allows, for example, for the scans for one antenna
to be specified separately from the scans for another antenna.  While
this works, it is not recommended because \schedb does not try to
identify scans that can be correlated together.  Anything that depends
on knowing what the whole array is doing is likely to fail.  {\tt DWELL}
time scheduling is one such item because \schedb must know how long
the slews are for all antennas in a scan.  Plotting of u-v coverage is
another because \schedb only plots u-v points for baselines between
antennas in the same scan.  The estimates of data volumes and rates
from the correlator, given in the summary file, are yet another
because they depend on counts of baselines.  Finally, any VEX file
produced in such a way is likely to cause problems at a correlator
that depends on it, such as DiFX (VLBA and many others).

\schedb allows sidereal time scheduling by means of the 
{\hyperref[MP:LST]{{\tt LST}}} parameter.
For VLBI, the concept of LST needs a bit more
specification since it is different for each element of the array.
{\tt LST} can take an argument which is the station whose LST is to be
used.  If there is no argument, that station is assumed to be the VLA
since LST scheduling was most commonly used for VLA schedules when
the capability was first added to \sched.  Now that dynamic scheduling
is being used on the VLBA, many users will want to set
{\tt LST=VLBA\_PT} to conform to the style of scheduling requested
for such projects.

If 
{\hyperref[MP:LST]{{\tt LST}}} is specified, there are two ways to set
the date.  With the original method, the year and month are ignored
and the day is assumed to be the (modified?) julian sidereal day
number.  Finding the LST day can be a bit painful, but a rough
estimate can be had from the fact that LST day 60501 was 2006 Feb. 16.
The estimate can be put in \schedb to narrow down to the right date.
The second method is much easier and the scheme normally used.  It is
to specify the UT day in the usual manner.  \schedb will attempt to
figure out the LST day number, taking into account the fact that 0
hours LST is sometime in the middle of the UT day.  It will also check
if your start time is in the approximately 3.9 minutes where the
result is ambiguous (LST days are shorter than UT days) and request
specification of the LST day number --- giving you the options.

If sidereal time scheduling is requested, most times and durations are
assumed to be in sidereal units.  Some exceptions are {\tt PRESCAN} and
{\tt MINPAUSE}.

It is a very good idea, when using LST scheduling, to check the
final output schedules, which are all in UT, to be sure that they
are for the right day.

When dynamic scheduling, it is often difficult to mesh projects
together perfectly.  This can lead to gaps in scientific observing
which causes an under-utilization of the array.  \schedb supports two
features that are meant to help with this situation.  The first is
that the user can specify optional scans on the ends of the project by
setting 
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}} {\tt = EXTRA} for those
scans.  The scans will appear in the summary file so their properties
are clear, but will not be passed to the machine readable files used
to control the antennas.  To activate them, so they are on the control
files, parameter 
{\hyperref[MP:DOSCANS]{{\tt DOSCANS}}} can be used to
select the scan range to be used.  The second option applies to 24
hour schedules which could be started at times other than in the
original schedule and wrapped around the day.  Parameter 
{\hyperref[MP:WRAP24]{{\tt WRAP24}}}
causes \schedb to copy the scans onto the
end of the original scans to make a 48 hour schedule.  
{\hyperref[MP:DOSCANS]{{\tt DOSCANS}}}
is then used to select the desired 24 hour
block.  It is expected that {\tt DOSCANS} and {\tt WRAP24} will be
used mainly by operations personnel.


\subsubsection{\label{SSSEC:Reconfigurations}Dealing with Formatter
Reconfigurations}

NOTE: Concerns about formatter reconfigurations will disappear when
the digital backends take over.  About half of VLBA projects use the
new system as of the start of 2013 and that should go to all during
the year, so soon this section will be obsolete.

A factor to consider when planning scan times is legacy formatter
reconfigurations.  These happen when the internal switching and setup
of the formatter at the station has to be changed.  Such changes
happen when any of a number of parameters, including the number of
channels, the sample rate, the BBC assignments, the BBC sidebands, and
the pulse cal detector setup, are modified.  A formatter
reconfiguration takes about 8 seconds on the VLBA and during that time
the formatter is not sending valid time codes to the recorder.  If
this happens during recording, it knocks the correlator out of sync
for both the duration of the reconfigure plus the time to resync.  In
practice, it also seemed to confuse the old VLBA hardware correlator
somehow for maybe one or two stations and they can take over a minute
to resync.  This is not likely to be the case for the software
correlator.

It is best to avoid reconfigurations if possible.  In the rare cases
where that is not possible, try to provide a gap between scans of
sufficient length to do the reconfiguration.  The formatter
configuration requested during a gap is the same as that during the
following scan, so this only requires using the 
{\hyperref[MP:GAP]{{\tt GAP}}} command
(or any other mechanism for having one scan
start a while after another ends).  Common reasons that
reconfigurations occur in schedules are changes in the sample rate,
changes in the BBC sideband (remember for net upper sideband, the 20cm
and 13cm systems on the VLBA use lower sideband at the BBC), and
changes in the kHz part of the frequency which changes the pcal
detector frequency (changes in the MHz part will not change the pcal
setup and will not trigger a reconfigure).

\subsubsection{\label{SSSEC:Starttime}Adjusting the Scan or Recording
Start Time}

The nominal scan start time, if set using 
{\hyperref[MP:DWELL]{{\tt DWELL}}},
is the time good data is expected to be available.
If recording and correlation could start instantly, that would also be
a good time to start the recorders.  The more modern systems,
especially the Mark5C recorders and the software correlators, approach
this ideal and the recordings are started at the time specified in the
VEX file for the start of good data.  That time is calculated based on
the expected slew rates and on any extra time, specified using the
{\tt TSETTLE, MINSETUP} and {\tt TLEVSET} parameters in the
{\hyperref[SEC:STACAT]{station catalog}}.  The start can also be
postponed with 
{\hyperref[MP:GAP]{{\tt GAP}}} or 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}.  With fixed scheduling
({\hyperref[MP:DUR]{{\tt DUR}}},
{\hyperref[MP:START]{{\tt START}}}, etc), the nominal scan starts are
forced by \schedb, but the time of good data, if later than the
scheduled scan start, is still set by the actual expected slews and
additions and that is believed by the Mark5C control software and the
correlator.  Parameters 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} and
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}, discussed below have no actual
effect if the derived start time is before the expected start of good
data.

With older systems, including the MARK5A systems that are still in use
at least part time at the beginning of 2013, it can take a small
amount of time to get the the recording going at the stations and the
correlation fully synced up.  With previous generation correlators and
tape recorders, this was a serious issue and it was advisable to start
the recordings at least 20 seconds before good data.  Modern (2010)
correlators are faster so the total time needed for both starting
recording and synchronizing is only a few seconds, or less.  Another
reason for possibly starting recordings early, or even recording
continuously between scans is that the Mark5A disk system can only
handle up to 1024 recording scans.  A recording scan is the time
between stops of the recording media.  There might be several source
scans in a recording scan.  Fast-switching, phase-referencing
observations with the older systems could run into this issue so the
default 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} (see below) has been set
to prevent recording gaps during the fast-switching in appropriate cases.
This section describes the tools in \schedb to allow the recordings to
be started early.

The schemes described in the 
{\hyperref[SSEC:SCANTIMES]{scan times section}}
(parent of this section) are used to set the
times of the scans as reported in the output files meant for human
consumption.  But the telescope control files actually give the times
for the recording to start and stop.  For the legacy (Mark5A) systems,
those times are in the {\sl crd.xx} files for VLBA systems and as the
uncommented scan-wide start time in the \$SCHED section of the VEX
file.  For the RDBE (VLBA etc) and WIDAR (VLA) systems, it is the data
good time in the VEX file, shown for each telescope as an offset from
the start time.

There are two primary parameters that can affect the
recording start time used for the legacy systems.  They are
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}, and 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}.  
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}
is used to request that the recording be started the requested
amount of time (record time) before the scan start time.  If that time
is earlier than the previous stop time, the recorder will be left
running.  

The extreme, and often useful, case of a pre-start is to not stop
recording between scans.  This is especially useful if you have many
short scans with short intervals between them, such as when phase
referencing.  
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} sets the smallest
gap between scans for which the recording will be stopped.  If the gap
is smaller, the recorder will be left running.  {\tt MINPAUSE} used to
be in units of playback time, so it was multiplied by the speed up
factor to get the effect at record time.  The speedup factor is no
longer a simple concept so that adjustment has been removed and now
{\tt MINPAUSE} applies to the record time.

The default value for 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}} is 5 seconds
when the {\tt DAR} is the legacy VLBA system or the MKIV system.  Otherwise
it is zero, which will be the case with the modern digital systems.  The
default value for 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} is 10 seconds 
when using the Field System or the legacy VLBA DAR.  Otherwise it is
zero which is the case for the new VLBA digital system.  The Field System
with the DBBC may be switched to zero in the future.

{\tt PRESTART} is applied before {\tt MINPAUSE}.  First the recording
start time is shifted earlier, then the interval from the last
stop time is examined to determine if the recording should be left
running.  The defaults of {\tt PRESTART=5, MINPAUSE=10} should
be ok in most situations (they are also in a state of flux as of the
end of 2010, so it is possible they have changed since this was
written).  Users should not need to worry about
these parameters most of the time.  The offset of the recording start
time from the scan start time can be displayed in the summary
file by adding {\tt PTSTART} to the arguments of 
{\hyperref[MP:SUMITEM]{{\tt SUMITEM}}}.
The recording start time is also available in
the {\sl sch.} files.

Another way to shift the recording start time is to use the parameter
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}.  This parameter was the original
way of introducing gaps between scans, but was considered obsolete in
recent years. However, it may have a use as a way of increasing the
time allowed between scans beyond what would be given with the station
parameter {\tt TSETTLE}, although a negative {\tt PRESTART} can do
the same thing.  {\tt PRESCAN} shifts the start time in
either direction (positive shifts to later times) after the other
parameters discussed above set the time.  If a positive {\tt PRESCAN}
is given, and the {\tt DURation} or {\tt DWELL} is increased by the
same amount, the whole scan can be shifted farther from the period of
the slew, allowing somewhat increased confidence that the recording
will start with good data.

\subsection{\label{SSEC:DYNAMIC}Dynamic Scheduling}

All of projects on the VLBA that do not involve other antennas or special
constraints are scheduled dynamically.
That means that they are put into a special queue, along with information
about their minimum requirements, and then are run at an appropriate
time given the weather and condition of the equipment.  This
increases the overall quality of VLBA output by avoiding observations
at times when it is clear that the results will be poor, even if it
also introduces inefficiencies in scheduling that mean that there is
some idle time (projects don't mesh together perfectly).  For example,
there is not much point in observing at 43 GHz when there is bad weather
at many sites.  But a 1.6 GHz observation at the same time might be fine.
Dynamic scheduling also allows more flexible response to targets of
opportunity.  Galactic sources, in particular, tend to have short
periods of enhanced activity so it is best to be able to observe when
they are high.  Of course, it is possible that some projects in the
dynamic scheduling queue will never be scheduled.

The PI for a dynamically scheduled project will be given a window in
LST at the VLBA\_PT (Pie Town) that will be scheduled, if the
observation is done.  It is useful slotting projects together if the
PI allows some flexibility in the actual start time.  The PI should
prepare a schedule using the 
{\hyperref[MP:LST]{LST}} parameter with Pie
Town as an argument ({\tt LST=VLBA\_PT}).

When a program is selected for a dynamically scheduled time slot,
VLBA operations personnel will modify the date (calendar or lst day
number) to match the scheduled day.  This last minute modification
is necessary because the stations do not have an LST concept and
the machine readable files delivered by \schedb must be in UT.
The files will then be loaded to the sites with instructions about
the time window to use, which may well be a subset of what is
actually in the schedules.  Because of this last minute modification
of the date, it is best to minimize the use of dates in the
\schedb input.  Use durations instead.

To provide flexibility in the start time, it is useful to schedule
using 
{\hyperref[MP:DWELL]{DWELL}} to set the scan lengths.  Then \schedb
can adjust the gaps between scans to allow for the slew times that
will be experienced by the actual observations.  If doing an
astrometric project with ``DELZN'' segments (geodetic type observing
all over the sky to solve for the zenith atmospheric delay), it is
useful to use the ability of \schedb to 
{\hyperref[SEC:GEOSEG]{construct such segments automatically}}.
Since such segments depend on
observing sources near rise and set, they cannot be moved around, so
without the automatic construction of the segments, the start time
cannot be changed.


\subsection{\label{SSEC:RECMANAGEMENT}Management of Data Recordings}

For most VLBI observations, the data are recorded at the stations and
played back later at the correlator.  It is not yet possible for the
recording process to be totally transparent to the user, but dealing
with it is now much less of a burden than it was in the tape era.
A top level issue is that a user is typically allocated a total amount
of recording media that he/she is allowed to use.  This number may
be less than the total that could be recorded during the observation.
It is required because the overall media supply may not be large
enough to allow full time recording at the maximum bit rate and the
scheduling committees need to apportion the resources according to
the project needs and priorities.

Beyond the overall amount of data recorded, the disk-based systems
still require the user to pay attention to the need for data quality
checks, to maximum reasonable recording scan lengths, to the need for
time at non-VLBA stations for module swaps, and to dealing with the
fact that the correlatable data is not provided starting at the exact
time specified for starting the recording.  These topics are discussed
in the 
{\hyperref[SSEC:STRATEGY]{Observing Strategy}} and 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}
and will not be discussed in detail here.

\section{\label{SEC:RECSYS}Recording Systems.}

VLBI observations require the transmission of raw data samples over 
very long distances.  Progress is being made toward an ultimate
goal of doing this in real time over fiber networks.  But EVLBI, as
such a system is called, is still only used for a small portion 
of VLBI observing and that is not likely to change in some regions
until more affordable access to high bandwidth networks can be obtained.

Most VLBI relies on recording the raw data on magnetic media, and then
shipping that media to a correlator where it is processed days to months
after the observations are made.  Managing those recordings, and the 
specification of the data streams to be recorded, is a major part of 
scheduling with \sched.  This section provides background on the
various recording systems in use.

Please be aware that recording systems are a technology under rapid
development.  It is entirely possible that some of the sections here
are not entirely up to date.

\subsection{\label{SSEC:RECBAK}Recording Systems History and Background}

\schedb was originally written in about 1979 as the scheduling program
for global VLBI observations using the Mark II recording system.  That
was a system capable of recording 4 Mbps on video tape recorders.  It
was in use in some parts of the world much longer than expected (at
least to 2003), but is now gone as far as we know.  \schedb version
9.4 and later does not support Mark II.

The wide band recording system in use for VLBI for many years was
the Mark~III system.  \schedb was never a general purpose scheduling
program for Mark~III observations.  Programs {\sc SKED} and {\sc PC-SCHED}
served that role.  However, \schedb was capable of scheduling Mark~III
observations on systems that used the VLBA control files (VLBA, VLA, and
Green Bank).  In fact, the output of {\sc SKED} and {\sc PC-SCHED} was
normally processed through \schedb to produce the telescope control files
for these antennas for all except geodetic projects.  Mark~III is also
obsolete, although one Mark~III schedule is still in the \schedb test
suite.  I am not aware of any Mark~III systems remaining in use.

The Mark~III system was replaced by several other systems with greater
capabilities.  These include the VLBA, VLBA4, Mark~IV, S2, and K4 tape
systems.  There were correlators associated with each system, and
there was a considerable amount of cross compatibility, either directly
or through the use of translation machines.  The Mark~III, VLBA,
VLBA4, and Mark~IV systems all used the same tape transport, although
with different electronics.  In their native modes, they used different
data formats, but the VLBA and Mark~IV systems were capable of reading
and writing Mark~III data.  More importantly, the VLBA and Mark~IV
systems have a wide range of compatible recording modes that could be
correlated together on the VLBA, JIVE, and other correlators.

By 2007, the tape systems were replaced by disk based recording
systems nearly everywhere.  The early disk systems were plug
compatible replacements for the tape drives so most of the data
configuration remained unchanged.  

The Mark5A system was the most widespread early disk system.  It was
developed by Haystack Observatory and the Conduant Corporation.  As a
plug replacement for the tape drives, the Mark5A system still has the
concept of tracks.  

The Mark5B system is an enhancement that uses the VSI standard
interface to record the data channels without all the formatting
baggage left over from the tape systems.  The Mark5A+ system allows
Mark5B recordings to be played on Mark5A playback units, but a minor
glitch that nobody is in a position to fix is preventing its use on
the VLBA.  The Mark5B+ system uses a faster interface and can handle
up to 2 Gbps.  

The Mark5C system was being deployed in 2011 and is meant to record up
to 4 Gbps, although it the initial configuration can be used at a
maximum of 2 Gbps.  The Mark5C- system is a scheme for allowing lesser
Mark5 hardware to pretend to be a Mark5C system for system
development.  

As of early 2013, the VLBA winding down use of the Mark5A
system and is moving most projects over to the Mark5C system.  Some 
other observatories are also moving to Mark5C, but usually with
different electronics.

There are other recording systems in use.  The Japanese have a K5
system.  The Australians are using a variant on the PCEVN system.
Also a variety of groups are testing real time VLBI over the fiber
networks.  This can involve real time correlation, or recording at
sites remote from the telescope.

Meanwhile, other potential future recording systems are being
investigated.


\subsection{\label{SSEC:RECCONTROL}Recording Systems Control}

The profusion of recording systems described in the last section is
further complicated by the the possibility of mixing elements of the
different systems.  There are three elements of each system that must
be specified in order to make proper schedules.  These are specified
in the \schedb 
{\hyperref[SEC:STACAT]{station catalog}} with the
parameters {\tt CONTROL}, {\tt DAR}, {\tt RECORDER} and {\tt DISK}.
The first element is the control system --- what software (and
hardware) is used to control the recording system.  The options that
\schedb can handle for wide band VLBI observations are VLBA and VEX.
Formally, these actually refer to the control file type, although each
type currently implies a specific computer and software system.  Note
that the {\tt CONTROL} variable has other options, but they imply one
of the above two, plus some specific other telescope control files.

The original VLBA control system runs on VME computers using software
mainly written for the VLBA.  A few other sites (VLA, Green Bank, and
one of the systems at Effelsberg) have such systems to control their
VLBI hardware.  Systems controlled by the VLBA software always consist
of VLBA data acquisition racks (DAR --- BBCs, formatter etc) and Mark5
disks.  During 2010, new Digital Backends (RDBE) and Mark5C recorders
began to be introduced on the VLBA.  These major changes are being
used as an opportunity to upgrade the telescope control systems.  The
new system is based on the EVLA Executor control system and runs on a
standard Linux computer.  Information is passed to this system from
\schedb via the VEX file.  \schedb now writes VEX files for all
observations as a result.  The new control system will initially just
control the new data acquisition system and recorder.  A new C-band
(6cm) receiver is under construction and it, along with all of the
LO/IF switching will be placed under control of the new computer.
Over the course of the next few years, all VLBA systems will be moved
to the new control.  In the meantime, both crd files for the old
system and VEX files for the new system will be required.

The VEX option for {\tt CONTROL} causes \schedb to generate a schedule
file in the VEX format, as does the 
{\hyperref[MP:DOVEX]{{\tt DOVEX}}}
main schedule input parameter (now the default).  This is the schedule
distribution file format developed mainly for the PC Field System
(PCFS) and the Mark~IV correlators.  It is now used by the DiFX
software correlator in use at the VLBA and other places, so it is
now needed by most if not all projects.  It also is needed to control
all new hardware being installed on the VLBA.

The PCFS, running on Linux PCs, is used to control VLBA,
VLBA4, Mark~IV, S2, and MARK5 VLBI hardware at many non-VLBA stations
including all of the EVN.  It is the descendant of, and replacement
for, the control system for Mark~III systems.  Sometimes this system
is referred to as FS9, for ``Field System 9'', referring to the earliest
version that could handle VEX input.

Systems controlled by the PCFS can consist of a VLBA, VLBA4 or Mark~IV
DAR connected to a VLBA4, VLBA, Mark~IV, S2, or Mark5 recorder.  Each
combination has slightly different capabilities and requirements.
\schedb understands a considerable amount about what these
capabilities and requirements are and attempts to insure that the
requested observations are possible.  However, when doing a large
observation with many diverse telescopes, it is best to stick to
standard, well tested, observing modes and use the frequencies
selected using the setup file parameter 
{\hyperref[SP:BAND]{{\tt BAND}}}.

During the transitions between recording systems, it may not be
obvious when the schedules are made which system a station will have.
Or stations may have both and want to run observations on one or the
other depending on the supply of media.  Because of this situation, a
separate input, called {\tt DISK} can be specified in addition to {\tt
RECORDER} in the station catalog.  It tells \schedb that the station
has a disk system and schedules can be made for it.  There is another
new parameter, {\tt MEDIADEF}, which can be {\tt TAPE} or {\tt DISK},
that can be used to set the default medium for the station while both
are available.  The {\tt MEDIA} parameter in the 
{\hyperref[MP:TAPEINI]{{\tt TAPEINI}}}
section can be used to override the default.
>From this description, it is clear that this scheme was designed for
the transition from tape to disk which was finished a few years ago.
As new varieties of disk or real-time systems are implemented, changes
are likely.

\subsection{\label{SSEC:MK5}MARK5 and EVLBI}

The Mark5 disk-based system has replaced the various tape based VLBI
recording systems.  This system is a major advance on many fronts
including scheduling.  To a much greater degree than with previous
tape systems, schedulers can ignore the recording system other than
making sure that they are not scheduling to record more data than can
fit on the disk space that they have been allocated.

\schedb supports Mark5 on the VLBA by including the required commands
in the telescope control files (the {\sl crd} files).  For systems
controlled by the Field System (PCFS), \schedb writes a {\tt .vex} file
in VEX format with the necessary commands to control Mark5.  The Mark5A
system is meant as a plug replacement for MarkIV or VLBA tape recorders.
It still records the same tracks that would be recorded on a tape
system so \schedb must still be aware of management of such issues.
Such concerns will be less, or at least different, for more advanced
versions of the disk based recording systems.

There are a few controls needed to schedule Mark5 natively.  First,
the 
{\hyperref[SEC:STACAT]{station catalog}} must show that the station
has a disk system.  That is done with the {\tt DISK} keyword.  This is
separate from the {\tt RECORDER} keyword to allow a station entry to
cover both tape and disk systems during the transition period.  There
is a station catalog keyword {\tt MEDIADEF} that sets the default
medium to use at each station.  \schedb will use that default in the
absence of an overriding {\tt MEDIA} command in the 
{\hyperref[MP:TAPEINI]{{\tt TAPEINI}}} section.
Schedulers for most VLBA observations
should probably ignore the problem and let operations deal with
getting the recording system right by rerunning \schedb just before
the observations.  For EVN and Global sessions, it should be clear
before the session which system will be used.

The examples {\sl egmk5vlba.key} and {\sl egmk5vex.key} show how to
set up Mark5 observations.  Now that the conversion to disk is complete
all other examples have been, or will soon be, switched to disk.

% *****************  Update the EVLBI stuff.

\schedb supports VLBI over networks.  This can involve real time
correlation in which case the data are routed directly to the Network.
An alternative might be called ftp VLBI.  In this case, the data are
recorded at the station, then read back through the Network, or
alternatively, sent over the Network and recorded at the correlator,
or both.  There are a few parameters meant to help control eVLBI
observation {\tt DATAPATH, GRABTO, GRABTIME, GRABGAP}.  This
documentation needs to be updated more on how eVLBI is actually
controlled.  eVLBI is in regular use in Europe, but not on the VLBA,
mainly because of differences in the availability of affordable network
connections of adequate bandwidth.


\subsection{\label{SSEC:VLBA}VLBA}

\schedb is the primary program for scheduling observations on the VLBA
and other systems that use the VLBA control system.  Not much will be
said in this section about the VLBA systems because they are the
``native'' systems for \schedb and are discussed extensively elsewhere.


\subsection{\label{SSEC:MKIV}MARK~IV (PCFS)}

\schedb supports Mark~IV observations on Mark~IV (and VLBA4) antennas
equipped with the Field System (PCFS). This is done by creating a {\tt
*.vex} file in the VEX format. The VEX file is a global and
self-contained description of the experiment that is scheduled. The
{\tt *.vex} file can be read by the control system (PCFS) and
translated (by a program called {\sc Drudg}) into a list of commands
for the telescope, data acquisition system and recorder.

\schedb produces VEX files with ``adaptive'' recorder control that enables
continuous recording on PCFS controlled telescopes, but can only
be correctly interpreted by FS9.3.11 (and higher).  This aided the
VLBA hardware correlator in synchronizing playback, but is no longer
of much interest as the sync time with Mark5 disk systems and current
correlators, including the DiFX software correlator on the VLBA, do not
take more than a second to sync.

\schedb now writes VEX files by default.  It can be prevented using
the input parameter 
{\hyperref[MP:DOVEX]{{\tt DOVEX}}}.

Mark~IV (MkIV) telescopes are characterized by {\tt DAR = MKIV} in the
{\hyperref[SEC:STACAT]{station catalog}} and can only be requested to
record in any of the MkIV FORMATs. Most MkIV telescopes only support
specific BBC's (called Video Converters) to be connected to certain IF
distribution boxes. \schedb supports ``astronomical patching'' or a
version of geodetic patching --- see 
{\hyperref[SP:M4PATCH]{{\tt M4PATCH}}}.
The astronomical patching requires odd BBC's to
be connected to either {\tt IFCHAN = 1N} (normal input, usually LCP)
or {\tt IFCHAN = 1A} (alternate, usually RCP). Even BBC's have to be
connected to {\tt IFCHAN = 2N} (usually RCP) or {\tt IFCHAN = 2A} for
LCP.  Also, you must use at least one of IFCHAN = 1N or IFCHAN = 2N
(i.e. a schedule that uses both IFCHAN = 1A and IFCHAN = 2A is not
permitted).  This can be controlled by explicitly setting {\tt BBC}.
See the details about 
{\hyperref[SP:M4PATCH]{{\tt M4PATCH}}} for the setup
implied by the geodetic patching.

In December 2000 the capability to record 512 Mb/s was introduced.
This is achieved by recording 64 tracks simultaneously on the tapes or
Mark5A.  It requires {\tt NHEADS = 2} in the station catalogue. All
MkIV stations now record using the Mark5 disk-based system. MkIV
Stations equipped with Mk5 systems can record data at up to
1~Gbps. This requires {\tt DISK = MARK5A} in the station catalogue.

Several features are not yet available or supported for MkIV (and MarkIV
based Mark5 systems).  Some as of late 2004 (some updates in early 2008)
are:

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item Continuous recording has been used widely, however the ability
  to acquire the information needed to flag data which is recorded during
  slewing is not universal (though is standard for EVN stations).
  The \schedb output {\sl .flg} file can be used by the AIPS task
  {\tt UVFLG} if telescope flagging data are not available.  In addition
  users need to insert gaps during continuous recording whenever they
  want calibration data.

\item Phase Cal detection at the telescopes is not implemented.
  This will likely become available with the new digital backends.
  Also, DiFX is acquiring the ability to detect phase cal tones.

\item For MkIV (VLBA4) telescopes there is flexibility for controlling
  when Tsys measurements will be made. Tsys measurements will typically
  be made at the beginning of a scan if there is a gap in the recording.
  When scheduling long scans or continuous recording, one may need to
  insert gaps in order to obtain Tsys data.

\end{list}


% \asdf  ***  Do I need to still avoid changing rates.
% That was in okmodes.f (jan2011) which has been removed.


In addition to requiring use of tested modes, \schedb will not
allow speedup factor changes during mixed VLBA and Mark~IV mode
observations.  This is because of track bit rate dependent delays that
are different in the two formats.  The correlator would require
different clocks for different modes, which is not yet available.
Fairly soon, this restriction will be relaxed.  Again, MODETEST will
turn off the test.

\subsection{\label{SSEC:FS9VLBA}NON--VLBA Telescopes with VLBA Recorders}

\schedb supports observations on telescopes that have VLBA
recorders but are controlled through PCFS. This is also done by
creating a {\tt *.vex} file in the VEX format (see section on
{\hyperref[SSEC:MKIV]{{\tt MkIV}}}).

The telescopes are characterized by {\tt DAR = VLBA} and {\tt
RECORDER = VLBA}, but {\tt CONTROL = VEX}. They can have a flexible
number of BBCs, and usually have only 2 IF channels: A \& C.
The telescopes can only be requested to record in any of the
VLBA FORMATs.

In addition {\tt DAR = VLBA4} and {\tt RECORDER = VLBA4} systems have
been introduced. These use the flexible {\tt VLBA} data acquisition
rack, but ({\tt DAR = VLBA4}) have a Mark~IV formatter mounted for
recording up to 1Gb/s.  Note that these systems write Mark~IV
formatted data and have been created to resemble Mark~IV systems. In
this sense their name is misleading.  These systems required a {\tt
RECORDER = VLBA4} in the tape era in order to accommodate 2 recording
heads (optional), but now all Mark5A systems can record the requisite
number of tracks.

Most of the VLBA racks controlled by the field system have what is
known as the ``geodetic wiring''.  This means that not all of the
BBCs can see all IFs.  Also, there are not enough sampler inputs do
use 2 bit samples from more than the first 8 BBCs.  In fact, switching
between lots of BBCs at one bit and 8 BBCs at 2 bits requires moving
connectors that really weren't designed to be moved often.  This is
an invitation for trouble.  The IF restrictions are such that
BBCs 1-8 can see IFs A and C while BBCs 1, 2, and 9-14 can see B and D.
\schedb understands these restrictions in it's automatic BBC assignment
section.  Note that, in some cases, the stations will put the same
signals on IFs A and B and on C and D.  This can be dealt with in the
frequency catalog by giving B as the ALTIFN for A and D as the ALTIFN
for C (or visa versa).  Or, or course, you can specify IFCHAN explicitly
in the setup file.



\section{\label{SEC:WIDE}Wide Band Observing: RDBE, DBBC, VLBA and
Mark IV Modes}

This section covers the scheduling of wide bandwidth observations.
With the older tape and MARK5A systems, that means 512 or 1024 Mbps
using or using a large number of "tracks" on disk.  With the digital
backends (RDBE and DBBC) and newer recording systems (MARK5C for now,
maybe X cube or MARK6 later), completely new systems are involved.
The first couple of paragraphs below are about the old systems.  Then
the section goes into more detail about the new digital systems.

{\bf OLD SYSTEMS:}

With the Mark5A recording system, the maximum bit rate that can
normally be recorded is 1024 Mbps on a Mark IV system and 512 Mbps
on a VLBA system.  These rates are recorded on a single module, unlike
in the tape era when 2 drives or 2 heads were required.

\schedb can make schedules for the 512 Mbps and 1Gbps modes.  See the
examples 
{\href{examples/eg512.key}{{\sl eg512.key}}} for a
VLBA only case and 
{\href{examples/eg2head.key}{{\sl eg2head.key}}}
for a PCFS (MarkIV) case.  Since the
advent of disk recordings, for the
user, these modes are not much different from other modes.  The
VLBA telescope schedules indicate use of the wide band mode simply
through the specification of track numbers above 64.  Note that the
two examples do either only VLBA or only Mark IV, but it is ok to mix
them.

{\bf NEW SYSTEMS:}

New digital backends and a new recording system started to be used for
science in 2012.  These increase the available bit rate to
significantly higher values.  The RDBE/Mark5C system developed at
Haystack and NRAO records 2048 Mbps.  Higher rates may eventually be
provided.  The DBBC system, developed in Italy and also using the
Mark5B or Mark5C recording systems, is being deployed on a similar time
scale and has similar bandwidths.  Other, even wider bandwidth,
recording systems are under development but will not be discussed here
yet.

\subsection{\label{SSEC:RDBE}The RDBE system}

The RDBE (Roach Digital Backend, where ROACH is the core board
containing a large FPGA) is a module that takes in 2 analog IF
signals, applies an anti-alias filter that passes 512 to 1024 MHz,
sets the power levels, samples the signals at a 1024 MHz sample rate
(8 bit samples at this stage), digitally filters the data to the final
basebands, resamples the data to 2 bits, and formats it for recording.
It takes the place of the IF distributers, baseband converters,
samplers, and formatter (including pulse cal detectors) in the old
VLBA system.  The VLBA antennas have two RDBE systems each, allowing
an increase in the number of channels, at least with the DDC
personality (see below).  In addition to allowing increased numbers of
channels, the use of 2 RDBEs allows simultaneous access to all 4 VLBA
IFs.  That is useful for the S/X system and for the new 4-8 GHz
system, for which two polarization pairs of output data are available.

Control of the RDBE and Mark5C recorders is handled by a new VLBA
control system running on a standard Linux computer.  The new system
software is based on the EVLA Executor.  Schedule information is given
to this computer by way of the VEX file, which is converted by
operations to a Python script that is read by the Executor.  All new
hardware installed at the VLBA for the next few years will use this
control system and, probably slowly, the old hardware will be switched
over to it.  In the meantime, both crd files and VEX files are needed
to control the VLBA sites.  When the new 4-8 GHz receiver was
installed on the VLBA, a new RF switch controller was installed that
affects all observing bands.  Because of this, both the new and old
control systems must be used to support observations with either the
new or old recording systems.  Note that the VEX file is also used by
field system stations (EVN and others) for antenna control.

The new control system at the site, and the DiFX correlator have a 
slightly different idea of when scans should start compared to the
old systems.  With the old system, the media are commanded to start
at a time that is the same at all stations and is set as the nominal
scan start time minus an offset given by 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}.
The Vex file shows that time as the uncommented 
``start'' time of the scan.  But the Vex file also has a station
dependent offset for the start of good data.  With {\tt DWELL}
scheduling, that is usually zero.  But if {\tt DURation} scheduling
is used, it can be significant.  That time is often referred to
as the good-data time or on-source time.  It depends on \sched's
concept of slew times and settling times.  The new systems do not 
start the media, or the correlation until that time.

{\bf TERMINOLOGY:}

Note that the terminology for the various signals has become rather
confused.  For backward compatibility in \schedb, we call the final
analog signal sent to the sampler at 512-1024 MHz the ``IF''.  That is
broken into narrower bandwidths called ``subbands'' by a polyphase
filter regardless of RDBE personality.  There is no flexibility to
move those subbands around in frequency.  The final signal that is
resampled to, usually, 2 bits and recorded is called the ``baseband
channel'' for purposes of \sched.  The baseband channel might be a
subband (PFB personality) or might be further frequency shifted and
filtered from within a subband (DDC personality).  This terminology
differs somewhat from EVLA practice where a baseband is the final 
analog signal and the final filtered signal is a subband.

{\bf RDBE PFB PERSONALITY:}

The FPGA in the RDBE supports multiple personalities that can be
swapped as needed.  The first developed was the PFB personality that
uses a polyphase filter to break each of the two 512 MHz IFs into 16
basebands of 32 MHz each, all lower sideband.  Exactly 16 channels
must be recorded, arbitrarily selected from the total of 32 provided
from both inputs.  This personality is selected by setting the
{\hyperref[SP:DBE]{{\tt DBE}}} parameter to {\tt RDBE\_PFB} in the setup
file.  Of the 16 subbands of the polyphase filter from each IF, 15
provide good data.  The other is really 16 MHz from each end of the
512 MHz, and is not useful.  It is made available for selection in
cases where it is desired to have all 16 required channels in one
polarization.  More typically, 8 channels, constituting polarization
pairs, will be selected from each IF input.  This personality can only
provide 32 MHz basebands at fixed frequencies within the IF for a
total of 2 Gbps.  Other than selecting the desired subbands, there is
no tuning flexibility.  Note that the PFB personality cannot be used
on both RDBEs at a VLBA station because the required VDIF output is
not available and because the required 2 Gbps per RDBE is beyond the
capacity of the recording system if both are used.


{\bf RDBE DDC PERSONALITY:}

The second personality that is available is the DDC (Digital Down
Converter).  It is selected using the 
{\hyperref[SP:DBE]{{\tt DBE}}}
parameter set to {\tt RDBE\_DDC} in the setup file. This personality
provides up to 4 filters per RDBE and there are 2 RDBE units at each
station.  The filters can have frequencies that are multiples of
15.625 MHz (see below).  The bandwidths of the DDC filters can be any
factor of 2 step between 1 and 128 MHz.

There is a complication forced by the use of a polyphase filter first
step of filtration to get the clock rate down to values the FPGA can
support.  Such filters do not have flexible frequency ranges.  This
one splits the band into 3 segments, 512 to 640 MHz, 640 to 896 MHz,
and 896 to 1024 MHz.  Each baseband must be confined to one of those
ranges.  The ``crossover'' frequencies at the filter edges have a
range of something like 4-10 MHz (to be determined) that is not really
usable.  \schedb will issue a warning if an attempt is made to have a
baseband cross one of these boundaries.  Note that the polyphase
filter to use will be determined by the frequency of the LO sum.  It
is possible that users of the 128 MHz bandwidth will want to offset
slightly for better pulse cal performance and this will cause a tiny
fraction of the band to get aliased.  \schedb will issue warnings, but
this can be tolerated.

The frequencies for the band edges in the DDC personality can be set
to any multiple of $256 / (2^{32})$ MHz = $0.0596046$ Hz in principle.
But values that are not integer Hz would cause problems elsewhere -
mainly with returning to phase after changes.  The smallest allowed
value that qualifies is 15.625 kHz.  One way to look at the allowed
values is that they are N*125 kHz plus 0, 15.625, 31.250, 46.875,
62.500, 78.125, 93.750, or 109.375 kHz.  If working with other
antennas with legacy systems, it will be necessary to stick to
multiples of 10 kHz which is only possible with the DDC by using
multiples of 250 kHz.  /schedb will warn if the frequency is not a
multiple of 250 kHz and will abort if it is not a multiple of 15.625
kHz.

{\bf VLBA TUNING RESTRICTIONS:}

The overall LO/IF/RDBE system on the VLBA will have some significant
tuning flexibility issues.  The RDBE is an add on to the older system
where the baseband converters, which could take only a small portion
of the 500 MHz IF, provided the necessary flexibility.  The LO/IF
system that creates those IFs is based on synthesizers that have
set points at N*500+-100 MHz.  Now, with the ability to take all of
an IF, that restricted tuning ability will become an issue, especially
in conjunction with the lack of tuning ability for the PFB personality
and the crossover points for the DDC.  Essentially all frequencies
can be reached using more than one LO setting, so no cases have been
identified where a particular spectral line cannot be observed.  But
full tuning flexibility that might be desired is not there.  Eventually
we hope to upgrade the front end synthesizers to designs with more
tuning options, and in fact design and prototyping of such a system
has started, although deployment is not yet funded (Feb 2012).

Note that, for the initial /schedb implementation of the RDBE, the
code to provide default channel frequencies based on the band has not
yet been written.  It is necessary to give the frequencies in the
setup file.  See the simple examples.  The defaulting capability will
be added eventually.  But for now, the upper-edge baseband frequencies
with PFB personality must be from the following list: 1040.0, 1008.0,
976.0, 944.0, 912.0, 880.0, 848.0, 816.0, 784.0, 752.0, 720.0, 688.0,
656.0, 624.0, 592.0, 560.0.  These can either be selected directly
using the {\tt BBSYN} setup file parameter, or values of {\tt FREQREF}
and {\tt FREQOFF} can be selected so that the difference between the
desired baseband frequency and the signed sum of all other LOs is one
of these values.

{\bf EXAMPLES:}

Example \schedb input {(\sl .key)} files for observations using the
new systems are: 

{\href{examples/egrdbe2.key}{{\sl egrdbe2.key}}} which is
a reasonably simple case with the VLBA and GBT.

{\href{examples/manual\_1.key}{{\sl manual\_1.key}}} shows
a lot of \schedb inputs instead of taking the defaults.  It uses
the RDBE/DDC on the VLBA and WIDAR on the VLA1 (VLA1 not really offered
yet, but VLA27 would be similar).

{\href{examples/rdbepfb.key}{{\sl rdbepfb.key}}} which is
an even simpler case with just the VLBA and using a standard setup.

{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}} which
shows how to do referencing pointing at 3mm, including using narrow
band data on masers, when the RDBE is used with the PFB personality.
It uses the crd input parameters to control the VLBA legacy hardware
which produces the power data used for reference pointing.

{\href{examples/egddc.key}{{\sl egddc.key}}} which uses the
DDC personality of the RDBE.

{\href{examples/egddc2.key}{{\sl egddc2.key}}} which uses the
DDC personality with two RDBEs and 8 baseband channels.

{\href{examples/egcwide.key}{{\sl egcwide.key}}} which uses the
PFB personality and observes using the new 4-8 GHz VLBA receiver with
one dual polarization setup and one single polarization, widely 
split frequencies setup.

{\href{examples/jvla.key}{{\sl jvla.key}}} is an example
that uses the PFB personality of the RDBE for joint observations
with the GBT and VLA.  There are only 512 Mbps at the VLA in this 
mode.

{\href{examples/vladdc.key}{{\sl vladdc.key}}} is an
example that uses the DDC personality with the VLBA, VLA, and GBT 
with a full 2 Gbps on all three.

{\href{examples/hsaddc.key}{{\sl hsaddc.key}}} is an
all-singing, all-dancing HSA example with the VLBA, VLA, GBT, and
Effelsberg.  It exercises reference pointing at all sites, array
phasing at the VLA, and Doppler tracking.

{\href{examples/pfbsettst.key}{{\sl pfbsettst.key}}} is a
vehicle for testing all the new RDBE/MARK5C standard setup files that
use the pfb personality.  These are the setups that start with 
{\sl rdbe\_pfb}.

{\href{examples/n2227.key}{{\sl n2227.key}}} is a
sample USNO Earth Orientation observation using PT and MK.


{\bf REFERENCE POINTING WITH THE RDBE:}

See the 
{\hyperref[SEC:REFPOINT]{Reference Pointing section}} for much
more information on how to do reference pointing.

Reference pointing on the VLBA is handled by the legacy system using
power measurements made by the old baseband converters (BBCs).  When
the main observations are using the RDBE, \schedb tries to set the
BBCs as closely as possible to the settings of the RDBE baseband
channels.  For bandwidths below 16 MHz, this can be done well for 8
channels, as long as the requested frequency is below 1000 MHz in the
IF.  \schedb will select the center 8 channels if there are more from
the RDBE (the PFB always gives 16).  For wider bandwidth baseband
channels, 16 MHz will be used and it will be centered on the RDBE
channel.  All this means that reference pointing, including using
Doppler for setting frequencies and setting narrow bandwidths for
masers can be done normally for the DDC personality.  If such
reference pointing must be done when using the PFB personality with
it's fixed 32 MHz baseband channels, it is best to set up the old
system using the piggyback scheme as demonstrated in the example
{\href{examples/egrdbe.key}{{\sl egrdbe.key}}}.  That
requires separate runs of \schedb for the MARK5C and legacy systems.


{\bf PARALLEL MARK5A and MARK5C RECORDINGS:}

Normally when scheduling a project that uses the RDBE/MARK5C system,
\schedb creates control files for the old system ({\sl .crd} files)
that drive the telescope and other systems, but do not cause MARK5A
recordings to be made.  Since \schedb does not have adequate bookkeeping
to allow independent specification of frequencies for both systems
in one pass, a reasonable choice of frequencies and bandwidths for 
the old system is made based on the capabilities of that system and
the settings for the new system.  

During testing of the RDBE/MARK5C system, it is useful to have a
parallel Mark5A recording.  If the default choices of frequencies and
bandwidths for the old system is adequate, \schedb can be told to make
MARK5A recordings using parameter switch /htmlref{{\tt
DOMKA}}{MP:DOMKA}.  The only way to check what those settings are is
to look at the output {\sl .crd} files.  Because of the limited 
bookkeeping, that information does not appear in the {\sl .sum} file.

If the user does not want to take the Mark5A setups provided by
\schedb with {\tt DOMKA}, then the run can be set up as a piggyback
with separate setups for each system.  The scheme for doing was 
mentioned above, and is described and demonstrated in example
{\href{examples/egrdbe.key}{{\sl egrdbe.key}}}.


\subsection{\label{SSEC:DBBC}DBBC:}

The DBBC being developed for the EVN and many geodesy stations is also a
system that samples at 512 or 1024 MHz and digitally filters the signals
to the desired bandwidths. But it has a different design where, like
with the old BBCs, the frequency can be set flexibly anywhere in the IF
band without concern about crossover frequencies etc.  The DBBC design
has a module for each output baseband, so they are more directly
comparable to BBCs. Support for the DDC personality of the DBBC has
recently been implemented in \sched, but should be used with caution.
The PFB personality is not yet supported.

The DDC personality is selected by default, and can be selected
explicitly by setting the 
{\hyperref[SP:DBE]{{\tt DBE}}} parameter to {\tt
DBBC\_DDC} in the setup file. \schedb will also accept a value of {\tt
DBBC\_PFB} but this is not properly supported and will simply mimic the
PFB personality of the RDBE. There are several different versions of the
DBBC being deployed with slightly different components. The major
difference is in the patching of IFs (aka conditioning modules) to
particular BBCs (this may become fully switchable with future upgrades).
Three variants are recognized by \sched. The variant is specified in the
stations file with the 
{\hyperref[ST:DBBCVER]{{\tt DBBCVER}}} parameter.
Each conditioning module (IF) has up to 4 switchable inputs. The signal
available on each input is station dependent, so IF names (
{\hyperref[FQ:IFNAME]{{\tt IFNAME}}}, 
{\hyperref[SP:IFCHAN]{{\tt IFCHAN}}}) should be
assigned with due reference to the particular station's wiring.

Currently 2 IF filters are supported. One in the range 10-512 MHz and a
second in the range 512-1024 MHz. A suite of additional IF filters will
be enabled with a future firmware release but are not available yet and
so are not yet supported by \sched. \schedb will warn you if your
selected frequencies attempt to use both the 10-512 MHz and 512-1024
filters at the same time.

Baseband filter widths of 1, 2, 4, 8 or 16 MHz are possible. 32 MHz will
be enabled with a future firmware upgrade. The frequencies for the band
edges in the DDC personality can be set to any multiple of 10 kHz.
(There is also a binary tuning mode which allows band edges to be set to
a multiple of $1024/2^{31} \,{\rm MHz} = 0.476 \,{\rm Hz}$, but its use
is not advised and it is not currently supported by \sched.)

Sampling is done with 2 bits at Nyquist rate only (1 bit sampling can be
emulated by channel selection on the recorder).



\subsection{\label{SSEC:OTHERREC}OTHER DIGITAL BACKENDS:}

There is a variant on the RDBE being developed at Haystack for mm VLBI
that has 4 input IFs and does not attempt any filtration.  It simply
samples and formats the data and sends it to the recorders.  It can
put out 8 Gbps.  This device is not yet supported by SCHED.

When the DAR is the RDBE, the output channels and all the input
channel information given to \schedb are written to the VEX file.  But
the crd files that control the old VLBA hardware also has to be told
something. \schedb does not have a separate set of variables for all
those configuration parameters, so it just does something reasonable.
It sets the number of channels to the maximum of the number requested
and 8.  It sets the frequencies to cover the middle of the RDBE
basebands and the sidebands to match the RDBE basebands.  It sets the
sample rate to the maximum of that requested and 32 Ms/s.  It sets the
channel bandwidth to the lesser of the request and 16 MHz.  It only
writes the first 4 pcal extraction requests (avoiding going into
channel numbers that are too high).  Recording on the Mark5A system
is not requested.


\section{\label{SEC:LINE}Spectral Line Observations}

\schedb can set observing frequencies for spectral line observations
based on velocities provided in the source catalog and rest
frequencies provided in a separate type of input. This option is
invoked by specifying 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}} and can be
turned off with 
{\hyperref[MP:DOPPLER]{{\tt NODOP}}} ({\tt DOPCAL} is an
obsolete form that was too easy to confuse with ``DO PCAL'').  If {\tt
DOPPLER} is invoked, \schedb calculates the velocity of the center of
the Earth with respect to the designated reference frame ({\tt VREF}
in the direction of the source at the time of the middle of the
project. From this velocity, the source velocity from the source
catalog, and the rest frequency, the required observing center
frequency is calculated.  The antennas need to know the LO settings so
\schedb must know the bandwidth.  The bandwidth will usually be
obtained from the setup file.  It may be provided for the scan with
the 
{\hyperref[MP:BW]{{\tt BW}}} parameter for some systems, unfortunately
not including the new digital backends such as the RDBE on the VLBA.

The reference frames supported by \schedb are the ``Local Standard
of Rest'' or LSR {\tt VREF=L}, heliocentric {\tt VREF=H}, and
geocentric {\tt VREF=G}.

Note that channels assigned to the same BBC will be given the same
frequency as the first channel on that BBC, no matter what velocities
etc are given for the other channels.  This will be the case when
there are upper/lower sideband pairs.  Their frequencies cannot
be set independently.  Because of the different sidebands, they
will, however, cover different velocity ranges.

The frequencies derived from the Doppler calculations have to be
rounded off to a value that can be set on the available synthesizers.
For the Mark~III/IV and legacy VLBA systems, frequencies can be set to
the nearest 10 kHz.  For the RDBE with the DDC personality on the
VLBA, usable frequencies are multiples of 15.625 kHz.  Note that, if
there is a mix of systems with 10 kHz and 15.625 kHz steps, one should
round to 250 kHz because that is the lowest value common to both.
Other systems are different --- VSOP, for
example, can only be set to the nearest 1 MHz.  The RDBE with the
PFB personality can only do frequencies in 32 MHz steps, and those
have LO dependent offsets --- it is probably best to avoid {\tt DOPPLER}
when using the PFB.  The parameter
{\hyperref[MP:DOPINCR]{{\tt DOPINCR}}} can be used to control the rounding.

The Doppler calculations are for the center of the Earth for the
middle of the project. This implies that the frequency for each source
will be constant for the duration of the project. Experience over the
years with spectral line VLBI has shown this to be the preferred
observing mode since it minimizes the chances of mistakes at stations
that do not have automatic frequency setting. The shifts of the
resulting spectra of about a km per second that result from the
rotation of the Earth can be removed in post-processing with the {\sc
CVEL} program in the NRAO spectral line software or with a task of the
same name and with similar capability in {\sc AIPS}.

The LO sum used when Doppler calculations are requested are calculated
by either the radio definition ({\tt VDEF=R} in the source catalog )
or the optical definition ({\tt VDEF=O} or {\tt VDEF=Z}). With the
radio definition, the LO sum is calculated as RESTFREQ * (1 - v/c) -
BW/2 where RESTFREQ is the line rest frequency from the line
initialization input, c is the speed of light, and BW is the bandwidth
(appropriately signed according to the sideband).  With the optical
definition, the LO sum is RESTFREQ / (1 + v/c) - BW/2.  Typically
velocities for radio spectral lines in galactic sources are given in
the radio definition in the LSR frame.  Extragalactic velocities, on
the other hand, are typically in the optical definition in the
heliocentric frame.  The differences in the radio and optical
definitions only matter at large (typically extragalactic) velocities.

\schedb will accept redshifts if {\tt VDEF=Z} in place of
velocities, but be very careful that you have adequate accuracy
to calculate proper frequencies - the bandwidths are typically
very much smaller than the observing frequency so the velocities
must be accurate.

Internally, if Doppler calculation is requested, \schedb calculates
the desired observing frequencies and puts them in the same array that
would be used if 
{\hyperref[MP:FREQ]{{\tt FREQ}}} were used. This will
override any {\tt FREQ} specifications in the main schedule and any
frequency specifications in the setup files.  The frequencies of
baseband converters will then be set properly based on the
{\hyperref[SP:FIRSTLO]{{\tt FIRSTLO}}} for the station.  Please note that
the setup files must still contain a complete, valid frequency
specification.  This is to allow validity checking and to allow
\schedb to pick up default parameters from the
{\hyperref[SEC:FRQCAT]{frequency catalog}}.  The frequency in the setup
should be close enough to the desired observing frequency that only
final tuning of the BBCs is needed to get the exact desired frequency.
For the VLBA with its 500 MHz IFs, this is not a serious concern. 

The number of channels desired is set with 
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}
in the setup file ({\tt NCHAN} in the main schedule
is an obsolete parameter and is not used.).  To calculate a frequency,
\schedb must have, for each channel, a bandwidth, a velocity from
the source catalog, and a rest frequency from the line initialization
input information.  If a value is missing for any channel of any
parameter, the value of that parameter for channel 1 will be
used. This avoids the need, for example, of specifying lots of
bandwidths when they are all the same.

For continuum sources mixed in with line sources, specify 
{\hyperref[MP:DOPPLER]{{\tt NODOP}}}
for that scan to avoid the Doppler calculations.

Often it is desired to observe a continuum source at the same
frequency as a line source for bandpass calibration. This can be done
by specifying the line source with 
{\hyperref[MP:DOPSRC]{{\tt DOPSRC}}}
in the continuum source's scan. The {\tt DOPSRC} will be used for the
Doppler calculation.

The important parameters in the \schedb keyin file for Doppler
frequency calculation are listed below. Detailed descriptions are
given with the descriptions of other \schedb parameters.

\begin{list}{}{\parsep 0em  \itemsep 0em }
\item 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER} and {\tt NODOP}}}
turn the Doppler calculations on and off.

\item 
{\hyperref[MP:DOPSRC]{{\tt DOPSRC}}} is used to specify the source,
if it is different from the scan source, for which the Doppler calculations
should be made.  This is useful for bandpass calibration.  Warning -
as with nearly all \sched\ variables, it defaults to the previous scan.
After using it, be sure to set it to blank or to the next source.

\item 
{\hyperref[MP:DOPINCR]{{\tt DOPINCR}}} is used to determine the level
of rounding of frequencies that is used.

\item 
{\hyperref[MP:LINENAME]{{\tt LINENAME}}} specifies which group of
rest frequencies to use. It must match one of the sets of lines
named with {\tt LINESET} in the {\tt LINEINIT} input.

\item 
{\hyperref[MP:BW]{{\tt BW}}} sets the bandwidth for the scan and
overrides the setup file value.  This was useful for switching between
wideband observations on calibrators and narrow band observations on
line sources.  The value in the setup file will be used if it is
not specified.  In general, it is a good idea to use a new
setup file when changing bandwidths because quite a few other
parameters also change.  With the new digital back ends, oversampling
is now allowed so {\tt BW} basically doesn't work.

% (This is out of date) The {\tt BW} parameter is not allowed if VEX
% files are being written.

\item 
{\hyperref[MP:LINEINIT]{{\tt LINEINIT}}} indicates that after the
next ``/'', information on the rest frequencies of spectral lines will
be given.  If invoked, the rest frequencies will be read, and \schedb
will return to reading input for the same scan that it was on before
the ``/''.

\end{list}

The rest frequencies are specified in separate keyin inputs in the
\schedb keyin file following a ``/'' if {\tt LINEINIT} was specified.
There can be one rest frequency per channel, although any not
specified default to the first which is often the desired
behavior. There should be one velocity per channel in the source file
for each source to be observed (other than continuum
calibrators). Each group of lines has a name which is then referred to
using 
{\hyperref[MP:LINENAME]{{\tt LINENAME}}} in the scan input. The
group can change with each scan, but be careful to change the setup
file, too, if necessary.  Up to 10 groups of lines are allowed. The
parameters in the {\tt LINEINIT} group are:

\begin{description}
\item [{\tt LINESET}:] Name of the group of lines. {\tt LINENAME} in
the scan input will be used to invoke this group.

\rcwbox
{Name of up to 8 characters.}
{Any name.}
{None}
{Defaults to previous value - don't do it!}
{{\tt LINESET='H2O'}}

\item [{\tt RESTFREQ}:] Rest frequencies.

\rcwbox
{Up to one real number per channel. The first value will be used
for any channels for which a value is not given.}
{Any value.}
{{\tt 0}}
{Defaults to previous value.}
{{\tt RESTFREQ=22235.08}}

\item [{\tt ENDLINES}:] This parameter, on a separate line with a ``/'',
ends the restfrequency inputs much like the {\tt ENDCAT} parameter
ends in-line source and station catalog inputs.

\rcwbox
{None.}
{None.}
{Not specified.}
{Defaults to previous value, but this has no effect since this will be
the last line of the rest frequency input to be read.}
{{\tt ENDLINES /}}

\end{description}

A fairly extensive list of possible rest frequencies is given below.
These frequencies are not guaranteed.  If anyone finds an error,
please notify Craig Walker (cwalker\@nrao.edu).

\begin{verbatim}
---------------------------------------------------------------
lineinit /
!   Frequencies from Reid and Moran's Annual Reviews article preprint.
!   Do not keep more than 10 lines in a SCHED input file.
lineset='OH1612'  restfreq=1612.231   /
lineset='OH1665'  restfreq=1665.402   /
lineset='OH1667'  restfreq=1667.359   /
lineset='OH1720'  restfreq=1720.530   /
lineset='OH4660'  restfreq=4660.42    /
lineset='OH4765'  restfreq=4765.562   /
lineset='OH6030'  restfreq=6030.747   /
lineset='OH6035'  restfreq=6035.092   /
lineset='CH3OH'   restfreq=6668.5192  /  Breckenridge and Kukolich ApJ 438.
lineset='CH3OH'   restfreq=12178.597  /  Breckenridge and Kukolich ApJ 438.
lineset='OH13'    restfreq=13441.417  /
lineset='NH3'     restfreq=18499.393  /  Pratrap Preprint.
lineset='CH3OH'   restfreq=19967.3961 /  Menton preprint.
lineset='H2O'     restfreq=22235.08   /
lineset='CH3OH'   restfreq=23121.0242 /  Menton preprint.
lineset='CH3OH'   restfreq=25124.87   /
lineset='SiO425'  restfreq=42519.3    /
lineset='SiO428'  restfreq=42820.54   /
lineset='SiO431'  restfreq=43122.03   /
lineset='SiO862'  restfreq=86243.35   /
lineset='SiO868'  restfreq=86846.89   /
lineset='CH3OH'   restfreq=44069.43   /  Bachiller preprint (SAO)
lineset='CH3OH'   restfreq=97980.97   /  Plambeck preprint (SAO)
lineset='SiO1293' restfreq=129363.26  /
! some more from VLA OBSERVE
lineset='H'        restfreq=1420.405752   /
lineset='H2CO4830' restfreq=4829.656900   /
lineset='H2CO145'  restfreq=14488.475000  /
lineset='NH3(1,1)' restfreq=23694.495500  /
lineset='NH3(2,2)' restfreq=23722.633600  /
lineset='NH3(3,3)' restfreq=23870.129600  /
lineset='NH3(4,4)' restfreq=24139.416900  /
lineset='NH3(5,5)' restfreq=24532.988700  /
endlines /
-----------------------------------------------------------------
\end{verbatim}

The example below shows the \schedb input for a spectral line It is a
modified version of the file used for a project by Phil Diamond in Dec
95.  The modifications are to adjust for some of the new features of
\schedb that were not available at the time the file was used.  Note
that it is not necessary to repeat the DUR and GAP specification every
scan.  However some users prefer to show these details and it
certainly doesn't hurt.  Also, the bandwidth specification is the same
as the setup file so it is not required (it used to be).


\verbatiminput{../examples/manual_line.key}

\section{\label{SEC:REFPOINT}Reference Pointing}

At high observing frequencies, it can be difficult to point antennas with
sufficient accuracy to keep the target source in the beam.  One tactic to
improve this situation is known as reference pointing.  The idea is to
peak up the pointing on a source prior to the VLBI scan.  The source can
be the target source, if it is sufficiently strong.  Otherwise it can
be another source.  It is best to find a source as close as possible
to the target, but it may be necessary to go tens of degrees to find
one that is suitable.  The reference pointing is commonly done at a
lower frequency than the interferometer observations for improved SNR.

Reference pointing is commonly used at the VLBA for observations at
3mm.  The actual pointing observations are typically done at 7mm where
the sensitivity is greater and the beam is larger.  The pointing
offsets are determined by the on-line system by fitting total power
measurements made while the antenna is moved over a pattern that
includes the nominal on-source, half power, and off-source positions.
Often this is done on strong SiO maser sources.  One minute should be
allowed for completion of this pattern after the antenna reaches the
pointing source.  Once a pointing offset has been determined, it will
be used until another is determined, or the project changes.  It
cannot be turned off.  Optimal time intervals between pointing scans
and maximum offsets to pointing sources are not yet known.  But
pointing every half hour to hour on sources within about 20 degrees
should be ok.  

The power data used for the reference pointing is measured by the
legacy system baseband converters (BBCs) which should be kept in mind
when scheduling MARK5C/RDBE observations.  More on that later.

Because total power mode is being used for VLBA pointing, sources must
be very strong --- more than about 10 Jy for continuum sources or
about the same flux density averaged over the observing bandwidth for
line sources (peak Ta of about 2 K).  Very few continuum sources are
strong enough, so most appropriate sources are SiO masers observed
with restricted bandwidth, usually 2 MHz, centered on the line.  See
the sample pointing command file 
{\href{catalogs/peak.cmd}{{\sl \$SCHED/catalogs/peak.cmd}}},
provided with the
\schedb catalogs and discussed below, for a list of possible targets.
Most of the SiO line sources are variable.  The ones in {\sl peak.cmd}
were thought to be good at the time the file was made.  Information on
masers used to be found at the 
{\href{http://www.ls.eso.org/lasilla/Telescopes/SEST/html/telescope-calibration/index.html}{SEST web site}}.
That link is now dead.  Please let me know if you know an alternative.
For information on high frequency flux densities of continuum
calibrators, one can try the
{\href{http://carma.astro.umd.edu/cgi-bin/calfind.cgi}{CalFind}}
tool at the CARMA website.  Please recommend other options if you have
them.

On the VLA reference pointing must be used for observations utilizing
frequencies greater than 15 GHz.  Reference pointing needs 2.5 minutes
on source to get solutions.
See the discussion of 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}} and the comments in the example
{\href{examples/hsaddc.key}{{\sl hsaddc.key}}} for more
details.  Please see  the 
{\href{https://science.nrao.edu/facilities/vla/docs/manuals/obsguide/modes/hifreq/strategy}{VLA's high frequency strategy guide}}
for more details.  For more information
on VLBI at the VLA, see 
{\href{https://science.nrao.edu/facilities/vla/docs/manuals/obsguide/modes/vlbi}{VLBI at the VLA guide}}.

For the GBT, reference pointing is recommend for frequencies of 8 GHz
and higher.  The interval should be 4-5 hr for 8-10 GHz, 3-4 hr for
12-16 GHz, 1.5-2 hr for 18-26 GHz, and 30-45min for 40-50 GHz.  The
pointing source should be stronger than 0.5 Jy and within 15 degrees
of the target.  Allow 8 minutes or more in a non-recording scan for
the pointing.  For more on VLBI at the GBT, see 
{\href{http://www.gb.nrao.edu/~fghigo/gbtdoc/vlbinfo.html}{the GBT documentation.}}

For Effelsberg, reference pointing should be used for frequencies 
above 5 GHz.  Like the GBT, allow 8 minutes on-source.

Reference pointing scans can be inserted explicitly by the observer or
\schedb can be requested to attempt to do the job automatically.  For
explicit scan insertion, the user specifies a scan with times and a
source.  Other factors such as the setup can also be specified.  The
parameters 
{\hyperref[MP:PEAK]{{\tt PEAK}}} and/or 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}}
will need to be set and the user should consult
the documentation on those parameters.  \schedb can be requested to
fill most of the required parameters using the same information used
for the automatic scan insertion discussed below.  See the discussion
of the parameter 
{\hyperref[MP:POINT]{{\tt POINT}}} for information on
how to control this semi-automatic mode.

Note that for the VLBA is in a transition period between the legacy
control system and a new control system similar to that on the VLA.
During the transition, both systems are operating in parallel.  They
cannot talk to each other, but are run from {\sl crd} files (legacy)
and a {\sl vex} file (new system) written by \schedb for the same
schedule.  For a project using the RDBE and MARK5C, the channel
control information must be appropriate for those devices.  But the
antenna control is still in the hands of the legacy system for all
cases, and reference pointing is based on power measurements made in
the legacy baseband converters.  \schedb sets the legacy system
frequencies and bandwidths to match as well as possible those being
used in the RDBE.  For continuum sources, this is ok for reference
pointing.  But most reference pointing is done on SiO masers using
narrow bandwidths and with frequencies set using Doppler calculations.
With the DDC personality, that is also ok because narrow bandwidths
at flexible frequencies can be set, and be matched between systems.

For RDBE based observations using the PFB personality, reference
pointing becomes a problem.  The PFB can only use 32 MHz bandwidths at
very restricted frequency set points.  A scheme has been established
using the input parameters 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}},
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}}, 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}},
{\hyperref[MP:CRDCH1]{{\tt CRDCH1}}}, 
{\hyperref[MP:CRDSETCH]{{\tt CRDSETCH}}}, and 
{\hyperref[MP:CRDNCH]{{\tt CRDNCH}}} to
allow somewhat independent control of the legacy BBCs.  See the
descriptions of those parameters, and the example
{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}} for
details.  As shown in the example, these parameters can be used for
both explicit pointing scan insertion and for use with automatic
pointing scan insertion by \sched.  Note that these capabilities have
replaced the need that existed when the RDBEs were first deployed for
separate MARK5A and MARK5C schedules.

Explicit insertion of pointing scans can be a pain and can completely
dominate the work involved in scheduling high frequency observations.
Therefore \schedb has a mode where it can do the work.  This mode is
invoked with the 
{\hyperref[MP:AUTOPEAK]{{\tt AUTOPEAK}}} command and
involves the use of a special set of input parameters either from a
separate file, the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}}, or from
in-stream commands, in the main \schedb input, contained between
{\hyperref[MP:PEAKINIT]{{\tt PEAKINIT}}} and {\tt ENDPEAK}.  Three
standard versions of this file are 
{\href{catalogs/peak.cmd}{{\sl peak.cmd}}}
(VLBA legacy system),
{\href{catalogs/peak\_RDBE\_DDC.cmd}{{\sl peak\_RDBE\_DDC.cmd}}}
(use with the RDBE using the DDC personality), and 
{\href{catalogs/peak\_RDBE\_PFB.cmd}{{\sl peak\_RDBE\_PFB.cmd}}}
(use with the RDBE
using the PFB personality).  The three files differ only in the setup
files they specify and are, in fact, constructed from the same master
file.  The standard files can be used as examples of the format.  It
is possible to watch details of the process by which \schedb chooses
pointing sources by setting the parameter 
{\hyperref[MP:PKWATCH]{{\tt PKWATCH}}}.
Be warned that this can produce a lot of
output to the {\sl sched.runlog} file.

There are several examples that demonstrate the use of reference
pointing.  The best example for the new systems (RDBE/DDC, WIDAR etc)
is 
{\href{examples/hsaddc.key}{{\sl hsaddc.key}}}.  That
example demonstrates reference pointing at the VLBA, VLA, GBT, and
Effelsberg, array phasing at the VLA, and Doppler setting with the DDC
personality.  As noted earlier, 
{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}}
demonstrates the use of the
crd parameters to schedule reference pointing when using the RDBE with
the PFB personality.  For reference pointing on the VLBA using the
MARK5A systems, see the ``eg3mm'' examples.  
{\href{examples/eg3mma.key}{{\sl eg3mma.key}}}
sets up the pointing scans without
any help from the automatic features in \sched.
{\href{examples/eg3mmb.key}{{\sl eg3mmb.key}}}
demonstrates use of the external peak command file.  
{\href{examples/eg3mmc.key}{{\sl eg3mmc.key}}}
produces the same results but using
{\hyperref[MP:PEAKINIT]{{\tt PEAKINIT}}} and no external file.  These
examples only include a few VLBA stations.  For the new systems, they
are mostly superceded by 
{\href{examples/eg3mm\_rd2.key}{{\sl eg3mm\_rd2.key}}}.

The peaking control information is organized around groups of antennas
and lists of possible pointing sources.  Up to 5 groups of antennas
can be specified.  For full automatic pointing, separate scans will be
added for each group (this can add quite a few scans).  For each
group, \schedb finds the source in the pointing list that can be
reached most quickly from the target source, that is above a specified
minimum elevation at all antennas in the group.  Pointing will only be
added for scans observing at a frequency above a specified cutoff and
only when there is enough of a gap in the schedule to fit one or two
scans plus the slew to the pointing source from the previous VLBI source
and the slew to the next VLBI source.  The parameter 
{\hyperref[MP:GAP]{{\tt GAP}}}
can be used to create such a gap.  See the discussion of
that parameter for a few more details.

The input parameters for the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} are:

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item {\tt SRCFILE} specifies the file name for a file containing
pointing sources.  That file is in the same format as the
{\hyperref[SEC:SRCCAT]{main source catalog}} and, indeed, is appended to
the source catalog in the internal files in \sched.  The default is
{\sl \$SCHED/catalogs/sources.pointing} which is a file provided with
the \schedb distribution.  If you don't wish that any file is read (ie
the pointing sources are in the main source catalog), specify {\tt
NONE}.  This parameter can only be specified once, or rather the last
value specified for all groups is used.

\item {\tt SETUP} specifies the setup file to use for this group for
pointing with continuum or very strong line sources.  These are
sources for which {\tt CALCODE} is not {\tt 'L'}.  If {\tt SETUP} is
not specified, it keeps the value set in the previous group.  The
initial default is blank, which will probably produce an error.

\item {\tt SETUPL} specifies the setup file to use for this group for
pointing on spectral line sources with {\tt CALCODE = 'L'}.  The setup
should be one with a 2 MHz bandwidth specified.  If not specified, it
keep uses the value of {\tt SETUP}.

\item {\tt LINEINIT} has exactly the same effect as the main program
input 
{\hyperref[MP:LINEINIT]{{\tt LINEINIT}}} and is used to delimit
input of spectral line rest frequencies.  This allows the frequencies
to be specified in the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} rather
than the main program.  It is allowed to have {\tt LINEINIT} sections
in both the main program and the {\sl PEAKFILE}.

\item {\tt MINFREQ} is the minimum frequency (MHz) for which attempts will
be made to insert pointing scans.  The default is 60000 MHz which is
appropriate for the VLBA.  This parameter keeps the value of the previous
group if not specified.

\item {\tt MINEL} is the minimum elevation allowed for a pointing scan.
Higher elevation scans will give better results, but to high a {\tt MINEL}
may cause \sched to have to choose a pointing source that is far away.

\item {\tt DWELL} is the minimum integration time to use for a pointing
scan.  For the VLBA, the default of 60 seconds is appropriate.  For the
VLA, it should at least 2.5 minutes.  See the discussion of the schedule parameter
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}} for much more information.
{\tt DWELL} keeps the value set for the previous group if not set.

\item {\tt STATIONS} is used to specify the stations for the group.
As of this writing, the maximum number is 30, which is also the maximum
number of stations in a schedule.  Stations in a group will share a
pointing scan while a separate scan, potentially with a separate
reference source, will be used for stations in another group.  It
is appropriate to keep stations at each end of the array in separate
groups because the appropriate reference source may vary near
the time of rise or set of the target source.

\item {\tt LINENAME} specifies which spectral line to use in a reference
pointing scan.  It has the same meaning as the main schedule parameter
{\hyperref[MP:LINENAME]{{\tt LINENAME}}}.  It defaults to blank which is
probably not what you want.  It keep the same value as the previous
group if not set.

\item {\tt VLAMODE} specifies the main schedule parameter
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}} to use for the pointing scans
involving the VLA.  See the descriptions of that parameter and of
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}} for details.

\item {\tt ENDPEAK} is used to terminate peak command input in the
main \schedb control file.  It should be in a group of its own since
no other parameters specified with it will be parsed.

\end{list}

As with all types of \schedb input, end each group with a ``/''.  The
order of parameters within a group (between ``/''s) is not significant.

\section{\label{SEC:MULTIPLE_CENTERS}Multiple Phase Centers}

The DiFX correlator has a capability to process many phase centers
within a primary beam in one pass.  It does this by cross correlating
with high spectral resolution and short time integration, then
splitting the data paths out for each desired phase center, shifting
the delay and phase for the new center, and integrating in time and
frequency.  There is a price of about a factor of 2.5 to do the
large transforms involved, but there is very little additional burden
for each phase center.  The difference in processing time between 20
phase centers and 200 is about 20\%.  Up to about 500 phase centers in
a field have been tested.  This mode is expected to be popular for
surveys and for in-beam calibration at lower frequencies.

\schedb supports the multiple phase center mode by providing the
details of all the desired phase centers to use for a given pointing
center in the output {\sl .v2d} file, which is used in correlator
setup.  In the future, this information could also go to the VEX file
when the standard and the readers can receive the information.

To invoke multiple phase center processing, and specify the centers,
the user should provide a list of all the sources to use with each
pointing center.  To do this a 
{\hyperref[MP:PCENTERS]{{\tt PCENTERS}}}
section should be added to the main \schedb input file.  Within that
section, each group of centers is given a name and a list of source
names.  The sources need to correspond to sources in the source
catalogs.  It is likely that the user would create a catalog of the
offset pointing centers and invoke it, along with the standard
catalog, using the new ability to use two source catalogs using
{\hyperref[MP:SRCFILE]{{\tt SRCFILE}}} and 
{\hyperref[MP:SRCFILE2]{{\tt SRCFILE2}}}.

To tell \schedb to use one of the named lists of pointing centers,
specify the name of the group from 
{\hyperref[MP:PCENTERS]{{\tt PCENTERS}}} using the input 
{\hyperref[MP:CENTERS]{{\tt CENTERS}}}
for each scan.  For now, the same list must be
used for all scans on a pointing center and all scans on that pointing
center must use the list.  The internal structure of \schedb will
allow that one-to-one correspondence between pointing centers and
phase center lists to be relaxed if and when the information can
be transmitted to the correlator.

When using this capability, the user should specify the size of the
FFTs to do on each baseband channel before splitting the data for each
phase center.  This is done with the (new) second argument to \schedb
input parameter 
{\hyperref[MP:CORCHAN]{{\tt CORCHAN}}}.  Normally that
argument can be ignored and the FFT size will be set to the larger of
128 or the first argument.  The FFT size needs to be large enough that
there is is insignificant delay smearing in a single channel.  The
required size depends on the baseband bandwidth (B MHz) and the
maximum distance between the pointing and phase centers (x arcsec).
For the VLBA for a 5\% loss of amplitude on an offset source, the
number of channels should be near B*x/2.35.  A somewhat more
conservative criterion is to limit phase winding to 5 spectral points
per turn of phase in the spectrum.  By that, given that the maximum
delay change for a 1 arcsecond shift is 139 ns on the longest VLBA
baseline (8600 km), the number of channels should be near 5*0.139*B*x.
The full width, half maximum beamwidth of a VLBA antenna (25m) is very
close to 30 and 1 arcminutes at 1.4 and 43 GHz, respectively.  For the
1.4 GHz case, the above two criteria give 3063 and 5004 channels for a
4 MHz baseband channel width.  A specification of 4096 channels would
likely be reasonable.  With the RDBE, much wider baseband channels 
are possible requiring many more spectral channels.

See the Wide-Field Imaging section of the
{\href{https://science.nrao.edu/facilities/vlba/docs/manuals/oss}
{Observational Status Summary}}
for more information on delay and fringe rate smearing.


There is an example, 
{\href{examples/egcent.key}{{\sl egcent.key}}}, with an
associated catalog 
{\href{examples/egcentsrc.dat}{{\sl egcentsrc.dat}}},
with the \schedb examples to demonstrate the use of this mode.

\section{\label{SEC:GEOSEG}Automatic Insertion of Geodetic Segments}

Phase referencing for weak source detection and astrometry depends on
the ability to transfer interferometer phase from a calibrator to a
target.  The largest source of error in that transfer is the
atmosphere.  The ionospheric component of the atmosphere can be
calibrated using multiple observing bands or modeled with the help of
GPS based ionospheric models.  The non-dispersive tropospheric
component needs to be calibrated, either by measuring gradients using
multiple calibrators near the target, or deriving the zenith delay
from observations and using a mapping function to get the elevation
dependence.  The latter method is generally accomplished by inserting
occasional clusters of observations of calibrators around the sky from
which the clock offset and the zenith delay can be derived.  AIPS task
DELZN is typically used to make the solutions, although some users
have their own programs for the purpose.  These clusters of calibrator
observations are called geodetic segments or DELZN segments.

Constructing a geodetic segment can be tedious given that one wants
low elevation observations at all stations.  The tropospheric effect
scales roughly as secant(zenith angle) (hereafter SecZ).  The
elevations at each VLBI station are different and change rapidly with
time.  It is also best to have sources that are high at some stations
and low at others to give robust SecZ fits.  External programs have
been written to construct geodetic segments for insertion into SCHED and
libraries of segments are available, mostly from Mark Reid of CfA.
But any schedule with such segments is tightly constrained in time ---
any time shift will cause what were low elevation scans to become
either high elevation scans or scans where the source is down.  Plus
gathering the required segments can be tedious.

/schedb can build and insert geodetic segments automatically into
schedules.  This should drastically reduce the overhead in
constructing such segments, and allows such segments to be made easily
when the station list is not just the VLBA.  Also the schedule can be
time shifted easily, a possible benefit for dynamic scheduling.  When
there is a time shift, a different list of sources for each segment,
optimized for the new time, will be built.  It has also been found that
this capability can be used to make short groups of scans that can
be used for atmospheric opacity solutions by AIPS task APCAL.

To request that a geodetic segment be built, the user should specify a
scan with the parameter 
{\hyperref[MP:GEOSEG]{{\tt GEOSEG}}} given with
an argument that is the total duration of the segment (typical values
are 20 to 45 minutes).  A list of sources from the normal \schedb
catalogs to consider for the geodetic segments is given with the
input parameter 
{\hyperref[MP:GEOSRCS]{{\tt GEOSRCS}}}.  Other parameters
to consider to influence the source selection are 
{\hyperref[MP:DWELL]{{\tt DWELL}}}
(the length of the individual scans within the segment), 
{\hyperref[MP:OPMINEL]{{\tt OPMINEL}}} (the minimum elevation
to consider --- 10 degrees is a reasonable choice), 
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}}
(the minimum number of stations in a scan) and
{\hyperref[MP:SETUP]{{\tt SETUP}}} (the setup file --- typically one with
a wide spanned bandwidth and maybe not at the same band as the main
observations).  Be sure to set these parameters back to their desired
values for the main observations ({\tt GEOSEG} will revert to zero by
default) or you may get unexpected behavior.  In addition, for the
scan that is being turned into a geodetic segment a source needs to be
specified.  It will be ignored in constructing the segments, but
without it some of the \schedb checking that comes earlier will not be
happy.

The parameter 
{\hyperref[MP:GEOPRT]{{\tt GEOPRT}}} can be used to cause
some details about each trial source sequence tested to be printed to
{\sl sched.runlog}.  There are various levels of print possible.

The algorithm used to construct geo segments is described in more
detail below.  It involves constructing a number of trial segments and
selecting the best.  There are a number of control knobs sticking out
that the user might want to play with although the defaults are
reasonable.  The parameter 
{\hyperref[MP:GEOTRIES]{{\tt GEOTRIES}}}
controls the number of trial segments to test.  Setting {\tt GEOTRIES}
large will likely produce a slightly better solution at the cost of
high run times for \sched.  The algorithm for picking sources is
reasonably good so the best of the early tested segments is likely to
be nearly as good as anything found later.  The source picking
algorithm is based on fits for secZ, with a penalty for long slews.
It is also capable of leaving an antenna out of a scan if it gets to
source much later than other antennas.  If that source would have been
important for the slow antenna (low elevation), it is blocked so that
it can be used in a later scan.  The standard is that an antenna will
be left out of the scan, or the source blocked, if that antenna gets
to source more than 
{\hyperref[MP:GEOSLOW]{{\tt GEOSLOW}}} (default 40
seconds) later than the third to last antenna to get there.  The
choice of the third-to-last antenna for the reference was an effort to
deal with various awkward scenarios that can arise when not all
antennas are in all scans.

There is an example among the \schedb examples called
{\href{examples/egdelzn.key}{{\sl egdelzn.key}}} that shows
how to construct a file with automatic geodetic segment insertion.
The 
{\hyperref[MP:GEOSRCS]{{\tt GEOSRCS}}} in that example are the set
provided by Mark Reid for his packaged geodetic segments, but with
source names corresponding to those used in the normal \schedb
catalog.  Users are likely to just cut and paste that list into their
schedules.

The example 
{\href{examples/egdelzn.key}{{\sl egdelzn.key}}}
includes three different source lists in 
{\hyperref[MP:GEOSRCS]{{\tt GEOSRCS}}}.
One is Mark Reid's original 60 sources.  In testing, this list was found
to be too sparse in some parts of the sky.  The second list is the
295 defining sources of the ICRF2.  This should be a good list, especially
at frequencies not too far from the 2.3 and 8.4 GHz bands in which it
was derived.  The third list is based on the USNO 1cm survey and is
should be the right one to use at 22 GHz and up.  It also has over 200
sources.

{\bf The algorithm:}

Note:  There were minor changes to the algorithm when it got tested
for 2 station observations.  Those changes are not yet reflected in
the description below.

As long as \schedb is producing good geodetic segments, the details of
the algorithm shouldn't matter too much to users.  But some may wish
to know, so it is described here.  When starting to work on a segment,
\schedb calculates the elevations at the middle of the segment for all
of the specified sources.  It assigns a priority for each source
depending on how many stations see it at low (below 
{\hyperref[MP:GEOLOWEL]{{\tt GEOLOWEL}}}) and high (above 
{\hyperref[MP:GEOHIEL]{{\tt GEOHIEL}}}) elevation.
The best sources are low at at
least two stations and high at at least two.  The next priority
sources have at least one low and three high stations or at least
three low stations.  The mix of low an high stations helps with the
eventual least squares fit to SecZ terms.  Higher priority numbers
(worse sources) are assigned to less optimal sources.  With the help
of the calculated information and priorities, \schedb constructs a
number (
{\hyperref[MP:GEOTRIES]{{\tt GEOTRIES}}} of trial geodetic
segments.  A quality measure for each segment is determined by setting
up a least squares fit for SecZ and clock terms.  The formal error on
the fitted SecZ term for the station with the highest such error is
the quality measure.

An algorithm is used to construct each tested segment that tries to
come up with a source set that works reasonably well.  This makes
constructing each segment slow, but means that not many need to be
tested.  The algorithm starts by locating the 5 closest sources in the
top two priority bins to the preceding source in the schedule.
``Close'' here means in terms of slew time for the array.  For the
first scan of the schedule, all qualified high priority sources
are considered since the array will usually slew to the first source
before the observations start.  One of the chosen sources is picked at
random.  Then the next source is picked at random from the 5 closest
sources that either add a high or a low observation to a number of stations
that is the lesser of a third of the total or a third of the total number
of low and high scans still needed.  That scheme continues until
there is at least one low and one high source for each station.  That usually
takes of order 6 scans.

For later scans in the segment, all sources given in 
{\hyperref[MP:GEOSRCS]{{\tt GEOSRCS}}}
that are up at enough stations (set by
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}}) are tried, one at a time.  A
dummy least squares fit for SecZ and clock is tried with the sources
in the segment so far, up to a maximum of the preceding 
{\hyperref[MP:GEOBACK]{{\tt GEOBACK}}} sources.
Restricting the number in the
look-back seems to help some times when choosing long segments.  The
default is large (100) so there will be no effect and this should be
good most of the time, but users might want to fiddle the value.
Three quality measures are considered in the selection of the next
source.  The first is the improvement in the sigma for SecZ for the
station that was worst with the already-selected sources, subject to a
penalty for long slew times.  If that is not sufficiently good, the
source that gives the best improvement for the previously worst
antenna without the slew penalty is selected, but with a requirement
that the improvement be more significant than was required when the
slew penalty was used.  If even that is not sufficiently interesting,
the source that gives the best RMS improvement in the SecZ sigmas
across the array, subject to the slew penalty, is chosen.  The
deranged may wish to use 
{\hyperref[MP:GEOPRT]{{\tt GEOPRT}}} to watch in
detail , in {\sl sched.runlog}, what is going on in the algorithm.  
Actually you can tell quite
a bit from {\tt GEOPRT=0} but you will likely need to use the code to
understand much of what is being spewed out, especially for a high
value of {\tt GEOPRT} such as 2.

Note that, in the fits, any SecZ of more than 4 (about an elevation of
15 degrees) is treated as 4.  This will make the quality of the fits
seem somewhat lower but will place less emphasis on scans that are so
low that the risk of failures is great.

While selecting sources, normally no one source will be allowed to
repeat.  But sometimes there aren't very many low elevation options
and it may be desirable to allow repeats.  Parameter 
{\hyperref[MP:GEOSREP]{{\tt GEOSREP}}}
sets the minimum number of scans that must go by
before a source is allowed to repeat.  This was a problem for the
original 60 source list, but much less so for the ICRF2 or 1cm sources.

For each of the 
{\hyperref[MP:GEOTRIES]{{\tt GEOTRIES}}} trial segments,
a quality measure is generated.  \schedb picks the best segment
according to the quality measure, and inserts that into the schedule.
The quality measure is based on the expected errors of a fit for the
zenith delay and clock for all stations.  Standard errors of 100ps are
set for all observations (the value doesn't really matter here
although a future enhancement would be to vary the number based on the
source strength) and the highest reported sigma across the stations is
used as the quality measure.  This process is similar to what is done
when the data are used and encourages both a high range of elevations
at each site and a significant range of elevations across antennas for
each scan.


\section{\label{SEC:VLA}Scheduling the VLA}

For much detailed information on VLBI at the VLA, follow the links to
the 
{\href{https://science.nrao.edu/facilities/vla/docs/manuals/obsguide/modes/vlbi}{VLBI at the VLA guide}}.

The WIDAR correlator is capable of providing phased array output from
the VLA in a VDIF format to be recorded on a Mark5C disk recording 
unit.  Such data can be played back on the DiFX correlators, at least.
Since
recorder ready data are provided by WIDAR, none of the normal VLBI
backends are used.  But the properties of the correlator are rather 
similar to the RDBE so, in fact, scheduling the VLA has become more
similar to scheduling other antennas than it was with the old system.

The \schedb output used by the VLA is the VEX file.  In many ways, the
setups are similar to those for the VLBA.  The user does not need to
worry about the details of the internal VLA LO setup, although the front
end name (
{\hyperref[SP:FE]{{\tt FE}}}) does need to be provided as there
can be ambiguities.  The software involved in translating the VEX file
and making the VLA scheduling blocks (vex2opt) takes care of most
details.  The important factor is that the LO and baseband frequency
specifications, taking into account the IF sideband, add up to the
RF frequency of the bottom edge of the desired baseband.  The bottom
edge is required because the EVLA phased output is always net upper
sideband.  

As for setups, the VLA is fairly similar to a VLBA antenna.  But there
are several crucial differences.  The VLA is now compatible with 
everything that the VLBA can produce (RDBE/PFB, RDBE/DDC-4 and RDBE/DDC-8).
The channels on the VLA must come in polarization pairs.  Each baseband must come from a
separate IF with RCP in A or B and LCP in C or D.  There are some
cases above 18 GHz where the BD pair must be at a lower frequency than
AC, but that mainly affects Ka band (~30 GHz), which is not available
on the VLBA.  \schedb will not try to protect against that although
the hooks are in the code in case of future need.

The restriction to net upper sideband needs to be considered when
using the RDBE with the PFB personality on the VLBA.  Either the VLBA
LO needs to be above the RF frequency, or the sideband inverting
capability of DiFX needs to be invoked.  For some bands, a high VLBA
LO is not possible so the DiFX mode will be needed.  If the LO/sideband
combination from a station for a channel spans the same RF range as
the LO/sideband combination at another station, despite opposite
sidebands, SCHED will detect the overlap and schedule for sideband
inversion.

Sample schedules that include the VLA have been provided.  One using
the PFB personality of the RDBE at the VLBA is 
{\href{examples/jvla.key}{{\sl jvla.key}}}
(modify for 16 channels!).  The WIDAR
baseband channels can have much wider bandwidths than the PFB 32 MHz
channels.  They can be up to 128 MHz wide so, with 4, there is enough
bandwidth to feed 2 Gbps, matching the output of the VLBA stations
when they use the DDC personality of the RDBE.  For an example of
using 128 MHz bandwidths with WIDAR and the RDBE/DDC, see
{\href{examples/vladdc.key}{{\sl vladdc.key}}}. 

For scheduling, the user should be aware that the VLA slews at 40
deg/min in azimuth and 20 deg/min in elevation, which is about half
the speed of the VLBA.  This can be an issue for widely separated
sources.  It is, however, faster than some other HSA or Global VLBI
antennas.  The use of 
{\hyperref[MP:DWELL]{{\tt DWELL}}} for scheduling
should insure that adequate on-source time is obtained with the
slower antennas.

Another issue is that, each time a frequency is seen for the first
time, there needs to be a one minute dummy scan during which the
levels of the analog signals into the samplers are set.  \schedb can
handle this when using 
{\hyperref[MP:DWELL]{{\tt DWELL}}} scheduling by
inserting the appropriate amount of time as a gap before the first
scan with each frequency.  The time required is given by the antenna
catalog parameter {\tt TLEVSET}.  {\sl VEX2OPT} will insert the
required dummy scan in this gap.  Alternatively, the user can
explicitly insert DUMMY scans.  These are scans that are not
recording, not doing pointing, and not doing phasing and are at least
as long as {\tt TLEVSET} (1 minute for the VLA).  \schedb will not try
to insert a gap, or claim a late on-source time, based on {\tt
TLEVSET} before such a scan.  It is traditional to put a series of
such DUMMY scans at the start of the observing block, stepping through
all the frequencies that will be used in the observing block.  Note
that an enhancement needed for the DUMMY scans on the VLA is to avoid
needing DUMMY scans even for small frequency changes such as those
associated with different Doppler frequencies for different sources.

{\bf ARRAY PHASING:}

An important concern unique to the VLA and other interferometers used
in phased array mode to generate a single data stream for VLBI is the
need to adjust the individual antenna phases so that the signals add
coherently when summed.  The instructions to actively phase during a
scan, to hold phase from a previous active scan, or not apply phase
offsets are given in the VEX file in ``intents''.  The relevant
intents are {\tt AUTOPHASE\_DETERMINE}, {\tt AUTOPHASE\_APPLY}, and
{\tt AUTOPHASE\_OFF}.  Each can be preceded by {\tt VLA:} (eg 
{\tt VLA:AUTOPHASE\_DETERMINE} if there is a reason to make them 
specific to the VLA.   They can be provided directly using the
{\hyperref[MP:INTENTs]{{\tt INTENTs}}} input to \sched, but \schedb will
also generate them as needed based on 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}}
parameter if that is used, which is recommended.  The use of 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}} is preferred because
the defaulting behavior between scans is cleaner --- it does not get
tangled with other uses of {\tt INTENTs}.  \schedb will not allow the
use of both phasing {\tt INTENTs} and {\tt VLAMODES} as then can step
on each other.

Phasing scans can be added simply as additional VLBI scans, or the VLA
can be sent to a source not observed by the rest of the antennas and
for which no recording is made.

For successful phasing of the array, a source must be greater than
about 0.1 Jy (That is an old VLA number but is probably still
reasonable.  See the guide referenced above for details) and have a
position that is good to a fraction of the VLA synthesized beam
(enhanced sensitivity is only obtained over this area).  It must have
small structure phases and not have other sources of comparable
strength in the primary beam that might confuse the phasing algorithm.
The position accuracy is especially important if a calibrator is being
used to phase the array for observations of another source.  

Adding phasing sources is tricky, because it is desirable to spend a
minimum amount of time on them, but if they are missed, the rest of
the data will be bad.  When phasing, the \schedb scan during which the
phasing occurs is broken into subscans by the VLA as only one solution
is done per subscan.  The \schedb scan should be long enough for at
least 4 such subscans.  The length of the subscans is set by the
scan-dependent parameter 
{\hyperref[MP:VLAPTIME]{{\tt VLAPTIME}}} in
seconds.  The default is 10 seconds which is reasonable for most good
phasing sources and is the minimum \schedb will allow.  If it is
necessary to phase on a weak source, this could be extended.  With the
default subscan length, the \schedb scan for phasing should be at
least 40 seconds on-source.

The interval between phasing scans depends on the observing frequency,
the VLA configuration, and the weather.  Intervals between 15 and 30 minutes
are typical. % ********  (add more or reference another document).

{\tt REFERENCE POINTING}

At frequencies greater than 15 GHz, the VLA a priori pointing is not good enough so
reference pointing must be used.  That is also controlled through use
of 
{\hyperref[MP:INTENTs]{{\tt INTENsT}}}.

******  Document how to insert pointing scans, and the use of 
automatic insertion of pointing scans.

The old parameter 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}} allowed automatic
insertion of VLA phasing scans in the observe files.  That scheme no 
longer works.  But an item on the to-do list is to make that parameter
insert VLA phasing scans.  That has not yet been done.


{\bf OTHER CONSIDERATIONS}

If doing DELZN segments to measure the tropospheric delay, it is best
to use a single dish mode as the phasing can take time and can confuse 
the troposphere solution algorithm.

It is still early days for VLBI observations using the WIDAR correlator
to generate the phased array output data.  This section will likely
need more information eventually.

Note that normal output from the WIDAR correlator will be obtained during
VLBI observations.  Such observations may be useful for determination 
of large scale structure, total flux density, polarization, or absolute
amplitude calibration.  The user may need some VLA specific scans, such
as on a flux calibrator, to make full use of such data.

This section has changed drastically with the advent of the upgrade
to the VLA and the use of the WIDAR correlator.  If you have a perverse
interest in the old system, see the obsolete sections.


\section{\label{SEC:INDIV}Special Concerns for Specific Observatories}.

WARNING:  UNDER CONSTRUCTION!!!

This section contains various hints regarding the special requirements
of specific observatories.  Some of this information is lifted directly
from email and other sources from the observatories.

This section is still woefully incomplete.


\subsection{\label{SSEC:GBT}Green Bank Telescope.}

There are a variety of concerns for scheduling the GBT.  Documentation
is maintained at Green Bank and can be accessed at the link:
{\href{http://www.gb.nrao.edu/~fghigo/gbtdoc/vlbinfo.html\#hifreq}{VLBI on the GBT:}}

More information may be added here eventually, but for now, use the
above link.

\section{\label{SEC:SPECIALVLBA}Single Dish VLBA Observing}

\schedb is used primarily to schedule VLBI observations on the VLBA
and most of the rest of this manual is devoted to details of how to
do that.  However, there are a variety of types of observations that
are rather different.  These are mainly single antenna observations
usually done to measure system performance.  \schedb is able to
make the schedules for these observations.  Such observations are
not likely to be of interest to users other than NRAO staff involved
in the testing and maintenance of the instrument.

Some items of special interest for VLBA scheduling are:
\begin{list}{}{\parsep 0em  \itemsep 0em }

\item 
{\hyperref[MP:SOURCE]{{\tt SOURCE:}}} The source name is used in
the usual way.  However, for pointing, there is a useful capability
to specify the name of a Solar System object and have \schedb
determine its location from a JPL ephemeris.  See the description
of {\tt SOURCE} for more details.

\item 
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE:}}} This should be set to
{\tt NONE} for single dish observations.

\item 
{\hyperref[SEC:SRCCAT]{{\tt CALCODE:}}} If set to ``{\tt L}'',
pointing data will be processed using differences between the
on-line and off-line channels.

\item 
{\hyperref[MP:PTVLBA]{{\tt PTVLBA:}}} This can be specified on a
scan basis and causes \schedb to write out a pointing pattern.  It can
be turned off with {\tt NOPTVLBA}

\item 
{\hyperref[MP:TAVLBA]{{\tt TAVLBA:}}} This can also be specific
on a scan basis, but not for a scan with {\tt PTVLBA}.  It is another
special mode, very similar to PTVLBA, for measuring antenna
temperatures.  It can be turned off with {\tt NOTAVLBA}.

\item 
{\hyperref[MP:PN3DB]{{\tt PN3DB:}}} This can be specified on a
scan basis and causes \schedb to write out half power tracking test
pattern.  It can be turned off with {\tt NOPN3DB}

\item 
{\hyperref[SP:AZCOLIM]{{\tt AZCOLIM:}}} This specifies a pointing
offset in arcminutes in the azimuth direction.  It is equivalent to
the term used in the pointing equations to account for feed offsets
so it is a constant angle on the sky.  The actual change in azimuth
increases at high elevation because of the cos(El) dependence of
the angular effect of an azimuth change.  It is available both
{\hyperref[SP:AZCOLIM]{in the setup file}} and 
{\hyperref[MP:AZCOLIM]{in the main schedule.}}

\item 
{\hyperref[SP:ELCOLIM]{{\tt ELCOLIM:}}} This specifies a pointing
offset in arcminutes in the elevation direction.  It is equivalent to
the term used in the pointing equations to account for feed offsets
and encoder offsets, which are equivalent for elevation.  It is in
the setup file.

\item 
{\hyperref[SP:PTINCR]{{\tt PTINCR:}}} This is the jump in arc minutes
between the on-source and half-power pointing positions for use in
setting up pointing patterns.  It is used in {\tt PTVLBA}, {\tt PN3DB} and
{\tt TAVLBA} modes.  This is a setup file parameter.

\item 
{\hyperref[SP:PTOFF]{{\tt PTOFF:}}} This is the jump in arc minutes
between the on-source and off-source pointing positions for use in
setting up pointing patterns.  It is used in {\tt PTVLBA}, {\tt PN3DB},
and {\tt TAVLBA} modes.  The default is 6 times {\tt PTINCR}.
This is a setup file parameter.

\item 
{\hyperref[MP:PTDUR]{{\tt PTDUR:}}}  This parameter is a time (in
the usual time format) that specifies the time spent in each pointing
position of a pointing pattern.  A reasonable value is 15 seconds.

\item 
{\hyperref[MP:PTSLEW]{{\tt PTSLEW:}}}  This parameter specifies the
time to allow to slew to the source.  It is specified in the usual time
units (seconds).  With dwell time scheduling or schedule optimization,
it should be kept small, often equal to {\tt PTDUR}.

\item 
{\hyperref[MP:FOCUS]{{\tt FOCUS:}}}  This is used to increment the
subreflector focus position.  The value is added to the nominal value
known to the on-line system for the particular receiver.

\item 
{\hyperref[MP:ROTATION]{{\tt ROTATION:}}} This is used to increment
the subreflector rotation position.  The value is added to the nominal
value known to the on-line system for the particular receiver.

\item 
{\hyperref[MP:ROTPAT]{{\tt ROTPAT:}}}  This triggers generation
of a focus-rotation test pattern of pointing observations.

\item 
{\hyperref[MP:ROTOFF]{{\tt ROTOFF:}}}  This is used to specify
the rotation offset positions of a focus-rotation pattern.

\item 
{\hyperref[MP:FOCOFF]{{\tt FOCOFF:}}}  This is used to specify
the focus offset positions of a focus-rotation pattern.

\item 
{\hyperref[MP:EPHFILE]{{\tt EPHFILE:}}} This is the name of
the ephemeris file to use if planets are included in the pointing,
as they typically are at high frequencies.  At the AOC, the
ephemeris files are typically kept in a directory assigned the
environment variable {\tt PLANET\_DATA}.  That assignment can
depend on computer architecture because the files are binary.

\end{list}

There are a number of setup files among the standard setups that are
for VLBA test observations.  Those that start with {\sl pt} are for
pointing or antenna temperature observations.  Those that start with
{\sl pc} are for pulse cal tests.

In addition to the above parameters, it is often best to make use
of one of the optimization modes to make the actual schedules.
{\hyperref[MP:OPTMODE]{{\tt OPTMODE=SCANS}}} is perhaps the most
useful.  With this mode, only a few template scans need be specified
and \schedb will pick the ones appropriate for use in the desired
time range.  Below is an example of a script, including everything
necessary to run \schedb on each VLBA station, for making pointing
and gain check observations.  This example is at a somewhat higher
level of complexity than most in this document, but it shows what
can be done with the program.  It actually makes a different schedule
for each station, taking into account the different portions of
the sky that can be seen.

\verbatiminput{../examples/doptg.com}

\section{\label{SEC:CONFIG}Configuration Studies}

\schedb has capabilities, added in 2002, that are useful in array
configuration studies.  These are tied to the
{\hyperref[SEC:PLOT]{plotting}} capabilities.  If 
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE = CONFIG}}}
is specified and a UV plot is requested from the
interactive plotting menu with more than one requested source, a map
of the station locations is plotted first.  It is possible to adjust
station selection by clicking on this map, and it is even possible to
move stations.  Also, the station selection can be used to set up a
configuration optimization that uses, as a quality measure, some
statistic about the sampled cells in a grid.  Alternatively, a contour
plot of the quality measure around a selected station can be made.
The effect of multifrequency synthesis can be examined with the help
of the 
{\hyperref[MP:UVMFS]{{\tt UVMFS}}} parameter.  This all makes for
a rather interactive way of examining possible configurations.  The
style is much like that used for the VLBA configuration search, but is
far more modern and interactive.  The optimizer is fast enough that a
1.8 GHz Pentium IV under Linux, optimizing arrays of 20 stations using
12 hour tracks of 10 minute scans on 4 sources can process over 50
different configurations per second.  To describe the capabilities,
the steps involved in using them will be described.

First, start with a planning type schedule such as is described in the
{\hyperref[SEC:PLANNING]{schedule planning section}}.  The scan
characteristics can be adjusted at will.  The examples are good for
``hunt and peck'' configuration examinations.  For the optimizer,
which looks at the uv points at the beginning and end of scans, it is
useful to use something like 
{\hyperref[MP:DUR]{{\tt DUR = 10:00}}} and
{\hyperref[MP:GAP]{{\tt GAP = 10:00}}} to evenly space these points.
Recall that setting the frequency to 0.3 MHz (the default for uv plots
when no setup is given) gives a one kilometer wavelength so the UV
coverage is in km.

There are two ways to look at alternative arrays.  One is to specify a
lot of stations up to the maximum that \schedb will accept.  Then the
ones to include in the uv plots can be selected from the sources menu
or interactively from the map.  This allows rapid trials of many
options.  As and alternative, or in addition, any station can be moved
interactively.  Note that you can use 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE=UPTIME}}}
to get continuous tracks on each source, or
you can give an actual schedule.  The author has found it useful to
invoke two instances of \schedb and carefully align the plot windows
(most easily by expanding them to full screen).  Then the window
manager can be used to blink back and forth to see differences easily.
Of course, selecting the station of interest to highlight (plot uv
points in red) helps distinguish differences too.

Note that, you can adjust the maximum number of stations by setting
the FORTRAN parameters {\tt MAXSTA} in {\sl sched.inc}, and {\tt
PSTMAX} in {\sl plot.inc}.  You might also have to increase {\tt MK} in
{\sl schin.f} to increase the allowed number of input parameters.  If
you just change {\tt MAXSTA}, \schedb should complain about other
changes that are needed.  Be warned that, as these parameters are
increased, the size of \schedb increases significantly since they
affect several 2D arrays with {\tt MCHAN}, which is rather large, on
the other axis.  Average users are not expected to do this sort of
thing, but if you are doing serious configuration studies, you are
probably not an average user.

The latitude and longitude range to set for the map should be set
using 
{\hyperref[MP:MAPLIM]{{\tt MAPLIM}}}.  \schedb will examine these
ranges and look for vector files that provide useful geographic
information.  If the region is large, country and ocean boundaries are
plotted.  If the US is included, state boundaries are also plotted.
Finally, if New Mexico is of significant size, the roads in New Mexico
will be plotted (this facility is being used for New Mexico Array - a
part of the EVLA - configuration studies).  For now, the map file
names are hardwired to be {\sl \$PLANET\_DATA/wdbtemp4.e00} for the
world map, {\sl \$PLANET\_DATA/states.e00} for the US states map, and
{\sl \$PLANET\_DATA/tra0003-2.dat} for the NM roads map.  {\sl
\$PLANET\_DATA} is an environment variable used locally to point to the
directory where the planetary ephemeris is kept.  The maps will not
be distributed with \schedb (they are much larger than all the rest
of \schedb put together), but can be made available to interested
users.

Start \schedb in the manner for plotting (specify 
{\hyperref[MP:PLOT]{{\tt PLOT}}} and the schedule file).
Once the menu comes up, set various
things.  Under Options, it is useful to decrease the default line
widths.  Under AXIS, select UV Plot and set the desired scale.  It
is useful to reverse the signs of the X axis so that the UV tracks
can be easily associated with stations on the map.  Under files,
select {\tt Both stations selected} so that any unselected stations
are left out of the plot.  Also select the sources you wish to use.
I have defined several sources at different declinations and at ra=0
for these studies and like to use the ones at 44, 18, -6 and -30 degrees
as a representative sample.  Then it is a good idea to save all this in
a parameter file from the FILES page.  On the next run, loading that
parameter file can save all the other setups.  Finally, click on PLOT.

At this point, a map will appear with selected stations in blue or red
and unselected stations in yellow or yellow with a red central dot.
You can right click on the map and the uv coverage for your sources
will be plotted.  You can drag the corners of the pgplot window to
make it larger, if you wish, or let the window manager expand it to
full screen.  The next plot (click {\tt PLOT} again) will then be
larger.  In the uv plots, any baseline involving a highlighted (red)
station will be plotted in red.  Others will be plotted in blue.  Left
clicking on the map will toggle the selection status of the nearest
station to the cursor.  Middle clicking on the map will flag the
nearest station to be moved.  The next left click (maybe others too)
will put that station at the cursor position.  Note that you cannot
return a station to its original position without restarting the
program.  Once a station has been moved, its symbol will be surrounded
by a green ring and, in the station list printed with the uv plots
(right click), the position will be in green.  Checking configurations
involves clicking stations on and off and running the uv plots.

The map can be zoomed in and out with {\tt 'Z'} and {\tt 'z'}
respectively.  The zoomed image will be centered at the location
of the cursor when the letter was typed.  The zoom out is by
a factor of 1.5, in by a factor of 1.0/1.5.

The optimizer is triggered by typing the letter {\tt O} (not case
sensitive) while the cursor is on the map.  What it does is count all
the highlighted stations, then it tries all combinations of that many
stations, choosing from all stations shown either in red or yellow
with a red dot.  Thus you can use the toggle operation to select that
stations that will be tried with the optimizer.  Be warned that the
number of arrays to try can get very large if you try to optimize too
many stations at once.  \schedb will inform the user of the number it
plans to try and then tells about its progress so he/she can decide
whether to wait and watch, go get a cup of coffee, go to bed, or abort
the process (kill the job - I suppose some day this should be made
friendlier).

The optimizer calculates a quality measure for each array and ranks
the resulting arrays accordingly.  The quality measure is based on
statistics of sampled cells in a special grid.  There are two options,
one is to simply count the number of sampled cells.  The other is to
look at the rms scatter of the number of samples per cell.  Other
quality measure options could be added without a lot of trouble.  Some
details are written to the {\sl nnnn.opt} file ({\sl nnnn} is the
project code), including the results for the top 200 arrays.

The optimizing grid is a polar with a radial cell size that scales
with the root sum of the radius squared plus a constant squared.  If
the constant is small, this ends up scaling with radius (a logarithmic
grid) which is useful for large arrays that cannot be reconfigured to
adjust the resolution.  For a large constant, the cells are evenly
spaced in radius, which places more importance on the longer spacings.
With an intermediate constant (the constant is in the units of the UV
plot), the cells have even spacing in the middle and go toward scaling
with radius on the outside.  This has been found to be the most useful
case, which is why this complexity is included.  If the constant is
too small, arrays that are excessively centrally condensed are
generated.  If too large, there can be poor short spacing coverage.
You will need to experiment with the values.  Also, you will need to
experiment with the number of cells to use in the radial and azimuthal
directions.  If the cells are too small, you will not distinguish
between arrays very well (each track is effectively isolated).  If too
large, all arrays will fill most or all cells so again this will not
be a good test.  After an optimization, there will be a faint
representation of the grid plotted under the UV coverage plots.

The parameters of the grid are set with 
{\hyperref[MP:GRIDNR]{{\tt GRIDNR}}} (the number of radial cells), 
{\hyperref[MP:GRIDNT]{{\tt GRIDNT}}} (the number of azimuthal cells), 
{\hyperref[MP:GRIDMIN]{{\tt GRIDMIN}}} (the inner radius of the grid), 
{\hyperref[MP:GRIDMAX]{{\tt GRIDMAX}}}
(the outer radius of the grid - which can bias
the resulting size of the array), 
{\hyperref[MP:GRIDW0]{{\tt GRIDW0}}}
(the constant discussed above), 
{\hyperref[MP:GRIDMEAS]{{\tt GRIDMEAS}}}
(select the quality measure), 
{\hyperref[MP:GRIDSTEP]{{\tt GRIDSTEP}}}
(select the spacing of latitude and longitude points calculated for
making the contour plot of quality --- see below), and 
{\hyperref[MP:GRIDVLA]{{\tt GRIDVLA}}}
(restrict the quality measure calculation to
only baselines involving a VLA station).

In addition to optimization, \schedb can plot contours of the quality
measure around a selected station.  To invoke this, toggle the station
selections until only one is red (if more are red, only one will be
used), then type {\tt S}.  Sched will calculate the quality measure
with the selected station at points on a latitude and longitude grid,
spaced by 
{\hyperref[MP:GRIDSTEP]{{\tt GRIDSTEP}}} arc minutes, and then
present a contour plot of the results.  This can be useful for finding
directions to move a station to improve coverage and for finding
the area over which a station can be moved to account for logistical
considerations.  The contours will remain until the map is replotted,
so if you repeat the process, multiple versions can end up on the
plot.  On replot, the contours will be replotted unless some other
action, like station selection or moving, has been taken.  This allows
hard copies including the contours invoked from the files menu to be made
for printing or whatever.

When the station map first appears, it is in full screen
mode.  But when you right click to get the uv plots, it is replotted
in one of the panels.

If one clicks {\tt 'K'} on the map, two postscript files are produced
that are useful for VLA centered SKA configuration studies.  These
are highly specific outputs with many parameters hardwired, so they
are not expected to be useful to the general user.  Someday, they
may be generalized.

Note that it would not be hard for a user willing to do a bit of
FORTRAN programming to cause other maps to be plotted or to add other
optimization quality measures.  If you want to do so, please let Craig
Walker know (cwalker@nrao.edu) so we can integrate a way to choose the
modes and input parameters and keep from having multiple versions of
\sched.  It is also just a matter of changing a few parameter statements
to increase the number of allowed stations.  This is kept down for
the released version of \schedb because that dimension is combined
with other large ones, like the maximum number of scans, to set the
size of some arrays and not everyone has huge memory computers.

These facilities were added by Craig Walker in early 2002.  Putting
them in \schedb was the easiest way to obtain facilities long wanted
for UV studies.  This scheme for UV optimization is especially useful
for arrays of relatively small numbers of antennas with strong
geographic constraints, as opposed to large arrays laid out on an open
plain.

\section{\label{SEC:SATEL}Satellite Tracking}

There was a project to use the VLBA to provide positional data to help
navigate interplanetary spacecraft.  For this project, the VLBA must
be able to point at the spacecraft so the ability to do so was
added to \schedb as of March 2004.  The spacecraft positions are
obtained with the help of {\sl spice} files that are typically from
JPL.  In Dec. 2014, this capability was augumented to utilize 
TLE (Two Line Ephemeris) files.

The NAIF software package from JPL is called to read the spice files
and calculate positions.  It is also used in processing the TLE files.
The NAIF software significantly increases the size of a \schedb
distribution, and the satellite tracking capability is unlikely to be
needed outside the AOC.  Therefore the tracking capability is not
included in the default \schedb distribution.

To use the tracking capability, a 
{\hyperref[SEC:SATINIT]{{\tt Satellite Initialization}}}
section needs to be included in the
main input file.  That section contains a group of inputs for each
satellite.  There are four input parameters in each group:

Note that the satellite routines also set the velocity for the
satellite for use with 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}.
The satellite frequencies can be specified with their rest frequencies
in a 
{\hyperref[MP:LINEINIT]{{\tt LINEINIT}}} section.

There seems to be an incompatibility between the NAIF software used for
satellite tracking and the code used for tracking planets based on a
JPL ephemeris that is used elsewhere in SCHED.  It is best not to mix
the two.  The satellite ephemeris files typically also contain the
planets so, if you wish to point at both satellites and planets, you
can do it with the satellite files alone.  Just don't set {\tt ephfile}.

Note that, according to notes in the code, this satellite tracking
section of \schedb does not take into account diurnal aberration which
it should, because it is also not taken into account in the on-line
system.  The planet section of sched does take it into account.  This
leads to different calculated positions when using the ephemeris and
when using the satellite tracking.  Some day, this should all be
handled better, but the effect is under an arcsecond so it does not
matter for pointing antennas.

The items in the {\tt SATINIT} section are:

\begin{enumerate}

\item {\tt SATNAME:} The name of the satellite.  This is only used internally
in \sched.  It is the name that should be used as the {\tt SOURCE} in
the scan inputs.  This name is not sent to the NAIF software.

\item {\tt SATNUM:} The number, used in the spice files, for the satellite (or
other celestial body, for that matter).  This number is assigned by JPL.
You need to know this number but I'm not really sure how you get it.
This number is sent to the NAIF software to tell it which satellite to
process.  For satellites, these numbers are negative.  They are positive
for planets etc.

\item {\tt KERFILE:} A {\sl spice} kernel file that gives information such
as leap seconds.  It is likely to have the extension {\sl .tls}.  Standard
versions at NRAO are in the \$PLANET\_DATA area.

\item {\tt SATFILE:} The {\sl spice} file for the satellite.  It is likely
to have the extension {\sl .bsp}.  Note that it must contain the satellite
(or asteroid or whatever) you want to observe AND any other bodies needed
to calculate the vector from the antenna to the body.  That will usually
mean that the Earth should be included and might require others, especially
if the satellite is orbiting around some other body.

\item {\tt TLEFILE:} The Two Line Ephemeris file for the satellite.
It is likely to have the extension {\sl .bsp}.

\end{enumerate}

When groups have been given for all satellites, give a line that
contains the word {\tt ENDSAT} and a slash.

If the above section is provided and one of the satellites is a source
in the schedule, \schedb will call the NAIF software once for a
nominal position for the summary file etc, then again for every scan
for every stations to get updated positions and rates.  It will also
calculate an approximate parallax correction for each station.  This
can amount to several arcseconds, and the calculation is believed to
be good to an arcsecond or better.  The scan/station dependent positions
are written to the {\sl .crd} files for the VLBA.  See the note below
about VEX files.

For a satellite (or any moving source, for that matter), \schedb plotting
can help you see where the object is going.  In the RD (RA/Dec) plots,
a line will be plotted for each scan.  A likely use for this capability
would be to obtain the transmission schedule for a satellite over some
days or weeks, make a schedule with a scan for each period that it
is transmitting, then make the RD plot and show the calibrators.  This
will help identify times when the satellite is both on and near
a likely phase reference source.

There is a \schedb example, 
{\href{examples/egsat.key}{{\sl egsat.com}}}
that demonstrates the use of the satellite
capability.  Interested users are recommended to start with that
example.

The scheme for handling moving sources in VEX files is not yet established.
However, to correlate such observations on the VLBA DiFX correlator,
a Vex file is needed for all the information other than the positions.
Thus VEX files can be written when there are moving positions, but several
warnings will be written about the use of such files.  The positions
of the moving sources should be obtained from ephemeris information at
correlation time, separately from the VEX file.  For pointing, positions
may or may not be good enough depending on the rates.  Also note that
solar system objects may require offset pointing positions between
different stations and that is not described in the VEX file.


\chapter{\label{CHP:INPUT}THE SCHED INPUT FILES (Includes parameter lists)}

This chapter covers the main input files that \schedb reads.
However note that there are a couple of special purpose files
that are covered in other sections.  The input for specification
of spectral line rest frequencies is covered in
{\hyperref[SEC:LINE]{the section on spectral line observations}}.
The input to control insertion of reference pointing scans is
covered in the section on 
{\hyperref[SEC:REFPOINT]{reference pointing}}.

See the 
{\hyperref[SEC:FILES]{\schedb Input and Output Files}} section of
this manual for brief descriptions of the files and pointers to the
standard versions.


\section{\label{SEC:SCHPAR}The Schedule File}

The schedule file is the main, and perhaps only, input file that the
user prepares.  It provides bookkeeping information for telescope
and correlator operators, points to the desired catalogs or contains
segments of catalogs, gives overall control commands to describe
the observations and lays out the detailed sequence of observing
scans.

A large number of input parameters are available for the schedule
file.  They are all described in detail in this section.  However,
most of the parameters default to reasonable values for ordinary
VLBI observations and can be ignored by most users.  The easiest
way to determine which ones to worry about is to follow one of
the examples and consult the detailed descriptions only when unsure
of the meaning or behavior of a parameter.

The descriptions of the parameters for the schedule file, and later
for the 
{\hyperref[SEC:SETUPS]{setup files}}, contain a wealth of
information about VLBI systems and scheduling style.  Serious users
might find it instructive to browse through these sections.

This section starts with list of the parameters, with one line
per parameter and, for web users, a link.  When a parameter is
given as mixed upper and lower case, the lower case letters are
optional in the input file.  The main part of this section is
the detailed descriptions of every parameter.  These descriptions
start with some text describing the parameter, its actions, and
information about how to use it.  Every parameter description
ends with a short table giving the following information:

\rcwbox
{The data type expected.}
{A list of specific options if appropriate.}
{The value assigned by \schedb if the parameter is not given in the
schedule file.}
{Can the parameter be specified for each scan or only once? If for
each scan, what happens if it is specified for one scan and not the
next.}
{An example specification of the parameter.}

If a parameter for which \schedb only wants one value is specified for
more than one scan, only the last value will be used. For parameters
that can be specified for each scan, nearly all default to the value
for the previous scan if not specified.  The only exceptions are {\tt
START}, {\tt STOP}, {\tt REP}, {\tt GROUP}, {\tt POINT}, and {\tt
COMMENT}.  Normal defaulting for these parameters would produce
undesirable behavior.  Note that {\tt TAPE}, {\tt REWIND}, {\tt
FASTFOR}, {\tt REVERSE}, are not obsolete because they were specific
to tape, which is no longer in use.


\subsection{\label{SSEC:PARLST}Summary List of SCHED Parameters}

COVER INFORMATION:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{VERSION}{~} Schedule version number. Helps identify latest.
\htlm{EXPT}{~~~~} Short description of project.
\htlm{EXPCODE}{~} Project code.
\htlm{PINAME}{~~} Name of Principal Investigator.
\htlm{ADDRESS1}{} Principal Investigator's address for cover
\htln{ADDRESS2}{ADDRESS1}{} information. Up to 4 lines allowed.
\htln{ADDRESS3}{ADDRESS1}{} ~
\htln{ADDRESS4}{ADDRESS1}{} ~
\htlm{PHONE}{~~~} Principal Investigator's phone number.
\htlm{OBSPHONE}{} Principal Investigator's telephone number
                        during obs.
\htlm{TELEX}{~~~} Principal Investigator's TELEX number (obsolete).
\htlm{EMAIL}{~~~} Principal Investigator's electronic mail
                        address(s).
\htlm{FAX}{~~~~~} Principal Investigator's FAX number.
\htlm{OBSMODE}{~} Frequency band, recording system etc.
\htlm{OBSTYPE}{~} Type of observation. Mostly for recorder control
\htlm{NOTE1}{~~~} 1st of 4 comment lines for cover information.
\htln{NOTE2}{NOTE1}{~~~} 2nd of 4 comment lines for cover information.
\htln{NOTE3}{NOTE1}{~~~} 3rd of 4 comment lines for cover information.
\htln{NOTE4}{NOTE1}{~~~} 4th of 4 comment lines for cover information.
\htlm{COVERLET}{} Flag that in-line cover letter follows.
\end{list}




CORRELATOR INFORMATION:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{CORREL}{~~} Correlator to be used.  Destination for recordings and log
                        files.
\htlm{CORAVG}{~~} Correlator average time.
\htlm{CORAVG2}{~} Alternate correlator average time.
\htlm{CORCHAN}{~} Number of spectral channels per baseband channel.
\htlm{CORNANT}{~} Number of antennas to be correlated.
\htlm{CORPOL}{~~} Polarization processing on or off.
\htlm{CORSRCS}{~} Origin of source positions for correlator.
\htlm{CORWTFN}{~} Correlator weighting function.
\htlm{CORTAPE}{~} Type of media on which to send correlator output to user.
\htlm{CORDFMT}{~} Format of export data.
\htln{CORSHIP1}{CORSHIP}{} Shipping address for correlator output.
\htln{CORSHIP2}{CORSHIP}{}
\htln{CORSHIP3}{CORSHIP}{}
\htln{CORSHIP4}{CORSHIP}{}
\htln{CORNOTE1}{CORNOTE}{} Notes for correlator operations.
\htln{CORNOTE2}{CORNOTE}{}
\htln{CORNOTE3}{CORNOTE}{}
\htln{CORNOTE4}{CORNOTE}{}
\end{list}

PROGRAM CONTROL:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{DEBUG}{~~~} Turn on various debugging printouts.
\htlm{OVERRIDE}{} Flag for programmers to bypass restrictions.
\htlm{DOSTA}{~~~} Restrict processing to specific stations.
\htlm{DOVEX}{~~~} Write a VEX file.
\htlm{VEXTEST}{~} Allow use of unreleased VEX features.
\htlm{EXIT}{~~~~} Finish interactive input.
\htln{OVERwrit}{OVERWRIT}{} Overwrite files from previous run of
                        \sched.
\htlm{PLOT}{~~~~} Invoke plotting part of \sched.
\htln{SCHedule}{SCHEDULE}{} Name of file containing rest of schedule.
\htlm{FREQLIST}{} Write some information from the frequency file to
                  {\sl frequencies.list} and quit.
\htlm{NOSETUP}{~} Do not use a setup.  For planning schedules.
\end{list}

CATALOGS and other other ``external'' input.

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{LINEINIT}{} Following inputs will be rest frequencies.
\htlm{SETINIT}{~} Name and flag for in-line setup data.
\htlm{SRCCAT}{~~} Flag for start of in-line source catalog.
\htlm{SRCFILE}{~} Name of external source file.
\htlm{SRCFILE2}{} Name of second external source file.
\htlm{STACAT}{~~} Flag for start of in-line station catalog.
\htlm{STAFILE}{~} Name of external station file.
\htlm{LOCFILE}{~} Name of locations file.
\htlm{TAPEFILE}{} File name for tape initialization information.
\htlm{TAPEINI}{~} Flag that next group of input is tape
                        initialization.
\htlm{EPHFILE}{~} File containing JPL ephemeris data for planets.
\htlm{FREQFILE}{} File containing standard frequency setups.
\htlm{PEAKFILE}{} File with reference pointing parameters.
\htlm{PEAKINIT}{} Following inputs are for reference pointing.
\htlm{PCENTERS}{} Flag for start of lists of multiple phase centers

\end{list}

GENERAL CONTROL PARAMETERS:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{CALTIME}{~} Integration time for calibration data.
\htlm{DODOWN}{~~} Keep down antennas in scans.
\htlm{DOSCANS}{~} Keep only this scan range.  Mainly for operations.
\htlm{WRAP24}{~~} Double a 24 hour schedule to allow different start.
\htlm{IATUTC}{~~} IAT-UTC for planetary motion cards at VLA.
\htlm{INTENTs}{~} Directives for observing, correlation, and processing.
\htlm{LINEPG}{~~} Number of lines per page in operator schedules.
\htlm{LST}{~~~~~} Schedule is in LST for specified station.
\htlm{NCHAN}{~~~} Number of baseband channels (Obsolete - set in setups).
\htlm{PRECDATE}{} ``Observe'' date for coordinate conversions.
\htlm{SUMITEM}{~} Items to show in the summary file.
\htlm{TANTSTA1}{} List 1 of stations for Ta measurement requests.
\htln{TANTSTA2}{TANTSTA1}{} List 2 of stations for Ta measurement requests.
\end{list}

BASIC SCAN TIMING and CONFIGURATION:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htln{STATions}{STATIONS}{} Station list for scan. Up to 30.
\htlm{SOURCE}{~~} Source name.
\htlm{QUAL}{~~~~} Qualifier for source.
\htlm{YEAR}{~~~~} Year of first scan stop time.
\htlm{MONTH}{~~~} Month number.
\htlm{DAY}{~~~~~} Day number. 1 is first day of {\tt MONTH}. Can
                        be day of year.
\htlm{START}{~~~} Start time of scan.
\htlm{STOP}{~~~~} Stop time of scan.
\htln{DURation}{DUR}{} Duration of scan.
\htlm{DWELL}{~~~} Duration of scan but start when antennas on
                        source.
\htlm{GAP}{~~~~~} Minimum interval between scans.
\htlm{PRESCAN}{~} Time to wait before starting recording (Obsolete).
\htlm{PRESTART}{} Time to start recording before scan start.
\htlm{PREEMPT}{~} Protect scan from preemption at PT and MK for EOP observations.
\htlm{GROUP}{~~~} Number of scans to repeat.
\htln{REPeat}{REPEAT}{~~} Number of times to repeat scan(s).
\htlm{SETUP}{~~~} Name of file containing VLBA setup information.
\htlm{COMMENT}{~} Comment to appear in schedule.
\htlm{SCANTAG}{~} Name for scan to put in summary tables.
\end{list}

SCAN PROPERTIES:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{LINENAME}{} Name of group of rest frequencies to use.
\htlm{DOPINCR}{~} Minimum increments for frequency setting.
\htlm{DOPPLER}{~} Set frequency based on velocity for
                        spectral line.
\htln{NODOP}{DOPPLER}{~~~} Turn off Doppler calculations.
\htlm{DOMKA}{~~~} Record on Mark5A during Mark5C observations.
\htlm{DOPCAL}{~~} Obsolete form of {\tt DOPPLER}.
\htlm{DOPSRC}{~~} Set frequency based on velocity of this source.
\htlm{FREQ}{~~~~} Up to 16 baseband channel sky frequencies for
                        VLBA.
\htlm{BW}{~~~~~~}       Baseband channel bandwidths.
\htlm{CRDCH1}{~~} First main channel for related VLBA legacy channel.
\htlm{CRDNCH}{~~} Number of VLBA legacy system channels.
\htlm{CRDFREQ}{~} Force VLBA legacy BBC frequencies separate from RDBE.
\htlm{CRDBW}{~~~} Force VLBA legacy BBC bandwidth separate from RDBE.
\htln{CRDDOP}{CRDDOP}{~~} Provoke Doppler setting of VLBA legacy 
                         BBCs separate from RDBE.
\htln{CRDNODOP}{CRDDOP}{} End Doppler setting of VLBA legacy 
                         BBCs separate from RDBE.
\htlm{CRDSETCH}{} List of setup baseband channels to use on VLBA legacy 
                         system.
\htlm{PCAL}{~~~~} Mode for pulse cal generators.
\htlm{CENTERS}{~} Use multiple phase centers in processing.
\htlm{PEAK}{~~~~} Peak up on source.
\htln{NOPEAK}{PEAK}{~~} Turn off peak up request.
\htlm{POINT}{~~~} Convert the scan to a reference pointing scan.
\htlm{PKWATCH}{~} Extra output when {\tt AUTOPEAK} selected.
\htlm{TANT1}{~~~} Turn on Ta measurement at the {\tt TANTSTA1}
                         stations.
\htln{TANT2}{TANT1}{~~~} Turn on Ta measurement at the {\tt TANTSTA2}
                        stations.
\htlm{TSYS}{~~~~} Turn on Tsys measurements (obsolete)
\htln{NOTSYS}{TSYS}{~~} Do not measure system temperature (obsolete)
\htlm{GEOSEG}{~~} Insert a geodetic (DELZN) segment.
\htlm{GEOSRCS}{~} Gives a list of sources for geodetic segments.
\htlm{GEOPRT}{~~} Turn on debugging print from geodetic insertion.
\htlm{GEOTRIES}{} Number of trial geodetic segments to test.
\htlm{GEOBACK}{~} Number of look-back scans while selecting geodetic
                     segment sources.
\htlm{GEOSLEW}{~} Relative weight of slew time in selecting geodetic
                     segment sources.
\htlm{GEOSLOW}{~} Stations getting to source this much later than others
                     can be left out of a scan in a geodetic sequence.
\htlm{GEOSREP}{~} Minimum number of scans between repeats of the same
                     source in a geodetic sequence.
\htlm{GEOLOWEL}{} Upper boundary of ``low'' elevation region for geo sources.
\htlm{GEOHIEL}{~} Lower boundary of ``high'' elevation region for geo sources.
\htlm{PN3DB}{~~~}  Do VLBA half power tracking tests.
\htln{NOPN3DB}{PTVLBA}{~} Turn off VLBA tracking tests.
\htlm{PTVLBA}{~~} Do VLBA pointing sequence.
\htln{NOPTVLBA}{PTVLBA}{} Turn off VLBA pointing measurements.
\htlm{TAVLBA}{~~} Request Tant measuring mode.
\htln{NOTAVLBA}{TAVLBA}{} Turn off VLBA antenna temperature measurements.
\htlm{PTDUR}{~~~} Duration of each step in VLBA pointing
                        sequence.
\htlm{PTSLEW}{~~} Time to allow for slewing to source in
                        pointing sequence.
\htlm{AZCOLIM}{~} Azimuth collimation offset for scan for VLBA.
\htlm{ELCOLIM}{~} Elevation collimation offset for scan for VLBA.
\htlm{FOCUS}{~~~} Focus offset for scan for VLBA.
\htlm{ROTATION}{} Subreflector rotation offset for scan for VLBA.
\htlm{ROTPAT}{~~} Expand pointing patterns to include focus/rotation.
\htlm{ROTOFF}{~~} Rotation offsets for ROTPAT pattern.
\htlm{FOCOFF}{~~} Focus offsets for ROTPAT pattern.
\htlm{CRDLINE}{~} Arbitrary line for VLBA files for on-line testing.
\end{list}

RECORDER CONTROL

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{MINPAUSE}{} Minimum record stop time between scans.
\htln{RECord}{RECORD}{~~} Record this scan. Non-zero or NOREC to not record.
\htln{NORECord}{RECORD}{} Do not record this scan.
\end{list}

The following parameters are obsolete as they only applied only to tape.

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{AUTOTAPE}{} Request automatic tape changes. Give tape time.
\htlm{FASTFOR}{~} Fast forward the wide band tape.
\htlm{REWIND}{~~} Rewind wide band tape.
\htlm{REVERSE}{~} Reverse direction of recording of wide band tape.
\htlm{TAPE}{~~~~} Force a tape change. Reset {\tt AUTOTAPE}
                        reference time.
\htlm{TPREF}{~~~} Reference time for Mark~II tape changes.
\htlm{TAPESYNC}{} Synchronize tape changes (see warnings).
\end{list}

eVLBI CONTROL:

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{DATAPATH}{} Controls where data goes first.
\htlm{GRABTO}{} Controls where recorded data goes.
\htlm{GRABTIME}{} Controls which data are sent.
\htlm{GRABGAP}{} Controls how much time is needed to send data.
\end{list}

OPTIMIZATION (Beware --- experimental features!):

\begin{list}{}{\parsep 0em  \itemsep 0em }
\htlm{OPDUR}{~~~} Duration for experimental optimizing mode.
\htlm{OPELPRIO}{} Two elevation ranges in which {\tt OPSKIP} not active.
\htlm{OPMINEL}{~} Minimum elevation for an "up" source.
\htlm{OPMINANT}{} Minimum number of antennas in a scan.
\htlm{OPMISS}{~~} For {\tt OPTMODE = SCANS}, only keep this scan
                        if this many scans have been skipped.
\htlm{OPNOSUB}{~} Don't subarray in experimental optimizing mode.
\htlm{OPSKIP}{~~} Skip source {\tt OPSKIP} times unless in
                        priority elevation range.
\htlm{OPTLOWT}{~} Time scale for low el samples in
                        {\tt OPTMODE = CELLS or CSUB}.
\htlm{OPTMODE}{~} Optimization mode.
\htlm{OPPRTLEV}{} Print level for optimizing routine (mainly mode HAS).
\htlm{OPTSLEW}{~} Time scale for slews in {\tt OPTMODE = CELLS or CSUB}.
\htlm{OPHA}{~~~~} Prefered hour angle for scan {\tt OPTMODE=HAS}.
\htlm{OPHAWID}{~} Tolerance for hour angle {\tt OPTMODE=HAS}.
\htlm{OPHAWT}{~~} Importance of HA vs other weights {\tt OPTMODE=HAS}.
\htlm{OPHASTA}{~} Reference station for hour angles {\tt OPTMODE=HAS}.
\htlm{OPMINSEP}{} Minimum separation of scans on a source {\tt OPTMODE=HAS}.
\htlm{OPSLEWWT}{} Importance of slew time vs other weights {\tt OPTMODE=HAS}.
\htlm{OPSLEWTI}{} Scale time for slew time weights {\tt OPTMODE=HAS}.
\htlm{OPHLIMWT}{} Importance of near limits vs other weights {\tt OPTMODE=HAS}.
\htlm{OPHLIMTI}{} Importance of HA vs other weights {\tt OPTMODE=HAS}.
\htlm{OPHMAXDT}{} Maximum offset from desired HA to consider {\tt OPTMODE=HAS}.
\htlm{HIGROUP}{~} Group a few scans from which to choose one based on El.
\htlm{AUTOPEAK}{} Insert reference pointing scans.
\htlm{MAPLIM}{~~} Lat/long limits for station map when {\tt OBSTYPE=CONFIG}
\htlm{GRIDNR}{~~} Number of radial cells in uv optimization grid.
\htlm{GRIDNT}{~~} Number of azimuthal cells in uv optimization grid.
\htlm{GRIDMIN}{~} Inner radius of uv optimization grid.
\htlm{GRIDMAX}{~} Outer radius of uv optimization grid.
\htlm{GRIDW0}{~~} Characteristic radius for linear to logarithmic grid spacing.
\htlm{GRIDSTEP}{} Set the spacing of points for quality grid around a station.
\htlm{GRIDMEAS}{} Set which quality measure to use.
\htlm{GRIDVLA}{~} Specify that only baselines to VLA antennas are to be used.
\htlm{UVMFS}{~~~} Show effect of MFS in UV plots.
\end{list}

SPECIAL VLA PARAMETERS:

\begin{list}{}{\parsep 0em  \itemsep 0em }
%\htls{VLABAND}{~} Obsolete - put in setup file.
%\htls{VLABW}{~~~} Obsolete - put in setup file.
\htlm{VLAINTEG}{} VLA correlator integration time.
\htlm{VLAPTIME}{} Duration of phasing subscans on the EVLA
\htlm{VLAMODE}{~} VLA observing mode.
\htlm{VLAPEAK}{~} Control reference pointing.
\htln{VLANTSYS}{VLATSYS}{} Turn off VLA system temperature corrections.
\htlm{VLAPSRC}{~} Phasing source for VLA observations.
\htlm{VLARFANT}{} Reference antenna for single dish or phasing.
\htlm{VLATSYS}{~} Turn on VLA system temperature corrections. Also {\tt VLANTSYS}.
\htlm{VLATYPE}{~} Type of VLA observations.
\htlm{VLAUSERN}{} Obsolete - VLA user number.
\end{list}


\subsection{\label{SSEC:PARDET}Details of SCHED Parameters}


\subsubsection{\label{MP:ADDRESS1}
{\tt ADDRESS1, ADDRESS2, ADDRESS3} and {\tt ADDRESS4}}

{\tt ADDRESS1, ADDRESS2, ADDRESS3}, and {\tt ADDRESS4} are used to
give the Principal Investigator's address for the cover information.
At least the first line must be provided if recording.

\rcwbox
{A character string of up to 64 characters for each of the 4
parameters.}
{Any.}
{Blank}
{Only one value used, the last.}
{{\tt ADDRESS1='1003 Lopezville Rd'}\\
{\tt ADDRESS2='Socorro, NM 87801}\\
{\tt ADDRESS3='  U S A '}}

\subsubsection{\label{MP:AUTOPEAK}{\tt AUTOPEAK}}

{\tt AUTOPEAK}, without an argument, is used to request automatic
insertion of reference pointing scans based in information in
the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} (which can also be specified
in the schedule input file using {\tt PEAKINIT}).  See the
section on 
{\hyperref[SEC:REFPOINT]{reference pointing}} for much
more information.  Note that specifying {\tt AUTOPEAK} will cause
\schedb to try to insert pointing scans, but does not guarantee
that it will find scans at high enough frequency or with enough
of a gap from the previous scan.  Scans will be inserted when it has
been at least 10 minutes since the last set of pointing measurements
and when there is adequate time for one or two pointing patterns
based on the dwell time in the PEAKFILE.  This can be triggered by
specifying specifying adequate gaps using 
{\hyperref[MP:GAP]{{\tt GAP}}}.  In such
circumstances, the pointing will be inserted during the specified 
gap.  The minimum interval between the original scans will maintain the 
interval from {\tt GAP}, but the pointing will be inserted during that
time.  The interval between the inserted pointing scans and the input
scan will typically end up much less than {\tt GAP}.


\rcwbox
{No argument.  Just specifying it turns on the attempts to insert
scans.}
{None}
{Not set.  Will not attempt to insert scans.}
{If set anywhere in the schedule, scan insertion is turned on.}
{\tt AUTOPEAK}


\subsubsection{\label{MP:AUTOTAPE}{\tt AUTOTAPE}}

{\tt AUTOTAPE} is an obsolete parameter that only applied to tape.
It can be ignored by users of disk-based recording systems (eg Mark5)
and eVLBI.

{\tt AUTOTAPE} is used to request that automatic tape allocation and
control be used at stations that use the VLBA control system and have
more than one tape drive.  It has no effect on other stations such as
those that use VEX or on VLBA controlled stations with only one tape
drive.  {\tt AUTOTAPE=1} or {\tt AUTOTAPE=2} causes the on-line system
to determine the tape direction, head position and track allocation
automatically. The schedules will only include instructions on whether
to run, stop, or rewind. {\tt AUTOTAPE>=2} also activates automatic
reversal of the tapes when the low tape mark is reached, even in the
middle of scans; with {\tt AUTOTAPE=1} the tape will stop at the low
tape point and wait for the next scan. The default action (any other
value of {\tt AUTOTAPE} including no value) is to have \schedb
determine the tape motion and related information.

Automatic tape allocation is now required for most VLBA observations.
{\tt AUTOTAPE=2} should therefore be specified in most schedules.
{\tt AUTOTAPE=1} is risky and probably should not be used.  It is
provided only so that \schedb can create schedules for all modes
that the on-line systems can handle.

Automatic tape allocation cannot be used for projects that will not
be correlated on the VLBA correlator.  \schedb will refuse to make
such schedules.  This relates to how the correlators learn how the
tape was handled at the stations.  Non-VLBA correlators generally
obtain some of the tape positioning information from the schedules
rather than the logs, and, with automatic allocation, the two
can be very different.

When automatic tape allocation is specified ({\tt AUTOTAPE=2}), any
station that is using the automatic allocation will be removed from a
scan if the source is below the hardware limits at both ends of the
scan.  One can tell when this happened because a ``{\tt D}'' will
appear next to the {\tt ---} in the summary file elevation and azimuth
for a scan where this happened.  There is no override.  If one is
need, let Craig Walker know and it can be added.  This function
will mainly affect the Mauna Kea VLBA site which is often scheduled
in scans before the source rises and which has long access times
for the site techs doing tape changes.

For more information on how automatic tape handling works, see the
{\hyperref[SSSEC:AUTOTAPE]{AUTOMATIC TAPE ALLOCATION}} section.

The rest of this section concerns the use of {\tt AUTOTAPE} for
the Mark~II system.  It can be ignored by most (all?) current
users.

For Mark II, {\tt AUTOTAPE} requests automatic tape changes.  Without
it, tape changes must be explicitly specified.  The value specified
for {\tt AUTOTAPE}, if there is one, should be a time.  The default,
if no argument is given, is {\tt 4:00:00}, which is the recommended
value.  Specify a negative number to turn off tape changes and a
positive number (a time) to change the default tape length.  Tape
changes are requested at intervals of the requested time beginning
with the earliest start time of the whole schedule. If this would
require a change in the middle of a scan, the change is moved to the
start of the scan and all following changes are moved up. This is
station dependent and so can cause non-simultaneous tape changes. The
tape is assumed to be kept moving between scans.

The reference time for {\tt AUTOTAPE} (Mark~II use) can be altered
with {\tt TPREF} in the \schedb keyin file and with the {\tt TPTIME}
in the {\tt TAPEFILE}. See Section~\ref{SEC:TPINI} for information on
{\tt TPTIME}. {\tt TPREF} is a time of the form {\tt hh:mm:ss}. The
automatic tape changes are requested at integral numbers of 4 hour
intervals (for the recommended time) before or after {\tt TPREF}. A
date is not needed because 4 hours divides 24 hours evenly. Even if
someone were to use the 2 or 6 hour VCR modes, those tape lengths
still divide 24 hours evenly.

If {\tt TAPE} is specified in a Mark~II schedule for a scan while {\tt
AUTOTAPE} is set, a tape change will be requested and following tape
changes will occur at 4 hour intervals from the time of the forced
change. One specification of {\tt TAPE} is usually all that is needed
to get the tape changing sequence right if the earliest start time is
a poor reference time.

For most Mark~II projects, the default action of {\tt AUTOTAPE} should
be good. The major exceptions are projects that start on the half hour
and tape changes are desired on the hour, and projects where it makes
sense to have a short tape at the start on some stations to avoid
short tape on other stations for which the source rises later. Both of
these cases can be handled nicely with {\tt TPREF}.

Note that for Mark~II observations, if {\tt AUTOTAPE} is turned off,
no initial tape mount at the start of the project will be requested.
This causes problems at some stations. It you insist on specifying all
tape changes with {\tt TAPE}, be sure to put one on the first scan for
each station. This mode of setting tape changes is NOT recommended.


\rcwbox
{None or a number.}
{Mark~III or VLBA: Not {\tt 1} or {\tt 2} - \schedb sets tape
direction, head position, and track assignments. {\tt =1} - VLBA
on-line systems set above parameters. {\tt =2} - activate mid-scan
automatic tape reversals. Mark~II: No argument or {\tt 0} - do
automatic tape changes at 4-hour intervals. {\tt -1} - turn off
automatic tape changes. {\tt hh:mm:ss} - time for modified tape
length.}
{Mark~III or VLBA: \schedb controls tape. \\
Mark~II: {\tt AUTOTAPE=4:00:00}}
{Only one value used, the last.}
{{\tt AUTOTAPE=2}}



\subsubsection{\label{MP:AZCOLIM}\tt AZCOLIM}

{\tt AZCOLIM} can be used to specify an
increment to the azimuth collimation offset value used for pointing.
This is added to the nominal position known by the on-line system
for the particular receiver and to the value specified in the setup
file.  It is also added to the values used for offsets in pointing
patterns and the 
{\hyperref[SP:AZCOLIM]{value from the setup file.}}

\rcwbox
{An azimuth collimation offset in arc minutes.}
{Any value.}
{0.0}
{Default to previous scan.}
{{\tt AZCOLIM = 0.25 }}



\subsubsection{\label{MP:BW}{\tt BW}}

{\tt BW} specifies the bandwidths to use for the scan.  One value can
be given for each baseband channel.  Any unset values will be set
equal to the first so it is usually only necessary to specify one.
Because of details of how the defaulting works, once more than one
channel is explicitly set to a non-zero value (rather than just
defaulting to the first), be sure to set that channel explicitly
again, or it will retain the previous value.  To get back to the 
default, explicitly set the bandwidth to zero.  Note that, once upon
a time, the sign of the bandwidth indicated the sideband, but that
is no longer true.

Some (all?) of the digital backend systems, including the RDBE, cannot
oversample.  Plus the software job in SCHED to allow the sample rate
to track the input bandwidth is looking a bit serious - the sample rate
gets entangled with disk management etc.  So, at least for now (written
in Dec 2013), it will be necessary to make a new setup file to use
a different bandwidth for most observations.

Note that new parameter 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}} can be used to
set the VLBA legacy system BBCs to a bandwidth when using the RDBE,
which, with the PFB personality, cannot be set to narrow bandwidths.
This is useful for reference pointing.  Since the legacy system can
oversample, {\tt CRDBW} can be used without a new setup file.

\rcwbox
{Up to one real number for each channel.  The number is the bandwidth
in MHz.}
{Need valid setting for the backend in use.  For the VLBA legacy
system, they were {\tt 0.0625}, {\tt 0.125}, {\tt 0.250}, {\tt 0.5},
{\tt 1}, {\tt 2}, {\tt 4}, {\tt 8}, or {\tt 16} MHz. For the digital
backends, must be half the sample rate.}
{Uses bandwidth from setup file.}
{Uses the most recent value specified.}
{{\tt BW=2,2,2,2}}

\subsubsection{\label{MP:CALTIME}{\tt CALTIME}}

{\tt CALTIME} is the integration time in seconds for calibration
data from the VLBA monitor system. This includes the total and
switched powers used for system temperatures and also the pulse
cals.

This is currently ignored for PCFS (VEX) systems.

\rcwbox
{A time in seconds for each scan.}
{Any.}
{{\tt 120}}
{Uses the most recent value given.}
{{\tt CALTIME=60}}


\subsubsection{\label{MP:CENTERS}{\tt CENTERS}}

Triggers the use of multiple phase center processing on the
DiFX correlator at least at the VLBA.  In practice, this puts
the list of phase centers in the {\sl .v2d} file used in
setting up correlation.  Some day, it may put the list in
the {\sl .vex} file, if there is a standard for how to do that.

The argument of {\tt CENTERS} must correspond to a list of
names in the phase center groups listed after a
{\hyperref[MP:PCENTERS]{{\tt PCENTERS}}} command.

For now, there is no clear way to make the phase center list
scan dependent, so specify the same name for each scan on the
same source.  This may not always be true, which is why the
association of a phase center group with a pointing
source is not done in the {\tt PCENTERS} specifications.

For more information on multiple phase center processing, see
that 
{\hyperref[SEC:MULTIPLE_CENTERS]{section about that topic}}.

\rcwbox
{A name of a group of phase centers.  For now, must be the
same for every scan on a given source.}
{Any name of a group provided through 
{\hyperref[MP:PCENTERS]{{\tt PCENTERS}}}}
{None - don't use multiple phase centers}
{Keeps value of previous scan.}
{\tt CENTERS=P1305}

\subsubsection{\label{MP:COMMENT}{\tt COMMENT}}

{\tt COMMENT} is a string of up to 128 characters to be written on
operator and telescope files just before the scan.

\rcwbox
{Text up to 128 characters.}
{Any.}
{Blank}
{Reverts to no comment if not specified for each scan.}
{{\tt COMMENT='ET, call home.'}}


\subsubsection{\label{MP:CORAVG}{\tt CORAVG}}

{\tt CORAVG} specifies the correlator averaging time in seconds.

For the DiFX software correlator on the VLBA, there are two options
for how the specified average time is treated.  If all average times
are to contain exactly the same amount of data and the time tags are
to match exactly the mean time of the data, the interval must be
an integer number of FFTs and of short-term accumulator intervals.
The default behavior of the correlator is to adjust the average time
to the nearest option that fulfills these criteria.  That may well not
be a very ``round'' looking number.  The adjusted time will usually
deviate from the requested time by only a few percent, although in some
extremes of narrow bandwidth and many spectral channels, it can be as
high as a factor of SQRT(2).  An alternative behavior is
offered where the correlator takes the exact value specified.  It then
bins the scan into intervals of that length and averages any short
term integrations that fall in a bin.  The data are given the time
tag of the center of the bin.  This allows the user to choose any
desired integration time exactly.  But the amount of data contributing
to each integration will vary, typically by one short-term
accumulation. Also the true mean time of a data point will be offset
from the time tag by a variable fraction of a short-term accumulation
period.  To invoke this behavior, put the word {\tt EXACT} as a second
argument to {\tt CORAVG} (not case sensitive).

For the original Socorro VLBA hardware correlator, valid values are an
integer N times the speed up factor times 0.131072 seconds.  Round
values such as 2, 4, 8 seconds etc may be specified and the nearest
possible value will be used.  This is what is expected from most
users.

The correlator default is 2 seconds but, at most frequencies, more is
probably ok most of the time.  The longer the on-line averaging, the
smaller the output data rates and the smaller the output data set.

Note the correlation parameters {\tt CORAVG, CORCHAN,
CORPOL, CORTAPE,} and {\tt CORSHIPn} must be specified when
the project will be correlated in Socorro and data
are being recorded.

\rcwbox
{A real or integer number followed by a string of up to 8 characters}
{Any, but see above for useful numbers. The string can be anything but
only "EXACT" will mean to do something different from the default.}
{Must be given for processing in Socorro.  Otherwise 2.0.  The string
can, and usually will, be omitted.}
{Only one value used --- the last.}
{{\tt CORAVG = 4, exact}}

\subsubsection{\label{MP:CORAVG2}{\tt CORAVG2}}

{\tt CORAVG2} specifies the alternate correlator averaging time in
seconds.  Valid values have the same restrictions as 
{\hyperref[MP:CORAVG]{{\tt CORAVG}}}.
This will be the average time used
on baselines to spacecraft (eg HALCA) processed on the VLBA correlator.
It will typically be smaller than {\tt CORAVG}.

\rcwbox
{A real or integer number followed by a string of up to 8 characters}
{Any, but see 
{\hyperref[MP:CORAVG]{{\tt CORAVG}}}
for useful numbers. The string can be anything, but
only "EXACT" will mean to do something different from the default.}
{0.0 --- not used.  The string can, and usually will, be omitted.}
{Only one value used --- the last.}
{{\tt CORAVG2 = 1}}

\subsubsection{\label{MP:CORCHAN}{\tt CORCHAN}}

{\tt CORCHAN(1)} specifies the number of spectral channels per baseband
channel (one polarization component) that the correlator will write.
{\tt CORCHAN(2)} specifies the number of channels to use in the internal
FFT in the correlator.

The VLBA correlator (both old and new) will, by default, make 128
channel spectra which are then channel averaged on-line for continuum
observations.  The typical number of output channels for continuum
observations is the greater of 16 or twice the baseband channel
bandwidth in MHz.  Over averaging can cause loss of amplitude due to
``delay smearing'' --- the effect of large phase slopes across the
channels going into an average.  Delay offsets can either come from a
large field of view or from errors in the a priori clocks used in
processing.  The twice bandwidth number is determined by the clocks
and should represent a minimum.

Corrections for this effect are made in AIPS, but the corrections are
probably not perfect.  Besides delay smearing, over averaging can lead
to SNR loss when bandpass calibration is done.  This is because edge
channels are discarded as part of bandpass calibration because of the
frequency shifts required to adjust for the effects of the fringe
rotators (Doppler effect, essentially).

For spectral line observations, the DiFX correlator can do a vary large
number of channels - "it's just software".  But excessive numbers
of channels lead to excessive output data rates and data set sizes.
Up to 4096 channels per baseband channel are supported normally and
up to 32768 channels can be supported if needed and justified.  There
are no special restrictions in full polarization mode.  The 32768 limit
is set by the AIPS postprocessing path.  Requesting too
many channels can cause the data sets to be so large as to be
difficult to impossible to manage.  Also, the combination of the
average time, the number of channels, and the number of baselines must
be such that the output data rate is less than 10 Mbyte/sec.  That is
per second of observe time.  The
data rate in bytes/sec is given APPROXIMATELY as

    4 * Ns * (Ns + 1) * Nc * Nsp * P / Tavg

 where Ns   = number of stations
       Nc   = number of (BaseBand) channels (1, 2, ... 16)
       Nsp  = spectral resolution (8, 16, 32 ... 512)
       P    = 2 for polarization, 1 for none
       Tavg = time average in seconds

The second argument can be used to specify the size of the FFT used in
correlators such as DiFX.  Normally that argument can be ignored and
the FFT size will be set to the larger of 128 or the first argument.
The ability to set that argument is provided in support of the multiple
phase center capability added to DiFX in 2010.  When using that
option, the spectral resolution of the transforms done before the
different phase centers are split must be high enough that the
differential delays, which show up in the data as a phase slope in
frequency, do not cause smearing.  See the discussion of
{\hyperref[SEC:MULTIPLE_CENTERS]{multiple phase center processing}} for
more details advice.

Note the correlation parameters {\tt CORAVG, CORCHAN,
CORPOL, CORTAPE,} and {\tt CORSHIPn} must be specified when
the project will be correlated in Socorro and data
are being recorded.

\rcwbox
{Two integer numbers, usually a power of 2.}
{Any, but see above for useful numbers.}
{The first argument must be specified for the VLBA correlator.
Otherwise it defaults to 16.  The second argument defaults 128}
{Only one pair of values is used --- the last.}
{{\tt CORCHAN = 32} or {\tt CORCHAN=16,2048}}


\subsubsection{\label{MP:CORDFMT}{\tt CORDFMT}}

Data correlated at the VLBA is always archived.  Most has been
converted to FITS files for use with astronomical processing software.
Some is now being converted to the types of files produced on the
Mark4 correlators (Haystack etc).  Those data can be processed through
the geodetic oriented programs including Fourfit.  To request production
of a Mark4 file, specify "{\tt CORDFMT = MARK4}".

\rcwbox
{A character string of up to 8 characters.}
{Any, should be FITS or MARK4.}
{Defaults to 'FITS'}
{Only one value is used --- the last.}
{{\tt CORDFMT=MARK4} or {\tt CORCHAN=16,2048}}


\subsubsection{\label{MP:CORNANT}{\tt CORNANT}}

{\tt CORNANT} informs correlator operations of the number of stations
scheduled.  This helps determine when all logs and media are in and
helps determine what the correlator load, both in terms of drives
needed and output data rate, will be.  See the discussion of
{\hyperref[MP:CORCHAN]{{\tt CORCHAN}}} for a formula to calculate
the output data rate.

The default value for {\tt CORNANT} is the number of antennas scheduled
which will nearly always be correct.  There should be no need to specify
a number other than in some special, very strange cases such as when more
antennas are scheduled than will be correlated.

\rcwbox
{An integer number.}
{Any, but it should be the expected number of antennas.}
{Number of antennas in schedule.}
{Only one value used --- the last.}
{{\tt CORNANT = 10}}


\subsubsection{\label{MP:CORNOTE}
{\tt CORNOTE1, CORNOTE2, CORNOTE3,} and {\tt CORNOTE4}}

{\tt CORNOTE1, CORNOTE2, CORNOTE3,} and {\tt CORNOTE4} provide four
text strings with which to pass information to correlator operations
staff.

This can be used to alert correlator operations to special
requirements such as multiple phase centers, special positions,
non-constant processing parameters etc.

\rcwbox
{Each parameter is a string of up to 128 characters}
{An address}
{Blank}
{Only one of each used --- the last.}
{{\tt CORNOTE1 = 'Please run the FD tape backwards.' }}


\subsubsection{\label{MP:CORPOL}{\tt CORPOL}}

{\tt CORPOL} can be either ``on'' or ``off''.  If it is ``on'',
all polarizations (RR, LL, RL, and LR) will be done.  If ``off'',
only the parallel hand polarizations (RR and LL) will be correlated.
Requesting full polarization (``on'') reduces the maximum number
of spectral channels per baseband channel available and increases
the output data rate.  However for continuum projects with modest
average times and 16 or 32 channels, neither of these is of much
concern and there is little harm in asking for full polarization
processing.  Perhaps the data will even be useful eventually.

Note the correlation parameters {\tt CORAVG, CORCHAN,
CORPOL, CORTAPE,} and {\tt CORSHIPn} must be specified when
the project will be correlated in Socorro and data
are being recorded.

\rcwbox
{Any 3 characters.}
{``on'' or ``off'' are the useful values.}
{Required for VLBA correlator, otherwise ``on''.}
{Only one value used --- the last.}
{{\tt CORPOL = 'on'}}

\subsubsection{\label{MP:CORREL}{\tt CORREL}}

{\tt CORREL} specifies the correlator to which VLBI media and logs
should be sent. This is for the cover information.  \schedb will abort
if this parameter is not given unless this is a VLA only observation
or a single dish observation (eg VLBA pointing).  Allowed values are
Socorro, VLBA, Haystack, Bonn, JIVE, Washington, USNO, Jpl, Bologna,
Mitaka, Penticton, ASC,  and Other (which should be followed by the name).
The name is not case sensitive.

The first word of {\tt CORREL} must be one of:
\begin{list}{}{\parsep 0em  \itemsep 0em }
\item {\tt Socorro}, {\tt VLBA}, or {\tt VLBADIFX}
(VLBA DiFX software correlator)
\item {\tt Haystack},
\item {\tt Bonn (MPIfR DiFX correlator)},
\item {\tt JIVE},
\item {\tt Washington} or {\tt USNO},
\item {\tt LBA},
\item {\tt JPL},
\item {\tt Bologna},
\item {\tt Mitaka},
\item {\tt ASC (Astro Space Center - Moscow)}
\item {\tt Penticton}, or
\item {\tt Other}
\item {\tt FXCORR} (Original VLBA hardware correlator --- no longer 
exists so \schedb will stop.)
\end{list}

Note the correlation parameters {\tt CORAVG, CORCHAN,
CORPOL, CORTAPE,} and {\tt CORSHIPn} must be specified when
the project will be correlated in Socorro and data
are being recorded.

\rcwbox
{Text up to 62 characters.}
{See list above for valid options.}
{Blank which causes \schedb to abort.}
{Only one value used, the last.}
{{\tt CORREL=VLBADIFX}}


\subsubsection{\label{MP:CORSRCS}{\tt CORSRCS}}

{\tt CORSRCS} is a character string instructing the correlator
staff where to get the source coordinates.  {\tt STANDARD}
will imply to get them from the correlator catalog.  This is
an extensive list of sources based on USNO geodetic/astrometric
solutions or, for sources for which VLBI positions are not
known, from the VLA calibrator list.  {\tt SCHEDULE} will
mean to get the positions from those used in this schedule.
Other statements can be made - this information will be
read by the correlator operations staff.  If more room is
needed, see the 
{\hyperref[MP:CORNOTE]{{\tt CORNOTE}}} parameters.

\rcwbox
{Text of up to 64 characters.}
{{\tt STANDARD} and {\tt SCHEDULE} are useful.  Others can be
used.}
{{\tt STANDARD}}
{Only one used --- the last.}
{{\tt CORSRCS = 'PI will provide before correlation.'}}

\subsubsection{\label{MP:CORSHIP}
{\tt CORSHIP1, CORSHIP2, CORSHIP3,} and {\tt CORSHIP4}}

{\tt CORSHIP1, CORSHIP2, CORSHIP3,} and {\tt CORSHIP4} provide four
character strings in which to specify the place to ship the
correlator distribution .

Note the correlation parameters {\tt CORREL, CORAVG, CORCHAN,
CORPOL,} and {\tt CORSHIPn} (if {\tt CORTAPE = DAT} or {\tt EXABYTE}) must
be specified when the project will be correlated in Socorro and data
are being recorded.

\rcwbox
{Each parameter is a string of up to 64 characters}
{An address}
{Blank --- Which causes and abort if you requested shipable media.}
{Only one of each used --- the last.}
{{\tt CORSHIP1 = 'Phil Diamond' }\\
{\tt CORSHIP2 = 'NRAO'} \\
{\tt CORSHIP3 = 'P.O. Box O' } \\
{\tt CORSHIP4 = 'Socorro, NM, 87801' } }

\subsubsection{\label{MP:CORTAPE}{\tt CORTAPE}}

{\tt CORTAPE} specifies the type of media that should be used for the
data distribution from the correlator.  This must be {\tt FTP}, {\tt
DAT}, {\tt DISK} or {\tt NONE}.  {\tt FTP} and {\tt NONE} basically
mean that the PI will pick up a disk copy of the data by means of a
network copy (there is no effective difference between the two).
EXABYTE was recently removed for lack of use, as 9TRACK was long ago.
DAT will likely go soon.  FLASH may get added some day, but not yet.  

\rcwbox
{A string of up to 16 characters}
{DAT, DISK, NONE, or FTP}
{Blank, which causes and abort if data are being recorded.}
{Only one used --- the last.}
{{\tt CORTAPE = 'DISK'}}

\subsubsection{\label{MP:CORWTFN}{\tt CORWTFN}}

{\tt CORWTFN} specifies the weighting function to be used on the VLBA
correlator.  The weighting function is applied by weighting the data
points before they are sent to the FFT.  Valid options are:

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item {\tt UNIFORM}.  No weights are applied.  The data are used
as is.  The is the option that most users will want.

\item {\tt ZEROPAD}.  With this option, the input data for the
FFTs are padded with zeros by a factor of two.  This reduces the
resolution of each spectral point.  With the FX correlator, the
frequency response of each spectral channel is sharper than with
an XF correlator and this may not be what is desired for some
spectral line observations.  If so, {\tt ZEROPAD} is a way to
reduce the effect.  Actually reproducing the frequency response
of an XF correlator is possible in theory, but not with any
of the available windowing functions.  Note that {\tt ZEROPAD}
should not be used with the 1:4 fan out because that causes
there to be no overlapping of FFTs so half the data are not used.

\item {\tt HANNING}.  With this option, a Hanning weighting is
applied in before the FFT.  This is done in the voltage (sample)
domain and has the effect, after cross correlation, of applying
a ``Hanning squared'' weighting on the final power spectra.  This
is probably not what the user wants.

\item {\tt QANNING}.  With this option, an approximation of a
``root Hanning'' weighting is applied to get close to the expected
Hanning response in the power domain after correlation.  It is
only an approximation because the windowing function cannot have
the negative values that would be required to do this exactly.

\end{list}

Eventually more options may be available.

\rcwbox
{Any text string of up to 16 characters}
{{\tt UNIFORM} and {\tt HANNING} are the useful options.}
{{\tt UNIFORM}}
{Only one value used --- the last.}
{{\tt CORWTFN = 'HANNING'}}

\subsubsection{\label{MP:COVERLET}{\tt COVERLET}}

{\tt COVERLET} alerts the program that all lines after the next '/'
and up the the occurrence of 'endcover' and '/' on a line will be text
that is to be transferred to the summary and operator schedule files
(sch. files).  This allows the PI to write a cover letter that will
make it into files that the operators at at least some stations will
see, hopefully eliminating the need to write a separate cover letter
file.  The amount of text is arbitrary and the line need only be
shorter than 256 characters.  Lines over about 80 characters may not
look good in the output.

Note that the operators at some telescopes, including the VLBA, do
not pay much attention to what is in the files.  Cover letters
of any type are not very effective.  Your observation should be
described well by the parameters that actually control telescope
operations.  Cover letters can be effective for observatories where
some operations have to be done by hand.

The {\sl egglobal.key} example shows the use of {\tt COVERLET}.

\rcwbox
{none}
{No argument required or useful.}
{It will be assumed that there is no cover letter.}
{Only use preceding the cover letter input.}
{{\tt COVERLET /}}


\subsubsection{\label{MP:CRDBW}{\tt CRDBW}}

{\tt CRDBW} is used in the main schedule when using either 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}} or 
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}}
to set frequencies on the VLBA for the legacy system that are 
different from what is set for the RDBE.  This is mainly to allow
Doppler setting for masers for reference pointing, which is recommended
at 86 GHz.  See 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}} for more
details.

The channels should correspond to the channels in the current setup
file because configuration information like the IF, first LO, sideband,
etc will be taken from the setup.  Only 8 channels will actually get
used as, when the RDBE is in use, for bookkeeping ease, only one channel
will be assigned to each bbc.

This parameter is equivalent to BW, but is only for use when using the
RDBE but wanting different settings in the old system.  It will be
ignored except on the VLBA using the RDBE.

Any unset values will be set to the same as the first channel.  It is
good practice to set to 0.D0 when not in use, which may require setting
all channels explicitly.

\rcwbox
{A list of bandwidths in MHz, one per channel.}
{0.0625, 0.125, 0.250, 0.5, 1, 2, 4, 8, or 16 MHz}
{It is required if {\tt CRDFREQ} or {\tt CRDDOP} is used.}
{Retains the value from the previous scan if not set.}
{{\tt CRDBW= 2.0, 2.0, 2.0, 2.0 /}}

\subsubsection{\label{MP:CRDDOP}{{\tt CRDDOP} and {\tt CRDNODOP}}}

{\tt CRDDOP} requests Doppler frequency setting for the VLBA legacy
system BBCs.  It is much like 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}
except that it should only affect the BBCs, not the RDBE.  This is
needed because the legacy system still controls the antenna pointing
and does not have access to power levels from the RDBEs, which are
controlled by the separate new control system.  The total power 
data from the legacy BBCs are used to make the pointing measurements.
See the discussion of 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}} for more
details about using the {\tt CRDxx} parameters.

When using {\tt CRDDOP}, you must also set 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}} and one (and only one) of 
{\hyperref[MP:CRDCH1]{{\tt CRDCH1}}}
or 
{\hyperref[MP:CRDSETCH]{{\tt CRDSETCH}}}.  

As an alternative to requesting \schedb do Doppler
calculations, you can force a specific frequency with 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}}.

Specify {\tt CRDNODOP} to turn off the BBC Doppler setting.

It is not recommended to attempt to use {\tt DOPPLER} and {\tt CRDDOP}
at the same time, although it might work.

\rcwbox
{No argument}
{None}
{Do not use {\tt CRDDOP}}
{Uses previous scan value if not specified}
{{\tt CRDDOP}}

\subsubsection{\label{MP:CRDLINE}{\tt CRDLINE}}

{\tt CRDLINE} allows the scheduler to insert an arbitrary string
into the crd control files for VLBA antennas.  It is intended to
simplify the testing of new features by someone programming the
on-line system.  You almost certainly don't want to use this parameter
unless you are a VLBA programmer.

\rcwbox
{A character string of up to 80 characters.}
{Any character string.}
{Blank}
{One per scan.  Remains at most recent value set.}
{{\tt CRDLINE = 'This was requested by Walter'}}


\subsubsection{\label{MP:CRDCH1}{\tt CRDCH1}}

When setting parameters for the VLBA legacy hardware different from
what is being set for the RDBE, parameters 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}}, 
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}},
{\hyperref[MP:CRDNCH]{{\tt CRDNCH}}}, 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}}, 
{\hyperref[MP:CRDSETCH]{{\tt CRDSETCH}}}, and 
{\tt CRDCH1} can be used.  Many of the channel parameters are taken
from the main setup.  These include sideband, sample rate, IF channel
etc.  With the legacy system ``CRD'' parameters, only 4 channels (8
before early 2014) can be specified.  With the RDBE\_PFB, the number
of setup channels is 16 while it can be up to 8 with the RDBE\_DDC.
By default, \schedb will try to spread the crd channels broadly over
the setup channels and, in particular, will try to have at least one
crd channel from each IF.  {\tt CRDCH1} gives the opportunity to
specify the first channel of a contiguous block of {\tt CRDNCH}
channels to use.  Alternatively, one can use 
{\hyperref[MP:CRDSETCH]{{\tt CRDSETCH}}}
to specify the template channels individually
--- probably the preferred option if not taking the default.

\rcwbox
{An integer}
{Any integer 16 or less}
{\schedb has an algorithm for distributing the channels broadly, 
making sure all IFs are represented.}
{One per scan.  Defaults to last value.}
{{\tt CHDCH1 = 5}}

\subsubsection{\label{MP:CRDNCH}{\tt CRDNCH}}

{\tt CRDNCH} sets the number of channels to use on the legacy VLBA
hardware (BBCs especially) when using the RDBE.  The main reason for
being concerned about the legacy hardware is that the power levels in
the BBCs are used by the old control system to do reference pointing.
See also 
{\hyperref[MP:CRDFREQ]{{\tt CRDFREQ}}}, 
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}}, 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}}, 
{\hyperref[MP:CRDCH1]{{\tt CRDCH1}}}
for controls related to such reference pointing,
especially with masers.

{\tt CRDNCH} is a required parameter when CRDFREQ or CRDDOP are set.

When not using CRDFREQ or CRDDOP, {\tt CRDNCH} will still set the number 
of channels used in the crd files controlling the BBCs.  If CRDFREQ and 
CRDDOP are never used, CRDNCH will be set to lesser of 4 (the number of
BBCs after April 2014) and the number of setup channels.

When {\tt CRDNCH} is less than the number of channels in the main setup
(typical if using the RDBE\_PFB), then the alignment between the main
setup channels and the legacy system channels can be set using
{\hyperref[MP:CRDCH1]{{\tt CRDCH1}}}

\rcwbox
{An integer}
{Any integer 4 or less}
{The lesser of {\sl NCHAN} for the setup and 4 (number of BBCs after 
April 2014.)}
{One per scan.  Defaults to last value.}
{{\tt CHDNCH = 2}}

\subsubsection{\label{MP:CRDFREQ}{\tt CRDFREQ}}

This parameter is equivalent to 
{\hyperref[MP:FREQ]{{\tt FREQ}}}, but is
only for use when using the RDBE but wanting different settings in the
old system.  It will be ignored except on the VLBA using the RDBE.
The main use will be for 86 GHz observations using the PFB personality
of the RDBE.  With the PFB, the bandwidth per channel can only be 32
MHz and the frequencies are not flexible.  To reference point on
masers, it is necessary to use the legacy BBCs with narrower
bandwidths and with frequencies that are not closely related to the
main setup frequencies.  Such settings can be determined from Doppler
calculations using 
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}} or set explicitly
using {\tt CRDFREQ}.  Note that 
{\hyperref[MP:CRDBW]{{\tt CRDBW}}} must
also be set if either of these options is used.

When {\tt CRDFREQ} or 
{\hyperref[MP:CRDDOP]{{\tt CRDDOP}}} is used, the
resulting frequencies appear in the {\sl xxcrd.ss} files that control
the VLBA legacy system.  They do not appear in the VEX file.  As of
this writing, they also don't appear on the summary file, although
changes can trigger specification of a new setup group that may not
obviously be different from another group, if the only change is 
in the setup parameters.

Any unset values of {\tt CRDFREQ} will be set to the same as the first
channel' value.  It is good practice to set to 0.D0 when not in use,
which may require setting all channels explicitly.

It is expected that this capability will be retired when the new
control system takes over antenna pointing.  At that time, any projects
requiring reference pointing on masers will need to use the DDC
personality of the RDBE, which allows fine tuning and narrow bandwidths.

\rcwbox
{A list of RF frequencies in MHz, one per channel.}
{Any allowed RF frequency MHz}
{Use values based on the setup file, with adjustments based on the
limitations of the BBCs relative to the RDBE}
{Retains the value from the previous scan if not set.}
{{\tt CRDFREQ= 43122.03, 43122.03 /}}



\subsubsection{\label{MP:CRDSETCH}{\tt CRDSETCH}}

{\tt CRDSETCH} is a list of setup file baseband channels to use for
many channel dependent parameters such as IF channel, polarization,
etc when setting up the channels for the VLBA legacy system.  There
can be as many entries as there are legacy system channels.  As of
early 2014 when 4 BBCs are being removed, that number is only 4.  The
effect is only on the crd files, not the Vex file.

This parameter can be very important when using the S/X system on
the VLBA.  The new VLBA control system will know that both S and X
band receivers are in use and will set the hardware accordingly.  
Critically, it will or will not deploy the ellipsoidal reflector over
the X band receiver.  If the channels sent to the legacy control 
computer (the crd files) do not contain any S band channels, then
that system will think this is an X band only observation.  It has
control of the subreflector so it will point the subreflector at 
the X band receiver.  But that optical path is now blocked by the
ellipsoid.  So no source data will get through.  However all other
parameters like system temperature and pulse cal will look ok.  You
end up with hard-to-diagnose lack of fringes.  This situation can,
and has (guess how we know about this!) happened when there are many
X band channels and only a few S band channels as is likely when
using the RDBE\_PFB.

\rcwbox
{A list of setup file channel numbers - up to 4.  This can be changed
on a scan basis}
{Any channels}
{If not used, and {\tt CRDNCH} is not used, \schedb will make a
reasonable selection, including making sure all IF channels are
represented.}
{Defaults to previous scan}
{{\tt CRDSETCH = 3,4,7,8}}


\subsubsection{\label{MP:DATAPATH}{\tt DATAPATH}}

This is an eVLBI control parameter.  Be warned: eVLBI support is
under development.
The eVLBI parameters are 
{\hyperref[MP:GRABTO]{{\tt GRABTO}}},
{\hyperref[MP:GRABTIME]{{\tt GRABTIME}}}, 
{\hyperref[MP:GRABGAP]{{\tt GRABGAP}}},
and 
{\hyperref[MP:DATAPATH]{{\tt DATAPATH}}}.

{\tt DATAPATH} determines where the main data flow goes.  It is meant to
be used with systems like Mark5 that have an eVLBI (over the net)
capability.  The data can either go to disk as in normal observing
{\tt DATAPATH=IN2DISK} or it can go directly to the network
{\tt DATAPATH=IN2NET}.

When the data are sent to disk, there is an option to send small amounts
over the network later for fringe checks and the like.  That option is
controlled by the {\tt GRAB...} parameters.

\rcwbox
{ Character string of up to 8 characters.}
{  {\tt IN2DISK} for normal recording to disk or tape - the default.
{\tt 'IN2NET'} for real time eVLBI with correlation or recording
at a remote location.}
{{\tt IN2DISK}}
{A value for each scan.  Defaults to previous scan.}
{{\tt DATAPATH = 'IN2NET' }}


\subsubsection{\label{MP:DAY}{\tt DAY}}

{\tt DAY} is the day number of {\em stop} time of scan. Day 1
is the first day of the month specified with the {\tt MONTH}
parameter, which defaults to 1 so that {\tt DAY} is the day of
year. If {\tt LST} was specified, {\tt DAY} must be the (modified?)
local sidereal day number for the reference station. These numbers are
printed on the right side of VLA monthly schedules and are near 56800
in 1996.

\rcwbox
{Integer.}
{Any.}
{Required for first scan - no default.}
{Defaults to previous scan. Only need for first scan if using
durations even if project crosses day boundary.}
{{\tt DAY=135}}


\subsubsection{\label{MP:DEBUG}{\tt DEBUG}}

{\tt DEBUG} is a switch that turns on some debug printouts.  It is
unlikely to be useful to users, only to programmers.


\subsubsection{\label{MP:DODOWN}{\tt DODOWN}}

Normally, \schedb eliminates stations for which the source is not up
if they are using a disk recording system.  {\tt DODOWN} with no
argument overrides that behavior and keeps stations in scans
regardless.  DODOWN can be set differently for each scan.  Setting
it to any non-zero value sets it to false (ie - go ahead and remove
stations).

In the tape era, only VLBA stations were eliminated and only if
{\hyperref[MP:AUTOTAPE]{{\tt AUTOTAPE}}} was set to 2.

Without {\tt DODOWN}, \schedb will also take a station out of a scan
if the predicted slew time is such that the antenna will not reach the
source before the scan end.  However, it was found that this can
prevent wraps from occurring in a timely manner during fast switching
operations such as phase referencing, when one source needs the wrap a
while before the other.  Therefore, \schedb will not remove a station
from a scan if mount type is ALTAZ and the requested azimuth slew is
greater then 315 degrees.  Such long azimuth slews would normally mean
that a wrap is needed so getting it started is useful.  There is no
perfect algorithm to always do the right thing here so some though may
be required by the PI if the behavior is odd.  {\tt DODOWN} is now
scan dependent to help with dealing with odd behavior.  Also
explicitly including or excluding stations from the scan can be a
strong tool for dealing with problems.  Beware of special instructions
when there is a chance that a program will be time shifted for dynamic
scheduling.  That will change when things like wraps need to happen.

Note that \schedb does not presume to tell the antenna what wrap to be
on, mainly because there is no mechanism to do so with the VLBA.  Some
day this may change in which case \schedb can be more intelligent
about what to do.  For now all \schedb can do is control what scans
are present and guess what the antenna will do.

\rcwbox
{None}
{No argument}
{Stations taken out of scans ({\tt DODOWN} not zero)}
{One per scan.  Defaults to previous value.}
{{\tt DODOWN} or {\tt DODOWN=-1}}


\subsubsection{\label{MP:DOMKA}{\tt DOMKA}}

{\tt DOMKA} (read DO-MKA) is a switch to request that, when observing
with the RDBE and MARK5C, that a parallel MARK5A recording be made.
It is expected to be used mainly for testing.

\rcwbox
{None}
{No argument}
{No Mark5A)}
{Only last used.}
{{\tt DOMKA}}



\subsubsection{\label{MP:DOPCAL}{\tt DOPCAL}}

{\tt DOPCAL} is an obsolete form of the parameter
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}.
It is no longer recommended because of possible confusion with
{\em DO PCAL}.

\subsubsection{\label{MP:DOPINCR}{\tt DOPINCR}}

{\tt DOPINCR} sets the frequency increments to use in setting
frequencies using 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}.  The
frequencies will be rounded to the nearest {\tt N * DOPINCR(1) +
DOPINCR(2)}.  The default for {\tt DOPINCR(1)} when the RDBE is not in
use is 10 kHz, the setting interval for the BBCs for the DBBC, LBA,
and the legacy VLBA and Mark~III/IV systems.  For the {\tt RDBE\_DDC}
option for {\tt DBE}, the default is 15.625 kHz.  For mixed
legacy/DBBC/MARKIV and RDBE observations systems, the default is 250
kHz, the smallest value that is a multiple of both 10 kHz and 15.625
kHz.  It is best not to use DOPPLER with the RDBE\_PFB personality
because of the tight tuning restrictions and the fact that the offset
{\tt DOPINCR(2)} depends on the LO setup.  The ATCA LO is set in
intervals of 1 MHz + 0.5 MHz.

The values are in kHz.  A new value may be given for each scan,
although usually a single value would be used for the whole
experiment.

\rcwbox
{A number specifying a frequency in kHz.}
{Any number.}
{Depends on DBE --- see text.}
{A value for each scan.  Defaults to previous scan.}
{{\tt DOPINCR = 1000,500} (appropriate for ATNF 20 GHz)}


\subsubsection{\label{MP:DOPPLER}{\tt DOPPLER} and {\tt NODOP}}

{\tt DOPPLER} and {\tt NODOP} control Doppler calculations for this
scan.  {\tt DOPPLER} turns them on, {\tt NODOP} turns them off.
See Section~\ref{SEC:LINE} for details.

Note that channels assigned to the same BBC will be given the same
frequency as the first channel on that BBC, no matter what velocities
etc are given for the other channels.  This will be the case when
there are upper/lower sideband pairs.  Their frequencies cannot
be set independently.  Because of the different sidebands, they
will, however, cover different velocity ranges.

WARNING --- if you are making extragalactic observations with high
velocities (above about 1000 km/s), be sure to pay attention to the
parameters {\tt VREF} and {\tt VDEF} in the source catalog.
Extragalactic velocities are likely to be based on the ``optical
definition'' which is not the \schedb default.  Also, they are likely
to be heliocentric, which is also not the \schedb
default.  In such a case, you would want to specify {\tt VDEF=O
VREF=H}.  Note that you are also allowed to give z directly with
{\tt VDEF=Z}.

\rcwbox
{None.}
{{\tt 0} or nothing to get Doppler calculations. A non-zero value will
turn them off, but use of {\tt NODOP} is a more convenient way to
do the same thing.}
{Don't do Doppler calculations.}
{Reverts to previous scan.}
{{\tt DOPPLER}}

\subsubsection{\label{MP:DOSCANS}{\tt DOSCANS}}

The user can specify optional scans on the ends of a project using
the 
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}} parameter.  Those scans will
be shown in the summary file {\sl .sum file}, but will not be sent 
to the telescope control and others files ({\sl .vex, crd.xx, sch.xx,
.oms} and {\sl .flag} files.  To actually utilize those scans, or for
that matter, any arbitrary subset of all the input scans, specify
the range of desired output scans with {\tt DOSCANS}.  The arguments
are the scan numbers of the first and last scans as they appear in 
the summary file.  

It is intended that {\tt DOSCANS} be used mainly by the VLBA scheduler
while trying to put together dynamic schedules.  It is often hard to
find projects that mesh together exactly without leaving gaps.  The
{\tt PREEMPT=EXTRA} and {\tt DOSCANS} parameters are intended to let
users provide productive observations to make during such otherwise
unfilled gaps.

Note that {\tt DOSCANS} can be used in conjunction with parameter
{\hyperref[MP:WRAP24]{{\tt WRAP24}}} to rotate the start point of
full day schedules around the clock for more convenient dynamic
scheduling.

\rcwbox
{Two integers}
{Values that correspond to scan numbers in the {\sl .sum} file}
{zero - don't use this scan restriction}
{One set of values used for the whole project}
{{\tt DOSCANS = 154, 367}}


\subsubsection{\label{MP:DOPSRC}{\tt DOPSRC}}

{\tt DOPSRC} is the name of the source for which the Doppler
calculation should be done. This is allowed to be different from the
source being observed to allow for observing continuum calibrators at
the same frequency as the line source. If it is blank, the source
being observed will be used. If it is not specified, the previous
value will be used so it must be set to blank after use in earlier
scans if it is desired to return to the original default.

A warning will be issued if {\tt SOURCE} and {\tt DOPSRC} are
different and both have velocities specified (assumed to be line
sources).   This is a valid but unlikely observing style so it
is not blocked.  But too often it has been the result of ignoring
the warning above about the defaulting behavior of {\tt DOPSRC}.

\rcwbox
{A source name.}
{Any source in the source catalogs.}
{Blank - use {\tt SOURCE}.}
{Reverts to previous scan. Can set to {\tt ' '} to return to default
behavior.}
{{\tt DOPSRC='W3OH'}}

\subsubsection{\label{MP:DOSTA}{\tt DOSTA}}

{\tt DOSTA} tells \schedb to process only those stations whose
names match the value given for {\tt DOSTA} to as many characters as
given for {\tt DOSTA}. This is intended primarily for telescope
friends who wish to rerun \schedb using the keyin file provided by
the observer and who do not want output for all stations. Requiring a
match only on the specified characters allows {\tt DOSTA='VL'} to be
specified to obtain all VLBA and VLA files.  DOSTA affects the
stations read for the current scan.  Normally it would be specified
among the first set of inputs and not changed.  In this case, it will
affect the whole schedule.

\rcwbox
{Text of up to 8 characters.}
{Any station name or portion thereof.}
{None}
{Defaults to previous scan.}
{{\tt DOSTA='VLBA'} makes all VLBA files.}

\subsubsection{\label{MP:DOVEX}{\tt DOVEX}}

{\tt DOVEX} tells \schedb to write a VEX format output file. It is now
the default so the parameter can be used to turn off writing of the
VEX file.  VEX is the format originally used by PCFS, the NASA/Goddard
field system that controls EVN, geodetic and other stations. It is now
used to control most correlators including the VLBA and other DifX
correlators, the JIVE correlator and the geodetic correlators based on
the Haystack design.  VEX files will also eventually be used for
control of the VLBA stations and the EVLA for VLBI.  So a VEX file is
required for essentially all VLBI observations now.


\rcwbox
{None.}
{No argument required.  If one given, DOVEX will be false.}
{DOVEX will be true unless given a non-zero argument.}
{Only one value used --- the last.}
{{\tt DOVEX=-1 --- to turn VEX outputoff}}


\subsubsection{\label{MP:DUR}{\tt DURation}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt DURation} specifies the length of the current scan. Usually this
is used instead of 
{\hyperref[MP:STOP]{{\tt STOP}}}. It is assumed to be
a UT time interval unless 
{\hyperref[MP:LST]{{\tt LST}}} was specified,
in which case it was assumed to be an LST time interval.
{\hyperref[MP:DWELL]{{\tt DWELL}}} is a very similar parameter except
that, with {\tt DURation}, the scan starts 
{\hyperref[MP:GAP]{{\tt GAP}}}
seconds (perhaps adjusted by the old parameter {\tt PRESCAN} after the
previous stop time while with {\tt DWELL}, the scan will start at least
{\hyperref[MP:GAP]{{\tt GAP}}} seconds after the previous stop time, but,
if necessary, will wait longer to allow all antennas to reach the
source.

Note that {\tt DUR} and 
{\hyperref[MP:DWELL]{{\tt DWELL}}}
may be both be used in the same schedule, but cannot both be used
for the same scan (that would not make sense).  If either is used,
the time specified overrides any previous specification of the
scan length made with either parameter.

Once the nominal scan start time has been specified as above it can be
adjusted further with the old, and mostly obsolete, parameter
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}.  Then the actual time that
recording starts is adjusted further with 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} and 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}.
{\tt PRESTART}, {\tt MINPAUSE}, and {\tt PRESCAN} allow the user to
start recording early to give the correlator a chance to synchronize
before the start of good data.  {\tt PRESTART} can also be used to
delay the scan start to be more sure it starts on good data --- mostly
useful with {\tt DWELL}.  These parameters also can help prevent short
stoppages which used to cause problems with playback with tape
systems.  Adjusting the media start time should no longer be needed
for correlators and recording systems currently in use (eg MARK5 and
DiFX).  See the descriptions of the parameters mentioned for more
information.  The \schedb defaults are generally reasonable so, if you
are not an experienced user who wants to exercise fine control of
recording management, don't worry about these parameters.

The start and stop times reported in the summary and operator schedule
files are the same for all stations.  They take into account any
adjustments made as a result of specifying 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}},
but do not take into account adjustments requested using
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} and 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}},
since those can be station dependent.  The
time the media is started is reported in the {\sl sch.xx} files
under the heading ''TPStart''.

With the VLBA RDBE recording system and DiFX correlators, both
recording and correlation start times ignore most of the efforts by
\schedb to adjust recorder start times.  They treat the data-good time
as given as an offset from the start time in the \$SCHED section of
the VEX file as the time to start handling data.  In the \$SCHED
section, there can be two start times, one commented out (line starts
with ``*'').  The commented one is the nominal start time as seen in
the \schedb summary file.  The active one is what \schedb thinks is
the media start time, usually the nominal start time minus {\tt
PRESTART}.  Then on each station line, there are two offset times, one
for the start and one for the stop.  The start is greater of zero and
the time when \schedb thinks the data will be good (on-source etc).
That is what is used by the VLBA to start recording and DiFX to start
correlation.  So effectively, even when using duration scheduling, you
are fairly likely to actually be using dwell scheduling.

See the 
{\hyperref[SSEC:SCANTIMES]{Scan Times}} section for more
information on the specification of scans.

\rcwbox
{A time in format {\tt hh:mm:ss}, {\tt mm:ss}, or {\tt ss}.}
{Any.}
{Not used.}
{Defaults to previous scan. Overridden by {\tt DWELL}.}
{{\tt DUR=13:00}}


\subsubsection{\label{MP:DWELL}{\tt DWELL}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt DWELL} is an alternate way to specify the duration of a scan.  It
is distinguished from 
{\hyperref[MP:DUR]{{\tt DURation}}} only in that
the start time of the scan will be delayed until \schedb expects all
antennas to be on source.  Both the slew time, including acceleration,
and the settling time from {\tt TSETTLE} in the 
{\hyperref[SEC:STACAT]{station catalog}}
will be taken into account.  The interval between
scans will not be allowed to drop below {\tt MINSETUP} from the
antenna catalog to allow for finite scan setup times at some antennas.
\schedb tries to arrange that useful data will be obtained for the
full time specified by {\tt DWELL}.  With 
{\hyperref[MP:DUR]{{\tt DURation}}},
some of the specified time may not have good data
because antennas are still slewing.  Please see the description of
{\hyperref[MP:DUR]{{\tt DURation}}} for a more complete discussion of the
actions of these two parameters and their interactions with other
parameters that influence scan times and recording activity.

As of Oct. 2010, {\tt DWELL} has acquired second and third arguments.
Argument 2 is the number of antennas to not wait for.  Typically it
will be a small integer like 1 or 2, but can be up to the number of
antennas (not sure what that would do!).  This should be useful if the
there is a problem with long slews between pairs of sources near the
zenith at one antenna.  It would also be useful if you wish to let the
less sensitive, but faster, antennas start observing once they are on
source on the assumption that large, slow antennas might not need as
much integration time.  This is an issue with global observations or
HSA.  
{\hyperref[MP:SUMITEM]{{\tt SUMITEM}}} {\tt = EARLY} can be used
to inspect the results of the use of the second {\tt DWELL} argument.
For example, with that argument set to one, one antenna should have
{\tt EARLY} negative (got there after the start).

The third argument is a minimum time on source for the antennas that
are not being waited for thanks to argument 2.  The default zero for
this argument allows the scan to end before the slow antenna(s) get to
source.  If a time is specified, then the scan will be extended until
the last antenna gets that much time.  In such a circumstances, the
scan will still start when first group of antennas (other than those
the second argument says not to wait for) get to source, so those
antennas will get a longer scan than specified.

Please note that the model \schedb uses to calculate slew times is
not especially sophisticated, especially in regard to the excess
times beyond the slew that an antenna might take to start getting
good data.  It is adequate for most purposes, but, for example, it
might not agree exactly with other programs such as the VLA
scheduling program Observe.  In such cases, the station specific
program probably has the better answer.  Also, for some systems,
such as the VLA, \schedb is more interested in when VLBI data
starts to be good which might be before a local correlator starts
to get good data.  As of Feb 2003, \schedb does take into account
the time an antenna takes to accelerate to full slew speed, and
should calculate slew times for short slews approximately correctly
even if full speed is not reached.

\rcwbox
{A time in any allowed time format (hh:mm:ss, mm:ss, sss etc.), followed
by an integer, and then another time.}
{Any time.  The integer should be smaller than the number of antennas.  The
second time is normally smaller than the first}
{The duration of the scan must be specified with some combination of
{\tt START, STOP, DURation,} and {\tt DWELL}.  The number of antennas to
not wait for defaults to zero as does the minimum time.}
{Reverts to previous scan.  Overridden by {\tt DUR}.  The second and
third arguments use the last setting in a {\tt DWELL} command (not
overridden by {\tt DUR})}
{{\tt DWELL=110,1,60} (which is equivalent to {\tt DWELL=1:50,1,1:00}).
{\tt DWELL=110} is equivalent to {\tt DWELL=110,0} except that the
latter will reset the second argument to zero if it had been something
else while the former will not.}


\subsubsection{\label{MP:ELCOLIM}\tt ELCOLIM}

{\tt ELCOLIM} can be used to specify an
increment to the elevation collimation offset value used for pointing.
This is added to the nominal position known by the on-line system
for the particular receiver and to the value specified in the setup
file.  It is also added to the values used for offsets in pointing
patterns and to any 
{\hyperref[SP:ELCOLIM]{value from the setup file.}}

\rcwbox
{A elevation collimation offset in arc minutes.}
{Any value.}
{0.0}
{Default to previous scan.}
{{\tt ELCOLIM = 0.25 }}



\subsubsection{\label{MP:EMAIL}{\tt EMAIL}}

{\tt EMAIL} gives the principal Investigator's electronic mail
address for the cover information.  Use an Internet address where
possible.  Either of EMAIL or FAX must be provided if recording
VLBI data.  Both should be provided.

\rcwbox
{Text of up to 64 characters.}
{Any.}
{Blank}
{Only one value used, the last.}
{{\tt EMAIL=cwalker@nrao.edu}}

\subsubsection{\label{MP:EPHFILE}{\tt EPHFILE}}

{\tt EPHFILE} is used to specify the location of the JPL ephemeris
file.  This is only needed if \schedb is being asked to calculate
the position of one or more objects using the ephemeris.  This is
done by including a recognized planet (or other body) name among
the sources and not providing a source catalog entry for it (if there
is a catalog entry, that is used instead).

The objects that \schedb understands are Mercury, Venus, Moon, Mars,
Jupiter, Saturn, Uranus, Neptune, Pluto, and Sun.  Topocentric
positions and rates will be provided for VLBA antennas if one of
these is specified.  Geocentric positions along with rates and
horizontal parallax are provided for the PM cards for the VLA.
Note that \schedb does not understand how to specify moving objects
to antennas that don't use the VLA or VLBA control file types.

Under unix, environment variables may be used.  For example, if
{\tt SCHED} is defined to mean {\tt /users/cwalker/sched}, the
base area under which all sched stuff is kept (substitute your
local directory), then one can specify the ephemeris file with
{\tt EPHFILE = \$SCHED/catalogs/newfile.eph}, if that were where
it is (it isn't!).  Use the {\tt setenv}
(c or t shell) or export (korn shell) to set environment variables.

At the AOC, for now, the ephemeris file is on Brian Butler's
computer in the location shown in the example below.  There is
also a copy in the \schedb catalogs subdirectory.

Note that if planetary observations specified to stations
that use the VEX file, the positions passed will not be
of adequate quality for correlation and maybe not for pointing.

\rcwbox
{Text of up to 80 characters - a file name.}
{Any valid file}
{'NONE'}
{Only one value used, the last.}
{{\tt EPHFILE=/planets/ephemeris/JPLEPH.403.2}}

\subsubsection{\label{MP:EXIT}{\tt EXIT}}

{\tt EXIT} terminates interactive input. It has
the same effect as reaching the end of file when input to \schedb
is from a keyin file. It should be issued after the ``/'' after the
last scan and needs a ``/'' of its own. Any inputs issued with it will
be ignored.  Since {\em SCHED} is nearly always used with an input file,
this parameter should rarely be used.

\rcwbox
{None which implies 0.D0.}
{None.}
{Not issued if non-zero.}
{Will terminate program so only can be used once.}
{{\tt EXIT /}}

\subsubsection{\label{MP:EXPT}{\tt EXPT}}

{\tt EXPT} is a description of the project for the listings.

\rcwbox
{Text up to 72 characters.}
{Any.}
{None.}
{Only one value used, the last.}
{{\tt EXPT='3C345 March 11, 1988 Mark II'}}


\subsubsection{\label{MP:EXPCODE}{\tt EXPCODE}}

{\tt EXPCODE} is the project code from the Network or from NRAO.
This is used as the first few characters of many file names.


\rcwbox
{Text of up to 8 characters. Best to use 6 or less.  In fact, only
5 characters will be kept by much of the NRAO bookkeeping system.}
{Any.}
{{\tt 'NUG'}}
{Only one value used, the last given.}
{{\tt EXPCODE=BW005}}


\subsubsection{\label{MP:FASTFOR}{\tt FASTFOR}}

{\tt FASTFOR:} is an obsolete parameter that only applies to tape.

{\tt FASTFOR:} requests that the wide band tape (Mark~III or
VLBA) be run at the maximum forward speed during the prescan. Usually
the intent is to get to the end of the tape prior to the start of the
scan. If no argument is given, all stations will be issued with a fast
forward instruction. If a list of stations is given, only those
stations in the list will be fast forwarded.  The station code may
be used instead of the station name (not case sensitive).

\rcwbox
{None or a list of stations.}
{None or a list of any stations in the scan. Not case sensitive.}
{No fast forward unless there is insufficient room on the tape to
complete the scan while recording in the current direction.}
{Reverts to no fast forward on next scan.}
{{\tt FASTFOR} or {\tt FASTFOR=VLBA\_BR}}


\subsubsection{\label{MP:FAX}{\tt FAX}}

{\tt FAX} is the  Principal Investigator's FAX number for the cover
information.  Either an EMAIL address or FAX number must be provided
when recording tape.  Both should be provided.

\rcwbox
{Text of up to 64 characters.}
{Any.}
{Blank}
{Only one value used, the last.}
{{\tt FAX='+1-505-835-7027'}}


\subsubsection{\label{MP:FOCOFF}\tt FOCOFF}

{\tt FOCOFF} gives the offsets in focus for a focus/rotation raster.
See 
{\hyperref[MP:ROTPAT]{{\tt ROTPAT}}} for details.

The values are offsets to be multiplied by the nominal offset
for the band as understood by the program.

\rcwbox
{Up to 20 real numbers - the number of nominal recrements in
focus for each position of a focus/rotation raster.}
{Any number.  1.0 or 1.5 typically.}
{0.0}
{Only one set used per experiment.}
{{\tt FOCOFF=0,-1,0,1,0}}


\subsubsection{\label{MP:FOCUS}\tt FOCUS}

{\tt FOCUS} is used in VLBA test observations to specify an
increment to the focus value used for the subreflector position.
This is added to the nominal position known by the on-line system
for the particular receiver.

Note that the schedule requires focus values in mm while tsm
reports focus achieved in cm.

This parameter might be used in astronomical observations if one
wished to have the most optimum focus for a given frequency for a
receiver that has a significant focus variation with frequency.  The
new (2012) 6cm receiver (4-8 GHz) has such a variation.

\rcwbox
{An incremental focus position in mm.}
{Any incremental focus position.}
{0.0}
{Default to previous scan.}
{{\tt FOCUS = 10.2 }}

\subsubsection{\label{MP:FREQ}{\tt FREQ}}

{\tt FREQ} specifies the LO sum observing frequencies for the baseband
channels in MHz.  When not specified, the last value specified is
used. If {\tt 0} is specified, or {\tt FREQ} is never given in the
schedule, the default from the setup file is used.  Any channels not
specified will be set to the same frequency as the first.  This
defaulting only works when that channel was not previously set to an
explicit value.  The defaulting to the first channel is usually not
what is desired.  Whenever the frequencies change, a comment appears
in the operator schedule file; the appropriate changes are made to the
BBC frequencies for antennas using VLBA or VEX control files; and for
snap files, dummy video converter commands are written without the
correct video converter number and with the full LO sum (personnel at
``snap'' sites must edit in the correct video converter numbers and
subtract the first LO). Since both the VLBA and Mark~IV systems can
only set frequencies to the nearest 10~kHz and the Mark~III video
converters are often used for Mark~II projects, do not try to set a
frequency that is not an even 10~kHz.  Actually, \schedb will round to
this value, or to 
{\hyperref[MP:DOPINCR]{{\tt DOPINCR}}}, if it is given.


\rcwbox
{Up to 16 real numbers in MHz.}
{Any.}
{Use the setup file values.}
{Uses the last value specified.}
{{\tt FREQ=22236.78,22238.78}}


\subsubsection{\label{MP:FREQFILE}{\tt FREQFILE}}

{\tt FREQFILE} is used to specify the file containing the standard
frequency setup information.  This file is provided with \schedb and
most users only need to point to it.  If you want a setup that does
not match one of the standards, \schedb will allow you to use one
although it will issue warnings to remind you to be sure you know what
you are doing.

On unix, an environment variable may be used.

For additions or corrections on EVN telescopes, contact
Des Small at {\tt small@jive.nl}.


{A file name of up to 80 characters.}
{Any.}
{{\tt \$SCHED/catalogs/freq\_RDBE.dat}}
{Uses the last value specified.}
{{\tt FREQFILE=/users/cwalker/sched/catalogs/freq.dat}}


\subsubsection{\label{MP:FREQLIST}{\tt FREQLIST}}

{\tt FREQLIST} is used to request a table of information from the
{\hyperref[MP:FREQFILE]{{\tt FREQFILE}}} be written to {\sl
frequencies.list}.  It takes two arguments giving a frequency range to
be covered in the list (in MHz).  If the second argument is omitted,
it will be set equal to the first.  This may be the only parameter
given to \schedb --- no others are needed.  \schedb will quit after
the table is made.  This facility should be useful for determining
which antennas can observe certain frequencies.

{2 real numbers which are frequencies in MHz}
{Any.}
{Not used.  No table written.}
{Uses the last value specified.}
{{\tt FREQLIST=4900,8600}}


\subsubsection{\label{MP:GAP}{\tt GAP}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt GAP} is the minimum gap in time between the previous stop time
and the current nominal scan start time when scheduling with
{\hyperref[MP:DUR]{{\tt DURation}}} or 
{\hyperref[MP:DWELL]{{\tt DWELL}}}.
For scheduling with 
{\hyperref[MP:DUR]{{\tt DURation}}}, it will be that
time interval.  For scheduling with 
{\hyperref[MP:DWELL]{{\tt DWELL}}},
the interval might be longer if required for slews, but it will not be
shorter.  Note that 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}},
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}} (old, mostly obsolete parameter) and
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}} are applied after the nominal
scan times are established and could make the period during which the
recording is stopped shorter than {\tt GAP}.  {\tt MINPAUSE} is used
to keep the recordings going through short gaps.  Note that, if
{\hyperref[MP:START]{{\tt START}}} is specified, 
{\hyperref[MP:GAP]{{\tt GAP}}} will be ignored.

If LST scheduling, GAP is a sidereal time, so it will be slightly
shorter in UT (by about 1.0027).

For all types of scheduling, if the gap between scans is less than the
value of 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}, the recordings are
left running.  The default {\tt MINPAUSE} is 10 seconds for legacy
systems and the DBBC. It is zero for the RDBE and WIDAR.

For Field System stations (most non-VLBA stations), gaps should be inserted to
allow bank changes.  The VLBA can switch between mounted disk banks
(modules) on the fly, but the field systems need a pause in the data
recording.  Such gaps should be inserted every 22 minutes for
recordings at 1 Gbps and proportionally less often at lower bit rates.
These gaps need to be more than 10s long.

The PCFS software requires an interval of 36 seconds at tape reversals
(not needed for disk) to produce a valid VEX file. A 40 second gap is
required to change setup.  Apart from these restrictions continuous
recording is implied for gaps shorter than 10 seconds.  In addition,
users should realize that during continuous recording no calibration
data is taken. Starting and stopping the recording can be forced using
{\tt GAP} or 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}, or by using
{\hyperref[MP:START]{{\tt START times}}}.  {\tt GAP} is probably the
preferred mechanism.  As of Feb. 2014, we are trying to determine what
is the current minimum time for bank changes.  It is actually likely
to be less than 40 seconds.

There is an interaction between {\tt GAP} and {\tt AUTOPEAK}.  Any 
specified {\tt GAP} will be enforced for the interval between the 
input scans, but the inserted pointing scan can occur during that 
interval.  Note, prior to Feb 2014, the gap was set to zero when
pointing was inserted, so under some circumstances, the input scans
could end up closer together than {\tt GAP}.


\rcwbox
{A time in any approved time format (hh:mm:ss, mm:ss, sss etc.)}
{Any time}
{Zero.}
{Reverts to previous scan.}
{{\tt GAP=2:00} (which is equivalent to {\tt gap 120}).}


\subsubsection{\label{MP:GEOBACK}{\tt GEOBACK}}

{\tt GEOBACK} is a knob sticking out of the algorithm that selects
sources for use in a geodetic segment.  For the current source
selection algorithm, it is not too useful and should be set to a value
higher than the number of scans expected in the segment.  The default
is 100.  For each new source, \schedb looks for which sources of those
available would contribute the most to improving the rms of the SecZ
parameters in a dummy fit.  That dummy fit does not use all the
sources in the segment so far, but rather is restricted to the last
{\tt GEOBACK} sources.  Without that restriction, once all antennas
are giving reasonable SecZ fits, no new source improves things much
and the bias to short slews can lead to selection of sources that
don't really contribute much to the segment.  By restricting the
look-back, each new source must contribute to a fit.  Since the
algorithm was changed to concentrate on the antenna that did worst in
after the previous source was added, rather than the RMS improvement,
this restricted look-back capability has not been especially useful.

{\tt GEOBACK} is also used to inhibit repeated use of any given source
in a segment.  Rather than prohibit repeats entirely, \schedb only
prohibits repeats within each {\tt GEOBACK} scans.

\rcwbox
{A number of scans to examine to help determine the best source to add
to a geodetic block}
{Any integer, but values above around 6 are highly recommended}
{100}
{Only one value used for the whole observation}
{{\tt geoback=10}}

\subsubsection{\label{MP:GEOHIEL}{\tt GEOHIEL}}

When selecting the initial sources (up to about 3/4 of the total)
in a geodetic sequence, \schedb tries to find one that are especially
low or high at some stations.  {\tt GEOHIEL} sets the lower bound
of the region considered to be high.  The related parameter
{\hyperref[MP:GEOLOWEL]{{\tt GEOLOWEL}}} sets the upper bound to the
``low'' region.  The default {\tt GEOHIEL} of 40 degrees has a
SecZ of 1.55.  Going higher increases slew times without all that
much gain in SecZ.

\rcwbox
{Any real number}
{This is an elevation in degrees.  It should be between 0.0 and 90.0}
{40.0}
{Only one value used for the whole observation}
{{\tt geohiel=53.4}}

\subsubsection{\label{MP:GEOLOWEL}{\tt GEOLOWEL}}

When selecting the initial sources (up to about 3/4 of the total)
in a geodetic sequence, \schedb tries to find one that are especially
low or high at some stations.  {\tt GEOLOWEL} sets the upper bound
of the region considered to be low.  
{\hyperref[MP:OPMINEL]{{\tt OPMINEL}}}
sets the lower bound.  The related parameter
{\hyperref[MP:GEOHIEL]{{\tt GEOHIEL}}} sets the lower bound to the
``high'' region.  The default {\tt GEOLOWEL} of 23 degrees has a
SecZ of 2.55 which differs by 1.0 from the SecZ of 40 degrees, the
default for {\tt GEOHIEL}.

\rcwbox
{Any real number}
{This is an elevation in degrees.  It should be between 0.0 and 90.0}
{23.0}
{Only one value used for the whole observation}
{{\tt geolowel=20.0}}

\subsubsection{\label{MP:GEOPRT}{\tt GEOPRT}}

Specifying {\tt GEOPRT} (no argument) or {\tt GEOPRT = 0}
will cause the quality measure and the elevations at all sites for all
scans in each trial geodetic sequence to be printed while trying to
specify a new sequence.  The output will go to {\sl sched.runlog}. 
This can be a considerable amount of print
and is only recommended when trying to understand what the algorithm
is doing.  If you are a glutton for punishment, use {\tt GEOPRT = 1}
or even {\tt GEOPRT = 2} to cause a lot of information from the source
choosing process to be spewed out.  This is likely only useful when
debugging the software and won't make much sense without looking at
the code to see what all the numbers are.

\rcwbox
{Either none, or a number of which 0, 1, 2 are the only useful ones}
{No argument, 0, 1, 2}
{-1 which, like anything below 0 means don't do it}
{One value used from the schedule (the last)}
{{\tt GEOPRT = 0} or simply {\tt GEOPRT}}


\subsubsection{\label{MP:GEOSEG}{\tt GEOSEG}}

Specifying {\tt GEOSEG} flags a scan to be converted into a geodetic
segment.  See 
{\hyperref[SEC:GEOSEG]{the section on insertion of geodetic segments}}
for more details about this capability.  The argument
of {\tt GEOSEG} is the total time for the geodetic segment.  The duration
of each scan in the segment is specified with 
{\hyperref[MP:DWELL]{{\tt DWELL}}}.
The scan to be converted should have a source specified
to keep various checking routines happy, but it is not important what
that source is, or even whether it is up.  In the construction of the
segment, it will be ignored.

Geodetic segments will likely need to be 30 to 40 minutes long to have
good coverage at all antennas with multiple low elevation scans.  They
could be even longer if slow antennas are included.  Note that not all
antennas will be in all scans.

The sources used for the geodetic segments are specified with
{\hyperref[MP:GEOSRCS]{{\tt GEOSRCS}}}.

\rcwbox
{Any time in seconds in the usual formats (hh:mm:ss, mm:ss, sss etc.)}
{Any time}
{zero - no geodetic segment to be constructed}
{Reverts to zero to avoid building successive segments.}
{{\tt geoseg=30:00} for a 30 minute segment}

\subsubsection{\label{MP:GEOSLEW}{\tt GEOSLEW}}

When selecting sources for a geodetic segment, \schedb takes into
account both the contribution to a fit for SecZ and the slew time.
{\tt GEOSLEW} controls the relative weight.  A value of 1.0 means
encourage slews shorter than about 1 minute.  A larger value would
encourage shorter slews.  A larger value introduces a larger penalty
for a long source and would encourage shorter slews.

\rcwbox
{Any real number}
{Any number}
{1.0 - favors slews of around a minute}
{Only one value used for the schedule - the last}
{{\tt geoslew=2.0}}


\subsubsection{\label{MP:GEOSLOW}{\tt GEOSLOW}}

\schedb can leave stations out of a scan if they get there much later
than most stations in order to help increase the number of scans in
a geodetic sequence.  If the source being checked is important for
the slow station, it can be blocked from being selected at this pass
so that it can be selected later when the slow station can get there in
a more timely manner.  The effect of doing this tends to be that the
slow antennas get used in roughly every other scan (the slew calculation
knows if an antenna has the full time of the previous scan to get where
it is going).  In the current algorithm, if the station arrives more
than {\tt GEOSLOW} seconds after the third to last antenna to get there,
it can be left out.  Average and median times have been tried as the
reference, but there tend to be issues when not all antennas were in
the previous scan.

\rcwbox
{Any real number - seconds.}
{Any number}
{40.0}
{Only one value used for the schedule - the last}
{{\tt geoslow=30.0}}

\subsubsection{\label{MP:GEOSRCS}{\tt GEOSRCS}}

{\tt GEOSRCS} is used to list the sources to consider for
automatically inserted geodetic segments.  It is array of source
names, where the sources need to be in the \schedb source catalogs.
Since the geodetic segments are best done with strong, compact
calibrators with well known positions, all sources of interest are
likely to be in one of the standard \schedb catalogs
{\href{catalogs/sources.gsfc}{{\sl \$SCHED/catalogs/sources.gsfc}}} or
{\href{catalogs/sources.petrov}{{\sl
\$SCHED/catalogs/sources.petrov}}}.  Note that some people use an odd
source name convention that is the J2000 name but truncated at 8
characters (some software doesn't like more).  As of this writing,
those names are only included as aliases in the GSFC catalog.  For
more information about automatic insertion of geodetic segments, see
{\hyperref[SEC:GEOSEG]{the section on insertion of geodetic segments}}
and the description of the parameter {\hyperref[MP:GEOSEG]{{\tt
GEOSEG}}}.

The list in the sample below is the recommended set that is the 
295 defining sources of the ICRF2.  This would be a good list to use
and is the list actually active in the example {\sl egdelzn.key}, alhough
that example shows a couple of other possible lists.

Sample input to \sched:

\begin{verbatim}
! ==========================================================
! =============  Sources for geodetic segments  ============
! ==========================================================
geosrcs='0002-478','0007+106','0008-264','0010+405','0013-005','0016+731',
        '0019+058','0035+413','0048-097','0048-427','0059+581','0104-408',
        '0107-610','0109+224','0110+495','0116-219','0119+115','0131-522',
        '0133+476','0134+311','0138-097','0151+474','0159+723','0202+319',
        '0215+015','0221+067','0230-790','0229+131','0234-301','0235-618',
        '0234+285','0237-027','0300+470','0302-623','0302+625','0306+102',
        '0308-611','0307+380','0309+411','0322+222','0332-403','0334-546',
        '0342+147','0346-279','0358+210','0402-362','0403-132','0405-385',
        '0414-189','0420-014','0422+004','0426+273','0430+289','0437-454',
        '0440+345','0446+112','0454-810','0454-234','0458-020','0458+138',
        '0506-612','0454+844','0506+101','0507+179','0516-621','0515+208',
        '0522-611','0524-460','0524-485','0524+034','0529+483','0534-611',
        '0534-340','0537-441','0536+145','0537-286','0544+273','0549-575',
        '0552+398','0556+238','0600+177','0642+449','0646-306','0648-165',
        '0656+082','0657+172','0707+476','0716+714','0722+145','0718+792',
        '0727-115','0736+017','0738+491','0743-006','0743+259','0745+241',
        '0748+126','0759+183','0800+618','0805+046','0804+499','0805+410',
        '0808+019','0812+367','0814+425','0823+033','0827+243','0834-201',
        '0851+202','0854-108','0912+029','0920-397','0920+390','0925-203',
        '0949+354','0955+476','0955+326','0954+658','1004-500','1012+232',
        '1013+054','1014+615','1015+359','1022-665','1022+194','1030+415',
        '1030+074','1034-374','1034-293','1038+52A','1039+811','1042+071',
        '1045-188','1049+215','1053+815','1055+018','1101-536','1101+384',
        '1111+149','1123+264','1124-186','1128+385','1130+009','1133-032',
        '1143-696','1144+402','1144-379','1145-071','1147+245','1149-084',
        '1156-663','1156+295','1213-172','1215+303','1219+044','1221+809',
        '1226+373','1236+077','1240+381','1243-072','1244-255','1252+119',
        '1251-713','1300+580','1308+328','1313-333','1324+224','1325-558',
        '1334-127','1342+662','1342+663','1349-439','1351-018','1354-152',
        '1357+769','1406-076','1418+546','1417+385','1420-679','1423+146',
        '1424-418','1432+200','1443-162','1448-648','1451-400','1456+044',
        '1459+480','1502+106','1502+036','1504+377','1508+572','1510-089',
        '1511-100','1514+197','1520+437','1519-273','1546+027','1548+056',
        '1555+001','1554-643','1557+032','1604-333','1606+106','1611-710',
        '1614+051','1617+229','1619-680','1622-253','1624-617','1637+574',
        '1638+398','1639+230','1642+690','1633-810','1657-261','1657-562',
        '1659-621','1705+018','1706-174','1717+178','1726+455','1730-130',
        '1725-795','1732+389','1738+499','1738+476','1741-038','1743+173',
        '1745+624','1749+096','1751+288','1754+155','1758+388','1803+784',
        '1800+440','1758-651','1806-458','1815-553','1823+689','1823+568',
        '1824-582','1831-711','1842+681','1846+322','1849+670','1908-201',
        '1920-211','1921-293','1925-610','1929+226','1933-400','1936-155',
        '1935-692','1954+513','1954-388','1958-179','2000+472','2002-375',
        '2008-159','2029+121','2052-474','2059+034','2106+143','2106-413',
        '2113+293','2123-463','2126-158','2131-021','2136+141','2142-758',
        '2150+173','2204-540','2209+236','2220-351','2223-052','2227-088',
        '2229+695','2232-488','2236-572','2244-372','2245-328','2250+194',
        '2254+074','2255-282','2300-683','2318+049','2326-477','2333-415',
        '2344-514','2351-154','2353-686','2355-534','2355-106','2356+385',
        '2357-318'

\end{verbatim}

\rcwbox
{Up to 400 source names.  That can be adjusted if more are needed}
{Any valid source names.}
{No sources}
{One list used, the last}
{See above text}

\subsubsection{\label{MP:GEOSREP}{\tt GEOSREP}}

\schedb resists scheduling a given source more than once in a
geodetic sequence.  But sometimes it is worth doing that when there
are limited low elevation options.  {\tt GEOSREP} can be used to
set the minimum number of scans after an observation in a geodetic
block that a source can be observed again.  The default is high
enough to normally prevent repeats.  A lower value will allow repeats.

\rcwbox
{Any integer.}
{Any, although negative and zero don't make much sense.}
{40.0}
{Only one value used for the schedule - the last}
{{\tt geosrep=6}}


\subsubsection{\label{MP:GEOTRIES}{\tt GEOTRIES}}

The selection of sources for a geodetic segment is based on
constructing several possible geodetic sequences and choosing the
best.  The first few selected sources for each tested segment are
chosen randomly from among those that can contribute to the low
elevation scans at at least one station.  After those, the program
chooses the source that best complements those chosen so far in
terms of improving the quality measure without excessive slewing.
Parameter {\tt GEOTRIES} sets the number of trial segments to
construct and test.  The algorithm for making segments comes up
with reasonable ones most of the time, so it is not generally
necessary to test very many.  The algorithm is also moderately
slow which will encourage not testing too many.  The default is
10 which seems reasonable.

\rcwbox
{Any integer 1 or above.}
{Any}
{10}
{One value used, the last}
{{\tt GEOTRIES=25}}


\rcwbox
{Either none, or a number of which 0 and 1 are the only useful ones}
{No argument, 0, or 1}
{-1 which, like anything besides 0 or 1, means don't do it}
{One value used from the schedule (the last)}
{{\tt GEOPRT = 0} or simply {\tt GEOPRT}}


\subsubsection{\label{MP:GRABTO}{\tt GRABTO}}

This is an eVLBI control parameter.  Be warned: eVLBI support is
under development.
The eVLBI parameters are 
{\hyperref[MP:GRABTO]{{\tt GRABTO}}},
{\hyperref[MP:GRABTIME]{{\tt GRABTIME}}}, 
{\hyperref[MP:GRABGAP]{{\tt GRABGAP}}},
and 
{\hyperref[MP:DATAPATH]{{\tt DATAPATH}}}.

{\tt GRABTO} is used to help control sending of small amounts of
previously recorded data over the net.  That process happens after the
scan of interest, which was recorded normally.  The data can either be
copied first to the system disk, then transferred later by, for
example, ftp or some other protocol {\tt GRABTO=FILE}.  Or the data
can be sent directly to the net {\tt GRABTO=NET} from the VLBI disks.
It seems that {\tt GRABTO=NET} is not valid for systems controlled by
the Field System (eg MarkIV and variants).

This is different from the real time transfer controlled by
{\hyperref[MP:DATAPATH]{{\tt DATAPATH}}}.

If {\tt GRABTO} is {\tt NONE}, which is the default, no data will be
written and the other {\tt GRAB..} parameters will be ignored.

Note that 
{\hyperref[MP:GRABTIME]{{\tt GRABTIME}}} determines what
segment of data is sent.  
{\hyperref[MP:GRABGAP]{{\tt GRABGAP}}} determines
what amount of time needs to be set aside to grab the data from the
VLBI disk (ftp transfer can happen during the next scan).

\rcwbox
{ Character string of up to 4 characters.}
{{\tt NET} for direct transfer to external network.
 {\tt FILE} for transfer to the control computer system disk.
 {\tt NONE} Do not transfer the data anywhere.}
{{\tt NONE}}
{A value for each scan.  Defaults to previous scan.  Be sure to set
back to {\tt 'NONE'} after a grab scan.}
{{\tt GRABTO = 'FILE' }}

\subsubsection{\label{MP:GRABTIME}{\tt GRABTIME}}

This is an eVLBI control parameter.  Be warned: eVLBI support is
under development.
The eVLBI parameters are 
{\hyperref[MP:GRABTO]{{\tt GRABTO}}},
{\hyperref[MP:GRABTIME]{{\tt GRABTIME}}}, 
{\hyperref[MP:GRABGAP]{{\tt GRABGAP}}},
and 
{\hyperref[MP:DATAPATH]{{\tt DATAPATH}}}.

{\tt GRABTIME} determines which part of a scan will be used for
eVLBI.  There are 2 arguments.  The first gives the duration in
seconds of the data to be sent.  The second argument gives the
seconds before the end of the current scan that the grabbed data
will end.  Thus the data to be sent are from the interval from
{\tt GRABTIME(1) + GRABTIME(2) } to {\tt GRABTIME(2)} seconds
before the end of the scan.


\rcwbox
{ Two real numbers --- times in seconds.}
{ Any times.}
{{\tt 30,0}.  Which means transfer the last 30 seconds of the scan}
{Values for each scan.  Defaults to previous scan.}
{{\tt GRABTIME = 30,0 }}


\subsubsection{\label{MP:GRABGAP}{\tt GRABGAP}}

This is an eVLBI control parameter.  Be warned: eVLBI support is
under development.
The eVLBI parameters are 
{\hyperref[MP:GRABTO]{{\tt GRABTO}}},
{\hyperref[MP:GRABTIME]{{\tt GRABTIME}}}, 
{\hyperref[MP:GRABGAP]{{\tt GRABGAP}}},
and 
{\hyperref[MP:DATAPATH]{{\tt DATAPATH}}}.

{\tt GRABGAP} specifies how much time will be needed after the
scan to transfer the data.  This will initially just be used for
checking, and maybe for some optimization functions.  Eventually
it may have other uses.

\rcwbox
{ Two real number --- time in seconds.}
{ Any time.}
{5.0 + {\tt GRABTIME(1)}*bitrate/110Mbps}
{Value for each scan.  Defaults to previous scan.}
{{\tt GRABGAP = 90 }}

\subsubsection{\label{MP:GRIDMIN}{\tt GRIDMIN}}

{\tt GRIDMIN} is the inner radius of the grid used for UV
coverage optimization.  It is in the units of the UV plot.
See the section on 
{\hyperref[SEC:CONFIG]{Configuration Studies}}
for details.  This is only used when
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE=CONFIG}}}.

\rcwbox
{Any number, typically a value similar to the array's shortest baseline.}
{Any value.}
{25.0 (km for NMA studies)}
{Only last one used}
{{\tt GRIDMIN = 10.0}}

\subsubsection{\label{MP:GRIDMAX}{\tt GRIDMAX}}

{\tt GRIDMAX} is the outer radius of the grid used for UV
coverage optimization.  It is in the units of the UV plot.
See the section on 
{\hyperref[SEC:CONFIG]{Configuration Studies}} for details.
This is only used when
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE=CONFIG}}}.

\rcwbox
{Any number, typically a value similar to the array's shortest baseline.}
{Any value.}
{250.0 (km for NMA studies)}
{Only last one used}
{{\tt GRIDMAX = 350.0}}

\subsubsection{\label{MP:GRIDMEAS}{\tt GRIDMEAS}}

{\tt GRIDMEAS} is used to choose between quality measures to use
when rating arrays using the UV coverage on the grid specified
with the other ``{\tt GRID}'' parameters.  The options are
{\tt COUNT}, which simply counts the number of sampled cells,
and {\tt RMS}, which determines the RMS of the number of samples
per cell.

\rcwbox
{{\tt COUNT} or {\tt RMS}}
{Only one of the above two options}
{{\tt COUNT}}
{Only last value used}
{{\tt GRIDMEAS = 'COUNT'}}


\subsubsection{\label{MP:GRIDNR}{\tt GRIDNR}}

{\tt GRIDNR} is the number of radial cells in the grid used for UV
coverage optimization.  See the section on 
{\hyperref[SEC:CONFIG]{Configuration Studies}}
for details. This is only used when
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE=CONFIG}}}.

\rcwbox
{Any integer.  About 40 can be a reasonable choice.}
{Any value. (non-integers will be truncated.)}
{20}
{Only last one used}
{{\tt GRIDNR = 40}}

\subsubsection{\label{MP:GRIDNT}{\tt GRIDNT}}

{\tt GRIDNT} is the number of azimuthal cells in the grid used for UV
coverage optimization.  See the section on 
{\hyperref[SEC:CONFIG]{Configuration Studies}}
for details.  This is only used when
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE=CONFIG}}}.

\rcwbox
{Any integer.  About 72 can be a reasonable choice.}
{Any value. Non-integers will be truncated.}
{36}
{Only last one used}
{{\tt GRIDNT = 72}}

\subsubsection{\label{MP:GRIDSTEP}{\tt GRIDSTEP}}

When doing 
{\hyperref[SEC:CONFIG]{configuration studies}}, if key {\tt S}
is pressed, \schedb will calculate the array quality measure for
points on a grid in latitude and longitude centered on the first
highlighted (red) station.  It is best to only highlight one.  Then
labeled contours will be plotted over the region of the calculation.
Note that the contours are not cleared until the uvcoverages are
plotted, so you can end up with several.  The contours are reploted
(including to an output file) until some action like altering a any
station's selection status or moving a station is done.  The spacing
of grid points in latitude and longitude for calculating the quality
is given in arcminutes by {\tt GRIDSTEP}.

\rcwbox
{A number in arcminutes of latitude and longitude for the spacing of
station locations used to make a contour map of quality measure}
{Any real number}
{3.0 - three arcminutes}
{Only last one used}
{{\tt GRIDSTEP = 6.0}}

\subsubsection{\label{MP:GRIDVLA}{\tt GRIDVLA}}

When doing 
{\hyperref[SEC:CONFIG]{configuration studies}}, only use baselines
to the VLA to calculate the quality measure.  This is useful for the NMA
which will have large swatches of baselines to the VLA.  Those swatches
dominate the sensitivity.

\rcwbox
{No argument to set.  Any non-zero number will unset.}
{Any number, but none needed (logical)}
{Not set (will use baselines to VLA antennas)}
{Only last one used}
{{\tt GRIDVLA}}

\subsubsection{\label{MP:GRIDW0}{\tt GRIDW0}}

{\tt GRIDW0} is the approximate radius of the transition
from linear to logarithmic radial grid sizes in the grid used for UV
coverage optimization.  It is in the units of the UV plot.
See the section on 
{\hyperref[SEC:CONFIG]{Configuration Studies}}
for details.  This is only used when
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE=CONFIG}}}.

\rcwbox
{Any number, typically a value at about 0.1 to 0.3 of the array's longest
baselines}
{Any value.}
{0.0 (results in a pure logarithmic grid)}
{Only last one used}
{{\tt GRIDW0 = 45.0}}


\subsubsection{\label{MP:GROUP}{\tt GROUP}}

{\em SCHED} has the ability to accept loops through scans.  The two
parameters that allow this are {\tt GROUP} and {\tt REPEAT}.  They
should be specified along with the parameters of the first scan in the
loop.  {\tt GROUP} specifies the number of scans to be involved in a
loop.  {\tt REPEAT} specifies how many times to go around the loop.
Any start or stop times specified for the scans of the loop will
only apply to the first pass.  {\tt DURation} or {\tt DWELL} should
be used to set the scan lengths.

\rcwbox
{Integer.}
{Any.}
{Not used.}
{Reverts to not being used if not specified for a scan.}
{{\tt GROUP=2}}

\subsubsection{\label{MP:HIGROUP}{\tt HIGROUP}}

{\tt HIGROUP} is used in conjunction with {\hyperref[MP:OPTMODE]{{\tt
OPTMODE}}} = {\tt 'HIGHEL'}.  If {\tt HIGROUP} is set to greater than
1 for a scan while {\tt PTMODE = 'HIGHEL'}, a number of scans specified by
{\tt HIGROUP}, including the one where it is specified, are checked for
elevation.  The single scan with the highest elevation is used.  This
aids in picking sources for calibrators, pointing scans etc what are 
best for a schedule whose run time might be set just before the observations.

\rcwbox
{Integer.}
{Any.}
{Not used.}
{Reverts to not grouping scans.}
{{\tt HIGROUP=6}}


\subsubsection{\label{MP:IATUTC}{\tt IATUTC}}

Obsolete parameter now that the VLA is no longer using observe decks.

{\tt IATUTC} sets the value of IAT-UTC. This is about 30 seconds now.
This is only used if ``//PM'' cards are needed for the VLA since the
zero-offset epoch must then be specified in IAT. \schedb does not
use IAT for anything else.  If not specified, the default is the
value from the SLA library which should be ok, as long as that
routine is maintained.

\rcwbox
{An integer number of seconds.}
{Any integer - should be correct value.}
{Value from {\sl SLA\_DAT}, which should be correct.}
{Only one value accepted, the last.}
{{\tt IATUTC=29}}


\subsubsection{\label{MP:INTENTs}{\tt INTENTs}}

{\tt INTENTs} is used to provide a series of text strings that give
guidance to various stages of data handling.  They can be directives
to telescopes to, for example, do active phasing at the VLA or hold
the previous phase.  They could be used by the correlator.  Or they can
be used to tell pipeline processing that a scan is to be used for one or
more specific types of calibration.  For now, the intents are written
to the VEX file as comments with the scans.

The arguments of {\tt INTENTs} are up to 25 strings of up to 80
characters each.  Note that each string should be in quotes and they
should be separated by commas.  If the line ends with a comma, the
next line can be used for the next string.  If no {\tt INTENTs} are
given, they default to the previous scan.  If any are given, they all
return to blank unless given again again.  If {\tt NONE} is specified,
all intents are cleared.

\schedb does not parse most {\tt INTENTs}.  But some, especially related
to the VLA phasing, are recognized and appropriate actions are taken.

An intent may be made to target a specific antenna by starting with
the station name followed by a colon.  Use the same station name as
used in the station catalog.  If no station name is given, the {\tt
INTENTs} will be assumed to apply to all stations for which it is
meaningful.  An example line with a station might address asking the
VLA to phase but not some other interferometer with: 
{\tt INTENT = 'VLA:AUTOPHASE\_DETERMINE'}.

Some established values of {\tt INTENTs} in the VLA environment are
listed here.  Also some requested for other instruments are listed.
Most will not be used in VLBI schedules.  A VLBI
specific list has not been generated.  Of interest for the VLA are {\tt
DETERMINE\_AUTOPHASE} and {\tt DETERMINE\_OFFSET\_POINTING}.  

\begin{list}{}{\parsep 0em  \itemsep 0em }
\item {\tt OBSERVE\_TARGET}
\item {\tt CALIBRATE\_BANDPASS}
\item {\tt CALIBRATE\_FLUX\_DENSITY\_SCALE} 
\item {\tt CALIBRATE\_COMPLEX\_GAIN}
\item {\tt CALIBRATE\_POLARIZATION\_ANGLE}
\item {\tt CALIBRATE\_POLARIZATION\_LEAKAGE}
\item {\tt CALIBRATE\_ABSOLUTE\_POSITION}
\item {\tt CALIBRATE\_OFFSET\_POINTING}
\item {\tt DETERMINE\_AUTOPHASE}
\item {\tt DETERMINE\_RFI}
\item {\tt CALIBRATE\_DELAY}
\item {\tt FIND\_FRINGE}
\item {\tt DETERMINE\_ANTENNA\_GLOBAL\_POINTING\_MODEL}
\item {\tt MAP\_ANTENNA\_SURFACE}
\item {\tt CALIBRATE\_FOCUS}
\item {\tt DETERMINE\_SINGLE\_DISH\_POINTING}
\item {\tt DETERMINE\_OPACITY\_TIPPING\_STYLE}
\item {\tt OBSERVE\_PULSAR}
\item {\tt TIME\_PULSAR}
\item {\tt SetAtnGain}
\item {\tt OTHER}
\end{list}

This above list is from VLA documentation.  For VLBI, the following
are also used, although the preferred method of creating them is
through the 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}} and 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}} parameters.  \schedb will not
allow mixing methods of specifying these aspects of the observing.

\begin{list}{}{\parsep 0em  \itemsep 0em }
\item {\tt AUTOPHASE\_DETERMINE} to apply the phasing offsets.
\item {\tt AUTOPHASE\_APPLY} to apply the phasing offsets.
\item {\tt AUTOPHASE\_OFF} to not apply any phasing offsets.
\item {\tt REFERENCE\_POINTING\_DETERMINE}
\item {\tt REFERENCE\_POINTING\_ADJUST}
\item {\tt REFERENCE\_POINTING\_APPLY}
\item {\tt REFERENCE\_POINTING\_OFF}
\end{list}

\rcwbox
{Up to 25 character strings of up to 80 characters each.  Can use 
separate lines as long as the preceding line ends in a comma.}
{Any strings.  'NONE' clears all INTENTs'}
{Blank}
{All {\tt INTENTs} keep the last value if none are specified.  If any
are specified, all are initialized to blank, and must be respecified
if still desired.}
{{\tt intent = 'DETERMINE\_AUTOPHASE', 'CALIBRATE\_BANDPASS'} or
{\tt intent=VLA:SetAtnGain}}


\subsubsection{\label{MP:LINEINIT}{\tt LINEINIT}}

{\tt LINEINIT} indicates that the next few keyin input groups are rest
frequency specifications for spectral line observations. See
Section~\ref{SEC:LINE} for details. {\tt LINEINIT} should not be
mixed with other indicaters of in-stream data such as {\tt SRCCAT},
{\tt STACAT}, {\tt SETINIT}, or {\tt TAPEINI}.  If {\tt LINEINIT}
is found, the end of the input group (everything up to the ``/'')
is not considered the end of inputs for this file.  The next inputs
after the line data are entered will continue to apply to the current
file (usually the first).

\rcwbox
{None.}
{None.}
{Not set.}
{Should only be given once in schedule.}
{{\tt LINEINIT /}}


\subsubsection{\label{MP:LINENAME}{\tt LINENAME}}

{\tt LINENAME} gives the name of the rest frequency group to use for
this scan. The rest frequencies and names are specified in the {\tt
LINEINIT} input. See Section~\ref{SEC:LINE} for details.

\rcwbox
{A name of up to 8 characters.}
{Must be one of the names in the {\tt LINEINIT} input.}
{Must use if {\tt DOPPLER} set.}
{Reverts to previous scan.}
{{\tt LINENAME='OH1665'}}


\subsubsection{\label{MP:LINEPG}{\tt LINEPG}}

{\tt LINEPG} is the number of lines on a page for the operator
schedule files and summary files.

\rcwbox
{Integer.}
{Any.}
{55}
{Only one value used.}
{{\tt LINEPG=60}}

\subsubsection{\label{MP:LOCFILE}{\tt LOCFILE}}

{\tt LOCFILE} gives the name of an auxillary file to the stations
catalog that can contain the station positions.  All parameters that
can be specified in the LOCFILE can be specified directly in the
{\hyperref[SEC:STACAT]{station catalog}} and are documented along with
that catalog.  The station locations used in the default catalogs are
from the VLBA correlator data base and are maintained in a very
different way from the rest of the information in the station
catalog, so it is convenient to have them in a separate file.  If
a user is making their own catalog, they could put all the
information in the station catalog as indeed they must if putting
the information into the main schedule through 
{\hyperref[MP:STACAT]{STACAT}}.

{\tt LOCFILE} defaults to the standard file distributed with
\sched.  If the file is not found, a complaint will only be
generated if a stations in the station catalog is missing
a position.

Only a subset of the stations catalog parameters can be put in the
LOCFILE.  They are {\tt X}, {\tt Y}, {\tt Z}, {\tt DXDT}, {\tt DYDT},
{\tt DZDT}, {\tt EPOCH}, {\tt AXISTYPE}, and {\tt AXISOFF}.  All other
station information must be in the main stations catalog.  In addition
to these parameters, a catalog version number ({\tt VERSION}), a
station name ({\tt DBNAME}), and a station code ({\tt DBCODE}), that
might be different from those used in the main stations catalog,
should be included.  The desired locations catalog entry is identified
by giving a matching DBNAME or DBCODE in the main stations catalog to
point to the locations catalog entry.  The use of different names and
codes is an artifact of the use of position information from the
geodetic groups which use different station names from those typically
used in astronomy.  Also the locations file generally contains a
separate entry for each pad of an interferometer such as the VLA which
is not the case for the stations catalog.

\rcwbox
{A file name of up to 80 characters.}
{Any valid file name or {\tt none}.}
{{\tt \$SCHED/catalogs/locations.dat}}
{Only specify once.}
{{\tt LOCFILE='/users/cwalker/sched/locations.dat'}}

\subsubsection{\label{MP:LST}{\tt LST}}

{\tt LST} causes \schedb to assume that all input times
are in local sidereal time. If no argument is given, the ``local''
refers to the VLA. Otherwise, a station name can be given to allow
scheduling in lst for some other station.

When {\tt LST} is specified, there are two ways to specify the date.
{\hyperref[MP:DAY]{{\tt DAY}}} can be used to specify the (modified?)
local sidereal day number as found on the VLA monthly schedules.  If
this is done, 
{\hyperref[MP:YEAR]{{\tt YEAR}}} and 
{\hyperref[MP:MONTH]{{\tt MONTH}}}
are ignored. \schedb senses this situation by
testing for a day number larger than the length of a year.  The other
option is to specify the calendar date in the usual way (
{\hyperref[MP:YEAR]{{\tt YEAR}}}, 
{\hyperref[MP:MONTH]{{\tt MONTH}}}, 
{\hyperref[MP:DAY]{{\tt DAY}}}).
In this case, \schedb will figure out when on that
calendar day the local sidereal time specified for a scan occurs.
With this option there is a period of a bit less than 4 minutes each
day when the specification is ambiguous (sidereal days are shorter than
UT days).  If that situation is encountered, \schedb will abort with
a request to choose the desired local sidereal day --- the options
will be shown.

This parameter was originally intended mainly for VLA-only scheduling.
But it is now also used for 
{\hyperref[SSEC:DYNAMIC]{dynamic scheduling}}
on the VLBA.

When {\tt LST} is selected, most times are sidereal times or
intervals.  These include 
{\hyperref[MP:START]{{\tt START}}},
{\hyperref[MP:STOP]{{\tt STOP}}}, 
{\hyperref[MP:DUR]{{\tt DURation}}}, and
{\hyperref[MP:DWELL]{{\tt DWELL}}}, but not 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}, 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}, or
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}.

\rcwbox
{Text of up to 8 characters giving the station name.}
{Any.}
{Not used if not given. {\tt 'VLA'} if given without argument.}
{Only one value used.}
{{\tt LST='VLBA\_PT'}}

\subsubsection{\label{MP:MAPLIM}{\tt MAPLIM}}

{\tt MAPLIM} is used to provide the longitude and latitude limits for
the plot that is made when (
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE}}} is
set to {\tt CONFIG} and there are more than one source.  This is
a special mode mainly for array configuration studies.  The 4
values are the longitude minimum and maximum followed by the
latitude minimum and maximum, all in degrees.  The system is such
that North America is at positive longitudes, which is backwards from
some schemes.

\rcwbox
{Four numbers.}
{Any.}
{Use numbers appropriate for NMA configuration study.}
{Only one value used.}
{{\tt MAPLIM=80.0, 140.0, 15.0, 50.0}}


\subsubsection{\label{MP:MINPAUSE}{\tt MINPAUSE}}

{\tt MINPAUSE} is used to specify the minimum time a recording will be
stopped between scans.  Its effects are basically ignored by the 
wideband systems (RDBE, WIDAR with MARK5C recording) on the VLBA, VLA
GBT, EB\_VLBA and perhaps others so users of those systems can ignore
the parameter, taking the default of zero.

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

If the interval between scans is shorter than the minimum specified
with {\tt MINPAUSE}, the recording will be be kept going between the
scans.  The need to prevent the recording from stopping for a short
interval was most pronounced with tapes which took several seconds to
accelerate and decelerate.  With disks, that is not an issue so the
only reason would be if there is a finite time to get the recording
organized and the playback synchronized.  Those are issues, at a low
level with the Mark5A systems, but not with the Mark5C, which is in
use and will become the dominant recording during 2013.  With Mark5C,
{\tt MINPAUSE} should be set to a very small value or zero.  Zero is
the default for all systems except the legacy VLBA DAR and anything
controlled by the Field System (may change for the DBBC).  For the
exceptions, 10 seconds is used.

For the VLA and sites with the VLBA control system, the recordings are
started at the data-good time as reflected in the individual station
lines of the VEX file.  Those times account for any antenna slew and
the additional time requested through {\tt TSETTLE} and other such
parameter in the station catalog.  {\tt MINPAUSE} only affects the
media start time which is the nominal start time minus {\tt PRESTART},
not the data good time, so it is basically ignored for such VLBA and
VLA

{\tt MINPAUSE} can be specified for each scan, but usually will be set
to one value for the whole schedule.  If the media start of a scan is
less than MINPAUSE (seconds) from the end of the last recording scan,
the recording will be left running between the scans.  This action is
station dependent --- different stations can have the recording
started at different times except when writing a VEX file, in which
case simultaneity is enforced.  The nominal start time of the scan as
displayed in the summary is not affected by {\tt MINPAUSE}.  You can
use the option {\tt TPSTART} in the 
{\hyperref[MP:SUMITEM]{{\tt SUMITEM}}}
list to display in the summary how long before
the scan start time the recording starts.  The recording start time is
also given in the {\sl sch} file.

{\tt MINPAUSE} is mainly used now to prevent excessive recording scans
on the Mark5A system.  The system does not allow more than 1024
data scans on the disks.  There is one scan for each period during which
the recording does not stop, regardless of the number of source scans
during that period.  This limitation can be an issue with large disk
packs and fast-switching phase-referencing projects.  The default
value is meant to prevent recording stops during fast switching.

While too many recording scans are a problem, so are too few.  If
something goes wrong with playback, the correlators cannot recover
until the start of the next recording scan.  Thus it is not wise to
have recording scans more than about an hour long.  Note that the MarkIV
systems will not stop the recording for gaps of less than 10 seconds
so a gap inserted to break a recording scan should be longer than
that.

Short recorder stoppages could cause problems for playback in the era
of tapes.  Every time the recording stopped, it must be resynced, which
takes 10-20 seconds for the old VLBA hardware correlator.  This is not
much of an issue for the DiFX software correlator or the MarkIV
correlators.

There are a variety of ways to prevent recordings from being stopped
between scans.  The simplest is to schedule using 
{\hyperref[MP:DUR]{{\tt DUR}}}
or explicit times with no specification of an interval
between scans.  In such cases, \schedb will not schedule any sort of
pause in scans or recordings.  One can use {\tt MINPAUSE} to keep the
recording going through short gaps.  For longer gaps when using {\tt
MINPAUSE}, the recording start time will not be affected.  
{\hyperref[MP:PRESTART]{{\tt PRESTART}}} (or a negative value for the old
parameter 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}}) can be used to shift
the scan start time forward from the time set by other criteria (such
as antennas on-source when using 
{\hyperref[MP:DWELL]{{\tt DWELL}}}).
The start time is moved by the same amount for all stations and is not
moved past the stop time of the most recent scan at any station.

For PCFS (VEX) controlled stations, the user should bear in mind that
all start times currently (Oct.\ 2001) must be equal. \schedb will
issue a warning if this condition is violated and will try to
synchronize recording starts when using {\tt MINPAUSE}.

In the tape era, it was possible for {\tt MINPAUSE} to confound your
attempts to leave gaps required by VEX files for tape reversals.  In
such cases, you would need to adjust {\tt MINPAUSE} on the offending
scans.  The default should not cause this problem because it does not
request continuous tape motion through scans long enough to keep the
VEX check routines happy for a reversal.

Note that {\tt MINPAUSE} used to be multiplied by the speedup factor
to determine the actual length of a pause at record time.  That made
it actually a time of the pause at playback time on the old VLBA
correlator.  That concept is no long relevant so the multiplication
by the speedup factor has been removed.

\rcwbox
{A number giving the minimum recording stoppage in seconds.}
{Any number.}
{10 seconds for legacy systems and anything controlled by the
Field System. It is 0 for anything else including the VLBA/RDBE 
and VLA/WIDAR systems.}
{Defaults to previous scan.}
{{\tt MINPAUSE=30}}



\subsubsection{\label{MP:MONTH}{\tt MONTH}}

{\tt MONTH} is the month of the stop time of the scan.  The day of
year of the first day of the {\tt MONTH}, minus 1, is added to the
value for \schedb parameter {\tt DAY} to get the day of year of
the project.  Thus {\tt MONTH} can be specified and {\tt DAY} given
as the day of the month, or {\tt MONTH} can be left at the default
of 1 and {\tt DAY} can be given as the Day of Year (DOY).  Other
combinations are also possible, but don't make much sense.

\rcwbox
{Integer.}
{Any between 1 and 12.}
{{\tt 1}}
{Defaults to previous scan.}
{{\tt MONTH=10}, meaning October.}


\subsubsection{\label{MP:NCHAN}{\tt NCHAN}}

{\tt NCHAN} is an obsolete parameter used in conjunction with {\tt FREQ} and
{\tt BW}.  Now that setup files are required, the number of channels is
obtained from them.

\subsubsection{\label{MP:NOSETUP}{\tt NOSETUP}}

{\tt NOSETUP} tells \schedb to ignore all setup file handling.  This
is meant to aid in planning when trying random or hypothetical
stations so that a setup file or frequency file entry for such
stations is not needed.  If this is specified, no telescope control
files can be written.  However, the plotting section is functional.

If {\tt NOSETUP} is specified, do not give {\tt SUMITEM=TAPE1} or
{\tt TAPE2}.

\rcwbox
{None.}
{Any none zero argument is the same as not specifying it.}
{Not specified.}
{Only one value used per experiment.}
{{\tt nosetup}}

\subsubsection{\label{MP:NOTE1}{\tt NOTE1, NOTE2, NOTE3, and NOTE4}}

{\tt NOTE1, NOTE2, NOTE3,} and {\tt NOTE4} are 128-character text strings that
can be used to pass any information in the cover section. Instructions
regarding pointing, Tsys measurement, and where to send logs are typically
provided this way.  Do not use exclamation marks (``!'').  They mess up
the VLBA system's ability to parse the control files.  \schedb will die
if you try.

\rcwbox
{Each of the 4 parameters takes a character string of up to 128
characters.}
{Any text.}
{Blank}
{Uses only one value, the last.}
{{\tt NOTE1='Please measure Tsys for every scan.'}}


\subsubsection{\label{MP:OBSMODE}{\tt OBSMODE}}

{\tt OBSMODE} gives basic information on the technical nature of
the project. The receiver wavelength and the recording system to be
used should be noted. Any non-standard setup should be noted here, and
expanded on with {\tt NOTE1}, etc.  This is for the cover information.

\rcwbox
{Text of up to 58 characters.}
{Any - include receiver wavelength and recording system.}
{Blank}
{Only one value used, the last.}
{{\tt OBSMODE='6cm  Mark II  Standard Network setup'}}


\subsubsection{\label{MP:OBSPHONE}{\tt OBSPHONE}}

{\tt OBSPHONE} is the phone number for Principal Investigator during
the observations for the cover information.

\rcwbox
{Text of up to 49 characters.}
{Any - usually a telephone number.}
{Blank}
{Only one value used, the last.}
{{\tt OBSPHONE='+1-505-835-7392'}}

\subsubsection{\label{MP:OBSTYPE}{\tt OBSTYPE}}

{\tt OBSTYPE} tells \schedb what type of observation this project is.
There are really only four options, although there are several ways
to specify most of them.  They are:

\begin{description}

\item[Mark II.]  Specifying either {\tt OBSTYPE = MKII} or {\tt MARKII}
causes \schedb to assume that the Mark II recording system will be
used.  This system is now obsolete, although maybe not totally gone, so
this should not be common.  It causes tape change requests to occur
at time intervals specified by {\tt AUTOTAPE} and assumes the Mark~II
tape is to be left running.

\item[Wide band recordings.] Specifying {\tt VLBI}, {\tt VLBA}, {\tt
MKIII} or {\tt MKIV} causes \schedb to assume that the wide band
recorders (tape or disk) are in use.  For the wide band recording
modes, the necessary information on tape speed, passes per index
position, etc., is taken from the setup file and the 
{\hyperref[SEC:TPINI]{{\tt TAPEFILE}}}
and the type of recorder to use is based on the
{\hyperref[SEC:STACAT]{station catalog}} and the {\tt TAPEFILE} parameter
{\tt MEDIA}.  If there is a gap between the stop time of one scan and
the start time of tape motion in the next (after taking into account
{\tt START, DWELL, GAP, and PRESCAN}), then \schedb will insert a
dummy scan with no tape motion (or possibly a rewind or fast-forward)
during this gap.  Note that there is no requirement that the
{\hyperref[SP:FORMAT]{{\tt FORMAT}}} in the setup file match which {\tt
OBSTYP is specified}.  In fact, it is allowed to mix types at
different stations.  For historical reasons, {\tt VLBA}, {\tt
MKIII}, {\tt MKIV}, {\tt MARKIII} and {\tt MARKIV} are allowed
alternatives with the same effect as {\tt VLBI} and some of these
appear in the examples.

\schedb does not support Mark~III recordings on other than
VLBA systems --- the snap output contains no tape commands.  In any case,
Mark~III is obsolete and no longer in use.

\item[Pure VLA observations.]  If {\tt OBSTYPE = VLA}, \schedb will
assume that only the VLA is being scheduled and that VLBI recorder setup or
commands are required.  This is the mode in which \schedb can be used
for many types of VLA scheduling.  With the advent of the EVLA project,
\schedb should no longer be used for scheduling pure VLA projects so 
this option is basically obsolete.

\item[Single dish observing.]  {\tt OBSTYPE = NONE} or {\tt PTVLBA}
(the default) causes recorder handling to be ignored. This is mainly for
VLBA single dish pointing observations.  This does set up the channels
in the Data Aquisition System (BBCs, IF distributers etc), but does
not record VLBI data.

\item[Configuration studies.]  {\tt OBSTYPE = CONFIG} causes a map
of station locations to be plotted when plotting uv coverage for
multiple sources.  This is mainly for array design
{\hyperref[SEC:CONFIG]{configuration studies}}.
The axis limits are set with parameter
{\hyperref[MP:MAPLIM]{{\tt MAPLIM}}} and default to values appropriate
for NMA configuration studies.  Continental, national, US state,
and New Mexico roads will also be plotted if the vector files are
available in {\sl \$PLANET\_DATA} as they are in Socorro.  If you want
to use this capability, you might wish to contact Craig Walker
about details and help --- it is not really meant for general use.

\end{description}

\rcwbox
{Text of up to 8 characters, not case sensitive.}
{{\tt MKII}, {\tt MARKII}, {\tt VLBI}, {\tt VLBA}, {\tt MKIII},
{\tt MARKIII}, {\tt MKIV}, {\tt MARKIV}, {\tt VLA}, {\tt PTVLBA},
{\tt CONFIG}, or {\tt NONE.}}
{\tt NONE}
{Only one value used per project.}
{{\tt OBSTYPE=MKIII}}


\subsubsection{\label{MP:OPDUR}{\tt OPDUR}}

{\tt OPDUR} is the total duration of project being scheduled with an
optimizing mode.  Some of the optimizing modes keep generating new scans
until they run out of time scheduled for the project.  This parameters
informs \schedb of the total project duration.

Note that the optimizing modes are somewhat experimental.  If they are used,
the output schedule should be checked carefully.

\rcwbox
{A time in time format (eg hh:mm:ss)}
{Any time that is to be used as the length of the project.}
{0}
{Only one value used per project}
{{\tt OPDUR = 13:30:00}}

\subsubsection{\label{MP:OPELPRIO}{\tt OPELPRIO}}

{\tt OPELPRIO} is used to specify two elevation ranges (4 values) to
give high priority when optimizing a schedule.  With {\tt
OPTMODE=SCANS}, scans on a source that falls within these elevation
ranges will be taken every time while scans falling outside these
ranges at all stations may be skipped depending on the setting of {\tt
OPSKIP} and on what happened on previous opportunities to observe the
source.  For geodesy projects, for example, priority might be given to
very low elevations (for atmospheric determination) and very high
elevations (to get good leverage on the parameter fits).

Note that the optimizing modes are somewhat experimental.  If they are
used, the output schedule should be checked carefully.

\rcwbox
{Four real numbers to be interpreted as elevations in degrees.}
{Any valid elevation (0 to 90 degrees)}
{All zero.}
{Only one set of values, the last, used for the project.}
{{\tt OPELPRIO = 2., 15., 75., 90.}}

\subsubsection{\label{MP:OPHA}{\tt OPHA}}

{\tt OPHA} is the parameter for {\tt OPTMODE=HAS} that sets the desired
hour angle at the reference station 
{\hyperref[MP:OPHASTA]{{\tt OPHASTA}}}
for this scan.  If this parameter is not set, \schedb figures out how
many scans there are on the source, when the source can first be
seen (either because of elevation limits or experiment start time) and
when it can last be seen.  It then spaces the desired observation times
evenly between those times.

The weight based on deviation from the desired hour angle is calculated
using the formula:
\begin{verbatim}
  TIMEWT=OPHAWT(JSCN)*(0.5+(1.0/PI)*
           ATAN(1.5*(TAPPROX-OPHAT(JSCN))/ OPHAWIDT(JSCN)))
\end{verbatim}
where {\tt OPHAT} is {\tt OPHA} converted to a time, {\tt TAPPROX} is the
proposed observe time of the next scan, and {\tt OPHAWT} and {\tt
OPHAWIDT} are other \schedb input parameters.  Note {\tt TAPPROX} is
likely to be adjusted slightly once the scan is chosen and full
account of slew times is taken.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\subsubsection{\label{MP:OPHMAXDT}{\tt OPHMAXDT}}

{\tt OPHMAXDT } is the parameter for {\tt OPTMODE=HAS} that sets
the maximum deviation from the desired hour angle that a scan will
be considered.  This helps limit the number of scans considered at
any one time but, most importantly, prevents use of the scan at an
inappropriate time, for example, because no appropriate scan was
available at that time.  Because of this parameter and {\tt OPDUR}
is is possible to not use all input scans.  Users should watch for
this and probably adjust scan parameters to fix the problem.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real time}
{Any}
{2:0:0 (2 hours)}
{Uses the most recent value specified.}
{{\tt OPHMAXDT = 30:00 }}

\rcwbox
{Any real hour angle}
{Any}
{Zero.  \schedb will pick the values.  The default is usually what you
will want.}
{Uses the last value specified.  It is not a good idea to specify one
and not the others as then all scans will have the same desired hour
angle and the behavior will probably be a bit weird.}
{{\tt OPHA=PT }}

\subsubsection{\label{MP:OPHAWID}{\tt OPHAWID}}

{\tt OPHAWID } is the parameter for {\tt OPTMODE=HAS} that sets the
normalization time (normal time format) for the tolerance for
deviation from the specified hour angle.  A larger value allows \schedb
to be a more sloppy with placement of the scan.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real time, usually in a format like 30:00 for 30 minutes.}
{Any positive value}
{Zero.  Set to the spacing between desired scans on the source.}
{Uses the most recent value specified.}
{{\tt OPHAWID = 30:00 (for 30 minutes)}}

\subsubsection{\label{MP:OPHAWT}{\tt OPHAWT}}

{\tt OPHAWT } is the parameter for {\tt OPTMODE=HAS} that sets the
relative importance of the deviation from the desired hour angle
compared to minimizing slew time or getting a scan near a limit.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real number.  But negatives don't really make sense.}
{Any}
{1.0.}
{Uses the most recent value specified.}
{{\tt OPHAWT = 3.5}}

\subsubsection{\label{MP:OPHASTA}{\tt OPHASTA}}

{\tt OPHASTA } is the parameter for {\tt OPTMODE=HAS} that sets the
reference station at which hour angles are calculated.  It is usually
best to choose a station in the middle of the array, such as Pie Town
({\tt VLBA\_PT} or {\tt PT}) for the VLBA.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{A station name or station code matching a scheduled station.}
{Any valid station in the schedule}
{{\tt PT}}
{Uses the one value for the experiment - the last specified.}
{{\tt OPHASTA = VLBA\_LA}}

\subsubsection{\label{MP:OPHLIMTI}{\tt OPHLIMTI}}

{\tt OPHLIMTI } is the parameter for {\tt OPTMODE=HAS} that sets the
normalization for the time offset from the limits of when a source
is up.   The equations for the weights for rise and set are:
\begin{verbatim}
  RISEWT=MAX(0.0,OPHLIMWT(JSCN)*(1.0-ABS(HA1(JSCN,RSTA)-HAMIN(JSCN))*
             3600.0/OPHLIMTI(JSCN)))
  SETWT=MAX(0.0,OPHLIMWT(JSCN)*(1.0-ABS(HA1(JSCN,RSTA)-HAMAX(JSCN))*
             3600.0/OPHLIMTI(JSCN)))
\end{verbatim}
where {\tt HA1} is the hour angle of the proposed scan, {\tt HAMIN}
and {\tt HAMAX} are the hour angles at which the source rises or
sets.  This only worries about the rise and set times.  Some day
it maybe should also worry about experiment start and end.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real hour angle - in seconds.}
{Any}
{1800.0}
{Uses the most recent value specified.}
{{\tt OPHLIMTI = 1200.D0}}

\subsubsection{\label{MP:OPHLIMWT}{\tt OPHLIMWT}}

{\tt OPHLIMWT } is the parameter for {\tt OPTMODE=HAS} that sets the
relative importance of the weighting based on being near the
rise or set time of a source.  For the equations
for these weights, see 
{\hyperref[MP:OPHLIMTI]{{\tt OPHLIMTI}}}.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real number}
{Any}
{Zero.}
{Uses the most recent value specified.}
{{\tt OPHLIMWT = 1.0 }}

\subsubsection{\label{MP:OPMINSEP}{\tt OPMINSEP}}

{\tt OPMINSEP } is the parameter for {\tt OPTMODE=HAS} that is used
to prevent two scans on the same source from being scheduled too close
together.  \schedb determines the default spacing of scans --- evenly
spaced across the available time --- regardless of whether the user
overrides that default by specifying the desired hour angles.  That
default spacing is multiplied by {\tt OPMINSEP} to get the minimum
separation.  Once a scan is scheduled,
another scan on that source will not be scheduled until after that
minimum separation has passed.  A different value can be given for
each scan.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real hour angle, although usually a fraction between about 0.0 and 1.0}
{Any}
{0.0 which means don't have a minimum separation.}
{Uses the most recent value specified.}
{{\tt OPMINSEP = 0.4}}

\subsubsection{\label{MP:OPMISS}{\tt OPMISS}}

{\tt OPMISS} is used to reduce the priority of some sources when
using {\tt OPTMODE = 'SCANS'}.  The current scan will only be
accepted if the {\tt OPMISS} scans have been skipped.  See
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more details.

\rcwbox
{Any integer}
{Any}
{Zero.  No scans will be skipped.}
{Uses the last value specified.  So if one scan is given a high
number, be sure to drop the value for the next.}
{{\tt OPMISS = 7}}

\subsubsection{\label{MP:OPMINEL}{\tt OPMINEL}}

{\tt OPMINEL} specifies the minimum elevation in degrees below which
sources will be considered to be ``down''.  In all modes, if less than
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}} antennas are up, the scan will
be skipped.

This is used mainly for optimizing modes to help select scans, and
for experiment planning in order to, for example, plot the uv
coverage available if all low elevation data and all data with less
than several antennas will be discarded.  The default will have no
effect on schedules.

\rcwbox
{A real number to be interpreted as an elevation.}
{Any valid elevation.}
{0.0}
{On per scan.  Defaults to previous scan.}
{{\tt OPMINEL = 15.}}


\subsubsection{\label{MP:OPMINANT}{\tt OPMINANT}}

{\tt OPMINANT} sets minimum number of antennas for which the
source must be up for the scan to be accepted.  To be up, a source
must be above the telescope slew limits, any specified horizon, and
above {\tt OPMINEL}.

This is used mainly for optimizing modes to help select scans, and
for experiment planning in order to, for example, plot the uv
coverage available if all low elevation data and all data with less
than several antennas will be discarded.  The default will have no
effect on schedules.  A separate value can be specified for each
scan.

\rcwbox
{An integer. }
{Any}
{0}
{One per scan.  Defaults to previous scan.}
{{\tt OPMINANT = 4}}


\subsubsection{\label{MP:OPNOSUB}{\tt OPNOSUB}}

{\tt OPNOSUB} tells the \schedb optimizing modes not to allow
subarraying.  All antennas are to be scheduled in all scans, regardless
of whether the source is up.

Note that the optimizing modes are somewhat experimental.  If they are
used, the output schedule should be checked carefully.

\rcwbox
{None}
{None}
{Not set --- allow subarraying.}
{Only one value used for schedule --- the last.}
{{\tt OPNOSUB}}


\subsubsection{\label{MP:OPPRTLEV}{\tt OPPRTLEV}}

{\tt OPPRTLEV} tells the \schedb optimizing modes how much extra information
on the inner workings of the scan choice to print.  So far, it is only
used for 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE=HAS}}}.  See the description in
the section on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for details.

\rcwbox
{A integer.}
{Useful values are between 0 and 3}
{0, which gives only bare summaries.}
{Only one value used for schedule --- the last.}
{{\tt OPPRTLEV=3}}


\subsubsection{\label{MP:OPSKIP}{\tt OPSKIP}}

In optimizing mode ``{\tt SCANS}'', skip each source {\tt OPSKIP}
times after it is last seen, unless it is in the {\tt OPELPRIO}
elevation range.  This parameter is not applied to pointing (and Ta
and PN3DB) observations when they are mixed with other types of
scheduling.  It is always applied when {\tt OBSTYPE} is {\tt NONE}
or {\tt PTVLBA}.

Note that the optimizing modes are somewhat experimental, especially
this one!  If they are used, the output schedule should be checked
carefully.

\rcwbox
{An integer, usually small.}
{Any}
{0}
{Only one value used for schedule --- the last.}
{{\tt OPSKIP = 2 }}

\subsubsection{\label{MP:OPSLEWTI}{\tt OPSLEWTI}}

{\tt OPSLEWTI } is the parameter for {\tt OPTMODE=HAS} that is used
to normalize the weighting based on slew time.  The slew time weight
is set by the equation:
\begin{verbatim}
 SLEWWT = MAX(0.0,OPSLEWWT(JSCN)*(1.0-OPSLEW/OPSLEWTI(JSCN)))
\end{verbatim}
Where OPSLEW is the difference between the stop time of the previous
scan and the time when all antennas are ready to observe the scan
being tested.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real hour angle}
{Any}
{Zero.}
{Uses the most recent value specified.}
{{\tt OPSLEWTI = 1:0:0 }}

\subsubsection{\label{MP:OPSLEWWT}{\tt OPSLEWWT}}

{\tt OPSLEWWT } is the parameter for {\tt OPTMODE=HAS} that sets
the relative importance of the weight based on slew time compared to
the other weights.  See 
{\hyperref[MP:OPSLEWWT]{{\tt OPSLEWWT}}} for
the equation used to set the slew weight for a scan.

See the discussion of the possible optimization modes in the section
on 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more information on
{\tt OPTMODE=HAS}

\rcwbox
{Any real number.  Positive is best.}
{Any}
{Zero. Don't pay attention to slew times.}
{Uses the most recent value specified.}
{{\tt OPSLEWWT = 1.0}}


\subsubsection{\label{MP:OPTMODE}{\tt OPTMODE}}

{\tt OPTMODE} sets the optimization mode.  The valid modes are:

\begin{description}

\item[{\tt NONE}.]  This is the default.  The input schedule will
be used as specified.

\item[{\tt SCANS}.]  For this mode, the schedule will be followed as
specified.  However only scans with more than 
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}}
antennas with the source up (above the horizon
and within the slew limits) and above {\tt OPMINEL} will be accepted.
For each accepted scan only those antennas that are up and above {\tt
OPMINEL} will be scheduled unless {\tt OPNOSUB} is specified.  {\tt
DWELL} would normally be specified to allow for slews.  Subarraying
will happen if two successive sources can only be seen by different
antennas since the optimization keeps track of the previous scan on a
per-antenna basis.

The usual way to use this mode is to specify a loop containing all
the desired sources (and frequencies etc.) and lasting longer than
the desired total time.  Then the optimization will pick the scans
that make sense and will quit after {\tt OPDUR}.  This mode is
especially useful for scheduling pointing observations.

There is a trick available, triggered by {\tt OPSKIP}, that is an
attempt to emphasize scans in desirable elevation ranges (set by
{\tt OPELPRIO}.  If a loop is used, this will cause scans to be
skipped {\tt OPSKIP} times before they are used again unless they
are in the desired elevation ranges.

There is another trick to give low priority to some scans using
{\hyperref[MP:OPMISS]{{\tt OPMISS}}}.  The current scan will only
be accepted if at least {\tt OPMISS} preceding scans in a row
have been missed.  If, for example, you have a loop of scans,
as is typical in pointing schedules, and you have one that you
only want to have used if all others are unacceptable (eg too low),
then set {\tt OPMISS} to the length of the loop.

\item[{\tt CELLS}.]  For this mode, the input scan list is treated
as a pool of possible scans.  The sky over each antenna is divided
into 9 cells (3 X 3 in Az and El) and the time that each cell
was sampled is recorded.  For each output scan, all input scans
are checked for which cells they sample and a weight is calculated
based on the time since the last time that cell was sampled.  The
weight is adjusted to discourage long slews with the characteristic
time scale of that discouragement set by {\tt OPTSLEW} in minutes.
Also, if some low elevation cells for a station have not been
sampled in a long time (characteristic time scale set by {\tt OPTLOWT},
the weight for other low elevation cells will be increased.  This
tries to compensate for edge stations that have no mutual visibility
with the rest of the array for sources at low elevation in certain
directions.  The input scan to use is then selected based on the
adjusted weights.

This mode is an attempt to provide a mechanism for scheduling
geodetic type observations.  Parameters {\tt OPMINANT, OPMINEL,
OPDUR,} and {\tt  OPNOSUB} have the same meanings for {\tt CELLS}
mode as for {\tt SCANS}.  The {\tt CSUB} mode is able to do almost
the same thing as this mode plus it handles subarraying.  It may
eventually completely replace the {\tt CELLS} mode.

\item[{\tt CSUB}.]  This mode is much like the {\tt CELLS} mode except
that it uses subarrays.  The sky over each antenna is divided into 9
cells.  For each possible pair or sources, a scan is constructed with
each antenna observing the source for which the priority is highest.
The priority is the result of the time since the cell the source is in
was sampled adjusted to downweight long slews ({\tt OPTSLEW}) and
upweight low elevation scans when other low elevation cells are not
being sampled ({\tt OPTLOWT}).  If the minimum number of antennas per
scan (
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}}) is not satisfied, some
are shifted so that it is.  Then the subarrayed scan is compared with
single source scans with each of the two sources and the best option
chosen.  There is a weighting factor which favors the single source
cases and has been adjusted so that something less than half the scans
include all stations.  Some day this should be made an input
parameter.  Finally, if there are more than 2 antennas left over, they
are put in a third subarray with an optimized source.

Like the {\tt CELLS} mode, this mode is for geodetic type
observations.  Various parameters have the same meaning here as for
the other modes except that OPNOSUB is not allowed since it doesn't
make sense.  Also, 
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}} is a goal.
The third subarray can have less as can one of the other two under
certain very special circumstances.

\item[{\tt UPTIME}.] This mode is designed for experiment planning.
For each input scan, it creates a string of scans of duration
{\hyperref[MP:DUR]{{\tt DUR}}} or 
{\hyperref[MP:DWELL]{{\tt DWELL}}}, spaced
by 
{\hyperref[MP:GAP]{{\tt GAP}}} (helps interpret UV plots), and lasting
for total time 
{\hyperref[MP:OPDUR]{{\tt OPDUR}}}.  All such series of
scans start at the start time of the first scan.  Usually ({\tt
OPDUR=24:00:00}) would be used to examine a whole day or the actual
start time and total duration of allocated time would be used.  Each
input scan would normally be on a different source.  Note that this
mode gives a backward time jump at the first scan based on each input
scan.  For this reason, writing telescope control files based on this
optimization mode is not allowed.

\item[{\tt HAS}.] For this mode, the user provides the scans that
should be observed.  All parameters of the scans are retained, except
the times.  As SCHED runs, once one scan is processed, the next is
chosen from those that remain based on an attempt to come close to the
desired reference station hour angle.  The user can specify the
desired hour angle, or can take the default which is to spread the
scans on each source evenly over the time interval during which it can
be observed with enough stations above a specified elevation limit.
The scan is chosen based on a weight which is the sum of a weight
based on deviation from the desired time, a weight based on the slew
time from the previous scan (to help try to minimize time lost to
slewing), and weights based on proximity to the start and end of the
time the source can be observed.  There is an example schedule among
the sched examples called {\sl eghas.key} that shows a way of using
this mode for survey type observations where there is a desire to
observe many sources, each over a wide hour angle range to get good UV
coverage.

{\tt OPTMODE=HAS} should not be used to schedule projects longer than
24 hours.  In that case, hour angles can be ambiguous.  Note that for
normal schedules the 4 minute difference between the sidereal and solar
days will not be important partly because only scan start times are
considered.  However there is just a chance of weird behavior for an
observation of 24 hours UT duration and short scans.

There are a number of input parameters to help guide the {\tt HAS}
mode in it's selection of scans.  Important parameter include
{\hyperref[MP:OPDUR]{{\tt OPDUR}}}, which sets the total length of the
observations, 
{\hyperref[MP:OPMINANT]{{\tt OPMINANT}}}, which sets the
minimum number of stations that must be up for a scan to be chosen and
{\hyperref[MP:OPMINEL]{{\tt OPMINEL}}}, which sets the minimum elevation
a station must be above to be considered to be up.  Note that to be
considered to be up, a station must also be above the local horizon as
specified in the station catalog.

{\hyperref[MP:OPHASTA]{{\tt OPHASTA}}} sets the reference station for
this mode.  This is the station at which the hour angles will be
measured.  Either the full name or the station code, if unique, can be
used.  
{\hyperref[MP:OPHA]{{\tt OPHA}}} sets the desired hour angle (at
the reference station) for this scan.  
{\hyperref[MP:OPHAWID]{{\tt OPHAWID}}}
sets a normalization time interval relative to
the desired hour angle over which the scan weight increases.
{\hyperref[MP:OPHAWT]{{\tt OPHAWT}}} is a normalization factor for
weights related to time offset from the desired hour angle.  This and
other weight normalization factors mentioned below help adjust the
relative importance of the different factors such as offset from the
desired time, slew time, and proximity to other scans on the same
source.  
{\hyperref[MP:OPHASTA]{{\tt OPHASTA}}} is used to set the
station for which the desired hour angles apply.  
{\hyperref[MP:OPMINSEP]{{\tt OPMINSEP}}}
sets the minimum separation of scans on a
source as a fraction of the spacing of scans that would be used if
they were spread evenly across the available time for that source.
{\hyperref[MP:OPSLEWTI]{{\tt OPSLEWTI}}} and 
{\hyperref[MP:OPSLEWWT]{{\tt OPSLEWWT}}}
set the reference time and the normalization
factor for the weights related to slew time.  The slew weight is {\tt
OPSLEWWT * ( 1 - (slew time))}/{\tt OPSLEWTI}).
{\hyperref[MP:OPHLIMTI]{{\tt OPHLIMTI}}} and
{\hyperref[MP:OPHLIMWT]{{\tt OPHLIMWT}}} set a similar normalization and
weight for the proximity to the extreme times at which a source can be
observed.  This latter is used to encourage a scan on the source, for
example, before it sets.  
{\hyperref[MP:OPHMAXDT]{{\tt OPHMAXDT}}} sets
the maximum deviation from the desired hour angle at which a scan will
be considered.  This prevents using very inappropriate scans when no
other scans are available.  Most of the above parameter can have
different values for different scans.

The equations for the various weights are given in the descriptions
for the parameters 
{\hyperref[MP:OPHA]{{\tt OPHA}}}, 
{\hyperref[MP:OPSLEWTI]{{\tt OPSLEWTI}}}, and 
{\hyperref[MP:OPHLIMTI]{{\tt OPHLIMTI}}}.  For
the most accurate information on how weights are set, look at the code
in {\sl \$SCHED/src/Sched/opthas.f}.

When the {\tt HAS} mode is used, a lot of information from the guts of
the algorithm can appear in the {\sl sched.runlog} depending on the
setting of the parameter 
{\hyperref[MP:OPPRTLEV]{{\tt OPPRTLEV}}}.  For
each output scan, some details of the weights etc for each possible
choice from among the input scans are given ({\tt OPPRTLEV=3}) or just
a summary for the scan can be given ({\tt OPPRTLEV=2} or higher).  At
the end, for {\tt OPPRTLEV=1} or higher, the properties (like
available observing time) and fate of each input scan are given in a
table.  Also a number of summary parameters are given for any {\tt
OPPRTLEV}.  All this information, while bulky, should help a user
figure out how to drive the program --- how to set set the related
input parameters.  But beware that, for {\tt OPPRTLEV=3}, the {\sl
sched.runlog} can be very large.

While constructing a schedule using this mode, it is very useful to
use the plotting capability of \sched.  The UPTIME and UV Plot capabilities
are especially useful in understanding what you have.  Also note that
when \schedb runs, it creates an output file with the extension {\tt .sch}
that could be used as the scan input section for another run of \sched.
So if the optimization mode comes close, but you wish to make a small change,
it is possible.  This is an old but little used capability and has not
actually received any maintenance for a long time as of late 2005.


In its early form, the {\tt HAS} mode is meant to be useful particularly for
scheduling surveys.  But at the moment, there is no way to associate scans
so it would be difficult to use it for phase referencing.  Also it would
be awkward to use to schedule blocks of scans around the sky for atmospheric
solutions (for aips task DELZN).  These limitations should be removed
in future versions.

\item[{\tt HIGHEL:}.] This mode is used, mainly for test observations,
to allow SCHED to pick a scan with good elevation across the array from
among a group of scans.  The number of scans from which to pick is
specified with 
{\hyperref[MP:HIGROUP]{{\tt HIGROUP}}}.  \schedb will do the 
geometry calculations for each of the {\tt HIGROUP} scans and pick the
one with the highest minimum elevation.  It will keep that scan and
skip the others in the group.  This is especially useful for the 
data quality tests and startup scripts.  See example 
{\href{examples/dqhiel.key}{{\sl dqhiel.key}}}.

\end{description}

In some optimizing modes, \schedb will not schedule a scan that crosses
0 hr UT.  This is also used to be true for dwell time scheduling, but it
no longer seems to be useful --- downstream processing doesn't trip over
such scans.

{\sl Note that the optimization modes are somewhat experimental.  If
they are used, the output schedule should be checked carefully.}

\rcwbox
{A mode.}
{{\tt 'NONE', 'SCANS', 'CELLS', 'CSUB',} and {\tt 'UPTIME'}}
{\tt NONE}
{Only one used in schedule --- the last.}
{{\tt OPTMODE 'CELLS'}}


\subsubsection{\label{MP:OPTLOWT}{\tt OPTLOWT}}

{\tt OPTLOWT} is a time scale in minutes for upweighting any low
elevation data in optimization modes {\tt CELLS} and {\tt CSUB} if
other low elevation cells are not being sampled.  See 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} for more details.

\rcwbox
{Any time in minutes (mmm.mm format) }
{Any time}
{15 --- this is a reasonable value.}
{Only one value used for project.}
{{\tt OPTLOWT = 10}}

\subsubsection{\label{MP:OPTSLEW}{\tt OPTSLEW}}

{\tt OPTSLEW} is a characteristic time scale in minutes for slews
beyond which to start discouraging use of scans on the grounds that
the slews are too long.  This is used for several optimizing modes.
See the description of {\tt OPTMODE} for more details.

\rcwbox
{Any time in minutes (mmm.mm format)}
{Any time}
{1.0 --- a reasonable value.}
{Only one value used for project}
{{\tt OPTSLEW=2.0}}


\subsubsection{\label{MP:OVERRIDE}{\tt OVERRIDE}}

{\tt OVERRIDE} is a switch that programmers can use to allow them to
bypass restrictions imposed on most users.  Commonly this will be to
allow them to test features that users are not yet allowed to try. It is
unlikely to be useful to users, only to programmers.


\subsubsection{\label{MP:OVERWRIT}{\tt OVERwrit}}

If {\tt OVERwrit} is specified, \schedb will overwrite any output
files that already exist on disk.  By default, \schedb will abort
if it finds any old files of the same names as those it is trying to
create.  That mode is provides some protection against errors, but
may be annoying when running lots of test cases.

\rcwbox
{None}
{None}
{Do not overwrite files.}
{Only one specification used --- the last}
{{\tt OVERWRIT}}


\subsubsection{\label{MP:PCAL}{\tt PCAL}}

{\tt PCAL} sets the mode of the pulse cal generators on the VLBA. The
generators can be off or can generate tones every 1~MHz or every
5~MHz. The input here can be used to change the mode from scan to
scan. A default can be established in the setup file.  Note that, if
{\tt PCAL} is specified in the schedule, it will override what is
in the setup file, even if a new setup is invoked.

Control over the phase cal detection is not implemented for telescopes
controlled by means of the VEX file. See notes on 
{\hyperref[SSEC:MKIV]{MkIV}} and 
{\hyperref[SSEC:S2]{S2}} for details. In the EVN,
standard practice is to use 1 MHz spaced tones at integer MHz
values. Spectral line users that want to switch phase-cal insertion
off should send special instructions to individual telescopes, as well
as specifying it correctly in the schedule.

\rcwbox
{The pulse cal mode.}
{{\tt ' '}, {\tt 'off'}, {\tt '1MHz'}, or {\tt '5MHz'}. A {\tt ' '}
causes the setup file value to be used.}
{Use the setup file value. If none there, use {\tt '1MHz'}.}
{Defaults to previous scan.  This applies even if there is a change
of setup.}
{{\tt PCAL='off'}}


\subsubsection{\label{MP:PCENTERS}{\tt PCENTERS}}

Specifying {\tt PCENTERS} followed by a "/" causes \schedb to read
groups of phase centers for use with multiple-phase center processing
on the DiFX correlator.  This is much like the reading of in-line
catalogs with {\tt SRCCAT} or {\tt STACAT}.  Each specified group has
a name specified with {\tt NAME} and a list of source names specified
with {\tt SOURCES}.  All of these sources should be in the source
catalogs.  It will be common to use a file, specified with
{\hyperref[MP:SRCFILE2]{{\tt SRCFILE2}}} to specify all the ``sources''
used as phase centers.

After the last phase center group, a line with
{\tt ENDCENT /} should be given to return \schedb to reading normal
program input.  There is an example {\sl egcent.key} that demonstrates
the capability.  The main effect will be the listing of the phase
centers

\rcwbox
{Just the word {\tt PCENTERS} followed by a "/"}
{None}
{Not used}
{Use only once per schedule file.}
{{\tt PCENTERS /}}


\subsubsection{\label{MP:PEAK}{\tt PEAK} and {\tt NOPEAK}}

{\tt PEAK}, if specified, will cause commands to be issued to tell
some antennas to peak up their pointing.  {\tt NOPEAK} causes
\schedb to stop issuing those commands.

As of March 1999, {\tt PEAK} is no longer used to control VLA
pointing.  Please see parameter 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}}.

Warning, {\tt NOPEAK} takes precedence over {\tt PEAK} if given in
the same scan.  \schedb has no way to tell that the {\tt PEAK} is new
rather than left over from the previous scan.  Often {\tt NOPEAK}
is given right after the peaking scan inputs to ensure that peaking
doesn't get left on in the next scan.  But if that next scan is 
meant to be a peaking scan, say on a different set of antennas, you
will not get what you want.  We have received user files like this.

For the VLBA, if {\tt PEAK} is greater than {\tt 0}, a peakup will be
done using the channel number specified by the {\tt PEAK} argument.
The peakup begins either when the scan starts, or when the antenna
reaches the source, whichever is later.  But the on-line system will
wait for a maximum of 30 or 40 seconds to reach source before giving
up. If it will take longer than that to reach source, a dummy scan or
a gap between scans should be inserted. The peakup routine reads the
total power after being on each position for 2 seconds and then goes
on to the next position. The pattern contains 10 points. Therefore the
peakup will take 20 seconds plus slew times which may be as little as
30 seconds - call it 45 seconds to be conservative - at high
frequencies. It could take significantly longer at low frequencies but
there is no good reason to use reference pointing there. After the
peakup is done, the results will be used until either another peakup
is done or the project code changes.  Hopefully, we'll have some way
to turn it off eventually.

It will be common to peak up at a different frequency from that being
used for observing (eg peak at 7mm for 3mm observations).  It will
also be common to peak on a line source during a continuum
observation.  Therefore a different setup file will be needed for the
peaking scans.  It is reasonable to use the standard pointing setup
files.  They have names like {\sl pt7mm.set}.  They use {\tt
FORMAT=NONE} which causes the on-line system on the VLBA to
not touch the formatter.  Note that this is very likely to mean
that any pulse cal data gathered during such scans are likely to
be spurious.

For stations other than the VLA and VLBA, adding a PEAK specification
to a scan will help trigger reference pointing observations.  This 
is common for the GBT and Effelsberg.

See the section on 
{\hyperref[SEC:REFPOINT]{reference pointing}} for
much more information on easy ways to insert pointing scans.

This command triggers the addition of {\tt REFERENCE\_POINTING 
INTENTS} to the VEX file.  When similar intents are added using 
VLAPEAK, they are prepended by {\tt VLA:}.  When they are added
because of the use of PEAK, they will not have a station identifier.
The scans before the first scan in which reference pointing is
requested with PEAK will have {\tt "INTENT = REFERENCE\_POINTING\_OFF"}.
All scans for which PEAK is greater than zero will have 
{\tt "INTENT = REFERENCE\_POINTING\_DETERMINE"}.  After the first
determination, any scans with {\tt PEAK} less than or equal to 0 
will have {\tt "INTENT = REFERENCE\_POINTING\_APPLY"}.  The {\tt PEAK}
scheme needs to be enhanced if we are going to treat different 
stations differently.

\rcwbox
{A digit that for the VLBA is a baseband channel number.}
{See discussion above.}
{Don't peak up.}
{Defaults to previous scan.}
{{\tt PEAK=3}}


\subsubsection{\label{MP:PEAKFILE}{\tt PEAKFILE}}

{\tt PEAKFILE} is used to specify an external file containing
parameters to control automatic insertion of 
{\hyperref[SEC:REFPOINT]{{\tt reference pointing}}}
scans.  The default is the file provided
with the \schedb distribution.  The same information can be put
in the main \schedb input using 
{\hyperref[MP:PEAKINIT]{{\tt PEAKINIT}}}.

\rcwbox
{A file name of up to 80 characters}
{Any file name}
{{\tt \$SCHED/catalogs/peak.cmd} on unix systems.}
{Only the last value specified is used.}
{{\tt peakfile=mypeak.cmd}}


\subsubsection{\label{MP:PEAKINIT}{\tt PEAKINIT}}

{\tt PEAKINIT} tells \schedb that the following lines, up to a
{\tt ENDPEAK} are input in the same format as the
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} and as described in the section on
{\hyperref[SEC:REFPOINT]{{\tt reference pointing}}}.

\rcwbox
{No argument.}
{None}
{Not set}
{Generally only used once.}
{{\tt PEAKINIT /}}


\subsubsection{\label{MP:PHONE}{\tt PHONE}}

{\tt PHONE} is the  Principal Investigator's telephone number before
and after the project. See {\tt OBSPHONE} for the number during the
project.  It is for the cover information.  It must be provided for
observations that record data.

\rcwbox
{Text of up to 64 characters.}
{Any.}
{Blank.}
{Only one value used, the last.}
{{\tt PHONE='+1-505-835-7392. (Ask for ET).'}}


\subsubsection{\label{MP:PINAME}{\tt PINAME}}

{\tt PINAME} is the name of the Principal Investigator.  Actually,
the person who should be used here should be the one who is organizing
the project, not necessarily the one leading the proposal.  With 64
characters, more than one person could be given. \schedb will
abort if {\tt PINAME} is not given for observations that record data.
This is for the cover information.

\rcwbox
{Text of up to 64 characters.}
{Any.}
{Blank, causing \schedb to abort.}
{Only one value used, the last.}
{{\tt PINAME='E.T. Smith'}}


\subsubsection{\label{MP:PKWATCH}{\tt PKWATCH}}

{\tt PKWATCH} is used with the automatic insertion of 
{\hyperref[SEC:REFPOINT]{reference pointing}} scans.
If specified, information will be sent
to the standard output about how pointing sources are chosen.  This
may help the user understand why expected sources are not used or
other problems of the sort.  It produces lots of output so it is best
to redirect the program output to a file when it is used.  In unix, this
is done by running \schedb with a line of the form:

{\tt sched < eg3mmc.key > ptg.out}

\rcwbox
{No argument}
{None}
{Not set --- no special output}
{Only last value used.}
{{\tt PKWATCH}}


\subsubsection{\label{MP:PLOT}{\tt PLOT}}

{\tt PLOT} is a switch that activates the plotting section of
\schedb which is described more fully in Section~\ref{SEC:PLOT}.
If plotting is desired, it is best to start \schedb interactively
and specify {\tt PLOT} and {\tt SCHEDULE=yourfile.key /}.  \schedb
will then go get the schedule from {\tt yourfile.key} (substitute
your actual schedule file name) and then come back for interactive
input to the plot section.

\rcwbox
{None.}
{None.}
{No plotting.}
{Only one used per schedule --- the last.}
{{\tt PLOT}}


\subsubsection{\label{MP:POINT}{\tt POINT}}

{\tt POINT} is used to tell \schedb to convert this scan to a
{\hyperref[SEC:REFPOINT]{reference pointing}} scan.  If the argument
is zero (which is the value it will get if {\tt POINT} is specified
without an argument), all stations that are in any group and have
appropriate frequencies as specified in the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} (see also 
{\hyperref[MP:PEAKINIT]{{\tt PEAKINIT}}}) will
be used.  If {\tt POINT} has a value, only stations in that group
from the 
{\hyperref[MP:PEAKFILE]{{\tt PEAKFILE}}} will be used.  When
{\tt POINT} is specified for a scan, \schedb restricts the stations
to those in the pointing group(s), switches to the pointing setup
file, sets DOPPLER if the source velocity (first) is not zero, turns
off recording, and sets other parameters needed to make a pointing
scan.  The parameters of the main scan are not affected.  The object
is to allow the user to explicitly set the times and source for
pointing, but allow \schedb to take care of all the other messy
details of converting the scan to a pointing scan.

{\tt POINT=-1} means don't add a pointing scan even if you can.  This
is useful especially when 
{\hyperref[MP:AUTOPEAK]{{\tt AUTOPEAK}}}) has
been specified, but you are doing low frequency scans.

To turn 
{\hyperref[MP:AUTOPEAK]{{\tt AUTOPEAK}}}) back on after using
{\tt POINT=-1}, set {\tt POINT} to a value less than -1, say -2 or
-999 (the value it has in the program if not set).

\rcwbox
{None or a number.  None means zero.  The number specifies a pointing group.  -1 means don't add pointing here.}
{Any integer 0 or above, but should match a pointing group if not zero}
{Not set (actually set to -999)}
{Set back to the unset state for each scan to avoid doing the
whole schedule in pointing mode}
{{\tt POINT=2}}


\subsubsection{\label{MP:PN3DB}{\tt PN3DB} and {\tt NOPN3DB}}

{\tt PN3DB} tells \schedb to write a VLBA tracking test sequence in
the VLBA control file for this scan. {\tt NOPN3DB} tells \schedb
to stop writing such sequences.  This parameter should only be of
interest to VLBA operations staff.  The sequence, which is not a
loop, starts with a scan of length {\tt PTSLEW} to set levels at
the half power point, then does a 15 second scan at the same place
to fix those levels, then does one scan each of length {\tt PTDUR}
at off source and on peak positions, then tracks the source at
the azimuth half power point.  That is followed by an off source,
on source, and half power in elevation tracking sequence.  {\tt PTINCR}
in the setup file is used to set the distance to the half power point.
The periods of tracking are the full scan duration minus all the
level fixing, off, and on scan durations, divided by two.  Scan
durations of about an hour are appropriate.


\rcwbox
{None.}
{None to set. {\tt NOPN3DB} to go back to non-pointing modes.}
{Not used.}
{Reverts to previous scan if not specified.}
{{\tt PN3DB}}


\subsubsection{\label{MP:PRECDATE}{\tt PRECDATE}}

The user provides \schedb with source coordinates in one of the J2000,
B1950, or DATE coordinate systems.  \schedb then determines the source
coordinates in the other systems.  The J2000 and B1950 systems are not
stationary with respect to each other.  To do a proper conversion, it
is necessary to specify for which date to do the conversion.  This
date is specified using {\tt PRECDATE}.  When \schedb converts from,
for example, B1950 to J2000 coordinates, it uses the B1950 equations
to precess to {\tt PRECDATE}, and then the J2000 equations to precess
from there to equinox 2000.  If the wrong date, by many years, is used,
the errors in the conversions will be a few tenths of an arc second.
This is enough to harm phasing of the VLA at high frequencies and
enough to be rather undesirable for positions used on the correlator.

The correct {\tt PRECDATE} to use depends on various factors.  If the
target source coordinates are being provided in the J2000 system, as
they really should be, then it doesn't matter much.  The correlator
and the VLA will be given the J2000 positions so no conversion is
involved.  Some antennas will be given B1950 coordinates for pointing,
but for single dishes, the few tenths of an arcsecond differences that
can be caused by different {\tt PRECDATEs} are not important.

The more important case is when the user has a B1950 coordinate for
the target source and wants \schedb to take care of the conversion to
J2000.  Then the correct {\tt PRECDATE} should be used.  The correct
date depends on how the B1950 coordinates were measured.  If they
were determined based on absolute measurements made on some date,
that is the date that should be used.  However, most target source
positions will be based on measurements of offsets from some
calibrator.  Then the date that should be used depends on the nature
of the calibrator positions.  
E.g, MERLIN uses a PRECDATE of 1950.0 as the default in the STARLINK
COCO precession routine.  On MERLIN, The calibrator positions
presumably are all based on measured positions originally determined
in J2000 (by VLBI etc), then converted to the B1950 coordinates that
are required by the on-line system.  Those conversions have all been
done assuming an ``observe'' date of 1950.0.  Thus, if you have B1950
source positions determined by offsets from a calibrator using MERLIN,
{\tt PRECDATE=1950.0} should be used.

If anyone knows what other systems of general interest do, let
Craig Walker know and a section can be added here.

The default {\tt PRECDATE} in \schedb has changed a few times over the
years.  Prior to 5 Aug 1997, a date of 1985.0 was hardwired into
the program.  After that, the user parameter was introduced with a
default of 1997.0.  On 6 May 1998, the default in the development
version of the code, and hence the next release (unknown date at this
writing) was changed to 1979.9, the old VLA value (the EVLA does not
use B1950 coordinates at all).

\rcwbox
{A fractional year.}
{Any valid time.  See the discussion above.}
{1979.9}
{Only one value is used.}
{{\tt PRECDATE = 1950.0}}

\subsubsection{\label{MP:PREEMPT}{\tt PREEMPT}}

{\tt PREEMPT} is used to allow, or not, scans to be preempted
for other purposes.  There are two cases.  {\tt PREEMPT = EXTRA}
tells /schedb and VLBA operations to treat the scans as extras
that can be used to help fill gaps between projects that often
occur with dynamic scheduling.  {\tt PREEMPT = NO} tells
operations not to use the Pie Town and Mauna Kea antennas at
the time of the scan for daily USNO Earth Orientation Parameter
(EOP) observations.  {\tt PREEMPT = OK} means that the time of
the scan can be used for the EOP observations on PT and MK.

The {\tt PREEMPT = EXTRA} option should only be used for a block of
scans at the beginning of the project and another at the end of the
project.  These scans can, and normally will, extend outside the time
assigned by the Time Allocation Committee.  The scans that do not have
{\tt PREEMPT = EXTRA} are considered to be the ``core'' and should
stay within the time allocation.  If \schedb finds any ``{\tt EXTRA}''
scans in the ``core'', it will complain and stop.  The {\tt EXTRA}
scans should be designed to enhance the goals of the project but
should not be critical to it as they may well not get observed.  Also,
they should not be used to do what is effectively a different project.

Scans that have {\tt PREEMPT = EXTRA} will not be written to the
output files other than the summary file unless they are included in
the range of scans specified with 
{\hyperref[MP:DOSCANS]{{\tt DOSCANS}}}.
The files affected are the {\sl .vex, .oms, crd.xx, sch.xx,} and {\sl
.flag} files.  These include all the antenna control files, so as far
as the telescopes are concerned, these scans do not exist unless
explicitly included in {\tt DOSCANS}.  Generally {\tt DOSCANS} should
only be used by VLBA schedulers.

Starting in October 2011, the VLBA has been used to provide daily
Earth Orientation Parameter (EOP) observations for the U.S. Naval
Observatory in return for financial support for VLBA operations.
These observations are a geodetic style run of duration up to 1.5
hours using the Pie Town to Mauna Kea baseline.  The observations were
happening within about 4 hours of 18 hours UT.  In early June 2013,
they were shifted to within about 4 hours of 7 UT, during the night.

These observations cause some disruption to normally scheduled
projects.  The fixed and dynamic projects are scheduled in the
normal manner.  Then, if possible, the USNO observations are
inserted in gaps between other projects.  If that is not possible,
the USNO observations preempt the normal project for the two
stations involved.  An effort to minimize the impact on the normal
project is made.  Parameter {\tt PREEMPT} allows the PI to
help with that minimization by specifying portions of the project
that can be preempted and portions that should be protected.  For
example, the parameter can be used to protect key calibration
observations.

{\tt PREEMPT} can be specified for each scan and has three allowed
arguments --- {\tt 'EXTRA'}, {\tt 'NO'} and {\tt 'OK'}.  The default,
{\tt 'OK'}, means that the scan be preempted and is a ``core'' scan.
{\tt 'NO'} means that it should be protected from preemption for the
EOP observations.  {\tt 'EXTRA'} means that this is an extra scan at
the beginning or end.  {\tt 'EXTRA'} implies {\tt 'OK'} as far as
preemption for EOP observations is concerned.  The parameter need only
be specified when it changes.

\schedb will examine the {\tt PREEMPT} specifications and identify
time periods of at least 1.7 hours when all scans allow preemption.
Those times are listed in the {\sl .sum} file and the new {\sl .preempt}
file.  Shorter periods that include the start and/or end of the project
are also listed as those would allow a partial overlap with the USNO
observations.

If there is a period of more than 4 hours between the $>1.7$ hour
preemptable periods, \schedb will complain.  If such periods are left
in the schedule, the user requests for scan protection may be ignored
when choosing when to insert the USNO observations.  If the whole project
is less than 4 hours long and is all protected, a warning will be
issued, but preemption would probably only occur if the project is
adjacent to a higher priority project that also cannot be preempted.

If {\tt PREEMPT} is not specified for any scans, but the project
uses automatic generation of geodetic segments, the geodetic segments
will have {\tt PREEMPT} default to {\tt 'NO'}.  This helps avoid
problems for legacy schedules.

\rcwbox
{A character string of up to 5 characters.}
{'EXTRA', 'OK' or 'NO'.  No other strings allowed.}
{'OK', except see text about geodetic segments.}
{Defaults to previous scan.}
{{\tt PREEMPT = 'NO'}}


\subsubsection{\label{MP:PRESCAN}{\tt PRESCAN}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

Please note: {\tt PRESCAN} is retained mainly for backwards
compatibility and should not normally be used.  However it may be
useful for a few situations with modern schedules.  For example, if
the user using 
{\hyperref[MP:DWELL]{{\tt DWELL}}} wishes to push the scan
further away from the preceding scan, then adding a positive {\tt
PRESCAN}, and lengthening the {\tt DWELL} time by the same amount will
do the job.  That is an alternative to increasing {\tt TSETTLE} in the
station catalog, which the user may not normally want to touch.

Originally, {\tt PRESCAN} was the mechanism for introducing gaps
between scans.  However that function is now better handled using the
separate parameters 
{\hyperref[MP:GAP]{{\tt GAP}}}, 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}}, and 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}.

{\tt PRESCAN} specifies a time by which to offset the nominal start 
of a scan from what has been determined based on all other criteria.
It is applied after all scan timing has been settled.  It won't 
back up (negative value) over the stop of a previous scan, but it
would be capable of messing up scan timing set by other parameters.
It should only be used with considerable care as it should not be
considered a carefully maintained feature.

Note that PRESCAN is treated as a UT time regardless of whether or
not LST scheduling is specified (it is added to the start time after
the schedule times are converted to UT internally in \sched).

If you are writing VEX files, please see the discussion of restrictions
on tape stop time given in the section on parameter 
{\hyperref[MP:GAP]{{\tt GAP}}}.


\rcwbox
{A time.}
{Any time.}
{Zero for all systems except legacy VLBA and MKIV DAR, for which it is
5 seconds.}
{Defaults to previous scan.}
{{\tt PRESCAN=20}, meaning start the scan 20 seconds late.}

\subsubsection{\label{MP:PRESTART}{\tt PRESTART}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt PRESTART} allows the recording to be started before good data is
expected.  It was used to give time for earlier correlators to
synchronize playback.  All correlators now in use are able to sync
quickly so the need to adjust start times to allow for synchronization
is basically gone.  In practice, the the Mark5A units take few seconds to get
going on record which is why the default is 5 seconds for the legacy systems.
For VLBA/RDBE and VLA/WIDAR systems, the default is zero.  The following
discussion is kept to describe the function of {\tt PRESTART} while
the parameter is available.

{\tt PRESTART} gives a time by which to start the recording at a
site before the nominal start time as established by 
{\hyperref[MP:START]{{\tt START}}}, 
{\hyperref[MP:GAP]{{\tt GAP}}}, 
{\hyperref[MP:DWELL]{{\tt DWELL}}}, 
{\hyperref[MP:PRESCAN]{{\tt PRESCAN}}} etc.  Like {\tt
PRESCAN}, if the requested {\tt PRESTART} moves the start of motion to
before the stop time of the previous scan, the recording will just be kept
moving.  But, unlike {\tt PRESCAN}, this time shift is done on a
per-station basis --- if a station was not participating in the
previous scan, it's recording start will be shifted the full
{\tt PRESTART} time, even if that means starting while other stations
are still recording the previous scan.  Also unlike {\tt PRESCAN},
the shift due to {\tt PRESTART} is not reflected in the scan
times reported in the summary or sch files.

The amount of time by which the recording start is shifted before
the nominal start time can be displayed using the {\tt TPSTART} option
in the 
{\hyperref[MP:SUMITEM]{{\tt SUMITEM}}} list.

See the 
{\hyperref[SSEC:SCANTIMES]{section on scan times}} for more
information on controlling scan times.

For PCFS (VEX) controlled stations, the user should bear in mind that
all start times currently (Oct.\ 2001) must be equal. \schedb will issue
a warning if this condition is violated.

Starting the recording early allows time for the correlator to
synchronize the inputs from different stations before the start of
good data.  Anytime the recording stops, the correlator takes time to
resync.  On the old hardware VLBA correlator, that time is empirically
about 8, 13, and 25 seconds for speedup factors 1, 2 and 4
respectively.  Therefore it was best to keep recording through short
gaps.  On other correlators playing Mark5 media, sync is rapid ---
on the order 1 second or less at the JIVE and MarkIV correlators and the
DiFX software correlator (current VLBA), so these concerns are not so
great.

One exception when it may be a good idea to stop recording is when
there will be a formatter reconfigure.  These happen when the internal
switching in the formatter, or the pcal detection setup, change
(number of channels, BBC assignments, sidebands, pulse cal detector
frequencies etc.).  The media does not receive good data while this is
happening and the correlator can have problems recovering sync afterward.
At least a normal resync must happen and occasionally (maybe 10-20\%
of the time) the correlator will get in a bad state and take a long time,
maybe over a minute, to resync.  If the media are stopped during a
reconfigure, a resync will be done normally.

\rcwbox
{A time.}
{Any time.}
{5.0 for legacy systems, 0.0 for VLBA/RDBE and VLA/WIDAR systems.}
{Defaults to previous scan.}
{{\tt PRESTART=15}, meaning start the recording 15 seconds early.}

\subsubsection{\label{MP:PTDUR}{\tt PTDUR}}

{\tt PTDUR} is the duration of each scan during a pointing loop for
the VLBA. This parameter should not be of concern to anyone but VLBA
operations staff.

\rcwbox
{A time in seconds.}
{Any.}
{{\tt 20}}
{Only one value accepted, the last.}
{{\tt PTDUR=15}}


\subsubsection{\label{MP:PTSLEW}{\tt PTSLEW}}

{\tt PTSLEW} is the time allowed in a pointing sequence to get to
source before beginning the raster. This parameter should only be of
interest to VLBA operations staff. In actual use, if a scan start time
is specified, the interval between that start time and the previous
stop time is added to the {\tt PTSLEW} to set the duration of the
slewing scan.  For most pointing observations, it is probably best
to set {\tt PTSLEW} to something small, perhaps the same as {\tt PTDUR},
and use dwell time scheduling.

\rcwbox
{A time in seconds.}
{Any}
{{\tt 160}, a sensible choice.}
{Defaults to previous scan.}
{{\tt PTSLEW=180}}


\subsubsection{\label{MP:PTVLBA}{\tt PTVLBA} and {\tt NOPTVLBA}}

{\tt PTVLBA} tells \schedb to write a VLBA pointing sequence in
the VLBA control file for this scan. {\tt NOPTVLBA} tells \schedb
to stop writing such sequences.  This parameter should only be of
interest to VLBA operations staff. Note that this is not a peak in the
sense that the antenna does not go to the derived position after the
pattern. It is used for measuring pointing offsets and pointing
equations. Parameters {\tt PTSLEW} and {\tt PTDUR} set, respectively,
the time allowed to get to source and the time spent at each position
in the pointing pattern.


\rcwbox
{None.}
{None to set. {\tt NOPTVLBA} to go back to non-pointing modes.}
{Not used.}
{Reverts to previous scan if not specified.}
{{\tt PTVLBA}}


\subsubsection{\label{MP:QUAL}{\tt QUAL}}

{\tt QUAL} specifies a qualifier that will be written along with the
source name to the VLA and VLBA schedules. It is useful for
distinguishing scans of different types on the same source.

{\tt QUAL} is not passed to a VEX file.

\rcwbox
{An integer of up to 3 digits.}
{Any integer of up to 3 digits including sign.}
{{\tt 0} but {\tt 1} for first scan of frequency switching if
something else not specified. Depends on scan for pointing.}
{Reverts to previous scan if not specified.}
{{\tt QUAL=34}}


\subsubsection{\label{MP:RECORD}{\tt RECord} and {\tt NORECord}}

{\tt RECord} tells \schedb to record data for
this scan.  Recording can be turned off by specifying {\tt NORECORD}.
This can be convenient for, as an example, VLA phasing scans.

NORECORD will insert scans in the VEX file, which have recorder = 0.
This will lead to the desired function in some cases, namely a
complete scan, but without data being recorded.

\rcwbox
{None.  Actually a non-zero argument would have the same effect as
specifying {\tt NORECORD}}
{None.}
{Make the recording.}
{Reverts to previous scan.}
{{\tt RECORD}}


\subsubsection{\label{MP:REPEAT}{\tt REPeat}}

{\tt REPeat = n} causes the scan to be repeated {\tt n} times.  If
{\tt GROUP} is specified with a value of {\tt m}, it causes {\tt m}
scans, starting with this one, to be repeated {\tt n} times. {\tt
DURATION} or {\tt DWELL} should be used if {\tt REPEAT} is used. {\tt
REPEAT} and {\tt GROUP}, together, provide a simple looping
capability.

\rcwbox
{An integer.}
{Any.}
{{\tt 1}}
{Reset to {\tt 1} on next scan.}
{{\tt REP=5}}


\subsubsection{\label{MP:REVERSE}{\tt REVERSE}}

{\tt REVERSE} is an obsolete parameter now that tape is no longer
being used.

{\tt REVERSE} requests that the direction of motion of the
wide-band Mark~III or VLBA tape be reversed at the start of the
scan. No rewinds or fast forwards will be done if this is requested.
{\tt REVERSE} is not needed normally. \schedb checks each scan to
see if it will fit in the current direction. If not, the tape will be
reversed before the next scan begins.
If {\tt REVERSE} is specified with no argument, the tape will be
reversed at all stations. If one or more station names are given, the
tapes will be reversed at only those stations.  Station codes may
be used instead of station names.

\rcwbox
{None or a list of stations.}
{No argument or the name of any stations in the scan. Not case
sensitive.}
{No reverse.}
{Reverts to no reverse on next scan.}
{{\tt REVERSE} or {\tt REVERSE=VLBA\_KP,VLBA\_LA}}


\subsubsection{\label{MP:REWIND}{\tt REWIND}}

{\tt REWIND} is an obsolete parameter now that tape is no longer
being used.

{\tt REWIND} requests that the wide-band Mark~III or VLBA
tape be rewound before the scan starts and during the prescan.  If
{\tt REWIND} is specified with no argument, the tape will be rewound
at all stations. If one or more station names are given, the tapes
will be rewound at only those stations.  Station codes may be used
instead of station names.

\rcwbox
{None or a list of station names.}
{No argument or the names of any stations in the scan.}
{No rewind, unless there is insufficient room left during a backward
pass to fit the next scan or a tape change is requested.}
{Reset to no rewind for next scan.}
{{\tt REWIND} or {\tt REWIND='vlba\_fd'}}


\subsubsection{\label{MP:ROTATION}\tt ROTATION}

{\tt ROTATION} is used in VLBA test observations to specify an
increment to the subreflector rotation value used for the subreflector
position.  This is added to the nominal position known by the on-line
system for the particular receiver.

Note that changing the rotation also changes the pointing offset
in a frequency dependent manner.

\rcwbox
{A rotation angle in degrees.}
{Any rotation angle}
{0.0}
{Default to previous scan.}
{{\tt ROTATION = 10 }}

\subsubsection{\label{MP:ROTPAT}\tt ROTPAT}

{\tt ROTPAT} causes \schedb to expand pointing patterns to include
a raster in focus and rotation.  The position offsets in this
raster are specified by 
{\hyperref[MP:FOCOFF]{{\tt FOCOFF}}} and
{\hyperref[MP:ROTOFF]{{\tt ROTOFF}}}.  {\tt ROTPAT} is only expected
to be used by VLBA testers.

{\tt ROTPAT} have a value which is the number of positions in
focus/rotation in the pattern.  It can only be used for 13cm, 6cm,
4cm, 2cm, 1cm, 7mm, and 3mm.  Note that the overall scan must be {\tt
ptslew} plus {\tt rotpat} times ( 2 times {\tt ptdur} plus N times 10
times {\tt ptdur} ) long to fit a full pattern with N pointing loops
at each focus/rotation position.

A typical set of offsets would be {\tt ROTOFF=-1.5, 0, 0, 0, 1.5}
and {\tt FOCOFF=0, -1, 0, 1, 0} with {\tt FOCPAT=5}.

\rcwbox
{A number of focus/rotation positions.  Up to 20.}
{Any number up to 20.}
{0 - Only do the central focus/rotation position.}
{Only one used for the experiment}
{{\tt ROTPAT=5}}

\subsubsection{\label{MP:ROTOFF}\tt ROTOFF}

{\tt ROTOFF} gives the offsets in subreflector rotation for a
focus/rotation raster.  See 
{\hyperref[MP:ROTPAT]{{\tt ROTPAT}}} for
details.

The values are offsets to be multiplied by the nominal offset
for the band as understood by the program.

\rcwbox
{Up to 20 real numbers - the number of nominal recrements in
rotation for each position of a focus/rotation raster.}
{Any number.  1.0 or 1.5 typically.}
{0.0}
{Only one set used per experiment.}
{{\tt ROTOFF=-1.5,0,0,0,1.5}}


\subsubsection{\label{MP:SCANTAG}\tt SCANTAG}

{\tt SCANTAG} allows the user to specify a name for the scan.  That
name appears in the summary file under the scan number.  Note that
it resets after each scan.  This is just to help users with bookkeeping
when constructing complicated schedules with loops and other constructs
that complicate knowing which output scan is which scan in the
summary.  The name is limited to 4 characters to fit in the desired
column in the summary file.

\rcwbox
{Any character string of up to 4 characters.}
{Any character string.}
{Blank}
{Reset after each scan, although all instances of that scan in a
loop will share the name.}
{{\tt SCANTAG='Cal2'}}


\subsubsection{\label{MP:SCHEDULE}\tt SCHedule}

{\tt SCHedule} allows \schedb to be started interactively to
specify options that might vary from run to run (such as {\tt PLOT,
DEBUG} etc.) and still get most of it's input from an
external file.  That external file is specified with {\tt SCHedule}.

Under unix, environment variables may be used.  For example, if {\tt
SCHED} is defined to mean {\tt /users/cwalker/sched}, the base
area under which all sched stuff is kept (substitute your local
directory), then one can specify one of the example schedules with
{\tt SCHEDULE = \$SCHED/examples/manual\_1.key}.  Use the {\tt setenv}
(c or t shell) or export (korn shell) to set environment variables.

\rcwbox
{A file name of up to 80 characters.}
{Any valid file name.}
{Use interactive input.}
{Only one used. It will apply to all following input.}
{{\tt SCH=/users/cwalker/bw12.key}}


\subsubsection{\label{MP:SETINIT}{\tt SETINIT}}

Setup file information can be specified in the main input file.  If
{\tt SETINIT} is specified, the next groups (to {\tt ENDSET}), are
assumed to be setup file information.  The setup name will be the
argument to {\tt SETINIT}.  Multiple setup files can be specified
this way.  An argument must be specified or the setup information
will not be read.

If {\tt SETINIT} is found, the end of the input group (everything up
to the ``/'') is not considered the end of inputs for this file.  The
next inputs after the setup data are entered will continue to apply to
the current file (usually the first).

Since 
{\hyperref[MP:SETUP]{{\tt SETUP}}} can specify a file name, when
there isn't an embedded setup file, it must be case sensitive.  As
a result, the case of the argument of {\tt SETINIT} much match
{\tt SETUP}.

\rcwbox
{A setup file name of up to 80 characters. Case sensitive.}
{Any character string.  Must not be blank.}
{Will not assume that setup information will follow.}
{Will revert to assuming no setup information will follow.}
{{\tt SETINIT=BW008.6CM.SET}}

\subsubsection{\label{MP:SETUP}{\tt SETUP}}

The argument to {\tt SETUP} is a file name where setup information can
be found.  A setup file must be specified.
See Section~\ref{SEC:SETUPS} for details of what should be in
the setup files. A new setup file can be specified for each scan for
mode switching.  The {\tt SETUP} file name may refer to an external
file that can be read by \schedb or it may refer to a setup
imbedded in the main \schedb input following a {\tt SETINIT}
command, whose argument is the setup file name.

Under unix, environment variables may be used.  For example, if
{\tt SCHED} is defined to mean {\tt /users/cwalker/sched}, the
base area under which all sched stuff is kept (substitute your
local directory), then one can specify the setup file with
{\tt SETUP = \$SCHED/setups/v6cm-128-4-2.set}.  Use the {\tt setenv}
(c or t shell) or export (korn shell) to set environment variables.

Since {\tt SETUP} can be a file name and some operating systems (unix,
Linux) are case sensitive, {\tt SETUP} must be treated as case sensitive,
including when referring to an embedded setup (from {\tt SETINIT)}.

\rcwbox
{A file name of up to 80 characters.  Case sensitive.}
{A valid file name.}
{No setup file used.}
{Defaults to previous scan.}
{{\tt SETUP='/users/cwalker/sched/v6cm-128-4-2.set'}}


\subsubsection{\label{MP:SOURCE}{\tt SOURCE}}

{\tt SOURCE} is used to specify the source name.  It is required for
the first scan and whenever there is a change. The name must match, in
a case-insensitive sense, one of the names of a source in the source
catalogs (recall that 5 different names or aliases are allowed for
each source).

{\tt SOURCE} may be the name of a Solar System object.  If so, if
an 
{\hyperref[MP:EPHFILE]{{\tt EPHFILE:}}} has been specified, and if the
object is not in the source catalog, \schedb will determine the position
and planetary motion of the object using a JPL ephemeris.  This position
is very good --- certainly good enough for use for pointing which
is the primary use envisioned (note that much work would be required
on the correlator to correlate planetary observations).  There is
a similar capability for pointing at satellites using orbital
elements in {\tt SATFILE} or {\tt TLEFILE} that are specified in the
{\hyperref[SEC:SATINIT]{{\tt SATINIT section}}}.

The Solar System objects that \schedb understands are Mercury, Venus,
Moon, Mars, Jupiter, Saturn, Uranus, Neptune, Pluto, and Sun.
Topocentric positions and rates will be provided for VLBA antennas if
one of these is specified.  Note
that \schedb does not understand how to specify moving objects to
antennas that don't use the VLA or VLBA control file types.
Specifically, solar system sources are not currently supported
for VEX output files.

\rcwbox
{Text of up to 12 characters.}
{Any source in the catalogs.}
{None.}
{Defaults to previous scan.}
{{\tt SOURCE='3C120'}}


\subsubsection{\label{MP:SRCCAT}{\tt SRCCAT}}

{\tt SRCCAT} is a flag to indicate that the following inputs are
to be treated as an in-line source catalog. See
Section~\ref{SEC:SRCCAT} for details of source catalog contents. The
catalog input is terminated by {\tt ENDCAT /} to resume schedule
input.  It is best to specify {\tt SRCCAT /} as a separate line not
part of other \schedb keyin input. \schedb stores the source
catalog information in internal arrays which have a maximum size that
may depend on the computer but is 500 in the distributed version. All
sources found in in-line catalogs are stored in these arrays because
they may be read before all scheduled sources are known. In contrast,
when an external source catalog is read, only scheduled sources are
kept. See the examples in Section~\ref{SEC:MKIII} for illustrations
of how in-line source catalogs are used.

If {\tt SRCCAT}
is found, the end of the input group (everything up to the ``/'')
is not considered the end of inputs for this file.  The next inputs
after the source data are entered will continue to apply to the current
file (usually the first).

\rcwbox
{None.}
{None.}
{Not used.}
{There can be as many in-line catalogs as desired, consistent with
the maximum number of allowed sources in the in-line catalogs.}
{{\tt SRCCAT /}}


\subsubsection{\label{MP:SRCFILE}{\tt SRCFILE}}

{\tt SRCFILE} is used to specify the name of the external source
file. See Section~\ref{SEC:SRCCAT} for the required formats. The
default {\tt SRCFILE} is {\sl \$SCHED/catalogs/sources.gsfc}, although
{\sl \$SCHED/catalogs/sources.petrov} is a good alternative.
Assuming the environment variable {\tt \$SCHED} is set (see below),
this is the usual \schedb source file.  If {\tt SRCFILE='none'} is
specified then no external catalog will be read.  The file name is
simply passed to the operating system so all the usual behavior you
expect normally apply, such as the use of the current directory if a
path is not given.

Under unix, environment variables may be used.  For example, if
{\tt SCHED} is defined to mean {\tt /users/cwalker/sched}, the
base area under which all \schedb stuff is kept (substitute your
local directory), then one can specify the source file with
{\tt SRCFILE = \$SCHED/catalogs/sources.petrov}.  Use the {\tt setenv}
(c or t shell) or export (korn shell) to set environment variables.

There is an option to use a second source catalog file using
{\hyperref[MP:SRCFILE2]{{\tt SRCFILE2}}}.  This could be useful if one
wishes to get calibrator information from the \schedb standard
catalog, but also have a catalog of program sources.  It is also
useful when using the ability to specify many phase centers per
pointing center.

\schedb will use the data for a source from the first catalog it
reads that includes that source.  It reads the in-line catalog first,
then {\tt SRCFILE} and then {\tt SRCFILE2}.

\rcwbox
{A file name of up to 80 characters.}
{Any file name or {\tt none}.}
{{\tt '\$SCHED/catalogs/sources.gsfc'}}
{Use only once.}
{{\tt SRCFILE=/users/cwalker/sched/sources.dat}}


\subsubsection{\label{MP:SRCFILE2}{\tt SRCFILE2}}

{\tt SRCFILE2} is a second source file, treated identically to
{\hyperref[MP:SRCFILE]{{\tt SRCFILE}}}.  This allows one to supplement
the main \schedb catalog with a local, but still not embedded,
catalog.  It is likely to be especially useful for observations
wanting multiple phase centers in each pointing center.

\schedb will use the data for a source from the first catalog it
reads that includes that source.  It reads the in-line catalog first,
then {\tt SRCFILE} and then {\tt SRCFILE2}.

\rcwbox
{A file name of up to 80 characters.}
{Any file name or {\tt none}.}
{Not used}
{Use only once.}
{{\tt SRCFILE2='centers.dat'}}


\subsubsection{\label{MP:STACAT}{\tt STACAT}}

{\tt STACAT} is a flag to indicate that the following entries are part
of the stations catalog. See Section~\ref{SEC:STACAT} for details of
the format. In-line catalogs can occur more than once in the {\sc
SCHED} keyin file.  The station catalog input is terminated with a
separate entry containing {\tt ENDCAT /}.

If {\tt STACAT} is found, the end of the input group (everything up to
the ``/'') is not considered the end of inputs for this file.  The
next inputs after the station data are entered will continue to apply
to the current file (usually the first).

\rcwbox
{None.}
{None.}
{Not used.}
{Can occur as often as desired.}
{{\tt STACAT /}}


\subsubsection{\label{MP:STAFILE}{\tt STAFILE}}

{\tt STAFILE} is the name of the external stations file. See
Section~\ref{SEC:STACAT} for the required formats. If {\tt STAFILE} is
not specified, it defaults to {\tt
\$SCHED/catalogs/stations\_RDBE.dat}.  If {\tt STAFILE='none'} is
specified then no external catalog will be read.

This must be specified among the first scan inputs since \schedb
will read the station catalog while setting up the first scan.  If
{\tt STAFILE} is not specified with the first scan's inputs, \schedb
will read the default catalog.  This is done because, while reading
the scans, SCHED needs to know some station information (like codes
in case you choose to specify them for the STATIONS input).

Under unix, environment variables may be used.  For example, if
{\tt SCHED} is defined to mean {\tt /users/cwalker/sched}, the
base area under which all sched stuff is kept (substitute your
local directory), then one can specify the station file with
{\tt STAFILE = \$SCHED/catalogs/stations\_RDBE.dat}.  Use the {\tt setenv}
(c or t shell) or export (korn shell) to set environment variables.

\rcwbox
{A file name of up to 80 characters.}
{Any valid file name or {\tt none}.}
{{\tt \$SCHED/catalogs/stations\_RDBE.dat}}
{Only specify once.}
{{\tt STAFILE='/users/cwalker/sched/stations.dat'}}


\subsubsection{\label{MP:START}{\tt START}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt START} is used to specify the start time of the scan in UT. If
{\tt LST} was specified, {\tt START} is assumed to be in local
sidereal time. {\tt START} must be specified for the first scan. For
later scans, it will default to the stop time of the previous scan if
not specified.  Note that the start time will be adjusted by
{\tt PRESCAN} to the time that the recording starts.

\rcwbox
{A time in {\tt hh:mm:ss} format.}
{Any time.}
{No default - \schedb will stop if first {\tt START} is not
given.}
{Defaults to stop time of previous time.}
{{\tt START=13:15:00}}


\subsubsection{\label{MP:STATIONS}{\tt STATions}}

{\tt STATions} is used to specify the list of stations to be included
in this scan. If there is any change to the list, the whole list
must be given again. The station names given must match ones
available in the station catalogs. The scans for any specific station
must be in time order.  Note that {\tt STATN} is no longer an
acceptable alternative.

The maximum number of stations that \schedb will handle is set
in a parameter statement in an include file and can be varied according
to the capabilities of the computer in use.  At the time this was
written, it was 22, but that may change.

You may specify the station code for any or all stations instead of
the name.  Sched will determine the station name from the catalog
information and use it for the rest of scheduling.  This use of
station codes is only offered for 
{\hyperref[MP:STATIONS]{{\tt STATions}}},
{\hyperref[MP:FASTFOR]{{\tt FASTFOR}}}, 
{\hyperref[MP:REWIND]{{\tt REWIND}}},
{\hyperref[MP:TAPE]{{\tt TAPE}}}, and 
{\hyperref[MP:REVERSE]{{\tt REVERSE}}}.
All other inputs requiring station names must use the names as given
in the station catalog.

\rcwbox
{A list of station names of up to 8 characters each.}
{Any stations in the station catalog.}
{At least one must be given for first scan.}
{Defaults to previous scan.}
{{\tt STATION=EB\_VLBA,GB\_VLBA,VLBA\_NL,VLA27,VLBA\_MK}}


\subsubsection{\label{MP:STOP}{\tt STOP}}

The topic of controlling scan timing is discussed in detail in
the 
{\hyperref[SSEC:SCANTIMES]{Scan Times section}}.

{\tt STOP} is used to specify the stop time of the scan in UT. If {\tt
LST} is specified, the time is in local sidereal time. Either a {\tt
STOP} time, a {\tt DURation}, or a {\tt DWELL} must be given for each
scan, although the {\tt DURation} or {\tt DWELL} can default to a
previous value. If {\tt STOP} and one of the others are both given
then the implied stop times are compared, and if those times differ by
more than 10 seconds, a complaint is generated. A simple check of
a long schedule made in durations is to include the stop time for the
last scan; if the schedule has problems, there will be an error
message.

\rcwbox
{A time in {\tt hh:mm:ss} format.}
{Any time.}
{Start time plus duration.}
{Either {\tt DURation}, {\tt DWELL}, or {\tt STOP} is required for
each scan. {\tt DURation} or {\tt DWELL} will default to previous scan.}
{{\tt STOP=13:45:00}}

\subsubsection{\label{MP:SUMITEM}{\tt SUMITEM}}

{\tt SUMITEM} is used to control the items listed in the summary file
for each antenna.  Two items are listed for each scan for each antenna
on each summary pass.  Up to 10 items can be requested causing
up to 5 summaries to be produced in the {\sl .sum} file.  The items
that can be requested are:

\begin{description}

\item[{\tt EL1:}]  The elevation at the start of the scan.  For scans
where the source is below the hardware limits or the horizon, a letter
code will be included.

\item[{\tt EL2:}]  The elevation at the end of the scan.  The limit
code will be included.

\item[{\tt ELA:}]  The average elevation of the scan ((EL1+EL2)/2).
The limit code will be included.

\item[{\tt AZ1:}]  The azimuth at the start of the scan.  The limit
code will be included.

\item[{\tt AZ2:}]  The azimuth at the end of the scan.  The limit
code will be included.

\item[{\tt AZA:}]  The average azimuth of the scan ((AZ1+AZ2)/2).
The limit code will be included.

\item[{\tt PA1:}]  The paralactic angle at the start of the scan.

\item[{\tt PA2:}]  The paralactic angle at the end of the scan.

\item[{\tt HA1:}]  The hour angle at the start of the scan.

\item[{\tt HA2:}]  The hour angle at the end of the scan.

\item[{\tt EARLY:}]  The number of seconds that the antenna arrived on
source before the scan started.  Negative numbers are common and are the
number of seconds that the antenna arrived on source after the scan
started.

\item[{\tt DWELL:}]  The number of seconds of on-source time in the
scan.  This does not take into account correlator resync times.  See
{\tt SYNC} for that information.  The total integration time should be
the smaller of {\tt DWELL} and {\tt SYNC}.  Note that neither takes
into account the time needed to switch between receiver bands (that's
on the wish list).

\item[{\tt SLEW:}]  The slew time in seconds from the previous source.

\item[{\tt TAPE1:}]  The tape drive in use, the recording direction,
and the head index position.  Cannot be used if 
{\hyperref[MP:NOSETUP]{{\tt NOSETUP}}}
is specified.  If the station only has disk, the
total GBytes recorded at the station up the the end of the scan is
given.

\item[{\tt TAPE2:}]  The set of heads in use (for example which of the
{\tt TRACKn} inputs is in use) and the tape footage in thousands.
Cannot be used if 
{\hyperref[MP:NOSETUP]{{\tt NOSETUP}}} is specified.

\item[{\tt DISK:}] The total GBytes recorded at the station up the
the end of the scan is given.  Nothing useful is given for tape only
stations.  Cannot be used if 
{\hyperref[MP:NOSETUP]{{\tt NOSETUP}}} is
specified.

\item[{\tt TPSTART:}] Show the offset of the recording start time from the
scan start time.  This is established by parameters 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}} and 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}

\item[{\tt SYNC:}]  The expected integration time with the correlator
synchronized.  This takes into account time lost to resyncs and
formatter reconfigures.  It does not take into account slew times, which
{\tt DWELL} does.

\end{description}

If any other items are desired, please inform Craig Walker.

Users of EVN antennas (and any others controlled by the PCFS and VEX)
are advised to study the listing created by {\tt EARLY}.  Currently
there is no complete mechanism for PCFS to monitor whether the
telescope was on source when the recording starts. Data taken
during this time are invalid, but are not flagged automatically.
Therefore it is advisable to make schedules with {\tt DWELL} or
inspect the listing for telescopes that arrive late on source.

\rcwbox
{Up to 10 character strings.}
{See the description above for valid parameters.}
{{\tt ELA, DWELL}}
{Only one value used, the last.}
{{\tt sumitem=el1, az1}}


\subsubsection{\label{MP:TANT1}{\tt TANT1 and TANT2}}

{\tt TANT1} requests that \schedb turn on antenna temperature
measurement at stations in the {\tt TANTSTA1} list, if it knows
how to do so for those antennas.   {\tt TANT2} does the same thing
for stations in the {\tt TANTSTA2} list.

This command currently has no effect on VEX, VLA, or VLBA output.
In fact, as more antennas have gone to the above file types, the
usefulness of this capability had been significantly reduced.
As of mid 1997, the only station for which automatic Tant requests
can be made is Green Bank.  Be warned that such measurements take
a minute or so.

\rcwbox
{None or a non-zero value.}
{None or {\tt 0} to turn on Ta measurements. Specify a non-zero
value to turn off Ta measurements.}
{Make the Ta measurements.}
{Defaults to previous scan.}
{{\tt TANT1=-1  TANT2 }}


\subsubsection{\label{MP:TANTSTA1}{\tt TANTSTA1 and TANTSTA2}}

{\tt TANTSTA1} is used to specify a list of stations for which {\tt
TANT1} will turn on and off Ta measurements. These stations must have
Green Bank or snap type files, or \schedb will abort.
{\tt TANTSTA2} specifies the stations whose antenna measurements
are controlled by {\tt TANT2}.

As noted in the discussion of {\tt TANT1}, the only station that
retains the capability for \schedb to request Tant measurements is
Green Bank.

\rcwbox
{A list of station names of up to 8 characters each. Should match names
of stations used in the schedule.}
{Any station names. Unrecognized names will be ignored.}
{Any stations in the schedule that have {\tt NRAO} or {\tt SNAP}
control file types.}
{Only one list, the last given.}
{{\tt TANTSTA1='BONN','JODRELL'  tantsta2=nrao}}


\subsubsection{\label{MP:TAPE}{\tt TAPE}}

{\tt TAPE} is an obsolete parameter now that tape is no longer in use.

{\tt TAPE} requests that \schedb force a tape change at the start
of the scan.  This will override any automatic tape changing that is
going on and will reset the reference time for any following automatic
tape changes. If no argument is given, the tape will be changed at all
stations. If a list of stations is given, the tapes will only be
changed at those stations; if a station is given that is not in the
scan, an error message will be generated and \schedb will abort.
Station codes my be used in place of station names.

For stations that only have one tape drive (all except the VLBA and
VLA), be sure to allow enough idle time to complete the tape
change.  This usually means 15 minutes and \schedb will issue
warnings if it is less than this.  Some stations claim to be able
to do it in 10.  If postpasses are required, and they are currently
(Feb 1997) being done at thin tape stations, an additional up to
33 minutes is required.  The station operators can override the
postpass to save time, at the risk of damaging tapes which cost
over \$(US)1000 each.  An alternative is to schedule the last pass
at such stations without stopping the tape.  If \schedb detects
that this has been done, it will issue an UNLOAD command instead
of POSTPASS.  Note that the automatic postpass will only be
requested at sites using VLBA control files.  The VEX format does
not (yet) include this concept.

\rcwbox
{None or a list of up to 30 station names.}
{No argument or a list of any stations in the scan. Not case sensitive.}
{Not used. Automatic tape changes by default.}
{Must specify whenever needed.}
{{\tt TAPE} or {\tt TAPE=VLBA\_MK,VLBA\_NL}}


\subsubsection{\label{MP:TAPEFILE}{\tt TAPEFILE}}

{\tt TAPEFILE} gives the name for the tape initialization file. See
Section~\ref{SEC:TPINI} for content details.  The alternative is
to have the tape initialization details imbedded in the \schedb
input following 
{\hyperref[MP:TAPEINI]{{\tt TAPEINI}}} or to use the defaults
which are fine for the VLBA.

Note that a tape initialization file is almost certainly NOT needed.
Most parameters in it relate to initial tape head and pass positions
which no longer make sense in the disk era.  The one possibly useful
parameter is the media specification, but that should be defined in
the station catalog and would only be used during periods of transition.

Under unix, environment variables may be used.

\rcwbox
{A file name of up to 80 characters.}
{Any file name.}
{{\tt 'NONE'}, causing defaults or parameters specified after
{\tt TAPEINI} to be used.}
{Only one accepted, the last.}
{{\tt TAPEFILE='vlba.head'}}


\subsubsection{\label{MP:TAPEINI}{\tt TAPEINI}}

{\tt TAPEINI} is a flag to inform \schedb that the next group
of input parameters will be tape initialization information,
equivalent to one line from the 
{\hyperref[MP:TAPEFILE]{{\tt TAPEFILE}}}.
See Section~\ref{SEC:TPINI} for content details.  Once the tape
initialization parameters have been read, \schedb will return
to reading the inputs for the current scan, usually the first.

Note that a tape initialization file is almost certainly NOT needed.
Most parameters in it relate to initial tape head and pass positions
which no longer make sense in the disk era.  The one possibly useful
parameter is the media specification, but that should be defined in
the station catalog and would only be used during periods of transition.

\rcwbox
{None.}
{None.}
{Not used.}
{Should not be used more than once.}
{{\tt TAPEINI /}}


\subsubsection{\label{MP:TAPESYNC}{\tt TAPESYNC}}

{\tt TAPESYNC} is an obsolete parameter left over from the tape era.

{\tt TAPESYNC} requests that \schedb try to synchronize tape changes
at the stations.  This is advisable to avoid slightly staggered tape
changes that would naturally result from a subarrayed schedule.
Such staggered tape changes can result in lost data because there
is a minimum of about 3 minutes per correlator job and a new job
is needed when a station changes tape.  This is a temporary
restriction but was in effect in late 1996.

WARNING:  {\tt TAPESYNC} could cause very strange behavior if used
with a schedule in which some stations are being scheduled separately
from others.  It should only be used when the scans as specified to
\schedb are in roughly time order (for subarrays, there can be
small deviations from time order and that will be ok).  It is only
recommended for use in conjunction with the optimization options.
For any schedules in which every scan is specified in the input, it
would be best to use 
{\hyperref[MP:TAPE]{{\tt TAPE}}} to force the
tape changes at reasonable times, if necessary.

Also, be sure that any automatically generated tape change requests
occur at times with sufficient gaps at single tape stations (all
except the VLBA and VLA).  See the discussion of 
{\hyperref[MP:TAPE]{{\tt TAPE}}} for details.

Note that, with automatic tape allocation, \schedb does not set the
tape change times so {\tt TAPESYNC} will have no effect.

\rcwbox
{None.}
{None.}
{Not used.}
{Last value used.}
{{\tt TAPESYNC /}}

\subsubsection{\label{MP:TAVLBA}{\tt TAVLBA} and {\tt NOTAVLBA}}

{\tt TAVLBA} tells \schedb to write a VLBA antenna-temperature
measuring sequence in the VLBA control file for this scan.  {\tt
NOTAVLBA} tells \schedb not to write such a sequence.  Parameters
{\tt PTSLEW} and {\tt PTDUR} are used as they are for {\tt PTVLBA}.
If antenna temperature measurements are desired as part of a VLBI
project, a separate scan with {\tt TAVLBA} set should be requested
before or after the main VLBI scan. Do not rely on a long {\tt PTSLEW}
to get the VLBI data since during the setup part of the scan, the
requested pointing position is at a half power point.

Use of {\tt TAVLBA} is not the recommended calibration method for the
VLBA. The apriori gains should be used instead. The VLBA antennas are
not set up for accurate single dish measurements. The {\em a priori}
values were obtained during good weather when this is not so much of a
problem. If the weather is good for the VLBI project, the {\em a
priori} values will be good to a few percent, probably better than any
Ta measurement. If the weather is poor, the Ta measurements will
probably be nearly useless.

This has no effect on VEX files.

\rcwbox
{None.}
{None set. {\tt NOTAVLBA} to go back to non-pointing modes.}
{Not used.}
{Reverts to previous scan if not specified.}
{{\tt TAVLBA}}


\subsubsection{\label{MP:TELEX}{\tt TELEX}}

{\tt TELEX} is the Principal Investigator's TELEX number for the
cover information.  This parameter is still provided only for
backward compatibility.  Don't bother with it.  Are telexes still
in use?

\rcwbox
{Text of up to 64 characters.}
{Any.}
{Blank.}
{Only one value used, the last.}
{{\tt TELEX='+1-910-988-1710'}}


\subsubsection{\label{MP:TPREF}{\tt TPREF}}

{\tt TPREF} is obsolete for the vast majority of users because Mark~II
systems were abandoned long ago.

{\tt TPREF} is the reference time for Mark~II tape changes. When
automatic tape changes are specified, as is done by default, they will
occur at times that are an integral number of tapelengths (default 4
hours) before or after this time.  Since the only really valid Mark~II
tape length of 4 hours divides a 24-hour day evenly, no provision is
provided to specify a day.

\rcwbox
{A time.}
{Any valid time between {\tt 0} and {\tt 24} hours.}
{Not used; rather start time of earliest scan of the schedule is used.}
{Only one value accepted.}
{{\tt TPREF=5:0:0}}


\subsubsection{\label{MP:TSYS}{\tt TSYS} and {\tt NOTSYS}}

This is an obsolete parameter because it only affected the Green Bank
control files and the SNAP file, neither of which is now in use.  Note
that the GBT now does continuous system temperatures in the same manner
as the VLBA.

By default, \schedb requests that system temperatures be measured
every scan in the NRAO (Green Bank) and snap control file types. The
VLBA measures Tsys continuously so no such request is
needed. For Green Bank, the system temperatures are measured at the
start of every scan (as part of the ``MARKIII'' procedure).  They are
no longer measured at the end of a scan.  For stations using snap
files, there is no concept of ``go to source, then do something'', so
Tsys requests are only made at the end of each scan. {\tt NOTSYS}
turns off the Tsys requests (For Green Bank, it also turns off all
other actions included in the ``MARKIII'' procedure which might
include antenna temperature measurements and peaking up pointing). The
Tsys measurements take a bit of time so it may be desirable to turn
them off when switching rapidly between sources; however, by doing so,
calibration may be compromised.  The measurement of system
temperatures can be turned back on with {\tt TSYS}.

This has no effect on VEX files; system temperatures are measured by
PCFS controlled at the beginning of every scan. Note that with thin
tapes and fan-out, the time between measurements could be as long as 44
minutes. \schedb will warn if there is more than 30 minutes between
Tsys measurements for PCFS systems, except on a last reverse scan which
may be forced to be long in order to avoid post-passing.

\rcwbox
{None.}
{Use it or not.}
{Ask for system temperature measurements.}
{Defaults to previous scan.}
{{\tt NOTSYS}}


\subsubsection{\label{MP:UVMFS}{\tt UVMFS}}

{\tt UVMFS} affects UV plots, allowing the user to show the effect
of using multi-frequency synthesis.  The first argument is the
number of tracks to plot per baseline.  The default is to plot one
with UV in km.  The second argument is the ratio of the highest
to the lowest MFS frequency.  The UV values will be in km the
middle of the frequency range.

This option could have been implemented by paying attention to
the frequencies in the setup file, and that option should be
added some day.  But that requires either fully specified setup
files, or freq.dat entries for all stations.  When \schedb is being
used for configuration studies, this is an undue burden.

Note that this is also used for the UV coverage based quality
measures used for configuration studies.

\rcwbox
{Two numbers.}
{The first number is converted to an integer.  The second is a real
and should be between 1.0 and about 2.0, although it is unrestricted}
{1 and 1.0 --- meaning only plot one track per baseline.}
{One value used for schedule}
{{\tt UVMFS = 5, 1.3 }}



\subsubsection{\label{MP:VERSION}{\tt VERSION}}

{\tt VERSION} Version number of the schedule for the cover
information. Usually this will be {\tt 1} for the first, {\tt 2} for
the second, etc. Often stations get a schedule, then the PI changes
his/her mind about something, or finds and error, and so creates a new
version. Later at the station, it is not always obvious which is the
latest version.  This version number is meant to make it
obvious. \schedb will abort if {\tt VERSION} is not specified.

\rcwbox
{Any real number, with decimals is desired as it will be printed in
F10.2 format.}
{Any but integers are typical.}
{{\tt 0} which causes \schedb to abort.}
{Only one value used, the last.}
{{\tt VERSION=1}}


\subsubsection{\label{MP:VEXTEST}{\tt VEXTEST}}

{\tt VEXTEST} is a switch that allows testing of VEX related features
that have not been released for public use.  It is likely to only be
of interest to the SCHED developers, although it is possible that
early users of new features may need it.

\rcwbox
{No argument - this is a logical}
{No arguments}
{Not set, which may block some VEX features.}
{Only last value specified will be used}
{{\tt VEXTEST}}

\subsubsection{{\tt VLABAND} and {\tt VLABW}}

These are obsolete parameters that specified the VLA observing mode
and the VLA backend filter width.  They should now be specified in
the setup file.  Any values specified in the main input will be
ignored.


\subsubsection{\label{MP:VLAINTEG}{\tt VLAINTEG}}

Obsolete for current VLA.

{\tt VLAINTEG} is used to set non-standard integration times in VLA
schedules.  This would be useful mainly to influence the speed with
which the system phases up.  The argument is in seconds.  The default
is 10 seconds.  \schedb generates {\tt //DS} cards for all scans
after a {\tt VLAINTEG} is specified.

\rcwbox
{Integer between 0 and 999.}
{See list above.}
{10 seconds.}
{Defaults to previous scan.}
{{\tt VLAINTEG=3}}


\subsubsection{\label{MP:VLAMODE}{\tt VLAMODE}}

{\tt VLAMODE} is used to control phasing up of the VLA.  The control
can also be done directly by specifying the phasing related
{\hyperref[MP:INTENTs]{{\tt INTENTs}}}, but that can be more cumbersome,
especially if other {\tt INTENTs} are changing from scan to scan.  A
phasing mode is required.  For a schedule using the VLA, if \schedb
does not get a {\tt VLAMODE} or a phasing related {\tt INTENT}, it
will quit.  When {\tt VLAMODE} is used, \schedb will generate the
appropriate {\tt INTENTs} for the VEX file for the {\tt VLAMODE} that
is given.

VLA reference pointing and array phasing must not be requested in the 
same scan.

The valid {\tt VLAMODE} values are:

\begin{description}

\item  {\tt '  '} - Do not apply or determine phases.
This generates {\tt INTENT = VLA:AUTOPHASE\_OFF}.

\item  {\tt 'VA'} - auto phasing on all IFs.
This generates {\tt INTENT = VLA:AUTOPHASE\_DETERMINE}.

\item  {\tt 'VX'} - Apply phasing determined in previous {\tt VA} scan.)
This generates {\tt INTENT = VLA:AUTOPHASE\_APPLY}.

\item  {\tt 'VS'} - single antenna VLBI (not available on EVLA as of 2014).
May want this to keep the phase center at the antenna if at all possible.
This could generate {\tt INTENT = VLA:SINGLE\_DISH}.


\end{description}

\rcwbox
{Text of 2 characters.}
{See list above.}
{None - required for VLA.}
{Defaults to previous scan.}
{{\tt VLAMODE='VX'}}

\subsubsection{\label{MP:VLAPEAK}{\tt VLAPEAK}}

{\tt VLAPEAK} is used to control reference pointing on the VLA.  The
user will need to provide a scan of at least 2.5 minutes on a
calibrator on which the pointing can be done.  The observations should
be at X band.  These scans can be inserted explicitly, or
{\hyperref[MP:AUTOPEAK]{{\tt AUTOPEAK}}} can be used to insert them
automatically (maybe not yet).  \schedb will create appropriate
{\hyperref[MP:INTENTs]{{\tt INTENTs}}} for the VLA scans based on the
value of {\tt VLAPEAK}.  It is not recommended that the user attempt
to specify the pointing related {\tt INTENTs} explicitly although that
is not prevented.  If that is done, there can be interactions with the
defaulting when other, unrelated {\tt INTENTs} are used.

The four settings for {\tt VLAPEAK} situations of interest are:

\begin{description}

\item {\tt 'DETERMINE'} indicates that the reference pointing
corrections should be determined starting from no offsets.  This sets
{\tt INTENT = VLA:REFERENCE\_POINTING\_DETERMINE}

\item {\tt 'APPLY'} indicates that the most recently determined reference
pointing offsets should be applied.  This sets {\tt INTENT =
VLA:REFERENCE\_POINTING\_APPLY}

\item {\tt 'ADJUST'} indicates that reference pointing corrections should be
determined starting with the previously determined values.  The
results that can be applied to later scans are the sum of the previous
and the newly determined values.  This sets {\tt INTENT =
VLA:REFERENCE\_POINTING\_ADJUST}

\item {\tt 'OFF'} indicates that no reference pointing offsets should be
applied and that no attempt should be made to determine them.  This
is the default and is what will be used at all but the highest 
frequencies.  This sets {\tt INTENT = VLA:REFERENCE\_POINTING\_OFF}

\end{description}

A pointing pattern can be done if in a scan if there are at least 150
on source.  Only one pattern is done, so adding significantly more
time is not useful (unlike the old VLA system). 

Reference pointing is important for observations at 1cm (K band) and
higher frequencies (ie Q band).  It might be useful at the high end
of the 2cm (Ku band) range.  For more information about reference
pointing on the VLA please see the {\bf Guide to Observing with the VLA}
section on 
{\href{https://science.nrao.edu/facilities/vla/docs/manuals/obsguide/modes/hifreq/strategy}{High Frequency Observing Strategy}}.
The pointing should be done at C or X band, with X band recommended.

VLA reference pointing and array phasing must not be attempted in
the same scan.  SCHED will abort if that is tried.

\rcwbox
{Text of up to 9 characters.}
{See list above.}
{{\tt 'OFF'}.}
{Defaults to previous scan.}
{{\tt VLAPEAK='APPLY'}}


\subsubsection{\label{MP:VLAPTIME}{\tt VLAPTIME}}

On the VLA, a \schedb scan intended for array phasing is broken into
subscans for purposes of obtaining phasing solutions at one solution
per subscan.  At least 4 subscans are required to obtain reliable
phases.  The length of the subscans can be set separately for each
scan using {\tt VLAPTIME} whose argument is in integer seconds.  The default
of 10 seconds will be good in most cases.  Longer times can be used if
a weak calibrator must be used or perhaps when phasing while recording
on the VLBI target source.  The subscan length is passed to the VLA 
through the VEX file in an {\tt INTENT} that is created by \sched.

\rcwbox
{A time in integer seconds.}
{Any time over 10 seconds.}
{10 seconds}
{Defaults to previous scan's value.}
{{\tt VLAPTIME=20}}



\subsubsection{\label{MP:VLATSYS}{\tt VLATSYS and VLANTSYS}}

Obsolete for current VLA.

The VLA on-line system normally applies a
Tsys-based amplitude correction to data from the VLA correlator.  In
order to calibrate 3-antenna and phased VLA data taken with the VLA as
a VLBI station, it is necessary to have raw correlation coefficients.
If the Tsys correction is made, the raw correlation coefficients are
lost. The old DEC10 scheme for obtaining the VLBI calibration data was
based on the standard VLA correlator output as archived, so it was
necessary to request that the Tsys correction be turned off. The new
scheme for obtaining the VLBI calibration information involves
extraction of the correlation coefficients by the on-line system
before the Tsys corrections are made. Therefore it is no longer
necessary to turn the corrections off and leaving them on makes it
easier to use the VLA correlator data to make VLA images. The default
action of \schedb is now to leave the corrections on and that
should be correct for essentially all observations. However, {\tt
VLATSYS} and {\tt VLANTSYS} can be used to turn the corrections on and
off, respectively, on a scan basis just in case someone still wants to
do so.

\rcwbox
{None}
{No value (a non-zero value turns has the effect of the opposite
parameter)}
{Keep Tsys corrections on.}
{Defaults to previous value.}
{{\tt VLANTSYS} or {\tt VLATSYS}}


\subsubsection{\label{MP:VLAPSRC}{\tt VLAPSRC}}

This parameter was developed originally for the old VLA system.  It has
not yet been converted for use with the VLA.  But that is on the to-do 
list.

{\tt VLAPSRC} can be used to specify the source to use for phasing the
VLA. If the scan is mode {\tt VX} and {\tt VLAPSRC} differs from {\tt
SOURCE}, then a scan will be inserted in the VLA observe file in {\tt
VLAPSRC} with mode {\tt VA}. The VLBI control file will not be
affected. The stop time of the phasing scan will be 1 minute before
the start of the VLBI scan or 3 minutes after the stop of the previous
VLBI scan, whichever is later. If less than 2 minutes of the VLBI scan
remain as a result, a complaint will be generated. It is wise to take
the VLA observe file into the NRAO {\sc VLA OBSERVE} program to check
the slew and dwell times, since the default timing used for {\tt
VLAPSRC} will not always be reasonable and the phasing scan stop time
may need to be adjusted. Note that, since \schedb does not
generate a phasing scan for a mode {\tt VA} scan or when {\tt VLAPSRC}
equals {\tt SOURCE}, {\tt VLAPSRC} need not be specified or changed
for such scans; this may minimize the number of times {\tt VLAPSRC}
needs to be specified.

\rcwbox
{Any source name of up to 8 characters.}
{Any source in the catalogs. ' ' resets to use {\tt SOURCE} and
turns off the special phasing scan.}
{Uses {\tt SOURCE}, which causes no phasing scan to be written.}
{Defaults to previous scan.}
{{\tt VLAPSRC='0255+164'}}


\subsubsection{\label{MP:VLARFANT}{\tt VLARFANT}}

Obsolete for current VLA.

{\tt VLARFANT} can be used to specify the reference antenna for the
VLA.  This will be the antenna used as the source of data in single
dish VLBI.  For the phased array, it will be the reference antenna
for the calibration solution for phasing.  Note that, in phased array
mode, the phase center is always at the normal VLA phase center.  In
single dish mode, if there are multiple antennas available to the
VLA correlator, they will be correlated with the phase center at the
reference antenna.  This is needed so for the old VLA system so that
the fringe rotators do not affect the single dish VLBI data.

Normally the reference antenna is number 10, which is the default.
If that needs to change, it is unlikely that users will be aware of
that fact in time to change their schedule, so either SCHED needs to
be rerun by operations with the new value, or the observe deck needs
to be edited.  Users in the vast majority should not worry about this
parameter.

\rcwbox
{An integer between 1 and 28}
{Any intger, specifying an antenna, between 1 and 28}
{10}
{Use only once.}
{{\tt VLARFANT=15}}



\subsubsection{\label{MP:VLATYPE}{\tt VLATYPE}}

Obsolete for current VLA.

{\tt VLATYPE} specifies the type of the observation
for the VLA observe file.

\rcwbox
{Text of up to 9 characters.}
{{\tt 'VLBI'}      - VLBI observation.
 {\tt 'CONTINUUM'} - normal VLA continuum observation.
 {\tt 'LINE'}      - VLA spectral line observation.}
{{\tt 'VLBI'}}
{Use only once.}
{{\tt VLATYPE='CONTINUUM'}}


\subsubsection{\label{MP:VLAUSERN}{\tt VLAUSERN}}

Obsolete for current VLA.

{\tt VLAUSERN} is the VLA user number. Provide the PI's VLA number
(same as the Socorro AIPS number) if desired. For VLBI runs the
default of 600 is fine.

\rcwbox
{Integer.}
{Any VLA user number.}
{{\tt 600}}
{Only last value entered is used.}
{{\tt VLAUSERN=332}}


\subsubsection{\label{MP:WRAP24}{\tt WRAP24}}

{\tt WRAP24} is a switch to aid VLBA operations in dynamic scheduling
of 24 hour projects.  For such projects, it is useful to be able to
start at a time of day different from what the user specified.  This
is facilitated by the parameters {\tt WRAP24} and 
{\hyperref[MP:DOSCANS]{{\tt DOSCANS}}}.
Specifying {\tt WRAP24} with no argument causes \schedb
to duplicate the schedule on a second day to form a 48 hour schedule.  
Actually it would duplicate any schedule, but it is mainly useful for
24 hour schedules.  The full 2 day (or whatever) schedule shows up in
the summary {\sl .sum} file.  Then {\tt DOSCANS} can be used to select
the desired 24 hours (or whatever time).

Note that this command has nothing to do with cable wraps.  \schedb does
not yet have control over cable wraps --- it only tries to predict them.

\rcwbox
{No argument}
{No argument - actually anything but -9999 will have the same effect}
{Do not wrap}
{Will take one specification for the observation}
{{\tt WRAP24}}


\subsubsection{\label{MP:YEAR}{\tt YEAR}}

{\tt YEAR} specifies the year of the stop time of the scan. This must
be specified for the first scan.  It is possible to specify it more
often, but that will almost never be necessary.

Note that two digit years will work for years between 1950 and 2050,
but are not recommended.

Also, SCHED will complain about an unreasonable year if it is not between
1900 and 2100.

\rcwbox
{Integer.}
{Any valid year.}
{None - \schedb will stop if not given for first scan.}
{Defaults to previous scan.}
{{\tt YEAR=1996}}



\section{\label{SEC:SRCCAT}Source Catalog}

\schedb uses catalogs to get source information such as names,
positions, and velocities.  These catalogs are in keyin
format. Entries are terminated with a ``/''.  Some or all of the
catalog may be included in a section in the \sched\ input file.
\sched\ will look there first for sources, and then go to the two
possible external catalogs to find the rest (or all).  Please note 
that the source catalog, along with the locations catalog of station
positions, is updated approximately annually to new solutions.  
All source positions will change, although likely by small amounts.
But relative astrometry projects should either use their own 
source positions to keep them constant over long times, or include
processing steps that account for any changes in the catalog positions
(the preferred solution).

As of Feb. 2015, there are two catalogs (plus older versions) included
with the \schedb distribution.  One contains a recent astrometry
solution from the Goddard Space Flight Center geodetic group.  There
is a symbolic link to it called sources.gsfc in \$SCHED/catalogs.  Another
contains a recent solution provided by Leonid Petrov.  The symbolic
link for the latest of these is sources.petrov.  The Petrov file
typically has very nearly all of the sources in the Goddard solution
(they are working from the same data sets) plus a significant number
more --- over 9000 in total.  There used to be a third file, 
{\sl sources.vlba} that contained all sources in either of the above
plus around 500 others from JVAS and an old VLA calibrator list.  
As the first two lists got large, the remaining extra sources in
{\sl sources.vlba} become more suspect as VLBI targets.  Plus maintenance
of the combined list was somewhat problematic, so it was dropped
in Feb. 2015.  If there is a {\sl sources.vlba} in the distribution, it
is either out of date, or is actually a symbolic link to one of the
main files, put there to try not to break old schedules.

The sources in the catalogs from the geodetic solutions are based on
the International Celestial Reference Frame version 2 or ICRF2 (these
have {\tt CALCODE=V}).  These have positional errors of a fraction of
a milliarcsecond to a few milliarcseconds.  They include sources from
the standard geodetic observing program, sources from the VLBA
calibrator survey, the Australian LBA survey, and various sources
specially observed in the RDV project on the VLBA. 

Users of accurate positions from the geodetic catalog are encouraged
to reference the original papers, some of which are listed in the
catalog headers.  Information about, and data from, the GSFC solutions
can be found at
{\href{http://vlbi.gsfc.nasa.gov/dataresults\_main.htm}{http://vlbi.gsfc.nasa.gov/dataresults\_main.htm}}.
Catalogs and much other useful information provided by Leonid Petrov
can be found at {\href{http://astrogeo.org/}{http://astrogeo.org/}}.

\schedb input parameters 
{\hyperref[MP:SRCFILE]{{\tt SRCFILE}}} and
{\hyperref[MP:SRCFILE2]{{\tt SRCFILE2}}} are used to point to any desired
external catalogs.  A file name of up to 80 characters can be
specified. The default source file is: \\ {\tt
SRCFILE=\$SCHED/catalogs/sources.petrov}.  \\ On unix systems with the
environment variable SCHED properly defined, this is the standard
catalog distributed with \sched.  Users of the html version of the
manual can read the catalog by clicking
{\href{catalogs/sources.gsfc}{GSFC}} or
{\href{catalogs/sources.petrov}{Petrov}}.

Source catalog information can be given in the main \schedb keyin
file. If the keyword {\tt SRCCAT} appears, all input after the next
``/'' is assumed to consist of source catalog entries until a line
 containing the keyword {\tt ENDCAT} and a ``/'' is encountered (don't
combine this keyword with a catalog entry).  Such ``in-line'' catalogs
may appear anywhere in a \schedb keyin file, although it is probably
best to put them near the beginning.  {\sc SCHED} will look in the
external catalog for any source not found in an in-line catalog.  If
you wish to prevent \schedb from looking in external catalogs, specify
{\tt SRCFILE=NONE} ({\tt SRCFILE2} is not used at all unless
specified.).  It is common to provide in-line source catalog entries
for unique program sources, but let \schedb find the fringe finders
and other calibrators in the standard catalog.  \schedb will look in
the in-line catalog first, then in {\tt SRCFILE}, then in {\tt SRCFILE2}.
It will use data from the first place a source is found.

The parameters for each entry in the source catalog are below.  Lower
case letters in this list are optional.  All catalog parameters except
{\tt EQUINOX} and {\tt EPOCH} revert to a default unless specified
for a source. {\tt EQUINOX} and {\tt EPOCH} default to the last specified.

Note that the 
{\hyperref[SEC:PLOT]{plotting capabilities}} of \sched,
specifically the RD plots, can be used to examine the distribution
of sources in the catalog and to find catalog near any desired
location.  This is useful, for example, for finding phase calibrators
near target sources.

\schedb will use whichever equinox coordinates are provided in the
catalog and determine J2000, B1950, and DATE coordinates.  All of
these coordinates are listed in the {\sl .sum} file.  Various stations
require different equinox coordinates.  For example, the VLBA only
understands J2000 coordinates while some other sites only understand
B1950, although those may all be gone by now.  Sched uses the SLALIB
routines to make the coordinate conversions.

The J2000 and B1950 coordinates systems move relative to each other so
an ``observe'' date is needed to make an accurate conversion.  This is
the date at which the coordinates of the reference sources were
determined.  For example, the VLA calibrator list coordinates were
determined in 1979.9 originally, and all subsequent updates, based
mainly on J2000 positions, were precessed to B1950 using an assumed
``observe'' date of 1979.9.  A similar situation exists at MERLIN,
where observing is done in B1950 coordinates.  There, the calibrator
positions (based again on positions provided originally in J2000) are
precessed to B1950 using an ``observe'' date of 1950.0.  Any B1950
source position determined on MERLIN should be precessed to other
systems using that date.  The user can specify the ``observe'' date
using the main schedule parameter 
{\hyperref[MP:PRECDATE]{{\tt PRECDATE}}}
which defaults to 1979.9, the correct value for use with
B1950 source positions determined on the VLA.  For purposes of
pointing antennas, the value of this date that is used is not very
important.  But if you are trying to phase reference, phase the VLA at
a high frequency, or derive positions for correlation, this is an
issue that should be dealt with properly.

The parameters of the source catalog are:

\begin{description}

\item [{\tt Source}:] This is the name of the source.  Up to 10 source
names (increased from 5 on Sept. 2010) can be provided to handle
aliases.  The names can have up to 12 characters each, although, as
noted below, some downstream software may not like that much.  No
software we know of requires less than 8 characters.

Be a bit careful about special characters included in source names.
Some are benign.  But, for example, the * and ? characters are used as
wild cards in many programs so, if either ends up in a file name (as
it will after SPLIT in AIPS), it could cause problems.  The temptation
to use * is high because of sources such as SgrA*.  But the
conservative approach is to avoid it.  Also, do not include imbedded
blanks in source names, as they cause problems at a variety of places
in processing.  Minus signs (dashes), plus signs, underscores, and
parentheses should not cause problems and are the commonly desired
characters.

Note that the number of characters you can have may be limited by
downstream software.  Snap files require source names of 10 characters
or less, but are not normally written by \schedb any more.
Finally, beware that the Mark~III correlators and the geodetic
software have 8 character source name limits.

\item [{\tt Ra}:] Right ascension. Remember that the VLA and
Westerbork need sub-arcsecond positions for phasing.

\item [{\tt RAERR}:] The coordinate error in the RA direction in but
in milliarcseconds.  Note that for RA, this is 15 times the coordinate
value error.  It is the coordinate error in the sense that, to get
the position error in angle on the sky, one would need to divide by
cos(Dec).  Prior to Dec 2014, this manual description indicated that
RAERR was the angle on the sky, but in practice for some time before
that (forever?), it had been the coordinate error in milliarcseconds.

\item [{\tt Dec}:] Declination.

\item [{\tt DECERR}:] The angular error in the declination direction in
milliarcseconds.  For dec, this is the same as the coordinate error.

\item [{\tt EQuinox}:] Epoch of the observations. Allowed values are
{\tt B1950}, {\tt J2000}, and {\tt DATE}.

\item [{\tt Calcode}:] Single-character calcode used for VLBA
control files. It is used by postprocessing packages to identify types
of sources, usually types of calibrators.  The {\tt CALCODE} is
optional for \sched.  {\tt CALCODE='G'} is reserved for pulsar
observations.  This calcode will trigger the use of the pulsar gate on
the VLBA correlator.  Think of {\tt G} as ``Gate''.  {\tt CALCODE='L'}
triggers on-line/off-line channel differences to be used for pointing
data analysis.  {\tt CALCODE='Z'} indicates that the source is a
satellite and that ephemeris data are needed for correlation (\schedb
will set this one for any satellite).

\item [{\tt VElocity}:] Velocity (km/s) of a spectral line
source. Up to 8 (16?) values can be given, one per base band
channel. The value for the first base band channel will be used for
any other channels for which no velocity is specified.  The
reference frame (eg LSR, Heliocentric...) and definition
(radio, optical or redshift) are given by {\tt VREF} and
{\tt VDEF}.

\item [{\tt VRef}:] The reference frame for velocity calculations.
Supported options so far are {\tt 'L'} for LSR, {\tt 'H'}
for heliocentric and {\tt 'G'} for geocentric.  LSR is the default.

\item [{\tt VDef}:] The definition of the velocity.  Supported options
are {\tt 'R'} for radio definition ($ V=c ( \nu_0 - \nu) / \nu_0$),
{\tt 'O'} for optical definition ( $ V= c ( \nu_0 - \nu ) / \nu = c (
\lambda - \lambda_0 ) / \lambda_0 = zc $ ), and {\tt 'Z'} if the
redshift is given directly.  The default is the radio definition.

\item [{\tt PMEPOCH}:] For planetary motion, the offset
from the {\tt RA} and {\tt DEC} are assumed to be zero at this time.
The format is {\tt PMEPOCH = yyyy,mm,dd,hh:mm:ss}; for example, {\tt
PMEPOCH = 1995,12,7,15:0:0} for 15 hours UT on 1995 December 7.
I appologize for any confusion caused by {\tt PMEPOCH} not being the
zero time for {\tt PMRA} and {\tt PMDEC} instead of {\tt DRA} and
{\tt DDEC}.  The \sched usage for planetary motion was established
long before the proper motions were added to the program and I did
not want to change the meaning of {\tt PMEPOCH}.  Also {\tt EPOCH}
is the standard throughout astronomy for the zero time of proper motion,
which is why it's meaning was changed from what is now {\tt EQUINOX}.

\item [{\tt DRA}:] Rate of change of {\tt RA} in seconds of time per
UT day.  This acts in coordinates of date.  Note that this is the
rate of change of the coordinate value, not the angular rate which
would be smaller by cos(dec).  The zero offset time is given by
{\tt PMEPOCH}.  Use {\tt DRA} and {\tt DDEC} for fast moving objects
like planets.  Use {\tt PMRA} and {\tt PMDEC} for slow moving
objects like stars.

\item [{\tt DDEC}:] Rate of change of {\tt DEC} in arcseconds per UT
day. Note that the azimuth and elevation reported by \schedb will not
take into account {\tt DRA} and {\tt DDEC}. This acts in coordinates
of date.  The zero offset time is given by {\tt PMEPOCH}.

\item [{\tt PMRA}:] The proper motion in RA in milli arcseconds per year.
This is an angular value and is 1/cos(dec) times the change in
coordinate value.  The zero offset time is given by {\tt EPOCH}.  When
{\tt PMRA}, {\tt PMDEC}, or {\tt PARALLAX} is used, the source
coordinates are shifted from the time specified by {\tt EPOCH} to a
time that is the stop time of the first scan or, if it is given, {\tt
PMEPOCH}.  {\tt PMRA}, {\tt PMDEC} are added to {\tt DRA} and {\tt
DDEC} respectively so that small motions during the observation of
fast moving stars can be accommodated.  The proper motion and planetary
motion parameters can both be used together, if one is mad enough
to want to do so.

\item [{\tt PMDEC}:] The proper motion in Dec in milli arcseconds per year.
The zero offset time is given by {\tt EPOCH}.

\item [{\tt EPoch}:] The zero point for proper motion expressed as
a fractional year such as 1993.6.

\item [{\tt PARALLAX}:] The parallax in milli arcseconds.  Synonym
{\tt PARALAX} for backward compatibility (yes, I misspelled it the first
time so backwards compatibility is an issue).

\item [{\tt FLUX}:] Flux densities at up to 10 frequencies for the
source.  The arguments (up to 30) are in triplets with the first being
the frequency in GHz, the second is the total flux density in some
image, and the third is the unresolved (peak) flux density --- what
you are likely to see on long baselines.  These values are typically
taken as a byproduct of geodetic observations and should be taken as
approximate.  All compact source vary to some degree --- most by a lot
--- so the source may well prove to have a different strength when
used than is shown.  But these flux densities should help distinguish
the strong from the weak calibrators.

\item [{\tt FLUXREF}:] A text string that indicated where the flux
density information came from.  It is likely to match one of the
catalog names from which positions of some sources were obtained.
It may not match the position catalog for an individual source.  A
typical case, at the time this parameter was added, is that the flux
densities come from one of Petrov's catalogs while many of the sources
use positions from a GSFC solution.


\end{description}

Below is a sample of a few sources from the March 2005 source catalog,
slightly reformatted to fit the page width.

\begin{verbatim}
SOURCE='J1629-2026'
     RA=16:29:03.0298580 DEC= -20:26:55.100570 
     RAERR=  29.510 DECERR=  13.450 CALCODE='V'
     REMARKS='VLBA Calib Survey - GSFC sols. - VCS2 - created 2004' /
SOURCE='J1630+2131','1628+216'
     RA=16:30:11.2308370 DEC=  21:31:34.310260 
     RAERR=   4.370 DECERR=   5.380 CALCODE='V'
     REMARKS='VLBA Calib Survey - GSFC sols. - VCS2 - created 2004' /
SOURCE='J1631+1052','1628+109'
     RA=16:31:18.7777000 DEC=  10:52:02.460000 
     RAERR=   4.370 DECERR=   5.380 CALCODE='M'
     REMARKS='JVAS-Browne etal. 1998, mnras, 293, 257; S8.4GHz= 72 mJy' /
SOURCE='J1631+4927','1629+495'
     RA=16:31:16.5398860 DEC=  49:27:39.515680 
     RAERR=   0.520 DECERR=   0.630 CALCODE='V'
     REMARKS='VLBA Calib Survey - GSFC sols. - VCS2 - created 2004' /
\end{verbatim}


\section{\label{SEC:STACAT}Station Catalog and Locations Catalog}

\schedb uses a catalog to get station information such as names,
positions, horizons, slew characteristics and more.  This catalog is
in keyin format.  Station positions may be stored separately in a
Locations Catalog.  There are standard Station and Location Catalogs
which will almost certainly have all stations used by a project.
\schedb will find these catalogs by default or their locations may be
specified.  Any or all of the Station Catalog entries may be given in
the main {\sc SCHED} input if desired.  In any case, the scheduler
should consult the catalog to be sure that the right station names are
being used in the schedule.  The catalog associated with this release
of \schedb is at 
{\href{catalogs/stations.dat}{{\tt \$SCHED/catalogs/stations.dat}}}.

\schedb input parameter {\tt STAFILE} is used to point to any desired
external catalog.  A file name of up to 80 characters can be
specified. The default is the standard catalog for digital backends:
\\ {\tt STAFILE=\$SCHED/catalogs/stations\_RDBE.dat}.  Eventually that
will be set back to {\tt STAFILE=\$SCHED/catalogs/stations.dat} once
the conversion of documentation and examples is complete.

Station catalog information can be given in the main \schedb keyin
file. If the keyword {\tt STACAT} appears, all input after the next
``/'' is assumed to consist of station catalog entries until a line
containing the keyword {\tt ENDCAT} and a ``/'' is encountered (don't
combine this keyword with a catalog entry).  Such ``in-line'' catalogs
must appear in the \schedb keyin file before the all of the input
for the first scan is complete.  This allows the use of station codes
to specify stations in each scan.

Both in-line catalog entries and an external catalog may be used for
the station catalog.  This would mainly be useful if there is a
non-standard antenna in the schedule.  That antenna's parameters can
be put in the in-line catalog while all other antennas are picked up
from the external catalog.  If you wish to prevent \schedb from
looking in external catalogs, specify {\tt STAFILE=NONE}.

It is only necessary to give one of {\tt X}, {\tt Y}, and {\tt Z} or
{\tt ELev}, {\tt LAT}, and {\tt LONG}.  The missing set will be
calculated.  If both are given, the provided values will be used.  If
a conversion is done, the WGS84 ellipsoid is used and the calculations
are accurate at the cm level.  Since WGS84 is tied to the ITRF, this
should be a good way to convert GPS coordinates to the Earth centered
coordinates used in VLBI.

Some of the information that can be given in the station catalog can
also be provided through a locations catalog.  This is mostly position
information.  The locations catalog can be specified by 
{\hyperref[MP:LOCFILE]{{\tt LOCFILE}}}.
See the description of that parameter for a
list of the station parameter that can be in the locations catalog.
\schedb will read and store the locations catalog before reading the
stations catalog.  If the station position is missing from the
stations catalog, \schedb will search for a station in the locations
catalog with the name specified with {\tt DBNAME} in the stations
catalog.  If a match is found, the associated coordinates will be
used.  The locations catalog is used because, in the standard
catalogs, the station locations are from the VLBA correlator data base
while all the other information is from other places.  It is much
easier to maintain separate catalogs.  Users will probably not need to
worry about all this, except perhaps to specify 
{\hyperref[MP:LOCFILE]{{\tt LOCFILE}}}
if they keep the \schedb standard catalogs in a
non-standard place.

The parameters of the station catalog are given below.  Items that can
be in the locations catalog are noted.  Lower case letters are
optional.  Entries for a station in the Station Catalog are terminated with
a ``/''.

Version and station names:

\begin{description}

\item [{\tt VERSION}:] Catalog version.  Actually set to the date when
all the master catalog segments were last gathered to form a full catalog.

\item [{\tt STAtion}:] Station name. Up to 8 characters.

\item [{\tt STCode}:] Station code. Up to 3 characters.  Usually there
are 2 characters.  See Appendix \ref{APP:STACODES} for a list
of codes.

\item [{\tt DBNAME}:] The station name used in the VLBA correlator
data base.  Might not be the same as {\tt STAtion}.  {\tt DBNAME} is
used to associate entries in the locations catalog with station
catalog entries.  \schedb uses {\tt STAtion} for almost everything
else.  This name distinguishes each pad of the interferometers.
There is a matching parameter with the same name in the locations
catalog.  Up to 10 characters.

\item [{\tt DBCODE}:] The station code used in the VLBA correlator
data base.  May not be the same as {\tt STCode}.  \schedb uses
{\tt STCode} for almost everything.  This code distinguishes each
pad of the interferometers so contains more information than the
usual 2 letter codes given in {\tt STCode}.  Can be put in the
locations catalog.

\end{description}

Station location:

\begin{description}

\item [{\tt FRAME}:] A character string indicating the origin
of the station location information.  Can be put in the locations
catalog.

\item [{\tt ELev}:] Station elevation in meters above (mean?) sea
level for geodetic coordinates or meters from the center of the Earth
for geocentric coordinates; these cases are distinguished by value
magnitude.

\item [{\tt LAT}:] Station latitude, either geodetic or geocentric.
The format is {\tt dd:mm:ss}. Positive in Northern Hemisphere.

\item [{\tt LONG}:] Station longitude, either geodetic or geocentric.
The format is {\tt ddd:mm:ss}. Positive in Western Hemisphere.

\item [{\tt ZALim}:] Zenith angle limit in degrees.  Can be used to
limit elevation coverage for stations with other than AZEL mounts.
The antenna will be assumed to point below this limit to whatever
limits are specified with {\tt AX1LIM} and {\tt AX2LIM} for purposes
of slew calculations.  However, if the antenna is below this limit,
the source will be considered to be down during any optimizations.

\item [{\tt X}:] Station X coordinate in meters.  This is in the
direction of the Greenwich meridian.  Can be put in the locations
catalog.

\item [{\tt Y}:] Station Y coordinate in meters.  This makes a right
handed coordinate system with X and Z.  Can be put in the locations
catalog.

\item [{\tt Z}:] Station Z coordinate in meters.  This is in the
direction of the north pole.  Can be put in the locations catalog.

\item [{\tt DXDT}:] Station rate of change of the X coordinate in
meters per year.  Can be put in the locations catalog.

\item [{\tt DYDT}:] Station rate of change of the Y coordinate
in meters per year.  Can be put in the locations catalog.

\item [{\tt DZDT}:] Station rate of change of the Z coordinate
in meters per year.  Can be put in the locations catalog.

\item [{\tt EPOCH}:] The epoch in MJD at which the X, Y, Z
coordinates apply.  In other words, when the offsets due to the
rates is zero.  Can be put in the locations catalog.

\item [{\tt DEScrip}:] Any text up to 80 characters (not used
by \sched).

\end{description}

Hardware types:

\begin{description}

\item [{\tt CONtrol}:] Telescope control file type. {\tt VEX} files
are produced for all projects because most antennas are converting
to using them for telescope control (including the VLBA) and most
of the correlators (DiFX, JIVE, MarkIV) need such files to control
correlation.  Other {\tt CONTROL} options imply that other format
files are written in addition to the {\tt VEX} file.  Valid option are
{\tt VLBA} for VLBA control files,
{\tt VEX} for stations that don't need any other formats,
{\tt VLA} for VLA observe files (obsolete),
{\tt NONE} for no control file - the default.
A {\tt 'V'} in the 5th character will cause a VLBA
control file to be produced with only the DAS (Data Aquisition System
--- BBC's, formatter, recorder etc) parameters.  It is meant for
cases with a VLBA style VLBI backend, but something else for telescope
control.  If the first
4 characters are VLBA, this will be the only file.  If they are
something else, both the other type of file and the reduced VLBA file
will be produced.  This is the default when {\tt CONTROL = VLA}.

\item [{\tt DAR}:] Gives the type of Data Acquisition Rack present.
This is mainly to identify the type of formatter is at the station
which will let the program know about the capabilities available.
Valid types are: {\tt VLBA}, {\tt RDBE}, {\tt RDBE2}, {\tt DBBC}, {\tt
MKIV}, {\tt VLBA4}, {\tt MKIII}, {\tt S2}, {\tt K4}, {\tt K5}, {\tt
VERA}, {\tt VSOP}, {\tt LBA} and {\tt NONE} (the default).  Note that
for Mark II scheduling (now obsolete), any site scheduled will be
assumed to have Mark II equipment.  The main non-obvious option above
is {\tt VLBA4}, which is a VLBA DAR but with a Mark IV formatter
installed. This will have VLBA BBC's and IF switching, but Mark IV
formatting characteristics.  The {\tt RDBE} and {\tt DBBC} are digital
systems containing FPGA chips that can support multiple personalities.
Those personalities are specified in the setup file since they can
change between schedules, or even scans.  The personalities are
specified with 
{\hyperref[SP:DBE]{{\tt DBE}}} setup file parameter.

The {\tt RDBE2} option is the same as the {\tt RDBE} except that
the presence of 2 RDBE units is assumed allowing twice as many 
channels with the DDC personality.  To use 2 RDBEs with one MARK5C
unit required the use of the VDIF format which is not yet available
for the PFB personality.  Also the PFB personality puts out a fixed
2 Gbps which is twice the capacity of the current MARK5C recorders.

\item [{\tt DBBCVER}: \label{ST:DBBCVER}] Gives the version of the DBBC.
Currently supported versions are:
\begin{itemize} 
      \item {\tt ASTRO} is the default {\tt DBBCVER}. It has 4
            IFs, with the following fixed patching: ifa=bbc01 to
            bbc04; ifb=bbc05 to bbc08; ifc=bbc09 to bbc12;
            ifd=bbc13 to bbc16. 
      \item {\tt GEO} has 2 IFs with the following fixed patching:
            ifa=bbc01 to bbc08; ifb=bbc09 to bbc16.
      \item {\tt HYBRID} has 3 IFs with the following fixed
            patching: ifa=bbc01 to bbc04; ifb=bbc05 to bbc08;
            ifc=bbc09 to bbc16.
\end{itemize}

\item [{\tt RECORDER}:] Gives the type of tape recorder(s) present
Valid options are: {\tt VLBA}, {\tt MKIV}, {\tt VLBA4}, {\tt MKIII},
{\tt S2}, {\tt K4}, {\tt K5}, {\tt VERA}, {\tt VSOP}, {\tt MARK5A},
{\tt MARK5B}, {\tt MARK5C}, and {\tt NONE} (the default).  The {\tt
VLBA4} option is for VLBA recorders which have been modified for 16
Mbps per track operation and can be equipped with 2 recording heads.
They are usually associated with {\tt MKIV} or {\tt VLBA4} DARs.

\item[{\tt NBBC}:] Tells \schedb how many BBC's or VC's are at the
site.

\item[{\tt NDRIVES}:] Gives the number of tape drives at the sites.
Most have only 1 but all VLBA sites, for example, have 2.  This can be
overridden for a schedule using the NDRIVES parameter in the tape
initialization information.  Note that, even with Mark5A disks, this
may need to be set to 2 to allow 512 Mbps recording, which requires
two heads or two drives to give 64 tracks.  {\tt NDRIVES} should be
the maximum number of drives at the station.  If less are in service,
the 
{\hyperref[SEC:TPINI]{tape initialization}} input, 
{\hyperref[TP:NDRIVES]{{\tt NDRIVES}}}
can be used to specify the smaller number.  For
S2 sites, NDRIVES should be the number of individual recorders.

\item[{\tt NHEADS}:] Gives the number of recording head blocks on
each VLBA or MKIV drive.  This will be useful mainly for MKIV
(and VLBA4) which will at some point have 2.

\item [{\tt DISK}:] Used to indicate that a disk based recording system
is available at the station.  Which system to use depends on the value
of the 
{\hyperref[TP:MEDIA]{{\tt MEDIA}}} parameter in the
{\hyperref[SEC:TPINI]{tape initialization information}}.  For VLBA
systems, commands for both {\tt RECORDER} and {\tt DISK} can be
included in the control file.  Valid arguments to {\tt DISK} for
now are restricted to {\tt MARK5A}, {\tt MARK5B}, {\tt LBADR}
and {\tt NONE} (the default).

\item [{\tt MEDIADEF}:] Gives the default recording system to use.  It
can be overridden by {\tt MEDIA} in the 
{\hyperref[MP:TAPEINI]{{\tt TAPEINI}}} section.
The options are {\tt TAPE} and {\tt
DISK}.  This is meant to facilitate VLBA operations during the
transition from tape to disk.

\end{description}

Horizon:

\begin{description}

\item [{\tt HOR\_AZ}:] Up to 200 azimuths at which horizon elevations
are given in {\tt HOR\_EL}.

\item [{\tt HOR\_EL}:] Up to 200 elevations for the horizon at the
azimuths specified by {\tt HOR\_AZ}. \sched's down, rise, and set
notes will take these horizons into account. They will also be used in
the optimization mode.

\end{description}

Mount details and performance:

\begin{description}

\item[{\tt MOUNT}:] The type of mount.  \schedb uses this, along with
the axis limits and rates, to calculate slew times.  The understood
options are {\tt ALTAZ}, {\tt EQUAT}, {\tt XYEW} and {\tt XYNS}.  Note
that {\tt XYNS} is for an XY axis system with the fixed axis in the
north-south direction (for example, Fairbanks).  {\tt XYEW}
is for the other orientation (for example, Hobart).

\item[{\tt AXISTYPE}:] The axis type as recorded in the VLBA
correlator data base.  There are different
keywords here than for {\tt MOUNT}.  Some day this should be cleaned
up.  Can be put in the locations catalog.  Will go to the VEX file.

\item[{\tt AXISOFF}:] The axis offset in meters.  
Can be put in the locations catalog.  Will go to the VEX file for
correlation.

\item [{\tt AX1LIM}:] The slew limits for the first axis which is
usually azimuth, hour angle or X.  The units are degrees for azimuth
or X and hours for equatatorial mounts.  There are up to 3 pairs of
numbers giving the lower and upper limits for 3 different parts of the
sky.  This is required to describe the limits for the 140' at Green
Bank and for XY antennas such as Hobart.  Only the first set will be
used for altaz antennas.  For altaz antennas, the zero for azimuth is
to the north and positive is clockwise looking down on the antenna.
For XY antennas, positive is to the north or east.

\item [{\tt AX2LIM}:] The slew limits for the second axis which is
usually elevation, declination, or Y.  The units are degrees in all
cases.  There are 3 pairs of numbers which define the three parts
of the sky over which the 3 pairs of {\tt AX1LIM}s apply.  The ranges
for altaz antennas should not overlap, although they can touch.  For
XY antennas, overlaps are ok.

\item [{\tt AX1RATE}:] The slew rate for the first axis in degrees
per minute for all mount types.

\item [{\tt AX2RATE}:] The slew rate for the second axis in degrees
per minute.

\item [{\tt AX1ACC}:] The acceleration for the first axis in degrees
per second squared for all mount types.  If one value is given, it is
assumed to apply to both acceleration and deceleration.  If two
values are given, the first is for acceleration and the second for
deceleration (although for the calculations, they are interchangeable).

\item [{\tt AX2ACC}:] The acceleration for the second axis in degrees
per second squared.  If one value is given, it is
assumed to apply to both acceleration and deceleration.

\end{description}

Scan timing information:

\begin{description}

\item [{\tt TSETTLE}:] The time in seconds (or mm:ss etc) to add to
the slew time for dwell time scheduling to determine when the antenna
is ready to observe.  This will include any computer overhead,
and time to make calibration observations.  Acceleration and
deceleration will be calculated explicitly if the above acceleration
parameters are provided in the station catalog.

\item [{\tt MINSETUP}:] The minimum interval between scans when using
dwell time scheduling.  If the slew time plus the settling time
drops below {\tt MINSETUP}, {\tt MINSETUP} will be used as the
interval between scans.  This is required because some antennas have
a minimum scan setup time but the actions that take that time can
overlap with the slew.  When the slew is long, the extra time does
not need to be added.

\item [{\tt TSCAL}:] Lets \schedb know when the station measures
system temperatures.  Arguments are text of 4 characters.  The viable
options so far are ``gap'' and ``cont'' that indicate the system temperature
measurements, or at least cal measurements, are done in the gap between
scans or continuously during observing.  The VLBA uses an 80Hz cal switch
and measures cal-on and cal-off powers from which, using a known cal
temperature, the system temperature can be derived.  Typical field system
controlled stations fire the cal once at the start of a scan and measure
the on and off power.  {\sc SCHED} will warn if there is inadequate time to
do this if TSCAL=GAP, but not when TSCAL=CONT.  This facility is still
not fully installed as of Nov. 5, 2008.

\item [{\tt MAXSRCHR}:] The maximum number of sources per hour.
This is originally intended to enable enforcement of the limit in
the number of slews per hour on the Mark1 telescope at Jodrell.  They
are very worried about fatigue and will refuse to run fast switching
schedules.  The default is 1.E6 which should be more than anyone
would try to schedule.

\item [{\tt TLEVSET}:] This is a time to be added to the slew
calculation to allow for the set-and-remember power level adjustments
that happen on the VLBA (RDBE) or VLA the first time a particular
setup is seen.  Like {\tt MINSETUP}, the time can overlap with slews
so functionally, this parameter acts exactly like {\tt MINSETUP} but
only for the first scan with a particular setup.  The VLBA needs 15
seconds.  The VLA needs 60 seconds.  As of Nov. 2012, the VLA actually
needs this every time there is a slight frequency change (like new
Doppler shift), but we will try to get that changed to be only for
more major changes.  Note that, if the first scan with a setup is
non-recording, non-pointing, and non-phasing, the scan itself will be
accepted as the level setting (DUMMY on the VLA) scan.  This allows
for explicit insertion of DUMMY scans.


\end{description}

Below is a sample entry from the RDBE based version of the standard 
station catalog.  The full catalog a can be examined 
{\href{catalogs/stations.dat}{here}} for the 
version that uses MARK5A at the VLBA and 
{\href{catalogs/stations\_RDBE.dat}{here}} for the RDBE
based version.

\begin{verbatim}

 STATION=VLBA_MK   STCODE=Mk  CONTROL=VLBA 
    DBNAME = MK-VLBA
    MOUNT=ALTAZ  AX1LIM=-90,450 AX2LIM=2.25,90 AX1RATE=86.8 AX2RATE=28.3
    AX1ACC=0.75  AX2ACC=0.25
    TSETTLE=6 TLEVSET=5 MINSETUP=5  DAR=RDBE  NBBC=16 
    DISK=MARK5C   MEDIADEF=DISK    TSCAL=CONT
    ! MK    From 150 K Ts line by Beasley and Medcalf  Aug 1992.
    HOR_AZ =   0,  5, 10, 15, 20,120,125,130,135,140,145,150,155,160,
             165,170,175,185,190,195,200,205,210,215,220,255,260,270,
             275,280,285,290,295,300,305,310,315,320,325,330,335,340,
             345,350,355,360
    HOR_EL =   5,  4,  3,  3,  2,  2,  4,  5,  5,  4,  4,  6,  8,  8,
              11, 12, 13, 13, 11, 11,  9,  7,  5,  3,  2,  2,  3,  3,
               5,  6,  8, 10, 12, 14, 12, 11,  9, 10, 11, 10, 12, 14,
              12,  9,  7,  5
  / 

\end{verbatim}

\section{\label{SEC:TPINI}Tape Initialization File}

The tape initialization file is mostly obsolete.  It is possible that
the ability to select the media type for particular stations will be
of use in the future during transitions between recording systems.
But all tape positioning capabilities became obsolete along with the
tape systems.  The highly unlikely that a tape initialization section
is needed in any schedule file.  If one is present, it is probably an
artifact of the use of old templates and it should be removed.

The tape initialization information can be used to select what
type of recording to make at a station and to give details about
the tape recordings if tape is used.

During the transition to Mark5, there was a period where both
tape and disk systems will be available at stations.  \schedb needs
a way to select which to use.  For each station, a default can be
set with {\tt MEDIADEF} in the station catalog. To override that
default, the {\tt MEDIA} parameter is provided here to tell
\schedb whether to assume that the data transmission system is
specified by 
{\hyperref[SEC:STACAT]{{\tt RECORDER}}} or 
{\hyperref[SEC:STACAT]{{\tt DISK}}} in the 
{\hyperref[SEC:STACAT]{station catalog}}.

The following is retain for historical reasons and should not concern
most users.

If you are not using the {\tt MEDIA} parameter, then you almost
certainly should not be using a tape initialization section {\tt
TAPEINI} or tape initialization file.  All the parameters have good
defaults for nearly all cases so explicitly setting them is more
likely to get you into trouble than to help.  The capability provided
by the file is only retained for special test observations.  Even the
{\tt MEDIA} parameter is not normally needed.  If your \schedb input
file contains a {\tt TAPEINI} section, you are probably an old time
VLBI observer using ancient templates.

When using a tape system, the tape initialization information tells
\schedb details about the tapes to be used at each site.  In nearly
all cases, the defaults are appropriate and very few users need to
specify any of this information.  Other than for test observations
which the user may wish to start in the middle of a tape, the only
exceptions are for observations that use thick tapes on Mark III or
Mark IV systems.  But since such tapes are no longer allowed at most
stations, this should be very rare.  If tape initialization
information is needed, the information can be specified in an external
file, the 
{\hyperref[MP:TAPEFILE]{{\tt TAPEFILE}}}, or can be imbedded
in the main file following the parameter 
{\hyperref[MP:TAPEINI]{{\tt TAPEINI}}}.

The capability to have a separate {\tt TAPEFILE} was originally part
of an attempt to deal with the general case of VLBA tape handling.
Such a file could have been used to schedule multiple projects per
tape by specifying where each project starts.  The file would have one
full set of inputs per project.  But the automatic tape allocation by
the on-line system now deals with this situation in a cleaner manner.
Automatic tape allocation and automatic reversals can be requested
using \sched's 
{\hyperref[MP:AUTOTAPE]{{\tt AUTOTAPE}}} parameter;
however, these options only apply to sites with VLBA control systems
and more than one tape drive and can only be used for projects to be
correlated on the VLBA correlator.  When automatic tape handling is
requested, \schedb puts the appropriate commands in the control files.
It also attempts to predict what the tapes will do assuming that they
start in the place specified in the tape initialization file.  Users
should be aware that these predictions may be not be accurate because
tape lengths can vary and the tape start position may depend on the
preceding project.

Note that the number of heads in use at a time (8, 16, or 32), which
determines the number of passes per head index position (1, 2, or 4 as
specified by 
{\hyperref[SP:TPMODE]{{\tt TPMODE}}} in the 
{\hyperref[SEC:SETUPS]{{\sl setup file}}},
is not allowed to change during a project
at a station, although different stations may use different values for
{\tt TPMODE}.  This restriction avoids a the bookkeeping nightmare
raised by the more general case.  \schedb checks all the requested
setups for a station and remembers the largest number of heads
(smallest {\tt TPMODE}) and allocates tape for all scans as if that
value were in use.  This is wasteful of tape, but allows some tests to
be done with mode switching.

The following are some capabilities supported through the tape initialization
file:

\begin{enumerate}
\item Different tape lengths at different stations.

\item Different bit densities, and hence tape speeds, at different
stations.

\item Tape drive and index position at program start specified for
each station.

\item Tape speed, bandwidth, and sample rate can change during run.
Beware of operational restrictions on the use of this capability.
See the 
{\href{http://www.aoc.nrao.edu/vlba/obstatus/guidelines.ps}{guidelines for preparing observing schedules}}
available from the NRAO WWW home page under VLBA.

\item Different number of tape drives at each station.
\end{enumerate}

A single set of tape initialization conditions can be specified in the
\schedb keyin file using {\tt TAPEINI} followed by a ``/'', in
much the same way that in-line catalogs are given. This is the normal
way that the tape initialization information is provided.  Unlike
the source and station catalogs, only one input group will be read and
that group will be terminated by a ``/''.  No {\tt ENDCAT} or
equivalent is required, or even allowed.

The input parameters of the {\tt TAPEFILE} are:

\begin{list}{~}{\parsep 0em  \itemsep 0em }
\htlu{MEDIA}{~~~} Which record system to use.
\htlu{NDRIVES}{~} Number of drives at the site.
\htlu{NHEADPOS}{} Number of head positions in use at site.
\htlu{OBSCODE}{~} Experiment code for this observation.
\htlu{TPSTA}{~~~} Station name for this group of parameters.
\htlu{TPDRIVE}{~} The drive to begin the observation on.
\htlu{TPINDEX}{~} The tape index at which to start the observations.
\htlu{TPLENGTH}{} The length of the tapes to be used at the site.
\htlu{DENSITY}{~} Are tapes at sites high or low density.
\htlu{TPTIME}{~~} Mark II tape length in time.
\htlu{HEADMODE}{} Indicator of head positions to use.
\end{list}

The first example shows a tapeini section that might be used during
the transition to MARK5.  Note that {\tt BOTH} means create a
schedule with both types of control information so that operations
can pick which to use.  This works for the VLBA, but not for
stations controlled by the VEX file.  For this example, all
tape parameter will take their default values.

\begin{verbatim}

tapeini /
tpsta    = vlba_sc, vlba_hn, vlba_nl, vlba_fd, vlba_la, vlba_pt,
           vlba_kp, vlba_ov, vlba_br, vlba_mk, gb_vlba, medicina,
           noto,    onsala60
MEDIA    = TAPE,    TAPE,    TAPE,    DISK,    DISK,    DISK,
           DISK,    TAPE,    DISK,    TAPE,    TAPE,    DISK,
           TAPE,    DISK
  /
\end{verbatim}

The second example of a tape initialization group shows the usage for
specifying the tape system.  Note the {\tt NDRIVES} is not given so
that it is picked up from the 
{\hyperref[SEC:STACAT]{station catalog}}.
Note that the 
{\hyperref[SSSEC:VLBIEG]{example file for VLBI at the VLA}}
contains a tape initialization group to show what it is like.  Usually
it should be reasonable to take the defaults.


\begin{verbatim}

obscode ='default'
tpsta   ='vlba', 'vla1', 'vla27', 'eb_vlba', 'gb_vlba', 'default'
tpdrive =1,      1,      1,       1,         1,         1
tpindex =1,      1,      1,       1,         1,         1
tplength=17600,  17600,  17600,   17600,     17600,     8800
nheadpos=14,     14,     14,      14,        14,        14
density =H,      H,      H,       H,         H,         L
        /

\end{verbatim}

\subsection{Details of Tape Initialization Parameters}

\subsubsection{\label{TP:MEDIA}{\tt MEDIA}}

{\tt MEDIA} is used to specify how the data are to be transmitted to
the correlator.  This is mainly useful when a station has
alternatives, such as both a tape system (
{\hyperref[SEC:STACAT]{station catalog}}
parameter {\tt RECORDER}) and a disk system
({\hyperref[SEC:STACAT]{station catalog}} parameter {\tt DISK}) and the
default needs to be overridden.  Valid arguments are blank (use the
default), {\tt TAPE} (use the tape system), and {\tt DISK} (use the
disk system).  Eventually other options such as real time may be
added.

If an option is specified that is not consistent with what is available
at the station, an error will occur.

Note that most, if not all, stations now have ways to convert tape to
disk files so it is essentially never necessary to specify {\tt MEDIA},
and, in fact, is essentially never necessary to have a tape initialization
section.


\rcwbox
{An array of character strings of up to 8 characters each, one per
station.  Not case sensitive.}
{One of {\sl Blank}, {\tt TAPE, DISK, TAPEDISK, DISKTAPE}.  Must
have corresponding {\tt RECORDER} or {\tt DISK} in the station
catalog.}
{{\tt TAPEDISK} for the VLBA controlled systems, {\tt TAPE} for others.}
{Defaults to the previous group.}
{{\tt MEDIA=DISK, TAPE, TAPEDISK, DISK}}


\subsubsection{\label{TP:NDRIVES}{\tt NDRIVES}}

{\tt NDRIVES} if the number of tape drives at each station. This
parameter can also be given in the station catalog and only need
be given here for abnormal configurations.  The value in the
tape initialization information will override the number in the
station catalog.

The VLBA sites and the VLA normally have 2 drives.
Other sites will usually have 1.

Note that the schedule can be forced to use a single tape drive other
than number 1 by setting {\tt NDRIVES=1} and {\tt TPDRIVE=N} where
{\tt N} is the desired drive (usually 2). This is useful if, for
example, tape drive 1 is out of service.

For S2 stations {\tt NDRIVES} indicates the number of transports in the
S2 recorder (usually 8).

{\tt NDRIVES} will not be allowed to exceed the number specified in
the station catalog.

\rcwbox
{An array of up to 30 integers, one for each station in the {\tt
TPSTA} list.}
{{\tt 1} or {\tt 2} are the likely choices.}
{{\tt 2} for the VLBA and VLA, {\tt 1} for others.}
{Defaults to the previous group.}
{{\tt NDRIVES=1,1,2,2,1,2}}

\subsubsection{\label{TP:NHEADPOS}{\tt NHEADPOS}}

{\tt NHEADPOS} is the number of head positions to use at the
station. The traditional number for Mark~IIIa sites is 12. However,
the VLBA uses a head position sequence with 14 positions. This allows
more data to be put on a tape. This input is provided mainly to allow
the number of head positions to be forced to 12 to match a schedule
made to allow time for tape changes every 12 head positions. This is
likely to be common for Mark~III projects.

The MkIV schedules are currently scheduled with similar
transverse tape format as the VLBA; normally the same 14 head
positions are used. For recordings made with 2 heads, 6 head
positions is the default.
For S2 recorders this parameter is ignored, the
different groups in an S2 format can be set by {\tt TPMODE}.


\rcwbox
{An array of up to 30 integers, one for each station in the
{\tt TPSTA} list.}
{{\tt 12} or {\tt 14} are the likely choices but the program will
take any value.}
{{\tt 14}}
{Defaults to previous group.}
{{\tt NHEADPOS=12,12,14,14,12,14}}

\subsubsection{\label{TP:OBSCODE}{\tt OBSCODE}}

{\tt OBSCODE} is the Project code for the project for which this
group of inputs applies.

\rcwbox
{Character of length 8.}
{Any valid project code.}
{{\tt DEFAULT}. Implies that this group will give the default
information.}
{Defaults to previous group, which is not likely to be useful.}
{{\tt OBSCODE='BW005B'}}

\subsubsection{\label{TP:TPSTA}{\tt TPSTA}}

{\tt TPSTA} is an array of up to 30 station names. One can be
{\tt 'DEFAULT'} which means that the corresponding parameters will be
used for stations not explicitly in the list.  A station {\tt VLBA}
will match any VLBA stations that are not specified explicitly.  Actually
it matches any stations with the first four characters ``VLBA''.
A station {\tt VLA} matches any station with the first 3 characters
``VLA'' that is not otherwise specified explicitly.  For example, it
matches ``VLA1'' and ``VLA27''.

\rcwbox
{Character of length 8.}
{Any station name.}
{Blank}
{Defaults to previous value if none are specified. This is likely to
be the normal mode of use with the station list only given for the
first observation. If any stations are given, it is assumed that a
complete new list is being given.}
{{\tt TPSTA='VLBA\_PT','VLBA\_KP','VLA27'}}

\subsubsection{\label{TP:TPDRIVE}{\tt TPDRIVE}}

{\tt TPDRIVE} is the tape drive on which to start the project. Each
element in the array applies to the station in the corresponding
element in the {\tt TPSTA} array. If {\tt NDRIVES=1}, the schedule
will use the tape drive specified by {\tt TPDRIVE} for all scans. This
is useful for cases when tape drive 1 is out of service.

\rcwbox
{An array of 30 integers.}
{{\tt 1} or {\tt 2} for VLBA sites. {\tt 1} for most others.}
{1}
{Defaults to previous value.}
{{\tt TPDRIVE=2,1,1}}

\subsubsection{\label{TP:TPINDEX}{\tt TPINDEX}}

{\tt TPINDEX} is the head index position on which to start. It will
be assumed that there are no previously recorded data at this index
position. A value for each station in {\tt TPSTA}. With the new head
position sequence all forward passes start on odd numbered index
positions. \schedb will require {\tt TPINDEX} be odd and will add
1 to any even value.

\rcwbox
{An array of 30 odd integers.}
{Integer between {\tt 1} and {\tt 13}.}
{1}
{Defaults to previous value.}
{{\tt TPINDEX=5,6,2}}

\subsubsection{\label{TP:TPLENGTH}{\tt TPLENGTH}}

{\tt TPLENGTH} is the length of the tapes in use at each site.  For
VLBA, Mark~III, and Mark IV tapes, the length is in feet.  Thick
tapes, which are still in use within the EVN but are not allowed at
the VLBA correlator, have roughly 8800 feet of usable length(see
the 
{\hyperref[SSSEC:TAPELEN]{section on tape lengths}}).  Thin
tapes used for most VLBA and Mark IV observations usually have 17600
feet of usable tape.  The VLBA operations staff tries to make sure
that all thin tapes have at least 17400 feet of usable tape by
splicing in extra when needed.  Note that the 200 ft difference
amounts to 30 seconds at 80 ips (the speed for speed-up-factor 2
observations).

Note that changing the length of the tape is not sufficient to switch
from thick to thin tape. In that case one usually also needs to modify
{\hyperref[TP:DENSITY]{the recording density}}

S2 tape length should be given in seconds, corresponding to Standard
Play in a US VCR. A tape with label ST-120 (or SE-180) should be
scheduled with TPLENGTH = 7200


\rcwbox
{An array of 30 integers giving tape lengths in feet.}
{Any value, but 8800 and 17600 are likely to be the true values.}
{17600}
{Defaults to previous value.}
{{\tt TPLENGTH=17600,00,8800}}

\subsubsection{\label{TP:DENSITY}{\tt DENSITY}}

{\tt DENSITY} specifies whether the tape is to be written at
high or low density.  The tape speeds corresponding to each density
can be specified in the setup file using {\tt TPSPEEDH} {SP:TPSPEEDH}
and {\tt TPSPEEDL}{SP:TPSPEEDL} or, better, they can be allowed to
default.

For S2 tapes, density ``{\tt H}'' refers to {\tt SLP} and ``{\tt L}''
to {\tt LP}.

\rcwbox
{An array of character strings of up to 8 characters each, of which
only the first character will be used.}
{The first letter of each string must be ``{\tt H}'' or ``{\tt L}''
(not case sensitive).}
{{\tt H} for the VLBA and VLA, {\tt L} for others}
{Defaults to the previous value.}
{{\tt DENSITY=H,L,L}}

\subsubsection{\label{TP:TPTIME}{\tt TPTIME}}

{\tt TPTIME.} This is for Mark~II. It specifies the reference
time for tape changes at each  site. The tapes at the station will be
changed an integral number of 4 hour intervals before or after this
time. In effect, it is a station dependent {\tt TPREF}. This value, if
specified, will override {\tt TPREF} for the corresponding station.

\rcwbox
{An array of 30 times in {\tt hh:mm:ss} format.}
{Any valid time between {\tt 0} and {\tt 24} hours.}
{{\tt -1} which causes it not to be used. {\tt TPREF} or the first
scan of the project will be used instead.}
{Defaults to previous value.}
{{\tt TPTIME=2:0:0,3:0:0,2:0:0}}

\subsubsection{\label{TP:HEADMODE}{\tt HEADMODE}}

{\tt HEADMODE.}  This allows the user to set the head usage mode.
Such a mode includes the head positions for each pass and the
sequence of head positions to use for passes.  There are two options
and a default.  Use of anything except the default (blank) is only recommended
for system tests.  The first option is VLBA14 which is the standard
VLBA/MARKIV sequence with 14 head positions.  The other option is
MKIV2H which is appropriate for Mark IV wide band observations that
use two headstacks.  If MKIV2H is set by the user, or more likely by
the program when in TWOHEAD mode, NEADHDPOS is forced to 6.

\rcwbox
{A character string of up to 8 characters}
{' ', 'VLBA14', or 'MKIV2H'}
{' ', which tells the program to figure it out.}
{Defaults to previous value.}
{{\tt HEADMODE=MKIV2H}}

\section{\label{SEC:FRQCAT}Frequency Catalog}

\schedb is able to fill in many items in setup files based on
knowledge of possible frequency setups at the stations as described in
the frequency catalog.  This allows the user to only specify basic
information.  A reasonable minimum set is: 
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}, 
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}},
{\hyperref[SP:BITS]{{\tt BITS}}}, 
{\hyperref[SP:POL]{{\tt POL}}} (can be {\tt DUAL}), and either 
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} (and
{\hyperref[SP:FREQOFF]{{\tt FREQOFF}}}) or 
{\hyperref[SP:BAND]{{\tt BAND}}}.
The frequency catalog also allows \schedb to check user specified
values against standard sets to warn of any oddities.

Most users will not touch the frequency catalog.  If they need a setup
that does not conform to what is in the catalog, they should just make
the necessary 
{\hyperref[SEC:SETUPS]{{\tt setup files}}} and ignore the
warnings after making sure that the special files are correct.  Be
very careful doing this.  There are filters on many of the LO and IF
cables, at least on the VLBA, that most users probably are not aware
of.  Any special setup files that do not match one of the standards
should be shown to Craig Walker for approval.  If it is a good one, it
may be added to the standards.  However, the standard set is
essentially complete for the VLBA.  If \schedb complains about yours,
it is likely to be in error.  If a user really wants his/her own
frequency catalog, use the input parameter
{\hyperref[MP:FREQFILE]{{\tt FREQFILE}}} to specify the file name.

There is a lot of information about available frequencies, receivers,
frequency ranges, filters etc, especially at the VLBA, in the standard
frequency catalog.  A table of information about possible setups for
observations within a frequency range can be made by running \schedb
with 
{\hyperref[MP:FREQLIST]{{\tt FREQLIST}}} {\tt = lowfreq, highfreq}
(eg {\tt freqlist=4800,8900}) as the only input.  The frequencies are
in MHz.  If only one frequency is given, the second will be set equal
to the first.  \schedb will produce a table in file {\sl
frequencies.list} containing details of the information available on
how to set up these frequencies at all known sites.  \schedb will then
quit.  Note that it is not necessary to transfer this information to
your setup files --- \schedb will do that automatically based on your
frequency and polarization requests in the setup file.  To examine the
catalog itself, look at {\tt \$SCHED/catalogs/freq.dat} or, if reading
the html version of the manual, click 
{\href{catalogs/freq.dat}{here.}}.


\subsection{\label{SSEC:FREQLST}List of Frequency File Parameters}

The parameters of the frequency file tell \schedb over what frequency
range the group if usable and on which stations.  Most of the parameters
are the same as parameters in the setup file since they are meant
for direct substitution once the correct frequency group has been
identified.  There is no defaulting between groups of inputs --- all
parameters are reset to zero, blank, or some equivalent value.

For the VLA, IF's A and C will be assumed to apply to VLA27 while
IF's B and D will be assumed to apply to VLA1.  All standard
frequency groups will have both VLA IF's on the same frequency.
Anything more complicated requires a setup file from the user.

\begin{description}

\item [{\tt STATIONs}] Up to 10 stations with this setup.  This will
be matched against the station name in the setup file.  The name
{\tt VLBA} will be a default for all VLBA stations.

\item [{\tt PRIOrity}] A ranking with low values prefered.  This
allows preference of one setup over another if both match the
required frequencies.  For example, the narrow band 50 cm receiver
would be chosen over the wide band one for narrow band observations
despite the fact that both would match the requested frequencies.

\item [{\tt NAME}] A name for the frequency group.  It is used
in listing and error notes to help the user find the right one.
Up to 12 characters long.  Any string ok.

\item [{\tt NOTE}]  A comment about the setup that will go to
various listings.  It is wise to note any limitations here that
might not be obvious to a user.  Up to 80 characters.

\item [{\tt IFNAME}\label{FQ:IFNAME}] The name of the IF for up to 8 IF
descriptions (eg. A, B, C, D).  There are a larger number than there are
phsical IFs to allow description of such systems as the VLBA 50/90 cm
system where there are more than one signal in each IF.

For antennas in the EVN that have VLBA(4) DARs, the codes in use are
usually A and C (LCP and RCP). For MkIV antennas there are two IF
distributors that can one can choose to connect to either IF channel.
Each distributor is connected to a fixed subset of the BBC's, either
the odds or the evens.  The normal situation has IF 1N on LCP and 2N
on RCP, but alternate channels 1A or 2A can be connected if more than
the first 7 BBC's need to be set to a single polarization.

For the 
{\hyperref[SSEC:DBBC]{{\tt DBBC}}}, {\tt IFNAME} contains two
characters. The first (A-D) gives the conditioning module to be used,
the second (1-4) determines which of the switchable inputs on that
conditioning module is to be selected. The signal available on each
input depends on the local station wiring, so careful catalogue
maintenance is required.

\item[{\tt ALTIFN}]  An alternate IF name for this frequency setup.
For the Mark IV systems, the odd BBC's are attached to IF's 1N and
1A.  The even BBC's are attached to 2N and 2A.  Generally the
same signal is put on 1N and 2A while another (other polarization)
is put on 2N and 1A.  When assigning IF names using frequency table
information, sched will pick {\tt IFNAME} or {\tt ALTIFN} depending
on whether the BBC is even or odd and on the first digit of the
names.

\item [{\tt RF1}] The low edge of the RF frequency range covered by
each IF.  \schedb will try to find the group with all the channels
best centered in the IF.  However, some channels will allowed to be
outside the range if necessary, as is common on the VLA.

\item [{\tt RF2}] The high edge of the RF frequency range covered by
each IF.

For Mark~IV systems, the frequency ranges in the frequency catalog
are calculated with the constraint that the complete range can be
obtained with the station preferred patching, i.e.\ with consistently
using high or low output on the IF distributor.  More frequency
coverage can be obtained with detailed knowledge and requires a manual
setup.

\item [{\tt CH1RF1}] The lowest RF frequency for channel 1.  If
non-zero, channel 1 will be required to fall in the range specified by
{\tt CH1RF1} and {\tt CH1RF2}.  This is mainly to be sure that the
right filter is used at 2cm on the VLBA.

\item [{\tt CH1RF2}] The highest frequency for channel 1.  See
{\tt CH1RF1}

\item [{\tt LO1}] The 
{\hyperref[SP:FIRSTLO]{{\tt FIRSTLO}}} for each IF
channel.

\item [{\tt FE}] The 
{\hyperref[SP:FE]{{\tt FE}}} (receiver
specification) for each channel.  Use {\tt omit} for unused channels.

\item [{\tt POL}] The polarization of the channel (RCP or LCP).

\item [{\tt SYN}] The 
{\hyperref[SP:SYNTH]{{\tt SYNTH}}} setting for each
of the three front end synthesizers on the VLBA.

\item [{\tt DUALX}] Use the wideband scheme at 4 cm on the VLBA.  See
the setup parameter 
{\hyperref[SP:DUALX]{{\tt DUALX}}}.

\item [{\tt LCP50CM}] Setting for the 50 cm filter.  See setup file
parameter 
{\hyperref[SP:LCP50CM]{{\tt LCP50CM}}}

\item [{\tt RCP50CM}] Setting for the 50 cm filter.  See setup file
parameter 
{\hyperref[SP:LCP50CM]{{\tt RCP50CM}}}

\item [{\tt CHNSTA}]  Only use this IF if {\tt CHNSTA} matches the
station name.  This allows the same groups to be used for VLA1 and
VLA27, but to differ in the IFNAME.  Options are the station name
or {\tt BOTH}.  This facility has been disabled and may be removed.
It has been made obsolete by the new digital patch panel at the VLA
and the effort by \schedb to determine which IF's are to be used for
the each setup depending on the specified modes in the schedule.
Modes {\tt VA, VR} and {\tt VL} require different IF restrictions.

\end{description}

The following are OBSOLETE VLA parameters that should not be used.

\begin{description}

\item [{\tt VLABAND}] The VLA frequency band.  See setup file parameter
{\tt VLABAND}

\item [{\tt VLABW}] The VLA bandwidth codes.

\item [{\tt VLAFEAB}] The VLA first LO.

\item [{\tt VLAFECD}] The other VLA first LO.

\item [{\tt VLAIF}]  The VLA gain file name.

\item [{\tt VLAROT}] The VLA ROT file name.

\item [{\tt VLASYNA}] The VLA AC F6 setting.

\item [{\tt VLASYNB}] The VLA BD F6 setting.

\item [{\tt FEFILTER}] The VLA BD F6 setting.

\end{description}


%huibhier

\section{\label{SEC:SETUPS}Setup Files}

Setup files are used to provide station-specific input parameters.
Most are for the VLBA, which requires complete configuration
information be present in each VLBA control file, and the VLA, which
requires information for the frequency setup.  For each scan in a
schedule, the setup file is specified with {\tt SETUP}.  Once specified,
it need not be given again unless it changes.  Several setup files
may be used in a schedule --- usually for switching between frequency
bands.

\schedb will not run without a setup file specified for each
scan.

Setup files can be imbedded in the main program input, much like
source and station catalogs.  The group of inputs immediately before
the setup file should contain the parameter {\tt SETINIT} with an
argument that gives this ``setup file'' (which may contain more than
one group of stations) a name.  This procedure may be used multiple
times to specify several ``setup files''.  In the main schedule,
the name given the imbedded file can be used as the argument to
{\tt SETUP} as if it were an external file.

The setup files can be used to control many aspects of the hardware
setup at the stations.  Mostly it is used to set frequencies and
recording modes, but it also has pulse cal detection, pointing, and a
number of other items.  Most parameters can be left unspecified and
\sched, with the help of the 
{\hyperref[SEC:FRQCAT]{frequency catalog}},
will find reasonable defaults.  See the discussions of individual
parameters for details. A reasonable minimum set would be:
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}, 
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}}, 
{\hyperref[SP:BITS]{{\tt BITS}}}, 
{\hyperref[SP:POL]{{\tt POL}}} (can be {\tt DUAL}), and either 
{\hyperref[SP:BAND]{{\tt BAND}}} or 
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} (and
{\hyperref[SP:FREQOFF]{{\tt FREQOFF}}}.  Some users may wish to specify
more information, for example 
{\hyperref[SP:BBC]{{\tt BBC}}},
{\hyperref[SP:NETSIDE]{{\tt NETSIDE}}}, and 
{\hyperref[SP:FORMAT]{{\tt FORMAT}}}
and perhaps many others rather than taking the defaults.

Each setup file can consist of several setup groups separated by ``/''.
Each group applies to the stations listed.  This allows some parameters,
such as 
{\hyperref[SP:FIRSTLO]{{\tt FIRSTLO}}}, to be station specific.
However, if no station specific values are included, stations may be
lumped together into a single group even though \schedb will have
to separate them before using other information to set the station
dependent parameters.  The ultimate case of this is to have just
one setup group and not specify any stations.  This is possible if
only generic parameters are given.  \schedb will figure out what
stations are needed and establish the necessary setup information.

If you don't take the defaults, \schedb will check your setup against
the information it has internally and in the frequency catalog.  If
your setup does not match one in the frequency catalog in terms of the
setup of the IF's, \schedb will complain, but not stop.  If the
complaint is about a VLBA setup, you are probably using a poor set of
synthesizer settings or have some other such problem because the
frequency catalog contains an essentially complete list of reasonable
setups.  Please be aware that there are filters in the LO and IF
signal paths of the VLBA that many users do not know about.  If your
setup is not in the frequency catalog, you may simply have specified
the wrong IF or synthesizer or you may be trying to use a signal
outside of the band of some filter.  For other stations, the frequency
catalog is not so complete.  If \schedb complains, double check your
parameters to be sure they are right.  In such cases, it is best to
email your setup to Craig Walker (cwalker@nrao.edu) for further
checking.

If only generic parameters such as those above are specified,
multiple stations can be specified for a setup group.  \schedb will
actually take those multiple stations and create multiple setup
groups before filling in the defaults, many of which will be
station dependent.

\subsection{\label{SSEC:SETSTD}Standard Setup Files}

Over 200 standard setup files have been created, covering many of the
normal modes of observing.  They are available at the same place as
the code for \schedb in a ``setups'' subdirectory.  Users may opt
to use these standard setups.  However, now that 
{\hyperref[SP:BAND]{{\tt BAND}}}
is available, it will make more sense for most users
to make their own setups, imbedded in the \schedb input file.  See
the example {\sl egvlba.key} for a template.  The only parameters
required in such a setup are 
{\hyperref[SP:BAND]{{\tt BAND}}},
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}, 
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}},
{\hyperref[SP:BITS]{{\tt BITS}}}, and 
{\hyperref[SP:POL]{{\tt POL}}}.
You need to know all of those just to pick the standard setup file
to use so why not make your own?  In fact, as users get accustomed
to doing this, many of the standard setups may be dropped.
This file has not been updated from MARK5A to MARK5C.

There are cases, however, when use of the standard files is
recommended.  These especially include precisely defined, and somewhat
complex cases like the Mark III standard modes (although MarkIII went
the way of the dinosaur long ago.  Also, if none of the standard files
matches the exact needs of a project, there is likely to be one that
is close and can be modified as required.  This is generally safer
than creating a setup file from scratch because it will be clear what
parameters are required.

The standard setup files take advantage of the defaulting ability of
\sched.  If you are interested in what most of the setup parameters
will actually be set to, the best way to do this is to run a simple
dummy schedule that uses the setup and look at the details reported in
the summary file.  A simple file like the 
{\hyperref[SSEC:EXAMPLE3]{simple example}} given earlier should do (with 
{\hyperref[MP:OBSTYPE]{{\tt OBSTYPE}}}
set to {\tt VLBI}), although cover and correlator
information will be required.

Standard setup files are named according to the following
conventions:

\begin{description}

\item[``{\sl v}'' files:] These are setup files for VLBI observations
using VLBA recording formats.  The VLBA system is very flexible so
there are large numbers of options.  There is much more information in
the name which might be best described with an example.  The file {\sl
v6cm-128-4-2-L.set} is for 6 cm observations in VLBA format.  The
first number after a ``-'' gives the total bit rate in Mbits/s which
is 128 in this case.  The next number is the number of channels (4).
The last number is the number of bits per sample (2).  If the file
only uses one polarization, there will be an ``L'' or an ``R'' at the
end.  If the file uses upper and lower sidebands where all upper
sidebands could be used on the VLBA, there will be a ``UL'' appended.
These files can be used when observing with sites such as Effelsberg
which have a limited number of BBCs.  All setup files, by convention,
end in ``{\sl .set}''.  Note that one can deduce the bandwidth and
sample rate from the above information assuming Nyquist sampling.
With 128 Mbits/s and 4 channels, the channel bit rate must be 32
Mbits/s.  With 2 bits per channel, this means that the sample rate is
16 Msamples/s.  Nyquist sampling implies 8 MHz bandwidth per channel,
which, with 4 channels, gives 32 MHz overall bandwidth.

\item[``{\sl m3}'' files:] These are setup files for Mark~III
observations.  \schedb only supports Mark~III observing for
systems with VLBA control computers and data acquisition systems.
These include the VLBA, the VLA, Green Bank, and, optionally,
Effelsberg.  An example file would be {\sl m3e18cmd.set}.  This means
Mark~III, mode E (4 passes per head position), 18 cm observing
wavelength, double speed.  Here, double speed means recording at 8
Mbits/s per track.  With Mark~III, there is a one-to-one
correspondence between tracks and channels and there are a total of 28
possible tracks.  Also, all sampling is in one bit mode.  Mode E uses
7 tracks (channels) at a time so this setup specifies a total bit rate
of (7 * 8) = 56 Mbits/s and, with Nyquist sampling, 28
MHz total bandwidth.

\item[``{\sl vla}'' files:]  These are setup files for VLA-only
observations.  The don't specify any tape related information.

\item[``{\sl pt}'' files:] These are setup files for VLBA pointing and
antenna temperature measurements.

\item[``{\sl pc}'' files:] These are setup files for VLBA pulse cal
tests.

\item[``{\sl nug}'' files:]  These are setup files for Mark II
observations.  The standard ``nug'' files are not being maintained any
more and may will not have the stations in them that are doing Mark
II.  They will need to be modified if anyone uses them.  If they are,
please send examples to {\bf cwalker@nrao.edu} so new standards can be
established.  Mark II is no longer available on most antennas,
including all that are operated by NRAO.

\end{description}



\subsection{\label{SSEC:SETEGS}Examples of Setup Files}

The standard setup files described above (Section~\ref{SSEC:SETSTD})
can be used as examples.  However a few of them are shown here
to show what they are like to someone who does not have easy access
to the machine readable files.

\newpage

  The first example is of a minimal setup file of a sort that might be
imbedded in a \schedb input file.  It includes the lines needed for
that imbedding.  This specifies a 4 channel, 8 MHz/channel, dual
polarization, 2 bit per sample mode (sometimes called 128-4-2 --- 128
is the total number of bits per second) for observations near 15 GHz.
It is invoked in the schedule by including ``{\tt setup=egvlba.2cm}''
among the inputs for a scan.  This is all many users will need.

\begin{verbatim}
setini = egvlba.2cm /
  band='2cm'  nchan=4  bbfilt=8.0  pol=DUAL  bits=2 /
endset /
\end{verbatim}

\newpage

This example is for a Mark~III mode B observation.  This shows a
number of items being specified that do not actually need to be
specified since the defaults are reasonable.  In particular, these
are the track assignments and the pulse cal extractor assignments.
The example just shows how one might specify all of these items
if desired.  Please start with the standard m3b6cm.set, rather than
this, for any real observations.

This example is definitely out of date in detail since the Mark III
tape recording system was abandoned long ago.  But is shows what can
be done in terms of a detailed setup.  Someday, it should be updated
to a currently used system.

%  ************  Make a better example.

\begin{verbatim}
 --------------------------------------------------------------------
 EXAMPLE:   Mark~III observations, Mode B (with extra inputs)
 --------------------------------------------------------------------
! m3b6cm.set
!  Tape length  Density  Tape speed  Time/pass
!     17600      High      80.0         44:00
!      8800      Low      135.0         13.02
nchan = 14  samprate = 4.0  bits = 1  bbfilter = 2.0  !   56 Mbps
tpmode = 2  format = MARKIII
bbc      = 1,  1,  2,  2,  3,  3,  4,  4,  5,  5,  6,  6,  7,  7
netside  = L,  U,  L,  U,  L,  U,  L,  U,  L,  U,  L,  U,  L,  U
ifchan  = L,L,L,L,L,L,L, L,L,L,L,L,L,L
freqoff = -16, -16, -12, -12, -8, -8, -4, -4, 0, 0, 4, 4, 8, 8
track1=4,18,6,20,8,22,10,24,12,26,14,28,16,30
track2=5,19,7,21,9,23,11,25,13,27,15,29,17,31
pcalxb1  =  S1,  S2,  S3,  S4,  S5,  S6,  S7,  S8,
            S9, S10, S11, S12, S13, S14,  S1,  S2
pcalxfr1 = 990,  10, 990,  10, 990,  10, 990,  10,
           990,  10, 990,  10, 990,  10,1990, 1010
!    Radio Astronomy allocation: 4990-5000
!    Radio Astnomomy footnote:   4950-4990
!    VLA 50MHz 4960.1 to 5010.1 with VC mode.
!        VLA 6cm receiver falling off at high end.
station  = VLBA
freqref  = 4990.99  !  Mark II network standard.
fe(1)    = '6cm'   fe(3) =  '6cm'
synth(2) = 4.1
firstlo  = 4100.00    rchan = A  lchan = C
   /
station  = VLA27
vlaband  = VC     vlabw = '0000'
firstlo  = 4360.10    rchan = A  lchan = C
   /
station  = VLA1
fe(2) = '6cm'  fe(4) = '6cm'
rchan    = B  lchan = D
   /
station  = GB_VLBA
fe(1)    = '6cm'   fe(3) =  '6cm'
firstlo  = 4260.0   rchan = A  lchan = C
   /
station  = EB_VLBA
firstlo  = 4100.0   rchan = A  lchan = C    /
\end{verbatim}

\newpage

This example shows a setup file for dual frequency, wide spanned
bandwidth, geodetic style observations.  Note that the firstlo
has to be specified separately for each channel because it varies.

\verbatiminput{../setups/vgeo-256-8-2.set}


\subsection{\label{SSEC:SETLST}Summary List of Setup File Parameters}

A list of the setup parameters is given below, followed by detailed
information on each setup paramater in Section~\ref{SSEC:SETDET}. All
of the parameters revert to the previous value if not specified for a
station. This allows most to be specified only once per setup file.
Some of the more difficult parameters, such as track assignments and
pulse cal configurations have defaults in \schedb that should
nearly always be used.  There needs to be a separate group for each
station, but after the first, the group may only contain the station
name.  The generic station ``{\tt VLBA}'' can be used for all VLBA
stations.  If it is desired to specify one VLBA station differently
from the the rest, that specific station (eg ``{\tt VLBA\_PT}'')
should be given before the generic ``{\tt VLBA}'' station.  All
parameters can have different values for different stations.

Note that the VLBA uses the concept of baseband channels.  Many of the
parameters take an array of arguments, one for each baseband
channel. The corresponding elements of the arrays specify the required
information for the baseband channel, such as the BBC from which the
signal will come, the VLBA IF that BBC is attched to, the bandwidth of
the BBC, and the frequency of the BBC. There is nothing to prevent
more than one baseband channel from being assigned to one
BBC/sideband. In such cases, care should be taken to insure that the
same frequency, bandwidth, and input VLBA IF are assigned for each
such baseband channel. If this is not done, the on-line system can get
confused about what signal is in each baseband channel.

\begin{list}{~}{\parsep 0em  \itemsep 0em }
\htls{AZCOLIM}{~} Collimation offset in azimuth.
\htls{BAND}{~~~~} Specify the frequencies generically.
\htls{BARREL}{~~} Control barrel roll mode.
\htls{BBFILTER}{} BBC bandwidth for each baseband channel.
\htls{BBC}{~~~~~} BBC assigned to each baseband channel.
\htls{BBSYN}{~~~} BBC frequency setting for each baseband channel.
\htls{BBSYN2}{~~} Second set of BBC frequencies for frequency switching.
\htls{BITS}{~~~~} Number of bits per sample.
\htls{DBE}{~~~~~} The personality to use in a digital backend.
\htls{DUALX}{~~~} Mode allowing more than 500~MHz at X band.
\htls{ELCOLIM}{~} Collimation offset in elevation.
\htls{FE}{~~~~~~} Receivers to be used.
\htls{FIRMFILE}{} A firmware file name to use - VLBA testers only!
\htls{FIRSTLO}{~} Sum of all LOs except the one set if {\tt FREQ} used.
\htls{FORMAT}{~~} Recording format to use --- ({\tt VLBA1:2} etc.
\htls{FREQOFF}{~} Value to add to {\tt FREQREF} for each
                        baseband channel to get LO sum.
\htls{FREQREF}{~} LO sum is {\tt FREQREF+FREQOFF}. Alternative
                        to {\tt BBSYN}.
\htls{FRSWITCH}{} Specifies frequency switching.
\htls{IFCHAN}{~~} IF channel to BBC for each baseband channel.
\htls{IFDIST}{~~} Attenuation of and input to IF Distributers.
\htls{LCHAN}{~~~} {\tt IFCHAN} to use if {\tt IFCHAN=L} (LCP).
\htls{LEVEL}{~~~} Attenuator setting for BBCs.
\htls{LOGGING}{~} Type of logging to be done.
\htls{LCP50CM}{~} Controls narrow band filter at 50 cm for LCP.
\htls{M4PATCH}{~} Controls which MarkIV patching to use.
\htls{MODETEST}{} Allow use of features still under development
\htls{NCHAN}{~~~} Number of baseband channels.
\htls{NETSIDE}{~} Net sideband of baseband channel.
\htls{NOISE}{~~~} Noise diode switching mode.
\htls{NOISEFRQ}{~~~} Noise diode switching frequency (VLA or VLBA).
\htls{PERIOD}{~~} Averaging time in the BBCs.
\htls{PCAL}{~~~~} Mode for pulse cal generator.
\htls{PCALFR1}{~} Pulse cal frequencies to be detected by detector ch1.
\htlt{PCALFR1}{PCALFR1}{~} Pulse cal frequencies to be detected by
                  detector ch2.
\htls{PCALXB1}{~} Bit and channel assignment of ch1 of a pcal detector.
\htlt{PCALXB2}{PCALXB1}{~} Bit and channel assignment of ch2 of a pcal
                  detector.
\htls{POL}{~~~~~} The polarization of each channel.
\htls{PTINCR}{~~} Step size for pointing patterns.
\htls{PTOFF}{~~~} Off source distance for pointing patterns.
\htlt{RCHAN}{LCHAN}{~~~} {\tt IFCHAN} to use if {\tt IFCHAN=R} (RCP).
\htlt{RCP50CM}{LCP50CM}{~} Controls narrow band filter at 50 cm for RCP.
\htls{SAMPRATE}{} Sample rate.
\htls{SIDEBAND}{} BBC sideband for each baseband channel.
\htls{STATION}{~} Station name.
\htls{STRING1}{~} 80 character string to pass to VLBA file.
\htlt{STRING2}{STRING1}{~} Another string. ~~~~~For any parameters
\htlt{STRING3}{STRING1}{~} Another string. ~~~~~not understood
\htlt{STRING4}{STRING1}{~} Another string. ~~~~~by \sched.
\htls{SWTCHDUR}{} Duration of the scans in a frequency switching loop.
\htls{SYNTH}{~~~} 2-16 GHz synthesizer settings.
\htls{TPMODE}{~~} Number of passes per index position.
\htls{TPSPEED}{~} Speed of the recorder in inches per second (obsolete).
\htls{TPSPEEDH}{~} Tape speed in inches per second at high density (obsolete).
\htls{TPSPEEDL}{~} Tape speed in inches per second at low density (obsolete).
\htls{TRACK1}{~~} Tape or Mark5A tracks for pass 1 at an index position.
\htlt{TRACK2}{TRACK1}{~~} Tape tracks for pass 2 (obsolete).
\htlt{TRACK3}{TRACK1}{~~} Tape tracks for pass 3 (obsolete).
\htlt{TRACK4}{TRACK1}{~~} Tape tracks for pass 4 (obsolete).
\htlt{TRACK5}{TRACK1}{~~} Tape tracks for pass 5 (obsolete).
\htlt{TRACK6}{TRACK1}{~~} Tape tracks for pass 6 (obsolete).
\htlt{TRACK7}{TRACK1}{~~} Tape tracks for pass 7 (obsolete).
\htlt{TRACK8}{TRACK1}{~~} Tape tracks for pass 8 (obsolete).
\end{list}




\subsection{\label{SSEC:SETDET}Details of Setup File Parameters}

\subsubsection{\label{SP:AZCOLIM}{\tt AZCOLIM}}

{\tt AZCOLIM} sets the azimuth collimation offset to add to the nominal
one used by the VLBA on-line computers for pointing. Usually this will
be {\tt 0.0}.  This allows the pointing for a VLBA antenna to be
adjusted.

\rcwbox
{A pointing offset in arc minutes.}
{Any real number.}
{{\tt 0.0}}
{Defaults to previous station.}
{{\tt AZCOLIM=1.2}}


\subsubsection{\label{SP:BAND}{\tt BAND}}

{\tt BAND} provides a simple way of requesting an observing frequency.
\schedb has an internal table of standard center frequencies that can
be called upon with {\tt BAND}.  If {\tt BAND} is specified, and
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} is not, \schedb will get the
observing center frequency from its internal table and will calculate,
based on the 
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}, 
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}} and 
{\hyperref[SP:POL]{{\tt POL}}} parameters,
the actual channel frequencies to use to center the observations at
the desired frequency.

The bands and centerfrequencies are in the table below.  When a
bandwidth is not zero, that center frequency is used if the
observation total bandwidth is the given amount.  This allows
the center to shift with increasing bandwidth, which is especially
useful at 21 cm where the radio astronomy band is near the edge
of the tuning range for the preferred IF at the VLBA.

\begin{verbatim}
----------------------------------------------
        SCHED STANDARD OBSERVING BANDS
----------------------------------------------
                   Center
      BAND        Frequency(1)   Bandwidth
     '90cm'         330.49          0.0
     '50cm'         610.98          0.0
     '21cm'        1465.49        128.0
     '21cm'        1435.49         64.0
     '21cm'        1416.49          0.0
     '18cm'        1658.49          0.0  (2)
     '18cm'        1653.99          0.0  (3)
     '13cm'        2295.49          0.0
      '6cm'        4990.49          0.0
      '4cm'        8415.49          0.0
      '2cm'       15285.49          0.0
      '1cm'       22235.49          0.0
     '24ghz'      23800.49          0.0
      '7mm'       43135.49          0.0
       'sx'   2295.49 and 8415.49   0.0
----------------------------------------------
1. Note, these are subject to change as the choices
are discussed with the community.
2. Most 18 cm observing.
3. For 32 MHz wide observations involving Jodrell, but not the
phased VLA.  Avoids RFI at Jodrell.  But must be higher to fit
in the VLA IF's.
\end{verbatim}

Specifying the {\tt BAND} works well when most setup file parameters
are defaulted.  But if the user insists on specifying many of the
other parameters, such as {\tt IFCHAN, BBC etc}, in non-standard
ways, the program may not do the right thing.  It is likely that
this will generate an error when the setups are checked.

\rcwbox
{A string of up to 5 characters.}
{One of the options listed above.}
{Blank, which means the frequencies must be specified elsewhere}
{Defaults to previous station.}
{{\tt BAND='2cm'}}

\subsubsection{\label{SP:BARREL}{\tt BARREL}}

Barrel roll is not used on the disk based system so can be
ignored in essentially all cases.

{\tt BARREL} sets the mode of the barrel roll.  The barrel roll is
designed to protect data against bad recording tracks.  Within each
head group of 8 tracks, or in some modes, within a pair of head
groups, the data for each ``track'' is actually recorded first
on it's assigned track, then the next frame (20,000 data bits)
is recorded on the next track, and the next frame on the next track
and so forth.  After 8 or 16 frames, depending on mode, the track
is back on it's original assigned head.  With this happening, if
a recorder track is bad, some of all channels in the roll group
are lost, but no channel is lost completely.  Thus there is just
a drop in sensitivity rather than a distortion of the information
being measured.  Very nearly all users should take the default
of {\tt roll\_auto}.  The options for {\tt BARREL} are:

Barrel roll should be ok for PCFS systems (VEX files).  In Dec
2000 the definition of barrel rolling has been updated to reflect the
discovery that the current (VLBA) practice is time reversed with
respect to the documentation.

Barrel roll is turned off for disk systems.

\begin{description}
\item[{\tt roll\_off}] turns off the barrel roll.
\item[{\tt roll\_8}] rolls within one group of 8 heads.
\item[{\tt roll\_16}] rolls within two groups of 8 heads each.
\item[{\tt roll\_auto}] tells the on-line system to pick the best
                      roll it can do.
\end{description}
One case where the user may need to set the roll is when the data
will be correlated with 2048 point FFT's (1024 point output spectra).
This cannot be done with a 16 track roll and so one of the lesser
rolls should be forced.

\rcwbox
{A string of up to 9 characters.}
{One of the 4 options listed above.}
{{\tt roll\_auto}}
{Defaults to previous station.}
{{\tt BARREL=roll\_8}}

\subsubsection{\label{SP:BBFILTER}{\tt BBFILTER}}

{\tt BBFILTER} sets the baseband channel bandwidth.  There is one
value for each baseband channel.  Any that are not specified will be
set equal to the first so in the usual case that all channels have the
same bandwidth, only one needs to be set.

For the RDBE systems with the PFB personality ({\tt DBE = RDBE\_PFB}),
the bandwidth must be 32 MHz.  There are no options.  For the DDC
personality ({\tt DBE = RDBE\_DDC}), the baseband channel bandwidth
can be anywhere between 1 and 128 MHz in factor of 2 steps.  For the
DBBC, the options are the factors of 2 between 1 and 16 MHz, with
additional options at 32 and 512 MHz to be enabled in the future.

For the original VLBA system and for MarkIV, the value must be a
multiple of 2 times 0.0625~MHz up to a maximum of 16~MHz. Up to 16
values can be accepted. If two or more baseband channels are assigned
to the same BBC/sideband, they should have the same {\tt BBFILTER}
assigned. If not the last will probably be used.

If not specified, one half of the 
{\hyperref[SP:SAMPRATE]{{\tt SAMPRATE}}}
will be used for all channels, if {\tt SAMPRATE} was specified.

For MkIV DARs in the EVN the 1 MHz, 250 kHz and 62.5 kHz filters
are only available as plug-ins and should be avoided if possible.
Although the 500kHz and 125kHz filters are standard they are generally
only available on the USB of the first few BBCs. Most stations have 4,
and are required to obtain up to 6.

\rcwbox
{Up to one real number for each channel giving bandwidths in MHz.}
{{\tt 0.0625}, {\tt 0.125}, {\tt 0.250}, {\tt 0.5}, {\tt 1.0}, {\tt
2}, {\tt 4}, {\tt 8}, {\tt 16}, {\tt 32}, {\tt 64}, {\tt 512},
depending on system.}
{{\tt 0} - If one is specified, it will be used for all channels.
If none are specified, half the sample rate will be used.}
{Defaults to revious station.}
{{\tt BBFILTER = 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2} \\ which
is same as {\tt BBFILTER = 2}}

\subsubsection{\label{SP:BBC}{\tt BBC}}

{\tt BBC} is used to specify the Base Band Converter (BBC) to
which each baseband channel is assigned.  A value can be given
for every channel.  If any or all values are missing, SCHED will
try to set to reasonable default values for the digital backends
and VLBA and MKIV format observations.  This is the option most
users should take.

Note that BBC assignments are arbitrary for the RDBE and the old VLBA
systems since all BBCs can see all input IFs.  However, for Mark~III and
Mark~IV systems and the current version of the DBBC, there are strong
constraints.  For Mark~III/IV ``astronomical patching'', which is the
only one currently properly understood, the odd BBCs must be connected
to IF1 (IFCHAN 1N or 1A where 1N is normally LCP and 1A is normally
RCP).  Even BBCs must be connected to IF2 (IFCHAN 2N or 2A, where 2N is
normally RCP and 2A is normally LCP). Mark III/IV ``geodetic patching''
is more complicated and partially understood by \sched. Essentially IF1
is connected to BBCs 1 to 8, and IF2 is connected to BBCs 9-14, though
in some systems there is an IF3 available on BBCs 3 and 4 (this is
actually an additional mixer on IF1 allowing access to a wider range of
frequencies). The current version of the DBBC also has constraints on
patching of BBCs to IF as described in the 
{\hyperref[SSEC:DBBC]{{\tt DBBCVER}}} section of the manual.

\rcwbox
{Up to one integer per baseband channel.}
{Integers between {\tt 1} and {\tt 8} make sense on the VLBA.  Higher
numbers make sense on some systems.}
{{\tt 0}}
{Defaults to previous station.}
{{\tt BBC=1,1,2,2,3,3,4,4,5,5,6,6,7,7}}


\subsubsection{\label{SP:BBSYN}{\tt BBSYN}}

{\tt BBSYN} is used to set the frequency for the BBC or digital filter
assigned to each baseband channel (subband channel in EVLA
terminology). This number will be overridden if 
{\hyperref[MP:FREQ]{{\tt FREQ}}} or 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}} is specified in the
\schedb keyin file. Even if {\tt DOPPLER} is specified, this value
serves as the default for continuum sources for which no velocity or
{\tt DOPSRC} is specified. All baseband channels assigned to the same
physical BBC should be assigned the same frequency.  This only applies
to hardware for which the BBCs can provide upper and lower sidebands.
For the digital backends where the ``BBC'' is just part of the FPGA
firmware, there will only be one baseband channel per BBC.  When a BBC
can provide more than one channel and different frequencies are given
for such paired channels, the last specified frequency will probably
be used and the monitor system will get confused about what signals
are present. Actually, first \schedb will complain.  Please see
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} for a discussion of required
parameters.

For MkIV all BBCs at a given station should fall in the range 100 -
220 (the ``Low patch'') or 220 - 500 the ``High patch'').

For the VLBA legacy DAR and MkIV systems, the baseband frequency must
be set on even 10 kHz frequencies.

The future is with the digital backends - the RDBE for the VLBA and
related systems and the DBBC system from Noto being deployed in Europe
and elsewhere.  There are also systems in other parts of the world but
more information is needed before those can be described.

With the RDBE DDC personality, there are some IF frequencies to avoid.
After sampling at 1024 GHz (the usable IF frequencies are between 512
and 1024 MHz), the firmware does a polyphase filter to narrow the
bandwidth to match what the FPGA clock rate can handle (256 MHz in
this case.  A complex filter is used which allows output bandpasses of
256 MHz width.  But the edge bands are centered at the sample rate and
at half that so only half of each of those bands can be used.  Thus
the accessible IF is divided into 3 bands: 512-640 MHz, 640-896 MHz,
and 896-1024 MHz.  Baseband channels can be placed anywhere in any one
of those 3 filter bands, but one should not attempt to cross the
boundary between two.  That won't work and \schedb will issue a warning.

The DDC personality can provide 4 basebands per RDBE and there are two
RDBE units at each station.  Those basebands can have bandwidths of
the factors of 2 between 1 and 128.0 MHz.  Spectral zoom mode in the
DiFX correlator can be used to obtain narrower bandwidths.  The total
output bit rate has a maximum of 2048 Mbps.  The values of {\tt BBSYN}
can be set to any frequencies that are 1024 MHz (the sample rate)
divided by powers of 2.  The finest setting is 0.0596046 Hz.  But any
frequency that does not have an integer number of cycles in one second
can cause big problems with carrying phase over various events like
frequency switches.  So the settings must be limited to multiples of
15.625 kHz --- the smallest setting that has an integer number of
cycles in a second.  This can be looked at as N*125 kHz + 0, 15.625,
31.250, 46.875, 62.500, 78.125, 93.750, or 109.375 kHz.  \schedb will
not accept settings that are not multiples of 15.625 kHz.  Projects
working with stations with other systems constrained to multiples of
10 kHz should use frequencies that are multiples of 250 kHz.  \schedb
will warn of attempts to use finer settings.  Note that any crd files
to control the old system while the DDC is in use will have BBC
frequencies rounded to the nearest 10 kHz because of hardware
limitations in the legacy BBCs.  That should be ok as data from the
BBCs are most likely not going to be recorded.

The PFB personality of the RDBE, ({\tt DBE = RDBE\_PFB}) has rather
rigid baseband frequency options.  A polyphase filter divides the
512-1024 band into 17 baseband channels, 15 of which have 32 MHz
bandwidth.  The other 2 are half bands on the ends (actually full
bands, but centered on the sample rate and half that).  Those edge
channels do not provide useful data, but often one is used when
recording single polarization to reach the required 16 basebands.
Each RDBE has 2 IF inputs and puts out 2048 Mbps (512 MHz total
bandwidth with 2 bit samples and Nyquist sampling) in 16 total
baseband channels.  There is not yet any ability to vary the bit rate.
The 16 channel can be chosen arbitrarly from all those produced from
both IFs.

The allowed {\tt BBSYN} frequencies for the PFB personality are 1040.0
1008.0, 976.0, 944.0, 912.0, 880.0, 848.0, 816.0, 784.0, 752.0, 720.0,
688.0, 656.0, 624.0, 592.0, and 560.0 and the bands must be lower
sideband.  The frequencies listed are at the top of the 32 MHz
channel.  The first is the one that will produce a corrupted baseband.

The DBBC system is more of a plug replacement for the MarkIV. The DBBC
has a range of possible IF frequencies, but currently only 2 are
supported (10-512 MHz and 512-1024 MHz). Up to 16 {\tt BBSYN} frequencies
can lie anywhere in the selected IF at a multiple of 10 kHz.

\rcwbox
{Up to 16 frequencies in MHz.}
{Any multiple of 0.01~MHz from 500.0 to 999.99~MHz.}
{{\tt 0} - should be specified.}
{Defaults to previous station.}
{{\tt BBSYN=720.99,720.99,724.99,724.99}}


\subsubsection{\label{SP:BBSYN2}{\tt BBSYN2}}

If frequency switching is specified, {\tt BBSYN2} is the
set of frequencies for the second scan of the switching loop.
Frequency setting using {\tt FREQREF} and any pcal defaults are not
used for the second frequency set. {\tt BBSYN2} must be specified for
this frequency set.

Frequency switching is not allowed when writing VEX files.  Also, it
is a little known and probably nearly unused option so it is not
well tested and may well go away some day.

\rcwbox
{Up to 16 frequencies in MHz.}
{Any multiple of 0.01~MHz from 500.0 to 999.99~MHz.}
{{\tt 0} - should be specified if frequency switching is requested
but not needed otherwise.}
{Defaults to previous station.}
{{\tt BBSYN2=728.99,728.99,732.99,732.99}}


\subsubsection{\label{SP:BITS}{\tt BITS}}

{\tt BITS} sets the number of bits per sample for each baseband channel.
If any channel is not specified, it will be set to the first.  Since
an experiment will typically use the same number of bits per sample
for all channels, it is usually only necessary to specify one value.

If {\tt BITS} is {\tt 2}, the first magnitude bit is placed on assigned
track plus 8 for {\tt FORMAT~= VLBA1:4}, on assigned track plus 4 for
{\tt FORMAT~= VLBA1:2}, and on assigned track plus 2 for {\tt
FORMAT~= VLBA1:1}.

\rcwbox
{An array of integers, one for each baseband channel.}
{{\tt 1} or {\tt 2}}
{{\tt 1} for all baseband channels if none are set. Same as baseband
channel 1 if one or more are set.}
{Defaults to previous station.}
{{\tt BITS=1}}

\subsubsection{\label{SP:DBE}{\tt DBE}}

{\tt DBE} is used to specify the personality to use in a digital
backend that is based on an FPGA.  Such personalities can be changed
quickly, so this parameter is not appropriate for the station catalog.
However personality changes have not been integrated with the observing
system yet so they will not be allowed within one key file.  Use 
multiple key files if you must switch, and don't do it often.
The personality determines much about the capabilities of the hardware.
In particular, it determines what baseband frequencies can be set.

The possible options are:

\begin{description}

\item {\tt RDBE\_PFB} is the original polyphase filter personality
developed by Haystack for the RDBE digital backend ({\tt DAR=RDBE} in
the station catalog).  It is restricted to 16 baseband channels of 32
MHz bandwidth each, lower sideband, with frequencies of 1024-16-N*32
MHz, where N is an integer between 0 and 15.  The initial version is
restricted to N even and there are no choices.  In that version,
channels come in pairs, one on each input IF, which are usually
polarization pairs.  Switching is being added to allow general
selection.

\item {\tt RDBE\_DDC} is the digital downconverter personality being
developed for the RDBE digital backend at NRAO.  It has a high degree
of flexibility of tuning frequency and bandwidth.  The restrictions
will be given here once they are known in detail.  For this personality,
the input IF (512-1024 MHz) is split into three signals by a complex
polyphase filter into three bands (512-640, 640-896, and 896-1024 MHz).
Note that the central one is 256 MHz wide while the other two are 128
MHz wide.  The few MHz around the transition between these bands should
be avoided as signal will be degraded, and any one baseband can only
access one side of such a ``crossover'' frequency.  \schedb will warn
of attempts use degraded frequencies (eventually).  The RDBE\_DDC can
provide 4 baseband channels from each of the two input IFs.  Those
baseband channels can be as wide as 128 MHz so the full input bandwidth
can be covered.  See 
{\hyperref[SEC:WIDE]{the wideband observing section}}
for more information about tuning restrictions and about the use of
dual RDBEs.

\item {\tt DBBC\_PFB} This is for the DBBC digital backend being built in
Noto for the EVN.  It is meant to have the flexibility of the old
MarkIV and VLBA backends.  Like the RDBE, it has PFB and DDC options.  
The PFB option is much like the RDBE equivalent and the two will be treated
the same in SCHED until that proves to be incorrect.

\item {\tt DBBC\_DDC} This is the digital down converter option for
the DBBC.  Unlike the RDBE equivalent, it does not have crossover issues
as the frequency conversion is done on the full bandwidth data stream.
Each channel, or upper and lower sideband pair of channels, is derived
in a separate converter.  Basically it tries to duplicate the function
of the legacy BBC/VC in a digital package with sampling before the
filter.  There are complicated restrictions on the IFs that can be
assigned to each BBC as described in 
{\hyperref[SSEC:DBBC]{{\tt DBBC}}}.
These restrictions should be alleviated with future firmware upgrades.


\end{description}

{\tt DBE} should not be specified for {\tt DAR}'s other than the RDBE
and DBBC.  Note that it may be necessary to explicitly set {\tt DAR}
to {\tt ' '} (blank) if there are multiple segments to the setup file
and an earlier one has it set to something else.

When the DAR is the RDBE, the output channels and all the input channel
information given to \schedb are written to the VEX file.  But the crd
files that control the old VLBA hardware also has to be told something.
\schedb does not have a separate set of variables for all those configuration
parameters, so it just does something reasonable.  It sets the number of
channels to the maximum of the number requested and 8.  It sets the
frequencies and sidebands to match the RDBE requests.  It sets the
sample rate to the maximum of that requested and 32 Ms/s.  It sets the
channel bandwidth to the lesser of the request and 16 MHz.  It only
writes the first 4 pcal extraction requests (avoiding going into
channel numbers that are too high).

\rcwbox
{A character string of up to 8 characters}
{One of ' ', '{\tt RDBE\_PFB}', '{\tt RDBE\_DDC}', '{\tt DBBC\_PFB}' or
'{\tt DBBC\_DDC}'. It is not case sensitive}
{'{\tt RDBE\_PFB}' for a station with the RDBE DAR, '{\tt DBBC\_PFB}' 
for a station with the DBBC DAR, and blank for anything else.}
{Defaults to previous segment.  See note above about setting blank}
{{\tt DBE='RDBE\_DDC'}}


\subsubsection{\label{SP:DUALX}{\tt DUALX}}

{\tt DUALX} is a switch to turn on the mode where the B and D IFs
are both assigned to RCP at 4 cm, but with separate first LOs. IF B
uses {\tt SYNTH} 1 while IF D uses {\tt SYNTH} 3. This allows more
than 500~MHz to be spanned instantaneously in this band and is used
for geodetic and astrometric observations.

\rcwbox
{None.}
{Do or do not specify.}
{B is RCP, D is LCP and both use {\tt SYNTH} 1.}
{Defaults to previous station.}
{{\tt DUALX}}


\subsubsection{\label{SP:ELCOLIM}{\tt ELCOLIM}}

{\tt ELCOLIM} specifies the elevation collimation offset to be added to
the one used by the VLBA on-line computers.  It can be used to adjust
the VLBA pointing.

\rcwbox
{A pointing offset in arc minutes.}
{Any real number.}
{{\tt 0.0}}
{Defaults to previous station.}
{{\tt ELCOLIM=1.2}}



\subsubsection{\label{SP:FE}{\tt FE}}

{\tt FE} gives four front end specifications for VLBA antennas, one
for each IF (A, B, C, and D). Note that the 2cm front end on the VLBA
has 4 filters; the on-line system chooses which to use based on the
frequency of baseband channel 1, with the dividing points for the
filter choice are 12.9, 13.9, and 14.9~GHz.  {\tt FE = omit} may
be specified to cause a channel not to be used.

{\tt FE} can also be used for other stations, especially the VLA and
any station that uses a VLBA backend.  The 4 receiver names correspond
to the first 4 IFs.  \schedb can provide appropriate defaults for the
VLA based on the frequency requests.

The front ends for the VLA and VLBA are listed here.  The maximum
ranges are given for the VLBA, which may be considerably greater than
the good ranges, especially at 13cm.

\begin{verbatim}
Name (FE)      VLBA Range  VLBA IFs  VLA Range   
VLBA   VLA         GHz                 GHz
4 m     4          ---        --   0.058-0.084  
90cm    P      0.302-0.352    BD    0.23-0.472   
50cm    -      0.588-0.633    BD       ---
20cm    L       1.18-1.85     AC     1.0-2.03     
13cm    S       1.92-2.84     AC     2.0-4.0    
6cm     C        3.9-7.9     ACBD    4.0-8.0      
4cm     X        7.7-9.05     BD     8.0-12.0 (also called 3cm)
2cm     Ku      11.8-15.6     BD    12.0-18.0    
1cm     K       20.5-25.3     --    18.0-26.5 (also called 1.3cm)
 -      Ka         ---        BD    26.5-40.0    
7mm     Q       37.6-46.2     AC    40.0-50.0    
3mm     -       79.7-96.0     BD       ---
13cm and 4cm can be observed together on the VLBA using all 4 IFs.
\end{verbatim}

\rcwbox
{A character string containing one of the options.}
{Band name for IF A, B, C, D in FE elements 1, 2, 3, 4.  {\tt omit}
for an unused IF (that's the default for unused IFs.).}
{{\tt 0} - should be specified for the used IFs.}
{Defaults to previous station if none are specified.  If any are
specified, only the new values are used.}
{{\tt FE(1)='20cm' FE(3)='20cm'}}



\subsubsection{\label{SP:FIRMFILE}{\tt FIRMFILE}}

If you are not involved in VLBA testing, you don't want to know about
this parameter!

{\tt FIRMFILE} is a way to specify the file name of the version of the 
digital backend firmware that will be used for an observation.  It
was requested after excessive confusion was encountered during 
intensive testing.  It will cause a comment with the file name to 
be inserted in the {\sl VEX} file {\tt \$TRACKS} section.

\rcwbox
{A character string of up to 80 characters meant to be a file name.}
{If you have to ask, don't try to use this parameter}
{Blank}
{Kept for each setup group specified for the setup file.}
{{\tt firmfile = 'DDCxy7872203'}}


\subsubsection{\label{SP:FIRSTLO}{\tt FIRSTLO}}

{\tt FIRSTLO} gives the LO sum for each baseband channel for all mixes
other then the one that will be set if {\tt FREQ} or {\tt DOPPLER} is
specified.  For most stations, this is for use by \schedb only; it
is not written to the output file.  However for stations that use VLBA
control files, but are not proper VLBA stations, it will be written in
a parameter that passes the information to the logging and correlator
systems so that they can figure out the observing frequency.  Please
see 
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} for a discussion of required
parameters.  If a value is not specified for a channel, it will be
set to the first.  Since most observations use the same firstlo
for all channels, it is usually only necessary to specify one.

For the VLBA: For frequencies below 16~GHz this is just the front end
synthesizer as specified by {\tt SYNTH}.  For 1 cm, it is the sum of
synthesizers 2 and 3.  For 7 mm, it is the sum of synthesizer 1 and 3
times synthesizer 3.  For 4 mm, it is the sum of synthesizer 1 and 6
times synthesizer 3.  At 90cm the value should be -500.0~MHz to make
any frequency calculations come out right; that mix is an up-convert.

If {\tt FIRSTLO} is not specified, \schedb will try to determine it
from the 
{\hyperref[SEC:FRQCAT]{frequency catalog}}.  This should be
the usual case.

\rcwbox
{An array of frequecies in MHz.}
{Any valid LO sum.}
{Will set based on the frequency catalog.  If channel 1 is set and
others are not, the others will be set equal to channel 1.}
{Defaults to previous station.}
{{\tt FIRSTLO = 2400, 2400}}


\subsubsection{\label{SP:FORMAT}{\tt FORMAT}}

{\tt FORMAT} is used to specify the recording format. Note that it is couched
in terms of tracks despite the switch to disks because the concept is still
used in Mark5A and in Mark5A+ playback of Mark5B.  Options are:
\begin{verse}

\noindent ~~~~ {\tt ~~~~~~~} - Set according to DAR/DBE type for first 
stage default.\\
\noindent ~~~~ {\tt VDIF~~~} - When DBE=RDBE\_DDC  \\
\noindent ~~~~ {\tt MARK5B~} - When DBE=RDBE\_PFB or using DBBC  \\
\noindent VLBA formats - VLBA legacy type systems:  \\
\noindent ~~~~ {\tt VLBA~~~} - Let \schedb choose the fan out. \\
\noindent ~~~~ {\tt VLBA1:1} - 1 bitstream on 1 tape track. VLBA format.  \\
\noindent ~~~~ {\tt VLBA1:2} - 1 bitstream on 2 tape tracks (fan out).    \\
\noindent ~~~~ {\tt VLBA1:4} - 1 bitstream on 4 tape tracks (fan out).    \\
\noindent ~~~~ {\tt VLBA2:1} - 2 bitstreams on 1 tape track (fan in).     \\
\noindent ~~~~ {\tt VLBA4:1} - 4 bitstreams on 1 tape track (fan in).     \\
\noindent MKIV formats -Mark IV (and VLBA4) systems:  \\
\noindent ~~~~ {\tt MKIV~~~} - Let \schedb choose the fan out. \\
\noindent ~~~~ {\tt MKIV1:1} - 1 bitstream on 1 tape track. Mark IV format.  \\
\noindent ~~~~ {\tt MKIV1:2} - 1 bitstream on 2 tape tracks (fan out).    \\
\noindent ~~~~ {\tt MKIV1:4} - 1 bitstream on 4 tape tracks (fan out).    \\
\noindent ~~~~ {\tt MKIV2:1} - 2 bitstreams on 1 tape track (fan in).     \\
\noindent ~~~~ {\tt MKIV4:1} - 4 bitstreams on 1 tape track (fan in).     \\
\noindent MARKIII format - Mark~III and VLBA systems. \\
\noindent ~~~~ {\tt MARKIII} - Mark~III tape format. No fan in or out.    \\
\noindent S2 - Canadian S2 record systems. \\
\noindent ~~~~ {\tt S2} - All S2 recordings. \\
\noindent Others:  \\
\noindent ~~~~ {\tt MARKII}  - No action. Use for Mark~II and single dish.\\
\noindent ~~~~ {\tt NONE}    - No tape to be used, as for pointing.       \\
\end{verse}

Note on track assignments: Track assignments are an easy thing to get
wrong. \schedb will make track assignments automatically for some
modes if they are not specified in the setup file.  Most users should
take advantage of this facility. Automatic track assignments will be
made for {\tt MARKIII} modes with 1 bit only, and for {\tt VLBA1:1},
{\tt VLBA1:2}, and {\tt VLBA1:4} modes with 1 or 2 bits. The barrel
roll is on by default (can be controlled with 
{\hyperref[SP:BARREL]{{\tt BARREL}}})
in {\tt VLBA} modes and off in {\tt MARKIII} mode. The
roll is within 8 or 16 track groups, advancing one track for each
frame.

The fan in modes, {\tt VLBA2:1} and {\tt VLBA4:1} were never implemented,
so this paragraph is only retained for historical reasons.
If using a fain in mode, give the same track
assignment to 2 or 4 channels.  In the fan in modes, if there are 2
bits per sample, the two bits will be put on the same track so there
will be one channel per track for {\tt VLBA2:1} mode and two channels
per track for {\tt VLBA4:1} mode.

For the fan out modes, {\tt VLBA1:2}, {\tt VLBA1:4}, {\tt MKIV1:2}, and
{\tt MKIV1:4}, give the first track assignment for the baseband
channel. Sequential formatter track assignments are used for the other
tracks associated with that baseband channel. The resulting recorder
track assignments are then given below:
\begin{verse}
{\tt VLBA1:2}, {\tt MKIV1:2}: \\
forward, track for 1st bit - {\tt 3 7 11 15 19 23 27 31} \\
forward, track for 2nd bit - {\tt 5 9 13 17 21 25 29 33} \\
reverse, track for 1st bit - {\tt 2 6 10 14 18 22 26 30} \\
reverse, track for 2nd bit - {\tt 4 8 12 16 20 24 28 32} \\
{\tt VLBA1:4}, {\tt MKIV1:4}: \\
forward, track for 1st bit - {\tt 3 11 19 27} \\
forward, track for 2nd bit - {\tt 5 13 21 29} \\
forward, track for 3rd bit - {\tt 7 15 23 31} \\
forward, track for 4th bit - {\tt 9 17 25 33} \\
reverse, track for 1st bit - {\tt 2 10 18 26} \\
reverse, track for 2nd bit - {\tt 4 12 20 28} \\
reverse, track for 3rd bit - {\tt 6 14 22 30} \\
reverse, track for 4th bit - {\tt 8 16 24 32} \\
\end{verse}

Note that MkIII modes are obsolete.

Format NONE is used for VLBA testing, such as single dish pointing.
When specified for VLBA data, the on-line system does not touch the
formatter.  This includes not readjusting the pcal detection.
Format NONE will mainly be used by VLBA staff for testing and in
high frequency projects that do reference pointing.  If the reference
pointing scan uses this format, no formatter reconfigures are done
which can prevent the significant data loss that can happen at
reconfigures.

Note that it is not necessary to specify {\tt FORMAT}.  {\tt FORMAT}
will be set equal to {\tt DAR} in the 
{\hyperref[SEC:STACAT]{station catalog.}}.
Stations with {\tt DAR = VLBA4} will write Mark~IV
format on the tape.  When the default format is taken, the barrel roll
is turned off for formats other than VLBA.

\rcwbox
{Text string of up to 8 characters.}
{See above text. Anything else will cause \schedb to abort.}
{DAR from station catalog.}
{Defaults to previous station.}
{{\tt FORMAT=MARKIII}}


\subsubsection{\label{SP:FREQOFF}{\tt FREQOFF}}

{\tt FREQOFF} gives the increment to the LO sum for the baseband
channel in MHz. This will only be used if {\tt FREQREF} is used. The
LO sum for baseband channel {\tt i} will be set to {\tt FREQREF(i)}
plus {\tt FREQOFF(i)}, and {\tt BBSYN} will be set to the absolute
value of the difference between the LO sum and {\tt FIRSTLO}. Please
see 
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} for a discussion of required
parameters.

\rcwbox
{Up to 16 frequencies in MHz.}
{Any valid frequency offset that gives a {\tt BBSYN} in the allowed
range.}
{{\tt 0.0} - no offset.}
{Defaults to previous station.}
{{\tt FREQOFF=-6.,-4.,-2.,0.,2.,4.,6.}}


\subsubsection{\label{SP:FREQREF}{\tt FREQREF}}

{\tt FREQREF} is the LO sum to use for the baseband channel in MHz.
{\tt FREQOFF} will be added to it. The LO sum is the sum of the {\tt
FIRSTLO} plus or minus, depending on sideband, the BBC synthesizer
setting {\tt BBSYN}. A {\tt FREQ} specification in the \schedb
keyin file will override {\tt FREQREF} plus {\tt FREQOFF}, as long as
the BBC settings stay within range and there are no sideband changes.

To set pulse cals properly and to deal with non-VLBA stations
correctly, it is best to know all of the LO sum, the first LO, and the
BBC settings, along with all of the required sidebands. Strictly
speaking, valid VLBA schedules can be written without knowing all
these, but \schedb can be made significantly simpler and more
reliable if all this information is required. Not all of these values
need to be specified since they are related. There are four possible
complete combinations, and if more values are specified than necessary
then a consistency check will be done. These complete combinations
are:
\begin{verse}
1. {\tt FREQREF} plus {\tt FREQOFF}, {\tt FIRSTLO}, {\tt NETSIDE}  \\
2. {\tt FREQREF} plus {\tt FREQOFF}, {\tt FIRSTLO}, {\tt SIDEBAND} \\
3. {\tt BBSYN}, {\tt SIDEBAND}, {\tt NETSIDE},
   {\tt FREQREF} plus {\tt FREQOFF} \\
4. {\tt BBSYN}, {\tt SIDEBAND}, {\tt NETSIDE}, {\tt FIRSTLO} \\
\end{verse}

\rcwbox
{Up to 16 frequencies in MHz.}
{Any valid frequency.}
{{\tt 0.0} for {\tt FREQREF(1)} which means don't use it. For baseband
channels 2 and higher, will be set to {\tt FREQREF(1)}.}
{Defaults to previous station.}
{{\tt FREQREF = 1662.49}}


\subsubsection{\label{SP:FRSWITCH}{\tt FRSWITCH}}

{\tt FRSWITCH} is a switch that turns on frequency switching. If
specified, a second group of synthesizer settings should be given in
{\tt BBSYN2}. This is used for VLBA files only.  In fact, the program
will die if frequency switching is attempted when a VEX output
file is required.

In general, frequency switching is probably better handled with a
scan loop.  The {\tt FRSWSITCH} option is not used often, if ever, and
should only be used with care.

\rcwbox
{None.}
{Do or don't specify it.}
{Not set.}
{Defaults to previous station.}
{{\tt FRSWITCH}}


\subsubsection{\label{SP:IFCHAN}{\tt IFCHAN}}

{\tt IFCHAN} is used to specify the IF channel attached to each
baseband channel for VLBA observations using VLBA data aquisition
systems.  For the VLBA, it should be {\tt A} or {\tt C} for 20, 13, or
6cm.  For 90, 50, 4, 3, 2, or 1.3cm, it should be {\tt B} or {\tt D}.
{\tt A} and {\tt B} are RCP; {\tt C} and {\tt D} are LCP. If {\tt
DUALX} is specified, both {\tt B} and {\tt D} are RCP. The new 4-8 GHz
system (still called 6cm) can put out signals on all 4 IFs in 2
polarization pairs.  The BBCs of the legacy backend can access any
of the 4 IFs.  An RDBE can only access 2 (any 2), so the 2 RDBE
option is needed to access all 4.  

As an alternative to explicit specification of the IF, {\tt R} or {\tt
L} can be specified. Then if {\tt RCHAN} and {\tt LCHAN} are specified
in the setup files, {\tt IFCHAN='R'} will be replaced with {\tt RCHAN}
and {\tt IFCHAN='L'} will be replaced with {\tt LCHAN}.  If a bad {\tt
RCHAN} or {\tt LCHAN} value is specified, \schedb will then complain
about a bad {\tt IFCHAN} specification.

1N, 1A, 2N, 2A are allowed values for MkIV telescopes.
See 
{\hyperref[SP:BBC]{{\tt BBC}}} and the 
{\hyperref[SEC:FRQCAT]{frequency catalog}}
parameter {\tt IFNAME} for more details.

A[1-4], B[1-4], C[1-4] and D[1-4] are all possible values for
the DBBC. The letter gives the conditioning module (A-D) to use, and the
number gives the input (1-4) on that conditioning module to select. See
the 
{\hyperref[SSEC:DBBC]{{\tt DBBC}}} section of the manual for more
details.

The ``geodetic'' wired VLBA systems (all not controlled by VLBA
software) have restrictions on their IF assignments because the IF
distributors only provide enough signals from each IF to feed 8 BBCs
while these systems typically have 14 BBCs.  The systems are wired so
that BBCs 1 and 2 can see all 4 IFs, BBCs 3-8 can see A and C, and
BBCs 9-14 can see B and D.  In addition, the racks can be switched so
that they provide one bit samples from all 14 BBCs or 2 bit samples
from the first 8.  SCHED understands all this and should give the
right default assignments.  This is one of many reasons why, as noted
below, it is best to let SCHED set many parameters including {\tt
IFCHAN}.

It should now be normal not to specify IFCHAN.  \schedb will use the
requested 
{\hyperref[SP:POL]{{\tt POL}}} and the 
{\hyperref[SEC:FRQCAT]{frequency catalog}}
to determine the correct {\tt IFCHAN}.  If {\tt
IFCHAN} is specified as ``{\tt R}'' or ``{\tt L}'', and {\tt RCHAN},
{\tt LCHAN}, and {\tt POL} are not specified, \schedb will get the
obvious polarization channels, although use of {\tt POL} is
recommended.

As of early 2013, the VLA can provide 4 output basebands to the recording
system.  Each is expected to come from a different IF so they should
be assigned to A, and C for RCP and B and D for LCP.  Eventually there
will probably be an increase in the number and more than one channel
will use the same IF.

\rcwbox
{An array of up to 16 characters of length 2.}
{{\tt A}, {\tt B}, {\tt C}, {\tt D}, {\tt R}, {\tt L},
{\tt '1N'}, {\tt '1A'}, {\tt '2N'}, or {\tt '2A'} (quotes required
on those that start with a number).}
{Will determine from the frequency catalog.}
{Defaults to previous station.}
{{\tt IFCHAN=A,C,A,C,A,C,A,C,A,C,A,C}}


\subsubsection{\label{SP:IFDIST}{\tt IFDIST}}

{\tt IFDIST} specifies the attenuation to apply in the IF distributers.
There is one value for each of the four IFs. This is only used to
attenuate the signals from solar observations or to select alternate
inputs, for example, for mm observations at VLBA sites with links to
other antennas.

This currently (Oct. 2001) is not implemented for VEX files.

\rcwbox
{A character string of up to 3 characters. The integers {\tt 0} and
{\tt 20} are also acceptable.}
{{\tt 0}, {\tt 20}, {\tt 'A'}, {\tt '20A'}, or {\tt 'A20'} but nothing
else. {\tt 0} - normal input, no attenuation. {\tt 20} - normal input,
20db attenuation. {\tt A} - alternate input, no attenuation. {\tt
20A} and {\tt A20} - alternate input, 20db attenuation.}
{{\tt 0}}
{Defaults to previous station.}
{{\tt IFDIST=0,0,'A',0}}


\subsubsection{\label{SP:LCHAN}{\tt LCHAN} and {\tt RCHAN}}

{\tt LCHAN} specifies the {\tt IFCHAN} to use if {\tt IFCHAN='L'} as
in LCP.  {\tt RCHAN} serves the same purpose for RCP.  If an invalid
argument is used, \schedb will complain that {\tt IFCHAN} is bad.
This allows IFCHAN to be specified by polarization which is more
meaningful to the observer.  It also makes it easier to deal with
antennas, such as the VLA, that might have different IF assignments
than the VLBA.

\rcwbox
{A single character.}
{{\tt A}, {\tt B}, {\tt C}, or {\tt D}}
{None. Must specify if {\tt IFCHAN='L'}.}
{Defaults to previous station.}
{{\tt LCHAN=A  RCHAN=C}}


\subsubsection{\label{SP:LEVEL}{\tt LEVEL}}

{\tt LEVEL} specifies the setting of the attenuators in the base band
converters (BBCs). Values between {\tt -1} and {\tt 256} can be
used. If {\tt -1} is set, the autoleveling will be activated. If {\tt
256} is set, the value from the previous scan will be used, thereby
locking in an autolevel value for, for example, pointing. Any value in
between sets a specific attenuation, but such values are rarely
used. Only one value is accepted but \schedb writes that value out
separately for each baseband channel.

This currently (Oct. 2001) has no effect on the VEX file.


\rcwbox
{An integer giving the level setting.}
{{\tt -1} to {\tt 256}. See above.}
{{\tt -1}}
{Defaults to previous station.}
{{\tt LEVEL=-1}}


\subsubsection{\label{SP:LOGGING}{\tt LOGGING}}

{\tt LOGGING} specifies the type of logging to be done on the
VLBA. {\tt STANDARD} is appropriate for normal observations of almost
any kind.  {\tt POINTING} is for pointing observations, although
current pointing observations actually use {\tt STANDARD}.  {\tt NONE}
causes the system to do only the same background monitoring that is
done when the antenna is idle.  {\tt SPECIAL} or a specific file name
uses a special list of monitor points and logging intervals provided
by the VLBA operators.  If one of these special files is used, it is
wise to put a comment in the experiment cover information that the
special logging file is needed.  Someone (PI or analyst) should add
this to the operators questionnaire. {\tt STANDARD}, {\tt NONE}, and {\tt
POINTING} are not case sensitive.  Any special file name must match
in case the name of the file loaded at the sites.  Contact the chief
VLBA operator to get special files made.

One of the uses of this system is to allow monitoring of system
temperatures at very short intervals.  Monitoring at 5 second intervals
is ok with the {\tt STANDARD} logging.  For 2 second points, a special
file is available called {\tt dblog2}.

This has no effect on the VEX file.

\rcwbox
{Character string - special file names are case sensitive.}
{{\tt STANDARD}, {\tt NONE}, {\tt POINTING}, or the name of a special
logging file that the operators have put at the stations.}
{{\tt STANDARD}}
{Defaults to previous station.}
{{\tt LOGGING = 'dblog2'}}


\subsubsection{\label{SP:LCP50CM}{\tt LCP50CM} and {\tt RCP50CM}}

{\tt LCP50CM} and {\tt RCP50CM} controls the LCP and RCP narrow-band
(609 to 613~MHz) filter in the 50cm system on the VLBA. {\tt BROAD}
means do not use the filter, while {\tt NARROW} means use it. This
band is in the UHF TV bands (channel 37) and at some sites the RFI
without the filter is so bad that the system will saturate, even for
the 90cm system (since the IF will saturate). The filter should be
used if at all possible.

\rcwbox
{Character string.}
{{\tt BROAD} or {\tt NARROW}}
{{\tt NARROW}}
{Defaults to previous station.}
{{\tt LCP50CM = BROAD  RCP50CM = BROAD}}


\subsubsection{\label{SP:M4PATCH}{\tt M4PATCH}}

{\tt M4PATCH} allows specification of the patching at MarkIV stations.
There are limited options so far - ASTRO and GEO1.

ASTRO is the default and has the odd numbered VCs on IF 1 (IFCHAN 1N
and 1A) and even numbered VCs on IF 2 (IFCHAN 2N and 2A).  Note that
1N and 2A are often connected to the same thing.  Same for 2N and 1A.
IF 3 is not used.

GEO1 is for a geodetic style patching. The pattern is:
\begin{verbatim}
        VCs 1-2    IF1 low  = 8180-8300 MHz
         "  3-4    IF1 high = 8300-8580 MHz
         "  5-8    IF3      = 8680-8980 or 8280-8580 MHz
         "  9-10   IF2 low  = 2120-2240 MHz
         "  11-14  IF2 high = 2240-2520 MHz
\end{verbatim}

\rcwbox
{Character string of length up to 8.}
{{\tt ''ASTRO'' or ''GEO1''}}
{{\tt ''ASTRO''}}
{Defaults to previous station.}
{{\tt M4PATCH = GEO1}}


\subsubsection{\label{SP:MODETEST}{\tt MODETEST}}

{\tt MODETEST} was first used to allow testing of recording modes
that were not ready for public release.  It is being adapted for
use whenever there are features under development that should not
be used by normal scientific users.  Either the features are still
under test, or have not been deployed to sufficient antennas to 
allow science use.  For example, it will be used while the new
VLBA synthesizers are being tested and deployed.

\rcwbox
{None.}
{}
{Defaults to false which means don't allow unreleased features.}
{Defaults to previous station.}
{{\tt MODETEST}}



\subsubsection{\label{SP:NCHAN}{\tt NCHAN}}

{\tt NCHAN} gives the number of baseband channels. A baseband channel
is the smallest unit that was once an analog signal. One sideband from
one BBC is a baseband channel. Nothing prevents the user from
assigning several channels to the same BBC/sideband. In such cases,
the data in the two channels will be identical.

\rcwbox
{An integer.}
{Any integer between {\tt 1} and the maximum number of channels which
on the VLBA is {\tt 16}.}
{{\tt 0} - it should be specified.}
{Defaults to previous station.}
{{\tt NCHAN=14}}


\subsubsection{\label{SP:NETSIDE}{\tt NETSIDE}}

{\tt NETSIDE} gives the net sideband. Usually to be used in
conjunction with {\tt FREQREF} and {\tt FIRSTLO}. If {\tt SIDEBAND} is
not set to {\tt U} or {\tt L}, it will be set based on {\tt NETSIDE}
and the frequency settings. Please see
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} for a discussion of required
parameters.

If only one value is specified, it is used for all channels.

Sched will attempt to make a default for {\tt NETSIDE} if it is
not specified.  The default will depend on the number of channels
in the setup file and the number of BBC's available at the station.
All upper sideband will be specified if possible.  Upper/lower pairs
will be specified otherwise (not in Mark~III mode).  This defaulting
will not be attempted if 
{\hyperref[SP:SIDEBAND]{{\tt SIDEBAND}}} is
specified (might generate conflict) or if 
{\hyperref[SP:FREQREF]{{\tt FREQREF}}}
is absent (frequency might end up inconsistent with
defaults).

\rcwbox
{An array of up to 16 single characters.}
{{\tt U} or {\tt L}. Otherwise will not be used.}
{{\tt 0} - defaulted or determined from other parameters.  Any
unspecified channels will be set the same as the first.}
{Defaults to previous station.}
{{\tt NETSIDE=U,L,U,L,U,L,U,L}}



\subsubsection{\label{SP:NOISE}{\tt NOISE}}

{\tt NOISE} is the specification for each IF of the switching mode of
the noise cals on the VLBA. The usual for VLBI is {\tt 'low-s'} which
means that the low noise cal, about 3~K, is switching continuously at
80~Hz for continuous system temperature measurements, while {\tt
'low-c'} means low continuous. {\tt 'high-s'} and {\tt 'high-c'} are
the same requests for the high (solar) cals; beware that most
receivers do not have solar cals.

This has no effect on the VEX file.

\rcwbox
{4 character strings of up to 6 characters each, one for each IF.}
{{\tt 'off'}, {\tt 'low-s'}, {\tt 'low-c'}, {\tt 'high-s'},
{\tt 'high-c'}}
{{\tt 0} - which is interpreted to mean 'low-s'}
{Defaults to previous station.}
{{\tt NOISE='low-s','low-s','low-s','low-s'}}

\subsubsection{\label{SP:NOISEFRQ}{\tt NOISEFRQ}}

This is not a useful parameter (2013) as the Pie Town link is
not in operation.  Someday it may be reactivated, although with
different hardware.

{\tt NOISEFRQ} is used to tell the system to use either the VLBA or
VLA noise tube switching frequency.  This is for VLBA antennas only
and actually only applies to Pie Town for when the Pie Town-VLA link
is working.  Note that the VLA switching frequency is 9.6 Hz and the
VLBA frequency is 80 Hz.  This means, for example, that there will be
80 on and 80 off states per second on the VLBA.

This has no effect on the VEX file.

\rcwbox
{1 character string of up to 4 characters.}
{{\tt 'VLBA'}, {\tt 'VLA'}}
{{\tt 'VLBA'}}
{Defaults to previous station.}
{{\tt NOISEFRQ='VLA'}}


\subsubsection{\label{SP:PERIOD}{\tt PERIOD}}

{\tt PERIOD} gives the integration time for detected powers in the
base band converters (BBCs). One value is accepted here although {\sc
SCHED} will write that value out separately for each baseband
channel. It would be ideal to set this to 30 seconds or so, but this
time is also used for the auto-leveling time constant so it should be
significantly less, with values of {\tt 1} or {\tt 2} typical. A value
of {\tt 0} implies do not integrate beyond the 1/80 sec cal cycle
time.

\rcwbox
{An integer giving the integration time in seconds.}
{Any integer {\tt 0} or greater.}
{1}
{Defaults to previous station.}
{{\tt PERIOD=2}}


\subsubsection{\label{SP:PCAL}{\tt PCAL}}

{\tt PCAL} sets the mode of the pulse cal generator on the VLBA.  Note
that this can also be controlled from the main schedule.  Most setup
files will set this to the 1 MHz setting.  If it should be turned
off, as for spectral line observations which might be confused by
the presence of the tones, it is likely that the user will want it
on for some scans (calibrators, for example) and off for others.  In
such cases, it is most convenient to control it from the main
schedule.

This currently (Oct 2001) cannot be controlled by means of the VEX
file. Most MkIV stations only support ``1MHz'' or ``off''. Around the
EVN, 1 MHz insertion is the default and switching it off is still a
manual operation at most stations that must be brought to the attention
of the local Friend of VLBI.

\rcwbox
{4 characters - see options.}
{{\tt ' '} - use default {\tt '1MHz'}. {\tt 'off'} - turn off pulse
cal generator. {\tt '1MHz'} - generate tones every 1~MHz. {\tt '5MHz'}
- generate tones every 5~MHz.}
{{\tt ' '}}
{Defaults to previous station.}
{{\tt PCAL='5MHz'}}


\subsubsection{\label{SP:PCALFR1}{\tt PCALFR1} and {\tt PCALFR2}}

There are 16 pulse cal detectors in the VLBA formatters, each with the
ability to detect signals from 2 bit streams. Each can be set to
detect a tone at a different frequency at any multiple of 10~kHz in
the baseband. {\tt PCALFR1} and {\tt PCALFR2} are arrays of 16
frequencies in kHz for the 16 detectors. {\em ACTUALLY, UNTIL A
FORMATTER UPGRADE IS COMPLETE, THERE ARE ONLY 8 DETECTORS.} If a
frequency of {\tt 0} is given, the detector will be used to count bits
in each state. {\tt PCALFR1} applies to the first channel of the
detector, while {\tt PCALFR2} applies to the second; they need not be
the same. \schedb is capable of setting {\tt PCALFR1}, {\tt
PCALFR2}, {\tt PCALXB1}, and {\tt PCALXB2} automatically, and this is
probably the option that most users should take. \schedb will use
the automatic settings if {\tt PCALXB1(1)} is not set.  If the {\tt
PCALFR} and {\tt PCALXB} values are defaulted, they will be adjusted
on a scan by scan basis for any changes in observing frequency,
including those requested by {\tt FREQ} or {\tt DOPPLER} in the {\sc
SCHED} keyin file.

The default will be to set up all available channels to detect, using
sign bits only, first the tone near the lower edge of the band in each
channel, then a second tone near the high edge of the band in each
channel, and then state counts (sign and magnitude for 2 bit data) for
each channel, then a third tone which is (usually) 1 MHz away from the
first tone being detected.  As many of these tones will be detected as
possible up to a total number of detected signals that does not exceed
the number of available detectors.

There is usually no problem with setting the {\tt PCALFR} and {\tt
PCALXB} parameters when {\tt PCAL} is off, so there is usually no need
to turn off this default. The one exception would be if the
frequencies are being switched rapidly in such a way that the {\tt
PCALFR} frequencies are changing. Each time they are changed, the
formatter is reconfigured, which blocks data to the recording for
about 8 seconds and throws the VLBA correlator out of sync.  Total
data loss is at least 16 seconds and can be more if there is a speedup
factor greater than one or if the correlator has a hard time
resyncing, which happens maybe 10-20% of the time.  To prevent this,
either specify the pulse cal detector parameters and they will be kept
constant or make sure the default pulse cal setup doesn't change (keep
constant the number of baseband channels, the channel bandwidth, and
the pulse cal tone frequencies in the basebands (don't change the kHz
part of the frequency).

Detection of Phase cal is not currently (Oct 2001) implemented on the
PCFS, although the VEX file has a way of specifying the desired
detection.  On MkIV telescopes this requires the installation of
additional hardware, but even on PCFS controlled telescopes with VLBA
hardware this is not yet supported.

\rcwbox
{An array of 16 integers, each giving a frequency in kHz.}
{Any multiple of {\tt 10} from {\tt 0} to {\tt 16000}.}
{See above. Note that defaulting depends on whether or not {\tt PCALXB1(1)}
is set, not whether any {\tt PCALFR}s are set.}
{Defaults to previous station.}
{{\tt PCALFR1=10,10,10,10,7010,7010,7010,7010}}



\subsubsection{\label{SP:PCALXB1}{\tt PCALXB1} and {\tt PCALXB2}}

{\tt PCALXB1} and {\tt PCALXB2} determine what the pulse cal detectors
measure. There are 16 pulse cal detectors in each formatter and 1
formatter at each VLBA station. ({\em FOR NOW, THERE ARE ONLY 8
DETECTORS AT EACH STATION}) Each detector can process two bit
streams. In each bit stream, either counts of bits can be determined
({\tt PCALFR1=0}) or a pulse cal tone can be detected. If the two bit
streams are from the same (2 bit) channel, and
the frequency is the same for both detectors ({\tt PCALFR1} and {\tt
PCALFR2} the same), the results will be combined for a single measured
amplitude and phase. The arguments are treated as character
strings. They begin with a letter indicating whether to look at the
sign (S) or the magnitude (M) bit. The letter is followed by a number
to indicate the channel from which the bits are to come. {\tt PCALXB1}
specifies the source of the first bit stream for each detector, while
{\tt PCALXB2} specifies the source of the second bit stream. ``Channel
number'' means the same quantity that is used as the index for most
setup parameters. A detector can be turned off by specifying {\tt
'off'}.

Most users should not need to worry about setting the pcal detection
parameters.  \schedb defaults to a reasonable set which is
described in the section on 
{\hyperref[SP:PCALFR1]{{\tt PCALFR1} and {\tt PCALFR2}}}.

\rcwbox
{An array of up to 16 character strings specifying Sign or
Magnitude bit and the channel number.}
{{\tt S1}, {\tt S2}, ... {\tt S16}, {\tt M1}, {\tt M2}, ...
{\tt M16}, or {\tt off}}
{See 
{\hyperref[SP:PCALFR1]{{\tt PCALFR1} and {\tt PCALFR2}}}.}
{Defaults to previous station.}
{{\tt PCALXB1=S1,S2,S3,S4,S5,S6,S7,off}, which could be used to
measure 1 tone in each channel of a Mark~III mode E observation.}

\subsubsection{\label{SP:POL}{\tt POL}}

{\tt POL} is used to specify the polarization of a channel.  This
may be used when asking \schedb to set a lot of defaults.  Or it
may be used to tell \schedb the polarization in cases where it
is not clear from other inputs.  Such cases arise when
{\hyperref[SP:LCHAN]{{\tt RCHAN}}}, and 
{\hyperref[SP:LCHAN]{{\tt LCHAN}}}
are not used AND the setup does not correspond to one in the
{\hyperref[SEC:FRQCAT]{frequency catalog.}}.

{\tt POL} should be {\tt RCP, LCP,} or {\tt DUAL}.  One value per
channel can be given.  Any channels not set will default to the
same value as the first so it is usually sufficient to just specify
one value.  If {\tt POL = DUAL} for the first channel,
\schedb will set alternate channels to {\tt RCP} and {\tt LCP}.

Actually, {\tt POL} can also be {\tt R} or {\tt L} (meaning {\tt RCP}
and {\tt LCP} respectively), but don't tell anyone.

\rcwbox
{An array of polarization specifications, one per channel.}
{{\tt RCP}, {\tt LCP}, or {\tt DUAL}}
{Will try to set based on other inputs or frequency catalog.}
{Defaults to previous station.}
{{\tt POL=DUAL}}


\subsubsection{\label{SP:PTINCR}{\tt PTINCR}}

{\tt PTINCR} is used to set the step size for pointing patterns on the
VLBA in arc minutes. A 10-point pattern is used with off, half-power,
on, half-power, and off positions in azimuth, and then in the same in
elevation.  {\tt PTINCR} gives the offset between the on and the
half-power positions. 
{\hyperref[SP:PTOFF]{{\tt PTOFF}}} gives the
distance to the off source positions.  Note that the off source
positions in elevation are {\tt PTOFF} arcminutes off in azimuth
and two times {\tt PTINCR} off in elevation.  This gives a smooth
sequence in elevation which, at low elevation, significantly
improves the baseline removal.

\rcwbox
{A real number giving the offset in arcmin.}
{Any number but it should be near 1/2 of the FWHM of the beam.}
{{\tt 0} - not too useful.}
{Defaults to previous station.}
{{\tt PTINCR=4.0}}



\subsubsection{\label{SP:PTOFF}{\tt PTOFF}}

{\tt PTOFF} is used to set the distance to the off source position
for pointing patterns on the
VLBA in arc minutes. See 
{\hyperref[SP:PTINCR]{{\tt PTINCR}}} for more
information.

\rcwbox
{A real number giving the offset in arcmin.}
{Any number but it should be about 3 times the FWHM of the beam.}
{{\tt 6.0*PTINCR}}
{Defaults to previous station.}
{{\tt PTOFF=36.0}}


\subsubsection{\label{SP:SAMPRATE}{\tt SAMPRATE}}

{\tt SAMPRATE} is used to set the sample rate in million samples per
second.  Only one value is used for all baseband channels. This is
usually, but not always, twice the baseband bandwidth specified with
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}}. Not used for Mark~II.

If not specified, twice the maximum bandwidth will be used, if
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}} was specified.

Note that the {\tt SAMPRATE} should not be less than 2 Mbps for the
VLBA (may change with Mark5C).  That is the minimum track bit rate for
the old tape systems and for the Mark5A and the fan-in capability was
never activated so lower sample rates cannot be recorded.  The user
will need to specify the {SP: SAMPRATE} in such cases because the
defaulting doesn't deal with this restriction.  It would be fixed, but
the restriction will likely go away soon.

\rcwbox
{Sample rate in million samples per second.}
{{\tt 0.25}, {\tt 0.5}, {\tt 1}, {\tt 2}, {\tt 4}, {\tt 8}, {\tt 16},
or {\tt 32}}
{{\tt 0} - Default from 
{\hyperref[SP:BBFILTER]{{\tt BBFILTER}}} }
{Defaults to previous station.}
{{\tt SAMPRATE=4}}


\subsubsection{\label{SP:SIDEBAND}{\tt SIDEBAND}}

{\tt SIDEBAND} is used to specify the baseband converter (BBC)
sideband for each channel.  This may not be the same as the net
sideband if the first mix is lower sideband, as for the VLBA it always
is at 20cm and 13cm and can be at other bands. Please see
{\hyperref[SP:FREQREF]{{\tt FREQREF}}} for a discussion of required
parameters.

If only one value is specified, it is used for all channels.

\rcwbox
{A single character for each baseband channel.}
{{\tt U} or {\tt L}}
{{\tt 0} - must specify.}
{Defaults to previous station.}
{{\tt SIDEBAND=U,L,U,L,U,L,U,L}}


\subsubsection{\label{SP:STATION}{\tt STATION}}

{\tt STATION} gives the names of the stations for which this group of
setup parameters applies.  \schedb deals with multiple stations by
expanding the input group out into a separate group for each
station specified.  This allows the defaults picked up later, for
example from the 
{\hyperref[SEC:FRQCAT]{frequency catalog}}, to be station
dependent.  Therefore, if only using very generic inputs, one can
lump the stations together even if their final parameters are
different.

There are two defaults allowed, {\tt VLBA} and {\tt ' '} (or none
specified).  If no stations are specified, the program goes through
the schedule and finds all stations that are in scans that request
that setup file and that have not been specified in other groups
within the setup file.  Those stations (just {\tt VLBA}) for any VLBA
stations) are added to the setup station list.

Later, the program looks for a perfect match to the station.  If it
finds one, it uses that setup group.  If not, it checks whether the
station is a VLBA station (first 4 characters in the station name are
{\tt VLBA}) and whether there was a {\tt station=vlba} specified.  If
so, \schedb uses the parameters from the {\tt vlba} group.

The old {\tt station=default} option has been removed.

Note that you cannot specify no stations for one setup group and some
specific ones for another within the same file and expect anything
reasonable to happen.

\rcwbox
{Up to 30 station names of up to 8 characters each.}
{Any valid station names. {\tt 'VLBA'} will match any VLBA station.}
{All stations that request that setup file.}
{???. Defaults to previous station.}
{{\tt STATION='VLBA\_PT'}}

\subsubsection{\label{SP:STRING1}
{\tt STRING1, STRING2, STRING3,} and {\tt STRING4}}

{\tt STRING1, STRING2, STRING3,} and {\tt STRING4} are 80-character
string that will be placed in the VLBA control file without
modification. This allows for new scheduling parameters provided by
the on-line group to be used before they get properly built into {\sc
SCHED}. Comments could be passed this way by preceding them ``!*''
and following them with ``*!''.

\rcwbox
{Any 80 character string.}
{It just needs to be understood by the on-line system.}
{Blank - not passed to VLBA control file.}
{Defaults to previous station.}
{{\tt STRING1=' !*  Special scan  *!'}}


\subsubsection{\label{SP:SWTCHDUR}{\tt SWTCHDUR}}

For frequency switched observations, with {\tt FRSWITCH} set, {\tt
SWTCHDUR} gives the time spent on each switch cycle.  The scan must be
long enough to allow a full scan setup.  15 seconds is probably the
minimum reasonable switch time.  For observations to be processed on
Mark~III correlators, there are additional restrictions on the
possible integration times; multiples of 5 seconds are OK, as are some
other times.

The frequency switching mode in \schedb is seldom if ever used so
should be treated carefully.

\rcwbox
{An integer number of seconds.}
{Any integer. {\tt 15} is typical.}
{{\tt 0} - specify it if {\tt FRSWITCH} set.}
{Defaults to previous station.}
{{\tt SWTCHDUR=15}}


\subsubsection{\label{SP:SYNTH}{\tt SYNTH}}

{\tt SYNTH} is a 3 element array of frequency settings for the three
2-16~GHz synthesizers for the VLBA. This is the LO for the first
mix. After this mix (or 2 mixes for 1.3cm and 7mm), the signal must be
in the 500-1000~MHz IF band.

Harmonic mixing issue:

Internally generated RFI tones can result from mixing of harmonics of
the front-end synthesizers on the VLBA.  Under some circumstances,
these tones can have amplitudes of several hundred in the
autocorrelations as measured using a 32 MHz baseband bandwidth and
31.25 kHz spectral channel bandwidth.  Such tones cause very strong
ringing across the autocorrelation spectrum without smoothing.  They
are also seen, more weakly, in the cross-correlations because of the
concentration of power in the affected channel.  All three of the
synthesizers are involved in producing these tones whether or not they
are actually in use.  So it matters how all synthesizers are set, not
just the active ones.

The tones are strongest when the frequencies that mix include the
nominal output frequency of one of the synthesizers.  They are also
strongest, at least for the 4-8 GHz "6cm" receiver when the
synthesizers are numbers 1 and 2, both of which feed the IF converter.
Other harmonics, and synthesizer 3, which usually is used for the high
frequency front ends, create tones that are much weaker.  A
complication is that, above 8.0 GHz, the synthesizer's main oscillator
is running at half the output frequency and doubler produces the final
output.  A birdy is seen at the half frequency.

SCHED tries to warn of choices of front end frequencies (often
obtained from the freq.dat file) that could cause problems.  When
SCHED is allowed to choose the frequencies of the unused synthesizers
(Setup parameter SYNTH), it will try exhaustively to find benign
frequencies and it should be able to in essentially all cases.  So it
is best to let SCHED choose.

It is not yet clear which bands can be affected when SCHED is allowed
to choose the unused synthesizer settings.  Any case where only one
synthesizer is in use (most observations below 16 GHz) will be ok as
SCHED can find benign settings for the other two.  If 2 IF pairs are
in use in the new 6cm receiver, it is established that one can get in
trouble with this issue - that is where it was found. S/X and high
frequencies where synthesizer 3 is used in the front end have not yet
been tested.

\rcwbox
{3 frequencies in GHz.}
{N*500 +- 100~MHz and between 2 and 16~GHz.}
{{\tt 0} - should be specified.}
{Defaults to previous station.}
{{\tt SYNTH=15.9,4.1,15.9}}


\subsubsection{\label{SP:TPMODE}{\tt TPMODE}}

{\tt TPMODE} is an obsolete parameter since tape is no longer used.

{\tt TPMODE} sets the number of passes at each head index
position. Allowed values are 1, 2, 4, and 8. For these cases, a
maximum of 32, 16, 8, or 4 heads can be used at a time. {\tt TPMODE=1}
is appropriate for Mark~III mode A, while {\tt TPMODE=2} is used for
Mark~III mode B. Setups with different values of {\tt TPMODE}
may be specified for a station during an experiment, but \schedb
will determine the lowest value specified for the station for the
whole experiment and use that for all scans.  Thus during the times
when the setup calls for fewer heads than could be used with the
minimum {\tt TPMODE}, some tracks will be left blank.  This wastes
tape, but saves a great deal of complexity in keeping track of
where data should be recorded on the tape.  It is strongly advised
that all setup files for a project use the same {\tt TPMODE}.
Note, however, that different stations can use different {\tt
TPMODES} without wasting tape.

The correct {\tt TPMODE} can be determined from the 
{\hyperref[SP:FORMAT]{{\tt FORMAT}}}, the number of bits per sample (
{\hyperref[SP:BITS]{{\tt BITS}}}), and the number of channels (
{\hyperref[SP:NCHAN]{{\tt NCHAN}}}.
Those parameters tell how many tracks are needed per channel and,
multiplied by the number of channels, how many tracks are needed per
pass.  For VLBA formats, that total number of tracks is divided into
32 to get {\tt TPMODE}.  For Mark~III, observations, the total number
of heads available is normally 28, although the VLBA systems can
record 32 tracks in Mark~III format.

\schedb will derive a reasonable default for {\tt TPMODE} in almost
all cases so it is not necessary to specify it.

{\tt TPMODE} can be used to force a format if {\tt FORMAT} is not being
specified, as is reasonable in station independent setup files.  A fan
out will be chosen that generates the requested number of passes per
head position.  If the observation uses wide band, 2 head (Mark IV and
VLBA4) or 2 tape (VLBA) mode, the fan out will be chosen assuming that
all antennas have the 2 head/tape capability.  Later, for single drive
stations, the number of channels will be cut in half.

For S2 recorders {\tt TPMODE} denotes the number of groups the S2
recorder can use in the desired recording mode. In other words it is
the total number of recorders divided by the number of recorders
implied by the mode. It must be consistent with the S2 mode implied by
the number of channels and bandwidth to be record.

\rcwbox
{An integer.}
{{\tt 1}, {\tt 2}, {\tt 4}, or {\tt 8}}
{{\tt 0} - \schedb will generate a reasonable default.}
{Defaults to previous station.}
{{\tt TPMODE=2}}


\subsubsection{\label{SP:TPSPEED}{\tt TPSPEED}}

The {\tt TPSPEED}  and related parameters are even more obsolete
now than noted below because tape is no longer used.

{\tt TPSPEED} is an obsolete form that has been replaced by
{\hyperref[SP:TPSPEEDH]{{\tt TPSPEEDH}}} and
{\hyperref[SP:TPSPEEDL]{{\tt TPSPEEDL}}}.  It will cause an
error message to be written.  The value given will be used for
{\tt TPSPEEDL}.

\subsubsection{\label{SP:TPSPEEDH}{\tt TPSPEEDH}}

{\tt TPSPEEDH} is an obsolete parameter because tape is no longer used.

{\tt TPSPEEDH} tells \schedb the recording speed of the tape in inches
per second when recording at high density.  The low density record
speed is specified with 
{\hyperref[SP:TPSPEEDL]{{\tt TPSPEEDL}}}. \schedb
uses this information to calculate where on the tape each scan is
located, when to reverse direction, switch head assignments etc.  The
density at which the recording should be made is set by the
{\hyperref[TP:DENSITY]{{\tt DENSITY}}} parameter in the tape
initialization inputs.

{\tt TPSPEEDH} and {\tt TPSPEEDL} will default to the correct values
for tapes written on VLBA, Mark~III, Mark IV, VLBA4 and S2 systems.  It
should not be necessary to specify them and it is probably safer not
to do so.

The speeds currently in use are:

\begin{description}
\item[67.5 ips] for low density Mark~III/IV at 2 Msamp/s per track.
\item[135 ips] for low density Mark~III/IV at 4 Msamp/s per track ---
               the ``normal'' speed.
\item[270 ips] for low density Mark~III/IV at 8 Msamp/s per track ---
               the ``double'' speed.
\item[66.665 ips] for low density VLBA format at 2 Mbits/s per track
               (with fan out etc, this may not be the sample rate).
\item[133.33 ips] for low density VLBA format at 4 Mbits/s per track.
\item[266.66 ips] for low density VLBA format at 8 Mbits/s per track.
\item[40 ips] for high density Mark~III/IV and VLBA format at 2 Mbits/s
               per track (with fan out etc, this may not be the
               sample rate).
\item[80 ips] for high density Mark~III/IV and VLBA format at 4 Mbits/s
              per track.
\item[160 ips] for high density Mark~III/IV and VLBA format at 8 Mbits/s
              per track.
\item[320 ips] for high density Mark~IV format at 16 Mbits/s per
              track --- the ``double--double'' speed.  This is not
              yet supported.
\item[4.2 ips] for S2 format on high density recordings.  The S2
              speeds are fictitious values that make the times come
              out right.
\item[6.3 ips] for S2 format on low density recordings.
\end{description}

The VLBA and VLA started using high density on all thin tapes on
about 1 May 1996.

Note that the recording speed determines the speed up factor on
playback.  All playback on the VLBA correlator is done at the higher
speed (160, 266.66 or 270 ips).  Projects recorded at less than the
highest speed will play back in less than real time.  It is important
that a reasonable fraction of projects have a speed up factor of more
than unity or the correlator will not be able to keep up with
observing.

The VLBA control file only specifies {\tt STOP}, {\tt +RUN}, {\tt
-RUN}, {\tt +REWIND}, or {\tt -REWIND}, and the on-line system deduces
the speed to use from the format and samplerate.  If \schedb has
the values different from what the on-line system chooses to use, the
direction and head position commands, along with tape changes, will be
wrong and the project will be messed up.


\rcwbox
{A real number that is the tape speed in inches per second.}
{Any of those listed above.}
{Defaults to values listed above depending on recording mode.}
{Defaults to previous station.}
{{\tt TPSPEED=80}}

\subsubsection{\label{SP:TPSPEEDL}{\tt TPSPEEDL}}

{\tt TPSPEEDL} is an obsolete parameter because tape is no longer used.

{\tt TPSPEEDL} tells \schedb the recording speed of the tape in inches
per second when recording at low density.  See the discussion of
{\hyperref[SP:TPSPEEDH]{{\tt TPSPEEDH}}} for details.

\rcwbox
{A real number that is the tape speed in inches per second.}
{Any of those listed in under {\tt TPSPEEDH}.}
{Defaults as in list under {\tt TPSPEEDH} --- depends on recording
mode}
{Defaults to previous station.}
{{\tt TPSPEED=135}}


\subsubsection{\label{SP:TRACK1}
{\tt TRACK1, TRACK2, ... , TRACK7,} and {\tt TRACK8}}

The {\tt TRACKn} parameters are mostly obsolete since tape is no
longer used.  For Mark5A disk systems, the track concept is retained,
but as if there were only one pass, so {\tt TRACK1} might still be
used.  But \schedb generally takes care of track assignments without
input from the user.

   The {\tt TRACKn} parameters are arrays of track specifications for
use during the {\tt n}th pass at a head position. One track is given
for each baseband channel. For Mark~III, there is a one-to-one
correspondence between baseband channels and tracks so this makes
sense.  For Mark~III observations, the VLBA track for a channel is
just the Mark~III track plus 3.  For many VLBA modes, several tracks
are used for each channel. In these cases, the first track used for
the baseband channel is specified and the on-line system determines
the rest. A fanned out channel uses adjacent tracks within the odd or
even groups and the lowest VLBA track used for data is 2. For example,
a 1:4 fan out channel uses tracks 2, 4, 6, and 8 for the low order
bit. If 2-bit samples are used, tracks 10, 12, 14, and 16 would be
used for those bits.  In such a case, the only track mentioned in a
{\tt TRACKn} parameter is 2.  If a fan-in mode is used, more than one
channel should be given the same track specification.  Fan-in modes
are not yet tested or in use.

For modes VLBA1:1, VLBA1:2, VLBA1:4, Mark~III mode B with ascending
frequency order (alternating sidebands), and Mark~III mode E, {\tt
TRACK1} can be left out. All of the {\tt TRACKn} commands will default
to reasonable values. This is the recommended action for most users
since track assignment is an easy area in which to make mistakes. {\sc
SCHED} will complain and stop if it does not know how to set the
tracks for the requested mode. For the Mark~III modes, extra baseband
channels (2 for Mode B and 1 for Mode E) can be specified and will be
put on the edge tracks that are not normally used for Mark~III. For
Mode B, they should follow the same alternating sideband pattern as
the rest of the channels.

\rcwbox
{One integer track specifications per channel.}
{Any integer between {\tt 2} and {\tt 33}.}
{{\tt 0} which will trigger automatic assignments for many modes.}
{Defaults to previous station.}
{{\tt TRACK1=4,18,6,20,8,22,10,24,12,26,14,28,16,30} \\
 {\tt TRACK2=5,19,7,21,9,23,11,25,13,27,15,29,17,31} \\
This example is Mark~III Mode B.}


\section{\label{SEC:SATINIT}Satellite Initialization.}

Parameters to specify satellite information can be included in a {\tt
SATINIT} section imbedded in the main schedule input.  See the
{\hyperref[SEC:SATEL]{Satellite Tracking section}} for more detailed
information on this.


\chapter{\label{CHP:SYSTEM}INSTALLING, AND RUNNING SCHED}

\section{\label{SEC:INSTALL}Installing SCHED}

This section is only needed if you do not have access to an installed
copy of \sched.

It is important that users obtain and use the latest version of
\schedb when scheduling observations.  \schedb is evolving with time
to add new features, to correct bugs, to keep up with hardware
changes, and to enhance its ability to prevent errors from being made
in schedules, based on experience.  There are typically one or two
releases each year and they are announced on the VLBI email exploder.
At institutions where there are several VLBI users, someone should be
in charge of making sure that the latest version is available.  When
that option is not available, the user should check that he/she has
the latest version before attempting to schedule a project.

The \schedb software, catalogs, auxiliary files, and documentation all
reside in subdirectories under a parent directory.  Installing \schedb
involves unpacking the tar file of the distribution into such a
directory.  If a canned executable is available for your type of
computer, it can hopefully, used as is.  Otherwise it will be
necessary to compile the program.  The {\tt SCHED} environment variable
should be set to the root directory where \schedb is installed.
The {\sc PGPLOT} subroutine library is required.  See below if you need
to install it.

The installation can be tested using the {\sl Verify} script in the
{\sl examples} subdirectory.  That script runs all the examples and
compares the results with results obtained at the time the release was
created.

\schedb is written in FORTRAN 77 using only a few common extensions
from the standard.  Development has occurred on a variety of machines
including VAXes, PCs, SUNs and Macs.  Current development is done
under Linux and Mac OSX, with pre-release testing on a Sun.  Old
versions were tested on Hp, SGI, IBM (AIX), and DEC Alpha, but such
machines are no longer being used for \schedb as far as I know.  A big
``thank you'' to Franco Tinarelli at Bologna for performing many of
these tests.  Machine dependent code has been isolated in special
subdirectories under the {\sl src/Cit} code directory.  There are very
few.  All other FORTRAN files should compile without changes on a wide
variety of machines.  Note, however, that all current testing is under
one or another flavor of unix.  There has been no recent testing under
other operating systems.  This will only change if there is pressure
to do so.  Please inform the developers if you install it on something
else.

Note that the usual fortran compiler on unix machines (including Macs)
these days are those from the GNU Project.  In the past, the compiler
was g77.  That works with gcc versions 3 and lower.  But development
of g77 is long finished.  For gcc 4 and higher, you must use gfortran
which was written from scratch.  We are in the process of switching
the support of \schedb to gfortran and have done so for various
architectures as can be seen in the configure scripts.  For some older
versions, we may not bother switching, but simply stop supporting, for
example, 32 bit machines.  By stop supporting, we mean not provide
configure scripts or test before releases.  It is likely you could
still use such machines.  We will also need to migrate the {\tt spice}
code for spacecraft tracking before we can abandon g77 completely.

If you plan to support \schedb under more than one computer
architecture, you may wish to have subdirectories under bin and point
to the appropriate one in the PATH environment variable.  Or you may
wish to have entirely separate installations.

To install \sched, the following steps can be followed.  Users of
anything but unix or linux (who don't exist as far as we know) will
have to make some modifications.

Users of Mac OSX will need to have X windows and the compiler installed.
Also for full functionallity, pgplot should be installed.  There are some
more details at the end of this section.

\begin{description}

\item [Environment and PATH (unix systems):] Set the environment
variable SCHED to the base directory under which \schedb will be
installed.  To do this type, for example, either {\tt setenv SCHED 
/users/cwalker/sched} or {\tt export SCHED=/users/cwalker/sched}
depending on the
shell you use.  Add the bin subdirectory to your PATH, be prepared to
specify the full path name when you run the program, or put a copy of
the binary (or a link to it) in some directory that is in your PATH.
If the plotting capabilities are used, which is highly recommended,
{\sl PGPLOT} will need to have been installed and the environment
variables {\tt PGPLOT\_DIR} and maybe {\tt PGPLOT\_FONT} will need to be
set.  In Socorro, the path and environment variables can be
established by adding {\tt setup\_vlba} and {\tt setup\_pgplot} to your
{\sl .tcshrc.Linux} (or equivalent file for other shells).

\item [ftp the tar file:] Use anonymous ftp to ftp.aoc.nrao.edu (user
"anonymous", password should be your full email address).  {\tt cd} to
pub/sched.  Tell ftp to do binary file transfers (type {\tt binary}).
List the tar files and subdirectories present.  The latest version
will be in a subdirectory with the highest version number.  Go to that
subdirectory and copy the {\sl sched.<version>.tar.gz} to your {\sl
\$SCHED} directory.  As of Version 8.0, that tar file contains
everything except the binaries for the common architectures. There
will also be a binaries subdirectory which has subdirectories for
several architectures which are obvious from their names ("spice" in
the name implies a version with satellite tracking enabled, which may
only work at the AOC).  Inside the architecture subdirectory is an
executable version of \sched.  If one of these works for you, you can
skip compiling the program and just use it.

\item [Unpack the tar file:] To unpack the tar file, type {\tt tar
-xvf <filename> --gunzip} while in the {\sl \$SCHED} directory.  This
will unload all files from the tar file, creating the necessary
subdirectory structure in the process.  A {\sl README} file will
appear in the top level directory which contains useful information on
the directory structure and on installing \sched.

Note that, after this step, a local html version of this manual will
be available in the doc/sched/sched.html under the parent \schedb
directory ({\sl \$SCHED}).  Your browser will probably run much faster
pointing at that version than at the version at NRAO.

\item [Try the binary for your system:] If you downloaded an
executable file, put it in the {\sl \$SCHED/bin} directory.  Note that
we are at a time of change in the computer world so there are a lot of
options, not all of which are covered.  Intel and equivalent machines
are changing from 32 to 64 bit.  GNU fortran is switching from g77
(with gcc version 3.x and below) to gfortran (with gcc version 4+).
Macs have moved from PPC chips to Intel chips.  And some versions of
\schedb are set up to do satellite tracking with extra software not
normally distributed with the package.  The architectures covered are
what are immediately available to the developers.  The subdirectories
are LINUX64 (64 bit Intel based Linux using g77), LINUX64SPICE (like
LINUX64 but enabled for spacecraft tracking), and OSX\_INTEL (Intel
based Mac with gfortran).  For a while, there may also be one or more
of LINUX (32 bit Intel based Linux using g77), OSXPPC (PPC based Mac
using gfortran), and SUN (SUN workstation running Solaris using f77).
If one of the binaries works for you, use it.  If not, you will need
to recompile.

\item [{\sc PGPLOT:}] If the plotting capabilities are desired
(believe me --- you want them), you should make the {\sc PGPLOT}
libraries and the font file available.  Check if your system already
has them.  That is fairly likely at astronomy sites.  If not, they can
be obtained from many repositories of open source code.  But if that
doesn't work, as of July 2011, {\sc PGPLOT 5.3.1} (which is not
obviously available on the {\sl PGPLOT} website) is included with
the \schedb distribution in the {\sl \$SCHED/PGPLOT} subdirectory.
Simplified instructions for installation are given in {\tt
\$SCHED/PGPLOT/README\_PGPLOT}.  There is extensive information on {\sc
PGPLOT} available from the WWW page at 
{\href{http://astro.caltech.edu/\~{}tjp/pgplot/}{http://www.astro.caltech.edu/\~{}tjp/pgplot/}}.
Those web pages are also
included with the {\sl PGPLOT} distribution.  Note that {\sc PGPLOT}
should be built with the same compiler and machine architecture as
\sched for everything to function properly.

Robert Mutel provided the following suggestion if you are running into
problems on a MAC with the use of the pgplot libraries (complaints
about being a FAT file): Edit the PGPLOT makefile to eliminate the
ranlib indexing steps, and add a 's' option to the ar steps (this is
equivalent to indexing with ranlib, but ranlib chokes because it
cannot read 'fat' libraries, which contain both 32bit and 64 bit
versions of the routines. 'Fat' libraries seem to be created by
default by ar, at least in the recent Mac OSX release.

\item [Compiling the program:] If you need to compile \schedb, you
will need to construct an appropriate Makefile and run make.  There is
a template Makefile ({\sl Makefile.master}) showing lots of possible
options and a number of simple scripts that edit the template to build
Makefiles for specific cases using the line editor sed.  You can
either modify the template Makefile or one of the scripts to match
your system configuration.  Basically what you need to do with the
required edits is tell make what FORTRAN compiler you use and where
various required libraries reside.  There are lots of comments in the
template Makefile to guide the process.  Once ready, run make.  Many
routines are compiled so it will take a few minutes.  Under gfortran,
there will be some warnings that can be ignored, especially about
character variables being truncated.

There is some oddity that has been seen on Mac OSX (May 2008) where it
is not equivalent to just type {\tt make} when the Makefile is what
you want and typing, for example, {\tt make -f Makefile.MacOSX}.  The
latter doesn't seem to work with what look to be problems finding
libraries.  We don't understand it.

Note that the Makefile requires the use of GNU make.  Check for GNU
make on your system.  It is installed on many if not most and is the
standard make under Linux and OSX.  If you don't have it, it can be
obtained from prep.ai.mit.edu.  Also a version (probably not current)
is available in the same ftp area as \sched.

\schedb can be compiled with or without the plotting capabilities.  It
is highly recommended that you compile with those capabilites.  To do
so, you will need {\sc PGPLOT} (version 5.2 or later) installed on
your system.  See above for more information on getting {\sc PGPLOT}
if you don't already have it.

There is also a stub for the routines related to use of the JPL
ephemeris, in case that code causes problems.  The JPL routines are
used for observations of planets, which are probably only of interest
for single-dish testing of the VLBA by staff.  Using the stub requires
changing some comments in the {\sl Makefile}.  Similarly, there is
a stub to avoid using the NAIF software related to satellite tracking.
The normal user will use that stub because the NAIF libraries are not
normally distributed with \sched.

\item [Testing:] The examples in the {\sl examples} subdirectory can
be used to test the code once it has been installed.  A few outputs
from each example are stored in the {\sl Stdout} subdirectory.  For
unix systems, the routine {\sl Verify} can be used to run all of the
examples and compare results with those in {\sl Stdout}.  The output
from {\sl Verify} will be in the file {\sl testruns.out}.  Any
differences are in the output from diff.  It is common to have
differences in items such as source positions in the last significant
figure.  Different machines handle rounding differently.  Such
differences can be ignored.  Any more serious differences are cause
for concern.

\end{description}

Some VAX FORTRAN features that are commonly supported by other FORTRAN
compilers remain in the code.  These features are supported by all of
the compilers that we are aware of that are being used for \schedb
currently.  They include long variable names, in-line comments, and
{\tt END DO}.  If you have problems with these features, please email
{\sl cwalker@nrao.edu}.  Considerable use was made of the SLALIB
(STARLINK) routines for precession, etc.  These routines use long
variable names so removing this non-standard feature would not be
easy.  (email permission to use the FORTRAN SLALIB routines has been
obtained from P. Wallace, although the version under the GNU license
was installed in March 2013).

If the code or any other files are moved from a unix or VMS machine to
a machine using DOS or Windows, beware that the end-of-line characters
are different.  At least on SUN and Linux, a pair of utilities
unix2dos and dos2unix can be used to fix the files.  As of Dec. 2009,
SCHED under Unix and Unix-like operating systems can read DOS format
files.

We are always interested in hearing about people's experiences
installing \schedb on various machines.  If you have problems, or even
success on machines other than those listed earlier, please let us
know (email to cwalker@nrao.edu).  We would be especially interested
if someone ports \schedb to a non-unix, or unix-like (eg Linux)
operating system.  \schedb was supported under VMS and DOS in the
past and the coding style hasn't changed, so a port to such operating
systems would probably not be difficult.

A recent experience installing \schedb on a MacOSX 10.5.4 system
showed the need to be careful about compiler versions.  That version
of OSX uses version 4.0.1 of the gcc compiler.  You have to use
gfortran, a Fortran 95 compiler, with gcc versions above 4.0 and g77
with lower gcc versions.  PGPLOT was loaded from the Fink, as were
both g77 and gfortran, and the PGPLOT was first built with gfortran.
The build of SCHED only went smoothly after switching to gfortran for
\sched.  There will be similar issues wherever the switch from gcc 3
to 4 occurs.  For some details of my first install of \schedb on a Mac
in 2003, see Appendix~\ref{APP:Mac2003}.


\section{\label{SEC:RUNSCHED}Running SCHED}

\subsection{\label{SSEC:RUNUNIX}Running SCHED under UNIX or LINUX}

To run \schedb on a UNIX machine such as a SUN or a PC under LINUX,
prepare the keyin file without system level commands.  Then type, for
example,
\begin{verbatim}
sched < input.key
\end{verbatim}
Alternatively, if plotting is wanted, for example, type:
\begin{verbatim}
sched
<SCHED will write a number of instructive lines>
* plot schedule=input.key /
\end{verbatim}
where the \schedb executable file is assumed to be in the default
directory or path and the \schedb input commands are in {\sl input.key}
in the default directory. The ``{\tt <}'' pipes the information in
{\sl input.key} to \sched.  The ``*'' is the prompt from \sched.
Remember that, in UNIX, file names and
commands are case sensitive.  Also, there is a complication for users
of the tc shell for versions after mid 1995: there is a built-in shell
command ``sched'' that the shell takes instead of running {\sc
SCHED}. So to use \sched, either alias ``sched'' to mean this
program or else specify the full path name of the execute module. The
files output by \schedb will appear in the default directory.

If your version of \schedb is linked with the {\sc PGPLOT} libraries
(has plotting capability), you will need
to set the environment variables {\tt PGPLOT\_DIR} to the location of
the {\sc PGPLOT} libraries and {\tt PGPLOT\_FONT} to the location of
the {\sc PGPLOT} font files.  If you use {\sc PGPLOT} for other
reasons (programming, DIFFMAP etc), then this is likely to be part
of your standard setup.

\subsection{\label{SSEC:RUNVAX}Running SCHED on a VAX with VMS}

Note that I am not aware of anyone using \schedb on VAXes any more.

To run \schedb on a VAX, make a VMS command file, called {\tt
INPUT.COM} for example, which begins with a VMS command that causes
\schedb to be executed. For systems with a fully installed Caltech
package, the command ``\$ \sched'' should work. Otherwise use a
command of the form ``\$ RUN UMA3:[VPGM.CIT.VLB]\sched'', where
you will need to substitute the correct directory specification. The
command file should end with ``\$ EXIT'', although this is not
necessary. The \schedb command file is run by typing, for example,
\begin{verbatim}
@INPUT.COM
\end{verbatim}
The files output by \schedb will appear in the default directory.

\schedb has not been tested under VMS since the plotting
capabilities were added.

% \subsection{\label{SSEC:RUNDOS}Running SCHED on an MS-DOS PC}

It has been a very long time since I was aware of anyone running
\schedb on an MS-DOS machine, or a Windows machine for that matter.

To run \schedb on a PC (MS DOS), prepare the input file without
system level commands. Then type, for example,
\begin{verbatim}
\CODE\SCHEDB < INPUT.KEY
\end{verbatim}
where the SCHED.EXE executable file is assumed to be in the CODE
directory (substitute whatever is correct for your system) and the
\schedb input commands are in INPUT.KEY in the default
directory. The ``$<$'' pipes the information in INPUT.KEY to the
program (note the similarity to UNIX). The files output by \schedb
will appear in the default directory.

It has been a long time since \schedb was ported to DOS.  It has
never been ported to Windows.  It seriously outgrew DOS, but should
work in Windows if someone were to take the effort to install it.


\section{\label{SEC:DISFIL}Distribution of Schedule Files}

Once \schedb has been used to make schedules for an observation, those
files need to be sent to the stations, usually by way of a distribution
center at NRAO or in Europe.  When time for a project is allocated,
instructions for how to accomplish this will be provided.


\section{\label{SEC:RELATEDPROGRAMS}Related Programs}

This section briefly describes other programs that may be of use when
using \sched.  The descriptions of {\sc SKEDCONV}, {\sc PC-SCHED}, and
{\sc UPTIME} have been removed as they are no longer in use.  That leaves
only the geodetic scheduling program {\sc SKED} which is still the
primary tool for scheduling geodetic project.

\begin{description}

\item [{\sc SKED}] Originally the scheduling program for Mark III,
{\sc SKED} is now the standard program for scheduling geodetic VLBI
observations.  It produces {\sc SKED} or drg files that are converted
to snap files by {\sc DRUDG}.  It also produces VLBA control files for
geodetic projects.  It has sophisticated automatic scheduling
capabilities, well beyond what is available in the optimization modes
of \sched, for geodetic projects.  Contact the GSFC VLBI group for
more information.

\end{description}


\section{\label{SEC:RELEASE}Release Instructions.}

This section is mainly for the primary \schedb developer.  It describes
the process of making a \schedb release.  It is written to allow the
main lines to be cut and pasted into a terminal to accomplish the
steps.  I have not set up a script because considerable interaction
and checking is normally required.

This section is derived from a separate file called {\sl
Release\_instructions} that is no longer being maintained.

\begin{description}

\item [Before a release:]

Be sure that the other developers have committed anything that they
want included in the release.

Make sure VERSION and VERNUM in {\sl versched.f} are up to date.
Make sure the version on the manual first page is current.

Make sure {\sl sched\_work} is synced with the svn repository.  This
should include the results of updating the manual.  Note that {\sl
sched\_work} is my development directory.  You may have something
different.

Make sure that the leap seconds in {\sl \$SCHED/src/Sla/dat.f} and
in {\sl \$PLANET\_DATA/naif0007.tls} (or equivalent like {\sl naif0010.tls}) 
are up to date.  If there is a change in dat.f, update the slalib.a 
in my other programming areas as they might affect the pointing and gain
programs, although I'm not sure if any actually are sensitive to
the leap second.  The slalib library for those programs is in svn at
https://svn.aoc.nrao.edu/repos/VLBA/rcwlib/trunk/slalib.  The other
programs are found starting at https://svn.aoc.nrao.edu/repos/VLBA.


\item [Setup files:]

Update the setup files from the master if needed.  Note that the following
will replace most of the setup files, but there are a fair number, mostly
for the lba, that are not built by makesetup, so do not do a global delete
of the .set files.  Note that the .set files are in the svn repository,
so run a commit after running makesetup.  If you do inadvertantly delete
the lba setups, they can be recovered from the repository.

\begin{verbatim}
cd $SCHED/setups
makesetup
\end{verbatim}

\item [Station, frequency, and messages files:]

These catalogs are maintained in pieces in separate subdirectories
to the {\sl catalogs} directory.  There are files for the US, DSN, 
EVN etc.  Different subdirectories are maintained by different people.
There is an {\sl Update} script in the base {\sl catalogs} directory
which does the file merge.  You can look in there to see what gets merged
to form the stations, freq, and messages files.  Run {\sl Update} when
all segments are up to date:

\begin{verbatim}
cd $SCHED/catalogs
Update
\end{verbatim}


\item [Source and location files:]

Install the latest source and locations catalogs from the geodetic
community.  The source files can be found either by contacting Goddard
(David Gordon) and Leonid Petrov (Radio Fundamental Catalog), or by
looking for ``GSFC VLBI'' or ``Petrov VLBI'' with a search engine.
The locations file is from Goddard (also Gordon).

The latest source files, with their names that identify the release,
should put in {\sl \$SCHED/catalogs} while the locations file with its
name including a release identifier should be put in {\sl
\$SCHED/catalogs/Master\_NRAO}.  Then the symbolic links {\sl
sources.gsfc} and {\sl sources.rfc} in {\sl \$SCHED/catalogs} and the
link {\sl locations.gsfc} in {\sl \$SCHED/catalogs/Master\_NRAO}
should be updated.  The final {\sl locations.dat} file in {\sl
\$SCHED/catalogs} will include both this downloaded file plus
contributions from other places.  It is built when Update is run in
{\sl \$SCHED/catalogs}, which updates most of the catalogs.  All of
the new files and links should be added to svn.  If SCHED complains
about duplicate station data, it might be that a station that formerly
came from one of the other locations files has been added to the
geodetic solution.  The geodetic solution should be given preference.
Watch out station data based on few observations.  They might have
unreasonably large rates.  This happened with the new data for the DSN
stations DSS14 and DSS63 in the 2015feb release, and we reverted to
using the old data in {\sl stations\_DSN}.

The old catalogs can be moved out of the main /schedb area.  I have
put a lot of such stuff in
~cwalker/files/sched\_ARCHIVE\_nonSVN/catalogs.  The new catalogs
should be added in svn.  After copying (not moving) them to some
storage location, the old ones should be deleted with svn.

Note that updating the source and locations files used to involve
reformatting the ones acquired from the geodetic groups, often a
complicated task especially if formats changed.  But now both GSFC and
Petrov are providing files in the correct format to use directly.  The
reformatting of the files used to involve the programs {\sl NEWLOC}
and {\sl NEWLOC} in {\sl \$SCHED/RELATED\_CODE}, but those should no
longer be needed.


\item [Test and produce standard output files:]

Once the code is thought to be working, go to the {\sl examples} directory
and run the {\sl Verify} script.  That will run all of the examples and 
compare the output with the last standard output set, which is kept in the
{\sl Stdout} subdirectory.  Once satisfied that all differences are 
understood, run {\sl Newstd} to update the standard outputs.  Note that 
both of these scripts will need to be maintained if changes or additions
are made to the examples suite.

Check the {\sl crd.} files with {\tt cksched} on a Sun.  There is a 
script {\sl Legacy\_cksched} that can be used to run cksched on all
{\sl crd} files in a directory.  It should be run on the updated
{\sl Stdout} directory as that has a sample from each example, rather 
than all.  Running in the {\sl examples} directory would create a 
huge amount of output.

Check the {\sl vex} files on a 64 bit Linux machine with {\sl
Check\_vex}.  This runs {\tt
/home/swc/software/VLBADIFX-TRUNK/bin/vexpeek} on all of the {\sl vex}
files.  Since there is only one per example, it does not matter if
this is done in {\sl examples} or in {\sl examples/Stdout}.  Note that
the error messages go to standard error so they do not go through a
simple pipe, such as to {\sl less}.  Use the construct {\sl Check\_vex
$|$\& less}

Try plotting, probably using example {\sl egplan.key}.


\item [Compile for multiple architectures:]

Compile and link \schedb for each target architecture.  Run {\sl
Verify} in the examples directory after each compile and check {\tt
testruns.out]} to make sure it works.  The compilations are without
satellite tracking unless otherwise noted.  Doing multiple
compilations has been useful for finding bugs that don't affect all
compilers.  Currently I support \schedb on the architectures listed
below.  Note that the environment variables \$PGPLOT\_DIR and \$PGPLOT\_FONT
may need to be changed depending on where PGPLOT is stored for that
compile (probably different for g77 and gfortran on Linux, for
example).

\begin{list}{}{\parsep 1ex  \itemsep 0em
                 \leftmargin 8em  \itemindent -20em }

  \item {\bf LINUX64GFORTRAN}  64 bit Intel linux compiled with gfortran (noatak).
  \item {\bf LINUX64SPICE~~~}  64 bit Intel linux compiled with g77 and 
                   including satellite tracking.
  \item {\bf LINUX64~~~~~~~~}  64 bit Intel linux without spice.
  \item {\bf OSX\_INTEL~~~~~~}  Intel Mac compiled with gfortran
  \item {\bf SUN~~~~~~~~~~~~}  Sun Solaris compiled with f77.
        Note some Sun's have too little memory for the default
        parameter settings.
\end{list}


To compile on a given machine, login to that machine.

\begin{itemize}

\item Make sure the environment variable \$SCHED is set properly.  You
can use the normal development directory.  Just be sure to revert to
the default compilation when finished.

\item Use the appropriate configure file such as configureLinuxSpice64
to make a {\sl Makefile} appropriate for the architecture (Someday,
get a proper configure script).

3.  Clean out previous efforts with {\tt make clean}, then compile and
link using {\tt make} (use {\tt gmake} on the Sun).

4.  Copy the binary to the right subdirectory in {\sl bin}

5.  Test the examples using Verify.  Also try plotting with an
example.  There have been cases where a bug in plotting only affected
on architecture.

\end{itemize}

To summarize:

\begin{verbatim}
cd $SCHED/src
configureLinuxSpice64
make clean   (gmake clean on the Sun)
make         (gmake on the Sun)
cp ../bin/sched ../bin/LINUX64SPICE/
cd ../examples
source ./Verify
less testruns.out
\end{verbatim}
Try a plot.

In the Verify step, look for unexpected differences.  Recorded run
times will be different, and often there will be last-digit
differences due to different rounding schemes.  Those are ok.  but
anything else could be a sign of trouble.

\item [Document the release:]

The manual should have been kept up to date while programming was in
progress.  Fill any gaps.

Write a release note.  This will be mainly a link to the manual
update section.  It will be sent to the vlbi exploder.

Check the README and README.ftp files in \$SCHED to be sure that
they are current.

      
\item [Set environment variables to aid the release:]

Set the NEWVER in the window where this work is being done so
that script segments below can be used with a cut-and-paste
Also check a couple of places below (other machines) where the
version number is also needed.  Note that the tar files are 
kept separately from the development version of \sched.  
If maintaining \schedb anywhere except cwalker's area, establish an
area for that.

\begin{verbatim}
setenv NEWVER 11.3
setenv TARDIR /users/cwalker/files/sched_ARCHIVE_nonSVN/TARFILES
\end{verbatim}

\item [Prepare the Manual:]

First, be sure that the manual is as up-to-date as you can reasonably
make it.  That said, there are sections that still need work as time
allows.  The manual is the equivalent of over 300 pages so maintaining
it is a significant job.  The most important parts to keep current are
the parameter descriptions and that the summary indexes of those
descriptions..  The {\tt htlatex} scheme does not automatically
produce complete indices of the parameters as {\tt latex2htms} did, so
the summary lists are now much more important but easy to forget.
Also, make sure the list of changes in the release notes section is
complete.  It is best to keep the manual up-to-date whenever changes
are made, not to wait until just before a release.

The examples in the manual are grabbed from {\sl ../examples} starting
from where latex is being run.  So this should be done in {\sl
\$SCHED/doc}, the normal place in a distribution, so the examples will
be from {\sl \$SCHED/examples}.  Note that these are not the copies of
the examples that will be put (see below) in {\sl
\$SCHED/doc/sched/examples}.

Process the manual.  The manual is in file {\sl \$SCHED/doc/sched.tex}
which is configured for processing by {\tt latex, pdflatex}, and {\tt
htlatex}.  {\tt latex} produces a .dvi file which can then be used by
various programs to produce other formats.  But this is probably not
the way to go.  However, it is useful to run bare {\tt latex} first
to shake out any problems in the file.  It seems to catch some errors that
the others miss.  Note that {\tt latex} or {\tt pdflatex} will be need
to be run at least 3 or 4 times to get all the references right.  {\tt
htlatex} does three passes of the latex step regardless.  pdflatex
directly produces a monolithic pdf file with active hyperlinks.  {\tt
htlatex} produces the HTML files with chunking to the level specified
in the call as shown below.  The html files produced by {\tt htlatex}
are the standard form for distribution of the manual.  The pdf file
from {\tt pdflatex} can be considered optional.

Note that the various files produced by {\tt latex, pdflatex}, and
{\tt htlatex} are not necessarily compatible, (so I've been tole) so
it is a good idea to delete them before running a different program.
The script {\tt latexclean} can do the cleanup as shown below.  That
is certainly something to try if there is a crash for non-obvious
reasons.

Note that, until Jan. 2015, the HTML manual was prepared with {\tt
latex2html}, but that program is no longer being supported and stopped
working at the AOC.  So we converted to htlatex, which involved
retyping most of the hyperref references in the text.  We cannot
easily go back.  In the process, the automatically-generated names of
the html pages, and the number of such pages, changed.  Any references
in external documents are going to have to change.

For a release, both the {\sl .pdf} and {\sl HTML} can be made using the 
sequence below.  Note that {\tt htlatex} makes the {\sl .html} files
in the {\sl doc} area, then copies, not moves, them to the desired
subdirectory specified in the third argument --- {\sl sched} in this
case.  So the {\tt /bin/rm *.html} command below is to clean out 
the unneeded files in the {\sl doc} directory.

The files produced by {\tt htlatex} that included sections that used
{\tt \\subsubsection} in the tex file (all of the parameter
descriptions!)  will have, by default, a very tiny font for the
section headers --- much smaller than the font used for the rest of
the text.  It's hard to believe that someone would set that up, but they
did.  The cure identified so far is to add the following line to the
sched.css file in \$SCHED/doc/sched.  I think it can go anywhere, but
I've been putting it in as the second to last line:
\begin{verbatim}
h5.subsubsectionHead{font-size:150%;}
\end{verbatim}

{\tt pdflatex} will leave the {\sl sched.pdf} file in the {\sl doc}
area.  The html files are prepared with {\tt htlatex}.  The
"sec-filename" in the example causes the {\sl .html} node names to be
based on the section headings, not just a sequence number.  The "3"
controls how finely the manual is chunked into multiple html files.
The "3" shown seems to be a reasonable choice, although some of the
files were multiple files in the {\tt latex2html} days.  Naming the
output files makes for referable names that won't keep changing.  The
{\tt -dsched/} argument causes the {\sl .html} files to be copied to
the {\sl sched} subdirectory, after which the originals in the current
area ({\sl doc}) can be deleted.
     
\begin{verbatim}
cd $SCHED/doc
latexclean sched
latex sched.tex        (correct any errors found)
latexclean sched
pdflatex sched.tex     (optional; may need several repeats to get links right)
latexclean sched
/bin/rm sched/*.html   (cleans out old files)
htlatex sched.tex "html,3,sec-filename" " " "-dsched/"
/bin/rm *.html
cd $SCHED/doc/sched
emacs sched/sched.css        (Add the line as described above.)
ln -s sched.html index.html  (To help some old bookmarks)
\end{verbatim}

The HTML files will be expecting to find copies of the examples and
catalogs in appropriate subdirectories of the {\sl sched} directory to
allow simple links.  So update them.  Don't worry about setups here
for now.  Give user write privileges to make other maintenance easier.
Some of the catalogs are write restricted in the {\sl
\$SCHED/catalogs} area to help prevent modifications to the derived
files produced by {\tt Update}

\begin{verbatim}
cd $SCHED/doc
/bin/rm -r sched/catalogs/*
/bin/rm -r sched/examples/*
tar cf - ../catalogs/sources.*     ../catalogs/rfc*  ../catalogs/freq*.dat \
         ../catalogs/stations*.dat ../catalogs/locations.dat \
         ../catalogs/peak*.cmd     ../catalogs/linefreqs.dat \
         ../examples/*.key         ../examples/*.com \
         ../examples/*.set         ../examples/egcentsrc.dat \
            | (cd sched; tar xfp -)
chmod  u+w sched/catalogs/*
\end{verbatim}


\item [Make the release version:]

Put together a new directory tree to hold the release.  This will be
very similar to the development version, but will not evolve after the
release, and will not contain some of the extra baggage of old files
etc that bloat the size of the development area.

Make a directory for the new version.  In this case it in in the 
{\sl files} subdirectory of my home area.

\begin{verbatim}
setenv SCHEDNEW ~/files/sched_$NEWVER
mkdir $SCHEDNEW
cd $SCHEDNEW
\end{verbatim}

Check out the current SCHED from svn.  It lands in a subdirectory, so
move it up, including the .svn files.  Don't be alarmed about messages
indicating sched/. and sched/.. can't be moved.

\begin{verbatim}
svn checkout https://svn.aoc.nrao.edu/repos/sched/trunk/sched
mv sched/* .
mv sched/.* .
\end{verbatim}

Copy over the examples/Stdout files, the execute modules, the setup
files, the html manual, and PGPLOT installation stuff, none of which
are under svn (they are fast changing, bulky, and can be derived from
files that are in svn).  The --delete deletes files on the receiving
side that are not on the sending side and is useful when updating,
say, a beta release that is not being done from scratch.

\begin{verbatim}
rsync -auv --delete --exclude ".svn" $SCHED/bin  $SCHEDNEW
rsync -auv --delete --exclude ".svn" \
     $SCHED/examples/Stdout $SCHEDNEW/examples
rsync -auv --delete --exclude ".svn" \
     --exclude "AAA_OLD" $SCHED/setups $SCHEDNEW
rsync -auv --delete --exclude ".svn" $SCHED/doc/sched $SCHEDNEW/doc
rsync -auv --delete --exclude ".svn" \
     --exclude "*.o" $SCHED/PGPLOT $SCHEDNEW
\end{verbatim}

Will need \$SCHED set to \$SCHEDNEW to run {\sl Verify}.
\begin{verbatim}
setenv SCHED $SCHEDNEW
\end{verbatim}
Do a compilation to be sure all is there and run {\sl Verify} to make
sure it works.  Then clean out the {\sl examples} directory using
{\tt schclean "*"} to avoid bloating the tar file.

Test the completeness using an rsync dry run.  The release directory
was filled with an svn checkout and some limited rsyncs, so it could
have missed something.  Also if some iteration happened, it might not
be complete. Note that output lines that end with a / are just an
indication of having entered the directory.  They don't indicate a
missing file.  Some non-svn files may show, like the latex temporary 
files.

\begin{verbatim}
rsync -auvn --exclude ".svn" --exclude "TEST" --exclude "*.o" \
   --exclude "*TEMP*" --exclude "*OLD*" --exclude "RELATED_CODE" \
   --exclude "*~" --exclude "*old*"  --exclude "*save*" \
   --exclude "*new*" \
   ../sched_work/* .
\end{verbatim}


\item [Make the tar file:]

Make the distribution tar file.  First be sure there are no old copies
in the archive and ftp areas.  Also go through the \schedb directory
structures weeding out excess files that don't want to end up in the
tar file.  The tar command below will also omit many that are not
needed.  As part of this, be sure to clean out the Verify output
with {\tt schclean "*"} in the {\sl examples} subdirectory.  Otherwise
the tar file will much bigger than necessary.

Note the {\tt --excludes} include the lib directory which has the NAIF
software.  Without that, the satellite version cannot be linked.
Without that, anyone wanting to do satellite tracking will need the
AOC version or a special export.  Also the {\sl RELATED\_CODE}
directory is excluded as users shouldn't need it.  But the \schedb
maintainer will.  The {\sl PGPLOT} directory is included because users
may well want it.   Note that the binaries will be included.

\begin{verbatim}
cd $SCHEDNEW/examples
schclean "*"
cd $SCHEDNEW
tar --exclude "bin/sched" \
    --exclude ".svn" --exclude "*.o" --exclude "*~" \
    --exclude "lib" --exclude "core*" --exclude "TEST"  \
    --exclude "RELATED_CODE" \
     -cf $TARDIR/sched_$NEWVER.tar .
gzip $TARDIR/sched_$NEWVER.tar
\end{verbatim}


\item [Test the release:]

This will not have the NAIF software so it will not be the internal
release.  Clean out {\sl sched\_temp} first if needed.  Unpack the
source distribution tar file into {\sl
/users/cwalker/files/sched\_temp} (or wherever you want - but adjust
{\tt SCHTEST} accordingly) and test the compilation without the
satellite stuff.  Use the makefile that does not use the spice package
(run configureLinux) Check testruns.out at the end.  This is best done
in a sacrificial window so the changed environment variables don't
haunt you later.

\begin{verbatim}
setenv SCHTEST /users/cwalker/files/sched_temp
setenv SCHED $SCHTEST
cd $SCHTEST
chmod u+w $SCHTEST/catalogs/*
/bin/rm -r *
tar -xvf $TARDIR/sched_{$NEWVER}.tar.gz --gunzip
cd src
configureLinux64
make
cd ../examples
Verify
\end{verbatim}


Maybe run the "Dry Run" rsync above to check for completeness.

     Kill the window to dump the unwanted \$SCHED etc. or at least:
\begin{verbatim}
setenv SCHED /users/cwalker/files/sched_work
\end{verbatim}


\item [Put files on the ftp site:]

Put the tar file on the ftp site.  Maybe some day, make a web site
for this.   Note that the binaries are in the tar
file now.

\begin{verbatim}
mkdir $FTP/sched/sched_$NEWVER
cp $TARDIR/sched_$NEWVER.tar.gz  $FTP/sched/sched_$NEWVER/
\end{verbatim}

Copy over README.ftp if it has changed.

\item [Put the documentation on the personal web pages:]

This is to create the copy of the web pages currently available at
{\sl www.aoc.nrao.cwalker/\~cwalker/sched/sched.html}.  My web pages
are staged to a separate area where I can work on them, then copied to
the {\sl public\_html} area.  That copy happens as part of the backup
job run twice per day using cron.  While doing the update, it is a
good idea to clean up the staging area and html area.  They tend to
accumulate unneeded old files for old versions.

The instructions here are based on the machine names for R.C. Walker.
They may change for a new maintainer.

Note that the files will all be in a directory numbered for the
release.  The file where users will look is a symbolic link to the
generic file {\sl sched}.

\begin{verbatim}
setenv WEBDIR /home/noatak/cwalker/webnrao
cd ~
mkdir $WEBDIR/sched_$NEWVER
cp -R $SCHEDNEW/doc/sched/* $WEBDIR/sched_$NEWVER/
cd $WEBDIR
/bin/rm sched
ln -s sched_{$NEWVER} sched
cd $SCHED
\end{verbatim}


\item [Announce the release and get it installed at the AOC:]

Send the email announcement to:
vlbi@nrao.edu,scistaff@nrao.edu,analysts@nrao.edu,pperley@nrao.edu,
vlbaops@nrao.edu,vlbatests@nrao.edu

Announcements of preliminary releases can go to:
nmsci@nrao.edu,analysts@nrao.edu,pperley@nrao.edu,vlbaops@nrao.edu

Also, at some point, include the other \schedb developers:
small@jive.nl,campbell@jive.nl,c.reynolds@curtin.edu.au,alef@mpifr-bonn.mpg.de

The AOC release is in software areas where I do not have write
privileges.  Tell the computer people (helpdesk) to place the update
in the computer areas.  Include the following information in email to
them (adjust version number):

The new release is in {\sl /users/cwalker/files/sched\_11.3}

The executables {\sl (sched, schclean)} are in machine specific
subdirectories under bin.  They go in {\sl /usr/local/bin}.  For the
in-house linux64 versions, use the one with the SPICE libraries
(LINUX64SPICE). These support spacecraft tracking.  We no longer
support LINUX32 or MACPPC.

The manual is in {\sl doc/sched/*} and goes in
http://www.aoc.nrao.edu/software/sched/*

The catalogs and setups are in separate directories that go in {\sl
/usr/local/sched}.  Note that the subdirectories in the {\sl catalogs}
directory ({\sl Master\_NRAO} etc) should not be included.


\item [Make a tagged version in svn:]

There is demand for tagging the releases, so here are the instructions.
This basically marks a revision as the tag (release).
To do so from trunk ( There is a slight variation for a branch origen):

\begin{verbatim}
svn copy https://svn.aoc.nrao.edu/repos/sched/trunk \
         https://svn.aoc.nrao.edu/repos/sched/tags/sched_$NEWVER \
         -m "Tagging SCHED $NEWVER for maintenance"
\end{verbatim}

To backfit a tag to other than the latest version:

\begin{verbatim}
svn copy -r 276 https://svn.aoc.nrao.edu/repos/sched/trunk/sched \
         https://svn.aoc.nrao.edu/repos/sched/tags/sched_9.3 \
         -m "Tagging release 9.3 of sched."
\end{verbatim}


\item [SVN branch and other SVN info:]

OPTIONAL (I normally don't do this)

Under some circumstances, it might be useful to have a full copy of a
release that is maintained with svn.  This involves making a branch
or tag (I think they are equivalent), and then checking it out to 
a new directory.  Then to be really useful, the items not maintained
in svn should be copied in.  I tried this with my first post-svn 
release in 2009, but found it too much work to maintain, so abandoned the
practice.  But the instructions are here in case.  They have been
edited since they were last tried, so watch for gotchas.

Make the branch - just a different directory than the tag.

\begin{verbatim}
svn copy https://svn.aoc.nrao.edu/repos/sched/trunk \
         https://svn.aoc.nrao.edu/repos/sched/branch/SCHED-$NEWVER \
         -m "Branching the 8.0 release of SCHED"
\end{verbatim}

To make a corresponding development area for the branch:

\begin{verbatim}
setenv SCHEDBASE ~/files/sched_branch$NEWVER
mkdir $SCHEDBASE
cd $SCHEDBASE
svn checkout https://svn.aoc.nrao.edu/repos/sched/branch/SCHED-$NEWVER/ .
\end{verbatim}

Don't drop the period at the end of the last command (= current directory)

Copy over the examples/Stdout files, the execute modules, and the html.
The exclusion of .svn files shouldn't be needed, but just in case...

\begin{verbatim}
cd $SCHEDNEW
rsync -auv --exclude ".svn" bin  $SCHEDBASE
rsync -auv --exclude ".svn" examples/Stdout $SCHEDBASE/examples
rsync -auv --exclude ".svn" doc/sched $SCHEDBASE/doc
\end{verbatim}


Some SVN HINTS:

In order to ignore some files in svn status etc.
Note the "." on the end of the second one.  
ignore.txt is needed for the second form.

\begin{verbatim}
cd examples
svn propset svn:ignore "*" Stdout
svn propset svn:ignore -F ignore.txt .
cd ../doc
svn propset svn:ignore "*" sched
\end{verbatim}

Developer advice:

If you are a developer and have an svn maintained version and wish to
update the items not in svn, such as the html manual, the Stdout
example outputs, or the setups (derived from makesetup), it might be
easiest to download and unpack the tar file into a new directory,
then rsync the desired stuff to your development area.

\end{description}


\chapter{\label{CHP:CHANG}RELEASE NOTES}


\section{\label{SEC:CURRENT}Recent Releases}


% seek point for editing:  development version

%  ToDo:
%     Every update, check leap seconds.  Update SLA routine dat.f and 
%        any $PLANET_DATA/naif00nn.tls files if one is planned.
%     ToDo items moved to the {\hyperref[SSEC:WISH]Wish List} March 2, 2015.


\subsection{\label{SSEC:VER_11.5}Version 11.5 development}

\begin{itemize}

\item  Nothing yet.

\end{itemize}


\subsection{\label{SSEC:VER_11.4}Version 11.4}

The nominal release date for this version is March 12, 2015.

\begin{itemize}

\item Updating the manual.  Make sure the parameter summary lists are
complete because they have become more important now that we don't
have the {\tt latex2html} indices.  Make sure all the example files are
listed (they weren't). Update the release instructions
in the manual.  The manual probably still has out-of-date sections as
much has been changing.  March 10, 2015  Craig Walker.

\item Modify the Newstd script in the examples area to change various constructs
like -0.0 in the {\sl sch} and {\sl sum} files to prevent spurious diffs when
running the Verify script that checks the output of all the example schedules
against previous outputs that are thought to be good.

\item GSFC (David Gordon) is now providing a locations file in 
KEYIN format.  That is now placed in the catalogs/Master\_NRAO directory
and combined with other locations files to make {\sl locations.dat}.
Conversion from geodetic formats is no longer needed.  Feb. 27, 2015  Craig
Walker

\item \schedb has long come with a combined source catalog, {\sl
sources.vlba}, that contained sources from JVAS, an old VLA calibrator
list, the GSFC solutions, the Petrov RFC solutions and possibly
others.  Creating the combined list has been a somewhat painful job,
especially when the input catalog formats change.  Now both
Goddard and Petrov are providing ready-to-use catalogs, and those
catalogs have many thousands of sources so the need for the combined
catalog is mostly gone.  Plus the remaining non-geodetic sources 
are likely not good VLBI sources.  Producing the combined 
catalog was always a chore for reasons that were rarely forseen.  
I have now retired and no longer will be able to support the combination,
so it has been abandoned.

The latest files from GSFC and Petrov will be kept in {\sl
\$SCHED/catalogs} in files whose names indicate the solution they are
from.  There are symbolic links called sources.gsfc and sources.rfc
which can be used to avoid having to keep up with the release names.
The examples have been converted to use one or the other of these
catalogs.  The GSFC file contains a number of aliases for the popular
sources, so if you want to use familiar names like 3C273 or DA193, use it.  
The RFC catalog just has the J2000 and 1950 names.  The RFC
catalog has far more sources --- over 9000 in the 2015feb version --- so
it may be the more productive place to look for nearby calibrators.
March 2, 2015 Craig Walker

\item While looking at the new source catalogs, I realized that RAERR
has not been conforming to what was described in this manual.  The manual
claimed that the error was in mas of angular error on the sky.  In 
practice, it has been mas, but in coordinate error.  Note that the 
RA coordinate is in time seconds, so the reported error (mas) would need
to be divided by 15 to get the actual coordinate error in the coordinate
units.  To get the angular error from the coordinate error, the value
needs to be divided by cos(dec).  Rather than change the catalogs, the
description of RAERR in the manual was changed to say that it is the
coordinate error in mas.  Feb. 22, 2013 Craig Walker

\item GSFC (David Gordon) is now providing their source data in KEYIN
format which can be used without conversion.  The catalog has multiple
aliases for many of the popular or well known sources.  Feb. 2015
Craig Walker

\item Leonid Petrov has provided his Radio Fundamental Catalog (RFC)
in KEYIN format for some time.  But we have now arranged so that we
no longer make any modifications.  It can be used as sent.  It has
over 9000 sources in the latest version so is a good place to look
for nearby calibrators.  Feb. 2015 Craig Walker

\item We are making corrections to the TLE ephemeris based satellite
tracking to get it to agree with bsp based tracking.  Walter Brisken
is testing and getting advice from Jon D. Giorgini at JPL.  RCW is
adding the code to sattle.f.  Feb. 21, 2015

\item Updating the NAIF software for satellite tracking to version
N0065 from N0056.  This is needed by an upcoming project because some
input files have changed format.  While at it, the GFORTRAN version
of the libraries were generated so now we can build the satellite
capable \schedb with GFORTRAN.  That is likely to become the main
version shortly.  Jan. 23, 2015  RCW and Bruce Rowen.

\item The HTML version of the manual had been derived from the {\sl
schec.tex} latex file using latex2html.  But that program is no
longer supported and has proven problematic to use with the latest
latex code.  Therefore, the manual was modified to work with pdflatex
and htlatex to produce both pdf and HTML versions.  Help for this was
obtained from John Shipman and William Colburn (Schlake) of NRAO.
Completed by Craig Walker, Jan. 22, 2015.

\item Implemented the use of TLE (Two Line Ephemeris) files for
satellite tracking.  This made use of a subroutine much like SATEP
that was provided by Walter Brisken.  Inside SCHED, there is little
difference between using the TLE files and the Spice files (.bsp)
files we have been using for satellites.  The use of a TLE file is
triggered by providing a {\tt TLEFILE} rather than a {\tt SATFILE} in
the SATINI section.  Dec. 9, 2014 RCW.

\item Force MarkIV format setups for disk stations to use TAPEMODE=1.
This means that there is one pass per "head position".  Head position
is a tape, not disk concept.  A Radioastron project somehow had 
tried to use two passes per head position for a MarkIV station.
Dec. 8, 2014.  RCW.

\item There have been changes related to LBA at least in the examples,
maybe more.  This could use documentation.

\item Prevent setting an unused synthesizer to the same frequency
as a used one.  Nov. 12, 2014  RCW.

\item Only allow VDIF or NONE for the format when using DBE=RDBE\_DDC.
Nov. 12, 2014  RCW.

\item Amy Mioduszewski made a pass through the manual updating VLA
items.  She notes that some other systems such at MERLIN could use
similar treatment.  Also she ran a spell checker which hadn't been
done in a while.  Oct. 6, 2014.  Amy M.

\item In the source catalog description of {\tt DRA}, the text said
the angular rate would be larger.  Actually it will be smaller.
Fixed.  Oct. 1, 2014, RCW.

\item Add the stations\_KVN.dat and locations\_KVN.dat to
Master\_ATNF and
cause them to be added to the final catalogs when running Update.  Sep
3, 2014  RCW.

\item Add more explanation to the warning about 40s required for field
system mode changes.  Sep. 3, 2014  RCW

\item Change setups in jvla.key to match standard frequency of 4990.  It
looks like some earlier changes to the LO was not complete, but watch
out for an undocumented reason to use the lower frequencies used to the 
point.  Aug 7, 2014.  RCW

\item Change all use of 5 MHz pulse cals to 1 MHz in the examples.
Only 3 examples affected.  The 5 MHz option adds more noise.
July 7, 2014.

\item Fixed a couple of bugs in the choosing of unused synthesizer 
settings and in the harmonic warnings.  June 19, 2014.  RCW.

\item Starting to add CDAS support.  Only a few hooks so far. 
June 17, 2014  RCW.

\item Add OPTMODE='HIGHEL' to simplify constructing certain kinds of
test observations.  It picks the source with the highest minimum elevation
across the array from a group, designated with new parameter HIGROUP,
of scans, presumably on different sources.  Make associated
example dqhiel.key.  June 17, 2014.  RCW.

\item Fix bug in CHKFIRM error message when DBE and DAR are not compatible.
May 13, 2014  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_11.3}Version 11.3}

\begin{itemize}

\item Planned release of SCHED 11.3 update 1 is April 14, 2014.

\item Prohibit source names that contain characters that the VEX
parsers do not like, including "*".  April 14, 2014  RCW

\item Added script {\sl Legacy\_cksched} that can be used to run all
the {\sl crd} files from the examples through the legacy system's
checker to improve the ability to find problems.  The script needs
to be run from a machine that has access to cksched, such as shire
at the AOC.  April 11, 2014 RCW.

\item Example dq415.key, a VLBA data quality test, was introduced.
This should replace mt506.key eventually, but that has not happened
yet. April 10, 2014.  RCW.

\item A bug in the setting of pcalx frequencies for the VLBA legacy
system was found by operations.  It affected setups with multiple IFs
with different IF sidebands.  In fixing that, another bug was found
that affected frequencies set for the VLBA legacy system channels when
the sideband inversion option was being used (the option that allows
different stations to use different IF sideband but the same BBC
sideband as is required for PFB observations with Green Bank at some
frequencies).  April 10, 2014.  RCW.

\item Planned release date for SCHED 11.3 is April 4, 2014.

\item Modify the criteria by which the Vex routines judge whether 
adequate breaks in the recordings are being provided for media changes.
Larger files are now allowed.  April 4, 2014  Cormac Reynolds.

\item Incorporate the file Release\_instructions into a
{\hyperref[SEC:RELEASE]{manual section of the same name}}.  This is mainly
for the primary \schedb developer.  If you have a morbid interest in 
what is involved, or want to understand why releases don't happen very
often, feel free to browse the section.  April 2, 2014.  RCW.

\item Got the Linux GFORTRAN compilation working again at the AOC, now
without a special compiler.  A recent Redhat upgrade provided the
required compiler update.  Removed configureLinux64gfortranAOC which is
no longer needed.  April 1, 2014  RCW  (not a joke). 

\item Move NEWLOC, the program for creating {\sl locations.dat} from a
geodetic station solution, to the RELATED\_CODE area and add it to
svn.  This means it will be managed with \sched.  March 21, 2014.  RCW.

\item Fix a bug in the selection of frequency file entry to use with
the RDBE\_DDC.  The calculation related to avoiding problems with crossover
frequencies was not correct.   March 21, 2014  RCW

\item Updating some more examples from use of MARK5A to MARK5C at the
VLBA.  Still there are some that are not finished.  March 21, 2014.  RCW.

\item Improve the program (NEWSRC) that updates source catalogs from
the old sources.vlba and new GSFC and Petrov catalogs.  Produced new
Petrov catalog, but waiting for new GSFC solution before updating
everything.  Also moved to the RELATED\_CODE subdirectory and added
to svn so it is managed with \sched.  March 16, 2014  RCW.

\item Warn when multiple phase centers are used with less than 4000
FFT channels.  This could be made much more sophisticated eventually
with a recommended value, but keep it simple for now.  March 6, 2014

\item Cause an abort of \schedb if and S/X project only has one band
in the crd files.  If the missing band is S band as it would normally
be, that will cause no fringes.  March 6, 2014.  RCW.

\item  Changing default selection of setup file channels to use for crd
file channels to ensure all IFs are represented.  Also adjust for only
4 crd channels because BBCs are getting removed from the stations.
March 3, 2014 RCW

\item  Add note in the CORRELATION REQUESTS section of the {\sl .sum} file
to indicate that the project uses multiple phase centers.  This was a
request from the analysts.  Feb. 20, 2014.  RCW

\item  Comment the SETUP lines in the SETUP place holders in the v2d file.
The analysts had been having to delete those.  Feb. 14, 2014.  RCW.

\item  Fix bug in the frequencies for standard setup v6cm-512-8-2-L.set.  It 
had unintended overlapping frequencies.  Feb. 10, 2014  RCW.

\item  Change the behavior of GAP when inserting pointing scans.  Previously,
GAP was set to zero after inserting the pointing, which could allow the
main schedule scans to end up closer together than expected.  Now enforce 
the GAP between the main schedule scans.  This can be important especially
if separate runs are needed for some reason and they need to be kept aligned.
Feb. 9, 2014  RCW.

\item  Check the specified format for the RDBE.  Feb. 4, 2014. RCW

\item  Turn off the warning about MARK5A recording on the VLBA when
no recording is being done.  Jan. 30, 2014.  RCW

\item  Manual description of {\tt NOPEAK} updated to include warning
that {\tt NOPEAK} takes precedence over {\tt PEAK} if both are specified.
Because of the way the parser works, SCHED has no way to tell when this
happens.  Jan 30, 2014.

\item Typo fixed in a warning message that the specified {\tt DBE}
is not consistent with the specified {\tt DAR} for the station.
Jan 27, 2014  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_11.2}Version 11.2}

\begin{itemize}

\item  Released Version 11.2 Update 1 on Jan. 23, 2014  RCW

\item  Typo fixed (spurious comma) that was tolerated by g77 but
not gfortran.  Jan. 23, 2014

\item  Release Version 11.2 on about Jan. 22, 2014.  Note that the
development and beta versions leading to this release were under
the version number 11.1.  RCW.

\item  Deactivate the wrap specifications in the Vex file for all but
the VLBA.  There is concern that some stations may have a partial 
implementation of this feature and could get in trouble, so we are going
to do more testing before actually using it.  Jan. 21, 2014.  RCW.

\item  Give warning and  abort if  a key  file line  is more  than the
maximum of 255 characters after a complaint from a  user.  Jan 21, 2014
RCW

\item Convert the MARK5A setup files for use with the RDBE\_DDC and
other digital backends.  These are the standard setups whose names
start with "v" <band>.  New example {\sl tstsets.key} has been added
to test some of the files.  The setups are sufficiently generic that
they would still work for Mark5A scheduling too.  Many of the old
standard setup files that were too narrow band or otherwise thought to
be uninteresting were deleted.  Still to be done is to provide standard
setups for the RDBE\_DDC in the wideband modes.  Jan 11, 2014.  RCW.

\item Provide more explicit warnings about S band channels out of 
2200-2400 MHz or in the satellite radio range.  Jan. 10, 2014.  RCW.

\item Expand the warning range for one LO being in or near the RF band
for another from 400-1200 MHz IF to 300-1200 MHz after seeing how soft
the IF converter filters are on the low side.  Jan. 10, 2014  RCW.

\item For the VLBA crd files, don't use a setup scan (ie make the main
scan span the whole time since the last scan) when the main scan, but
not the setup scan, would require a wrap.  This is to force the on-line
system to do the wrap when it should, which would it would not have in the
past.  Note that this does not affect recordings since the legacy control
system (crd files) no longer controls any recorders.  For those who really
care about the reasons for this, see the header comments in {\sl wrap.f}. 
Jan 9, 2013.  RCW.

\item Abort if the baseband frequency for the RDBE\_DDC is closer than
half the bandwidth to a crossover frequency or band edge.  Jan. 7, 2014 RCW.

\item Add wrap sector to the {\sl Vex} file.  The allowed sectors are in the
``pointing\_sector'' lines of the \$STATION section for each antenna.  The
name of the sector is given on the station line of the \$SCHED section.
Jan. 7, 2014  RCW.

\item Test release made to developers and made available in-house.  Jan. 2,
2014.  RCW. 

\item Change the limits in warnings from the Vex code from 35 to 40 stations
and from 300 to 1000 sources.  These match number in an email exchange 
of June 26, 2013 that was not implemented at the time.  Jan. 2, 2014.  RCW.

\item Set the default for {\tt DOPINCR} to 15.625 kHz for the RDBE\_DDC and
to 10.0 kHz for non-RDBE systems.  If both are in use, set {\tt DOPINCR} to
250 kHz.  If the RDBE\_PFB is used with {\tt DOPPLER}, abort if DOPINCR
is not given.  {\tt DOPINCR(2)} is required and depends on the
FIRSTLO.  I think using {\tt DOPPLER} with the PFB is a bad idea (32 MHz
tuning steps, which equals the bandwidth) so I did not want put a lot of
effort into trying to figure out a reasonable default {\tt DOPINCR(2)}.
Dec. 28, 2013.  RCW.

\item Cause '{\tt INTENT='NONE'} to clear the list of intents.  Note that
VLA phasing intents that SCHED adds when {\tt VLAMODE=VA} etc are used are
not affected.  Dec. 27, 2013.  RCW.

\item Make {\sl stations\_RDBE.dat} and {\sl freq\_RDBE.dat} the default
files of those types.  Eventually those will be renamed to {\sl stations.dat}
and {\sl freq.dat}.  But the work of changing examples and documentation
is being saved for later.  Dec. 27, 2013.  RCW

\item Warn if MARK5A is requested on the VLBA since most of those
recorders have been removed from the stations.  A significant item
remaining on the to-do list is to convert the remaining MARK5A
examples to the digital systems.  Dec. 27, 2013.  RCW.

\item Prohibit change of DBE for a station for RDBE stations.  The
mechanisms for personality switches are not yet smooth enough to do
in mid experiment.  Dec. 26, 2013.  RCW.

\item The requirement for a setup with the right bandwidth means that
multiple pointing setups are needed for the frequencies at which
reference pointing on lines might be done.  Those are now provided, at
least for the RDBE\_DDC.  Also the automatic pointing scan insertion
has been taught to use the 2 MHz files when {\\tt CALCODE='L'} for the
inserted source.  Dec. 26, 2013.  RCW.

\item The usefulness of the ability to set the bandwidth on a per
scan basis is basically lost with the new systems.  Those systems
require that the sample rate be twice the bandwidth.  They don't support
over sampling.  In principle, SCHED could adjust the sample rate when
a new bandwidth is requested, but the software changes to do this 
looks to be extensive because of the number of places where the sample
rate is used.  Maybe this will be done some day, but not now.  Dec. 22,
2013  RCW.

\item Changing the name of the RDBE system at Effelsberg from 
EB\_VLBA to EB\_RDBE to help avoid confusion concerning their
control systems and other issues.  Dec. 2013  RCW.

\item Make the defaults {\tt MINPAUSE=10} and {\tt PRESTART=0} 
for the DBBC and for an RDBE not under the VLBA control system,
such as at EB\_RDBE.  Dec. 18, 2013  RCW.

\item Enforce sample rate = twice bandwidth for RDBE\_DDC.  This
may mean trouble for schedules that do reference pointing on masers.
Soon I should make {\tt SAMPRATE} an in-line parameter, or force it
based on the input bandwidth.  But not for this release.
Dec. 15, 2013.  RCW

\item Needed to adjust several examples because updated catalog
information from Europe switched stations to new digital backends.
Those have different tuning constraints than the old systems.
Nov. 13, 2013 and later  RCW.

\item Changed TSCAL default in station catalog to 'GAP', indicating
that the station needs gaps between scans for Tsys measurements.
All VLBA stations are set explicitly to 'CONT'.  Nov 12, 2013  RCW.

\item No longer warn when the DDC frequency is not a multiple of
250 kHz as we are no longer concerned about that working, unless
older systems limited to N*10 kHz are used.  The error when the
frequency is not a multiple of 15.625 kHz is still in effect.

\item Point out to users when they mix RDBE and non-RDBE frequency 
and station files.  That is generally a bad idea and has caused 
problems for some observations.  Nov. 5, 2013  RCW.

\item Change the trigger for warning messages about leaving time for
Tsys measurements to include the requirement that TSCAL be 'GAP'.
Nov. 4, 2013. RCW

\item Change the default firmware for the RDBE\_DDC to be VDIF.  While
at it, split the setting of default values of DBE out of CHKFIRM  and
put in a new routine SETFIRM.  Move both those routines to new
places in the calling routines for \schedb logical cleanliness
Oct. 31, 2013.  RCW.

\item Making stations\_RDBE.dat complete raised a conflict between the
RDBE version of the Effelsberg entry from the NRAO maintained portion
of the catalog and the Mark5A version maintained at JIVE.  For the
RDBE, call the station EB\_RDBE with code Er, but expect that to
merged back to EB\_VLBA eventually.  Oct 31, 2013. RCW

\item Getting rid of the old stations\_RDBE.dat for single RDBE
stations.  Renaming stations\_RDBE2.dat to stations\_RDBE.dat since
all VLBA stations now have 2 RDBEs.  Make stations\_RDBE.dat complete
by appending all the non-VLBA station catalog segments.  Oct. 31, 2013
RCW.

\item Update the USNO example n2227.key to the new frequency setup.
Oct 29, 2013  RCW.

\item Make the warnings about self-generated RFI from LO harmonics
less intimidating and a bit more informative.  Oct 25, 2013.  RCW.

\item Improve the scan timing for inserted reference pointing.  Before,
if there was a long gap between scans, the first inserted scan would
start at the beginning of the gap and cover the full time.  Especially
while Mauna Kea is waiting for the source to rise, that could be hours.
The issue had to do with when the final optimization routine call was 
allowed to adjust times and when it was not.  Oct. 24, 2013.  RCW.

\item Fix bug that caused comments to be lost in many circumstances.
Oct. 21, 2013  RCW.

\item Example eg3mm\_rd2 demonstrates the new ability to deal with
reference pointing in the crd files while using the RDBE\_PFB and
without separate Mark5C and Mark5A passes.  Example eg3mm\_rdbe.key
used the separate passes and has been removed.  Oct. 2, 2013.

\item Change egrdbe.key to piggyback.key.  It is the one remaining
example of a file that uses the runsch scheme to get Mark5C and Mark5A
files or recordings.  Oct. 2, 2013  RCW

\item Move peak.cmd to catalogs/Master\_NRAO and set it up to be the
parent of the related files in the catalog directory.  Have Update
write peak.cmd, peak\_RDBE\_PFB.cmd, peak\_RDBE\_DDC.cmd based on the
parent peak.cmd but with altered (with sed) setup file names.  Oct. 2,
2013.  RCW

\item The changes to allow frequency settings different between the
legacy and RDBE systems included setting the legacy system data format
to a reasonable value for the sample rate, independent of user input 
(which would be for the RDBE).  This cured a problem that happened when 
changing bandwidths in some satellite tests.  Note added Oct. 28, 2012
RCW (work done in September).

\item Allow SCHED to make VLBA legacy system (crd) files using
reference pointing on masers using Doppler calibration even when using
the RDBE\_PFB which cannot be tuned.  As part of this, the new input
parameters {\tt CRDDOP, CRDNCH, CRDCH1, CRDFREQ,} and {\tt CRDBW} were
added to control just the crd files and not the main setups.  This an
the item below were a significant code upgrade.  Sept. 30, 2013.  RCW

\item Remove the concept of pcal sets and merge them into the frequency
sets.  There will not be a separate frequency set for each pcal state
used.  This simplifies some program logic and should make eventual
simplification of the Vex code easier.  Sept. 30, 2013.  RCW.

\item Add {\sl Verify\_one} to test one key file in the same way that
Verify tests all of them.  Later added {\tt Newstd\_one} to add one
example's output to the Stdout directory.  RCW Sept. 30, 2013.

\item Removed {\sl manual\_vla.key} - it was for the pre-Widar system.
RCW.

\item Fix synthesizer 2 setting for 2.6 GHz LO entry in
{\sl freq\_RDBE.dat}.  Sep. 4, 2013.  RCW.

\item Release a new Version 11.1 Beta on June 19, 2013  RCW

\item Trap bad IF names coming from freq.dat under some special
circumstances when freq.dat entries cover some, but not all, 
channels.  Also trap errors caused when the vlbasetup stuff tries
to print a blank string.  June 17, 2013.  RCW.

\item Fix frequency error in ptd7ghz.set.  Jun. 11, 2013.  RCW.

\item Update the text in the in the {\tt PREEMPT} section to reflect
the 12 hour shift of when the USNO observations are being made.
June 10, 2013  RCW.

\item Don't allow channels with different bandwidths with the DDC.
Adjust some of the warnings having to do with frequency setting.
Clarify the warning about duplicate channels.   Jun. 6, 2013  RCW.

\item Fixed bug in generation of the VLBA legacy system crd files 
created when scheduling antennas with two RDBEs.  June 4, 2013.  RCW.

\item Removed a couple of continuum sources from the recommended list
in peak.cmd because of recent low flux densities.  May 2013  RCW.
The pointing source list needs to be revisited.

\item Changing the code (RDBELEVT) and documentation to reflect the
shorter set-and-remember time and shorter down-sampling level setting
times on the VLBA.  May 22, 2013.

\item Changed the compiler (FC) in configureLinux64gfortran from a
specific one, newer than the default, needed at the AOC to support 
pgplot to generic gfortran.  Made configureLinux64gfortranAOC to 
retain the AOC specific path to gfortran.  May 10, 2013.  RCW.

\item Released a beta version on April 26, 2013.

\item Reduce TLEVSET in the stations catalogs from 15 to 5 seconds 
for the RDBE reflecting recent changes in the set-and-remember operation.
The VLA still has TLEVSET=60.  April 25, 2013  RCW.

\item Cause the printout that monitors the building of geodetic 
segments to go only to sched.runlog, not to the terminal.
April 10, 2013.

\item Support for the DBBC provided by Cormac Reynolds, April 9, 2013.  
    \begin{itemize}
        \item Basic description of the DDC personality of the DBBC.
        Allows the usual defaulting of BBCs and IFCHANs. {\tt freq.dat}
        entries need to use the new IF names (A[1-4] to D[1-4]). 

        \item Only supports the 10-512 and 512-1024 MHz filters, and
        assumes constraints imposed by the 1024 Msps firmware version (a
        2048 Msps firmware is planned).

        \item Added a `DBBCVER' keyword to the station catalogue to
        discriminate between different DBBC versions (currently `ASTRO',
        `GEO', `HYBRID').

        \item Placeholder support for the PFB personality - should only
        be used for testing. 
    \end{itemize}

\item Default Mark5B track assignments correctly for VSI outputs. This
now follows the BBC$\rightarrow$track mapping given in the ``Mark 5B
User's Manual" (Haystack). Cormac Reynolds, April 9, 2013.

Slightly modified by RCW to prevent changes to the Mark5B track
assignments when using the VLBA. 

\item Significant revision of the LBA catalogues (new telescopes, new
DBBC and Mark5B systems). Updated positions for the ATCA pads. Added
IF/BBC defaulting mechanism for LBADAS and LBADR to allow simplified
setups. Cormac Reynolds, April 9, 2013.

\item Make it an error, not an obscure warning, when someone tries to
assign two polarizations to the same IF.  Yes we observed a schedule
that did that.  April 3, 2013.  RCW.

\item Adjust the correlator resync times for the RDBE/MARK5C systems
go reflect that the media always stops, that it starts at the 
time good data is expected to start, and that correlation does not
take any time to synchronize (no recorded data are lost).  Besides
reflecting actual timeings better, this will prevent inappropriate
warnings from being issued.  April 1, 2013  RCW.

\item Update the SLALIB to version 2.5-4.  This version is under the
GNU license so there should be no licensing issues, although I did 
have permission to use the older version.  Tests show that the positions
of date change by tens of milliarcseconds relative to the old version.
This was traced to changes in the nutation routine nutc.f which contains
more modern theory than the previous version.  For details see the 
comments in that routine.  The new positions are presummably better.
March 28, 2013 with the difference reconciled on Apr. 6, 2013.  RCW.

\item {\tt CORREL=FXCORR} will now cause an abort.  The correlator no
longer exists.  March 26, 2013.  RCW

\item Remove a number of parameters related to the old VLA system
from the manual descriptions of the setup files.  March 25, 2013 RCW.

\item Add VLBA entries in {\sl freq.dat} and {\sl freq\_RDBE.dat} for
S/X that use 7.9 GHz for 4cm.  These have the LO in the RF so are
not considered good.  But the geodesy community is using them.
March 25, 2013  RCW.

\item Implement the ability to set VLBA synthesizer frequencies
to 10 kHz rather than the current 500+-100 MHz in preparation for
the new synthesizers that are still under development.  March 25, 2013,
RCW.

\item Write the synthesizer 1 and 2 settings, regardless of which
is being used, in the comment at the end of the if\_def line in the
VEX file.  This is in support of the new VLBA synthesizers which will
be controlled by the Executor based on information in the VEX file.
March 21, 2013  RCW

\item Write the first LO frequency in the VEX if\_def lines to one
more significant figure to support the new VLBA synthesizer that is
under development.  That synthesizer can be set in 10 kHz steps.
March 20, 2013  RCW

\item Shift frequencies of pt7ghz.set to avoid RFI.  Use different
frequency at BR from other sites.  March 13, 2013  RCW.

\item Add a question about are you using the right station catalog
when a mismatch between the DBE and the DAR are found.  March 8, 2013.

\item The test to warn about overlapping scans that might be intended
to be correlated together got confused when there were empty scans.
Fixed March 8, 2013.

\item Soften the warning about more than 2000 scans if only the
VLBA is being used.  March 1, 2013  RCW.

\item Change read time default of GRABTIME so that GRABTIME(2) can
be set to zero.  As it was, the read default was zero and, if that
was found, the default of 10 seconds was set.  The read default
GRABTIME(1) also changed, but that should have no effect visible to
the user.  Feb. 20, 2013  RCW.

\item Change the defaulting behavior of {\tt GRABTIME} to allow
{\tt GRABTIME(2)} to be zero.  Feb. 2013  RCW.

\end{itemize}


\subsection{\label{SSEC:VER_11.0}Version 11.0}

\begin{itemize}

\item \schedb version 11.0 release.  Jan. 16, 2013. RCW 

\item Add {\tt firmware\_type} to the {\sl VEX} file as comment in the
\$TRACKS section.  It is set to the value of the parameter {\tt DBE}.
Aldo add the setup file parameter {\tt FIRMFILE} for use by VLBA
testers.  It is written as another comment in the \$TRACKS section of
the {\sl VEX} file.  Normally users should ignore {\tt FIRMFILE}.
Feb. 13, 2013.

\item The accounting for Gbytes recorded did not stop accumulating
for non recording scans.  Fixed.  Feb 13, 2013.  RCW.

\item A sched\_temp version released for local testing on Feb. 10, 
2013.  RCW.

\item Extend the flags for slewing to one second before START
- PRESTART and to one half second after TONSRC.  There were
rounding issues of some sort and, with the switch to PRESTART=0
for the VLBA and VLA wideband systems, many flags had zero 
length.  Note that start times, good-data times, and flag times
are all only given to the integer second, while the START and
TONSRC times can be fractional seconds --- one may be converted
from LST and the other is based on a slew calculation.  Feb. 10,
2013.  RCW.

\item User scan comments are now shown in the summary file.
Feb. 9, 2013.  RCW.

\item Created example rdbepfb.key that is a simple 6cm example using
the RDBE with the PFB personality.  The setup is one of the new
standard setups. Feb. 9, 2013.  RCW.

\item Added parameter {\tt WRAP24} to assist in dynamic scheduling
of 24 hour projects.  {\tt WRAP24} duplicates the schedule, causing
a 24 hour project to look like a 48 hour project.  Then {\tt DOSCANS}
can be used to select the desired 24 hours.  Feb. 9, 2013.

\item Modified the disk use calculation for the VLBA and VLA wideband,
MARK5C system to reflect the fact that they don't start recording
until the data-good time in the {\sl VEX} file rather than the
specified media start time that has been used by previous systems.
The calculation for the MARK5A and other systems still depends on the
start time.  Note that the media start time is the nominal scan start
time minus {\tt PRESTART} and is the uncommented start time in the
{\sl VEX} file.  Feb. 9, 2013  RCW.

\item Removed the special source list in a format for the old correlator
data base from the {\sl .sum} file.  Also remove the list of 
correlation blocks required by setup changes, which was also an
old VLBA correlator issue only.  Feb. 4, 2013  RCW.

\item Upped the version number to 11.0 given the number of changes
and the time since the last full release (10.2).  But it is still
a development version.  Feb. 3, 2013,  RCW.

\item While adding scan counts etc for the ``EXTRA'' scans, (see next
item) many format changes were made in the .sum file.  Anyone parsing
this file automatically should check their code.  As a human, rather
than machine, readable file, the format is subject to changes.
Feb. 3, 2013 RCW.

\item Adding the ability of the user to specify optional ``EXTRA''
scans at the ends of projects to help fill gaps using the {\tt
PREEMPT} parameter.  Feb. 3, 2013 RCW

\item Change the note that is written by the Doppler routine when
it is forced to set two channels to the same frequency because they
are opposite sidebands from the same BBC.  It looked too much like an 
error message rather than an informational note and worried a user.
Feb. 1, 2013  RCW.

\item The parameter PRESCAN no longer did as advertised in that it
could end up being applied more than once because some scan time
setting routines get called more than once.  Fix the situation and
modify the documentation to indicate the use of PRESCAN to shift
a scan relative to the data ready time.  Jan 30, 2013.  RCW.

\item Change the defaults for {\tt PRESTART} and {\tt MINPAUSE} so
that they continue to be 5 and 10 sec respectively unless all of
the stations are VLBA/RDBE or VEX/WIDER CONTROL/DAR.  In those
cases, make them zero as those systems always stop and only pay
attention to the data good time in the Vex file.  Jan 29, 2013  RCW.

\item Prohibit VLA phasing and reference pointing in the same scan.
Jan. 23, 2013. RCW.

\item Release a version to {\sl sched\_temp} for testing by others.  
Jan. 23, 2013. RCW.

\item Removing the routine that tried to adjust the freq.dat frequency
ranges for the RDBE.  With freq\_RDBE.dat available, it is not useful,
and is improperly changing some entries.  Jan. 21, 2013.  RCW.

\item Changed behavior of setting the start time with dwell scheduling
when the first scans of the project contain subsets of antennas.  Now
all antenna groups start at the start time of the first scan, where
before they tended to start in sequence.  The change was driven by the
need for ``Dummy'' scans at the start of VLA schedules.  A special
case needed to be added in the code to not revert to scan 1 needed to
be added for use by the scheme for adding DELZN sections.  Jan. 23,
2012. RCW.

\item Standard setups for the RDBE PFB personality added for 6cm and 
higher frequencies.  Jan. 23, 2013. RCW.  Later added 20 and 13 cm.

\item Starting to implement support for the DBBC.  Jan. 20, 2013.

\item Release a version to {\sl sched\_temp} for testing by others.  
Jan. 19, 2013. RCW.

\item Add a flag for latex2html to cause nodes to have names based on the
section titles.  These can then be referenced from outside the manual.
Jan. 19, 2013

\item Add reference pointing {\tt INTENTs} for stations other than the
VLA (they were added for the VLA previously).  See the description
of the {\tt PEAK} command for more details.    Jan. 18, 2013

\item Creating example hsaddc.key which will be a primary example for
VLBA and HSA observations with the RDBE with DDC personality.  It 
demonstrates VLA phasing and reference pointing on all 3 instruments.
In setting up the VLBA pointing at 3mm, it also uses resetting of
bandwidths and Doppler tracking.  The comments in the file provide
much advice on setting up such observations.  Jan. 17, 2013.

\item Add ptdxxx.set pointing setup files for use with the RDBE/DDC.
While at it, get rid of the ptvxxx.set pointing setup files that I do not
believe are needed.  Jan. 17, 2013.  RCW

\item Add a couple of GBT and many EB entries to freq\_RDBE.dat.  Jan. 17, 2013

\item Add headers to the source files and fix some solution names, 
especially in sources.vlba.  Jan. 15, 2013.

\item Set up for use of VLA band names for the VLA.  Jan. 15, 2013.

\item Control VLA reference pointing through the use of {\tt VLAPEAK} and 
{\tt INTENTs}.  Jan. 2013 ongoing  RCW.

\item Control VLA phasing through the use of {\tt VLAMODE} and {\tt INTENTs}
Jan. 2013  RCW

\item Add parameter {\tt VLAPTIME} and the resulting INTENT in the VEX file.
This is the VLA phasing subscan length.  Check that the scan length is
at least 4 times that length and that the subscan length is over 10s. 
Jan. 4, 2013.

\item Fix bug where the stop year was used in the VEX file {tt
\$SCHED} section for the start time of a scan.  If the scan crossed
the year boundary, this created havoc later.  Jan 2, 2013 RCW.

\item Add warning if it looks like scans that are meant to be correlated
with each other are being scheduled separately.  That was ok with log
driven correlators, but not VEX driven correlators.  Dec. 27, 2012. RCW

\item Warn when harmonics of the front end synthesizers can beat with
each other and cause internal RFI.  Also make the choice of frequency
for the unused synthesizers much more sophisticated to try to avoid
such harmonics.  Dec. 27, 2012  RCW

\item Added FE etc output to the if\_def lines of the VEX file for
stations other than the VLBA.  Require FE be specified for the VLA.
Dec. 13, 2012.  RCW.

\item For the RDBE/DDC, change some comments and the manual about the
allowed bandwidths and frequencies.  Encourage the use of multiples
of 250 kHz.  Update egddc.key.  Dec. 13, 2012.  RCW.

\item Add "DISK" as a valid option to CORTAPE.  Dec. 7, 2012.  RCW.

\item Fix link to wrong file for egrdbe2.key in list of examples in
this manual.  Dec 7, 2012  RCW.

\item Fix issue with selecting a legacy BBC frequency when the RDBE
baseband frequency is 1008.00.  Previously 1000.00 was chosen, but
the output format to the crd file did not have enough digits.  Changed
to subtract a multiple of 5 MHz to prevent going above 999.99.
Dec 6, 2012. RCW.

\item Support for the dual RDBE option at the VLBA antennas added.
Nov. 8, 2012  RCW.

\item Made a BETA release on Nov. 5, 2012  RCW

\item Add antenna catalog parameter TLEVSET which attempts to allow
time for the set-and-remember operation the first time a setup is seen
on the VLBA (RDBE) or VLA.  Populate the catalog with those values.
Nov. 05, 2012.  RCW.

\item Remove the VLA from the examples egglobal.key and hsa21cm.key, both
of which use the legacy system which is not supported on the VLA.  Switch
manual\_1.key to the RDBE/DDC + WIDAR systems.  Replace VLA1 with GBT\_VLBA
in manual\_2.key.  Nov. 1, 2012.  RCW.

\item Added vladdc.key as an example of observing with the VLBA, GBT, 
and VLA using the DDC personality of the RDBE.  Oct. 31, 2012.  RCW

\item For optmode SCANS (used for pointing) using the scheme for 
skipping some scans in less interesting elevation ranges, set so 
that the first scan for each source is taken.  Oct. 31, 2012.

\item Make example jvla.key be for a VLBA RDBE/PFB vs 4 channel WIDAR setup.
Oct. 28, 2012.  RCW.

\item Add checking for violations of the setup file constraints imposed
by the WIDAR correlator phased array system.  Oct 27, 2012.  RCW

\item Add a warning if the scan gaps using the RDBE are inadequate for
level setting.  Oct 24, 2012.  RCW.

\item Fix and array overflow when listing the setups used for each source
when there are lots of such setups.  This was found trying to do 3mm 
wideband observations.  Oct. 23, 2012.  RCW.

\item Calculate the best settings for the unset front end synthesizers
to avoid birdies from beats of harmonics of the different synthesizers.
Such birdies turned up strongly in the RFI tests with the new C band
receiver.  The optimum settings depend on the frequencies of the
synthesizers in use so no one simple choice works.  Oct. 22, 2012.  RCW.

\item Beta version to be released Sept. 20, 2012 to get the changes
below into the system.  RCW.

\item For the crd files written for RDBE/Mark5C observations, offset
the LO frequencies by 10 kHz for better pulse cal detection.  Also
change from format='none' to a reasonable recording type format so
that the formatter will be configured, which is required for pulse
cal detection.  Sept 20, 2012.  RCW.

\item Beta version to be released around Sept. 12, 2012.

\item Fix bug in the VEX code where the if\_def comments needed by the
new VLBA on-line code were not written if the first station using the
IF was not VLBA station.  Now separate if\_def lines are written for
VLBA and non-VLBA stations.  Sept. 10, 2012  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_10.2}Version 10.2}

Version 10.2 was released near July 11, 2012.  It mainly provides
support for the new wide C band receiver and switch control systems on
the VLBA, improved support for the new wide bandwidth backends and
recorders, and initial support for VLBI at the VLA/WIDAR.

\begin{itemize}

%  Remove the old VLA parameters from the code and manual.  Too much
%  work to do before the next beta release.

%  Put in spectral zoom.
%  Put GST in some sched output file (sch file?)

\item Add support for R1002 digital back-end used at KVAZAR stations
(Svetloe, Badary, Zelenchuk) July 11, 2012. DMS

\item Update source catalogs to RFC2012b and GSFC2011b.  RCW  July 4, 2012.

\item Make a beta version June 25, 1012  RCW.

\item Remove PTLINK parameter and example.  Jun 19, 2012. RCW

\item Remove the EVLA parameter.  The EVLA is now being handled more
like a normal station.  Jun 19, 2012.  RCW.

\item When EXIT requested, shut down normally rather than aborting
for no scans given.  Jun 16, 2012  RCW.

\item Add all the C band options for the new receiver to freq.dat
so that we don't have to use freq\_RDBE.dat when scheduling with the
old system.  {\sl \$SCHED/RELATED\_CODE/MAKEFREQ/makefq\_c.f} can make the
list.  The choice of new or old systems is hardcoded, but easy to
change in this program that will likely only get used once. 
May 6, 2012 RCW.

\item Add CORDFMT to request Mark4 output files from the correlator.
The default is to request FITS output.  June 4, 2012, RCW.

\item Change the {\sl .v2d} file to the {\sl .tv2d} file.  These files
are not the final one used for correlation and we had too many cases
where a rerun of SCHED would clobber the hand modified version.  So
now, the file should be renamed before hand editing.  May 31, 2012.  RCW.

\item Add a warning if the LO for one channel is going to be in the
IF for another.  The scheme used does not recognize possible odd cases
if we ever get receivers with multiple first LOs in the receivers,
but will work for the main current case of the wide C band receivers 
or for the wide RCP option at X band.  May 22, 2012  RCW.

\item Make it possible to schedule the VLA for VLBI.  Much old VLA
code was removed or bypassed.  It is now expected that the VLA will be
scheduled by way of the VEX file.  May 16, 2012. RCW

\item Add INTENTs to sched input and to VEX output.  SCHED treats these
as character strings and does not attempt to parse them, at least not 
yet.  They can be used to tell observing, correlation, and post processing
systems of the intended use of the scans.  May 07, 2012.  RCW

\item Fix Vex Freq naming convention to allow for 3 digit bandwidth for
the RDBE/DDC 128 MHz option.  May 7, 2012.

\item Make a beta release May 4, 2012 RCW.

\item Change maximum DDC bandwidth to 128 MHz.  Before May 3, 2012. RCW.

\item Make lists of stations in the Vex file work when there are 
large numbers of stations.  The MODE lines will just get long, which
is ok because each station is a parsable token.  The comment lines
with various other definitions are a single such token and are limited
to 128 characters, so they overflow into multiple lines if needed.
Apr 27, 2012.

\item Fix bug when warning about two pointing centers using the same 
list of phase centers.  A line break in a write to a character string
caused overwrite of the next string.  April 27, 2012.

\item Add elevation of skipped scan when scheduling one station at
a time.  Meant for pointing observations when there is a question
about why too many scans are being skipped.  April 23, 2012  RCW.

\item Improve the checks on bandwidths and frequency settings for the
DDC personality.  April 19, 2012. RCW

\item When the IF sideband is lower, set the synthesizer frequency
in the crd file to negative.  This is the ruse we are using to convey
the IF sideband information to the VME on-line system at the VLBA
sites.  Previously, it could always be figured out from the band
name and synthesizer setting.  But the new 6cm (4-8 GHz) receivers
have made it possible for the sideband to be ambiguous.  April 16, 2012
RCW.

\item When making a RDBE schedule, the pulse cal tone detection for
the artificial channels created for the VLBA old backend was being 
set up for the wrong frequencies in some cases (lower sideband IF).
Fixed.  March 11, 2012.  RCW.

\item There were some issues with the wrap calculation when different
antennas were scheduled separately.  Fixed, I hope.  April 5, 2012.

\item The DDC will use frequencies that require more digits than the 
usual 10kHz steps.  In the output files, make the number of digits
sensitive to the number required.  March 2012 RCW

\item Fixed a rarely encountered bug when making optimized schedules when
they stopped on the first scan of a particular planet or satellite.
Found in a pointing run.  March 2012  RCW

\end{itemize}




\section{\label{SSEC:OLDRELEASE}Old Releases}


\subsection{\label{SSEC:VER_10.1}Version 10.1}

This version was released on or about Feb. 14, 2012.  It addresses a number 
of issues related to the new wideband system on the VLBA.

\begin{itemize}

\item Add example 
{\href{examples/eg3mm\_rdbe.key}{{\sl eg3mm\_rdbe.key}}}
that shows how to schedule reference pointing while doing RDBE\_PFB observations
where the RDBE cannot be told to use the Doppler frequencies and narrow 
bandwidths needed for reference pointing.  This involved adding the catalog files
{\sl sources\_RDBE\_PFB.pointing} and {\sl peak\_RDBE.cmd} which are very 
similar to {\sl sources.pointing} and {\sl peak.cmd} but set up for use when
making the RDBE schedule (VEX file).  Feb. 14, 2012.  RCW.

\item Add warning if requesting more than 0.5 MHz per spectral channel
if correlating in Socorro.  That puts the  data at some risk of smearing
when correlated with a priori clocks.  Feb. 10, 2012.

\item Add ASC (Astro Space Center - Moscow) to the allowed correlators.
That correlator is used for Radioastron data.  Feb. 10, 2012  RCW.

\item Beta version released near Feb. 7, 2012  RCW

\item Tweak egrdbe.key and egrdbe2.key to make them more useful for
users.  Also work on the wideband part of the manual.  Feb. 7, 2012.

\item Increase number of digits on RA and Dec in multiple phase centers
in the v2d output at request of Adam Deller.  Feb. 6, 2012 RCW.

\item Deal with cases of multiple pcenters input groups.  Also warn when
a centers group is not found.  Fix bug when testing for multiple centers
on a phase center.  Feb. 1, 2012  RCW.

\item Some pointing schedules driven from the scripts using the optimization
mode that takes scans that are up were passing up a lot of good scans at the
start.  Itcatalogs/sources.gsfc2011b turns out that this was because the estimated start time of
the first scan was changing too much until a scan was finally kept and 
sources that were actually up were flagged as down.  Fixed Jan. 31, 2012.  RCW

\item Allow 1040MHz BBC for RDBE\_PFB so it is possible to schedule
single polarization runs that span the full IF bandwidth.  Warn
of likely corruption of data in that channel.  If sideband inversion
is being used, the 528 channel will also be needed so allow that too,
but warn that the on-line system will change it to 1040.  Correlation
will happen as if it is 1040, so don't expect fringes.  Jan. 4, 2012 RCW.

\item Make it possible to write Vex files for pointing observations on
the VLBA.  This required providing a FORMAT in the schedules and
getting around some tests against non-recording projects in the Vex
and regular code.  A future enhancement will be to allow FORMAT=NONE
for non-recording observations and to provide some way to specify
pointing patterns in Vex.  The immediate need is driven by the
transfer of control of all switches on the VLBA antennas to the new
control system which was originally meant to control the RDBE and
Mark5C but will eventually control everything.  The new control system
works from the Vex files and must control the switches for all
observing, including pointing type single dish tests.  This item
also includes adding the {\sl ptv...} setup file for pointing with
a FORMAT assigned.  Nov. 15, 2011. RCW

\item Make new source catalogs sources.vlba.2011nov, sources.rfc2011d,
and sources.gsfc2011a based on the Goddard 2011a\_astro and Petrov
2011d solutions.  Provide symbolic links sources.vlba, sources.Petrov,
and sources.GSFC so schedules don't have to be kept up to date with
last release.  See the top lines of any of those files for details of
how they differ.  Users should think about which they wish to use
which is why sources.vlba is no longer there except temporarily as a
link to the previous catalog.  Nov. 11, 2011 RCW

\item Fix an oversight in the Vex code where two FREQ blocks could
be considered the same if everything except the net sideband matches.
We actually had a test schedule involving sideband inversion at the
GBT that had just such a situation, when the FREQ blocks should
not have been condsidered to be the same.  Nov. 8, 2011  RCW.

\item Fix a bug where, if there were no periods ok for preemption,
an array element with subscript 0 was accessed.  The SUN version
did not like that and crashed.  Nov. 3, 2011.  RCW

\item When using the frequency catalog to find a good first LO etc
when using the RDBE, discourage choices that will cause baseband 
channels to include a crossover point.  This should help get settings
for which the 32 MHz channels with the PFB are at the right place, 
even when there are both upper and lower sideband first LO choices.
It also helps get the right LO setting when the DDC is used.  Nov. 3,
2011.  RCW.

\item Add warning when the first scan crosses midnight and there might
be confusion about DAY, MONTH, and YEAR applying to the stop time.
Nov. 2, 2011  RCW.

\item Add support for the new VLBA 4-8 GHz receiver.  Very many
frequency options were added to freq\_RDBE.dat to support the 4 channel
IF converter.  The use of any of the 4 IFs was added to the checking
routines, although the total number is still limited to 2 for now.
Example egcwide.key was added to exercise this system.  This will still
be called the 6cm band.  Nov. 1, 2011 RCW.

\item For RDBE/PFB observations where the sideband in the RDBE
must be lower, allow for the fact that the DiFX correlator can invert
the sideband.  This is done in the code by the program that checks
the setups for the RDBE/PFB.  If an upper sideband is found, it is
converted to lower with appropriate LO and sideband changes.
Some bugs were revealed in the VEX new mode section,
some of which were fixed, but not all yet.  Oct. 16, 2011  RCW

\item Make freq\_RDBE.dat with frequency bands adjusted for 512-1024 MHz.
This now has the VLBA and GBT and one fake EB entry.  More will be 
needed.  Oct. 12, 2011  RCW.

\item Fix the hsa1cm.key file for some setup errors recently identified
in the ongoing observations.  Oct. 11, 2011  RCW.

\item Rationalize the DSN stations in the catalogs.  Move to the DSS
names as much as possible, consistent with the positions from the 
geodetic solutions.  This might break old key files. Oct. 11, 2011  RCW

\item Update the locations catalog to gsfc2011a.  Oct. 16, 2011  RCW

\item Add BEGIN and END to locations catalog inputs to deal with time
ranges for episodic motion.  Set up the format translators from 
geodetic solutions to provide those numbers.  Discontinue the use
of DBCODE and AXISTYPE in the locations file (AXISTYPE is in the
stations catalog) and DBCODE is not used.  Oct. 5, 2011 RCW

\item Remove use of RCWINCLUDE with verbatiminput to include examples
in the manual and simplify the update and release process.  Sept. 26, 2011
RCW.

\item Only announce fits being skipped in geodetic segment if GEOPRT=1 or
higher.  Sept 21, 2011.

\item Improve the {\sl PGPLOT} distribution included with \sched.  This is
mainly improving the organization and instructions.  Also it involved 
some changes in the scripts that build the makefile for \sched.
RCW  Sept 24, 2011.

\end {itemize}


\subsection{\label{SSEC:VER_10.0}Version 10.0}

\begin{itemize}

\item Add eg24.key to demonstrate putting comments in 24 hour schedules
to help the people doing the dynamic scheduling choose alternate 
start points, shifting scans before that point to the end of the schedule
(wrap).  RCW  Sept. 18, 2011.

\item Make changes in Vex code and catalogs to support Mark5B better
on the EVN.  Des Small Sep. 2011.

\item Add the maximum settling time for stations in a pointing group
to the interval between pointing scans when doing 
{\hyperref[MP:AUTOPEAK]{{\tt AUTOPEAK}}}.  This was related to a 
request from Krichbaum in early 2011.  Sep. 16, 2011  RCW.

\item Add parameter {\tt PREEMPT} to allow the user to protect certain
scans from preemption of PT and MK for EOP observations. For details,
see the section on 
{\hyperref[MP:PREEMPT]{{\tt PREEMPT}}}.

\item Add to the VEX if\_def lines information about the receiver, the
LO to the receiver (as opposed to the IF converter), and the 50cm
filter.  These are required for the new control system to set the
switches on the VLBA antenna.  Using a comment is a kludge, but VEX
has no place for the information.  Sept. 8, 2011.

\item Add entries for the K band 7 feed receiver at the GBT.  Also 
change all the other receivers to the A,C IFs.  Aug. 15, 2011  RCW.

\item Allow the 528 MHz BBC setting for the PFB personality of the
RDBE.  It will produce poor data, but is needed to get 16 unique
channels in one polarization as per user request.  Aug. 12, 2011  RCW.

\item Make sources in phase centers not case sensitive.  July 22, 2011 RCW.

\item Include a {\sl PGPLOT} distribution with \sched.  
This is still somewhat of a work in progress.  July 20, 2011. RCW.

\item Improve the logic for the printing of frequency sets and
especially the printing of sets used for each source.  July 19, 2011 RCW.

\item Avoid problems with printing the {\sl .sum} file when there are
too many setups.  July 19, 2011 RCW.

\item Fix flush.f (FLUXH) to backup over the EOF once it has read to the
end of file.  GFORTRAN 4.6 was getting a run time crash.  Reported by
Leonid Petrov.  June 16, 2011.  RCW.

\item Make various changes to the code that generates the DELZN segments
to work better when there are only 2 stations and when there are a large
number of scans.  mid June, 2011. RCW.

\item Add pointers in the frequency sets and source summaries in the {\sl .sum}
file so that it is possible to relate a source to a frequency.  Useful when
trying to see what {\tt DOPPLER} has selected for frequencies when there are
several sources.  May 17, 2011 RCW.

\item Add some GBT setups that match the IF range (possibly with inverted
sideband) with the VLBA to facilitate RDBE PFB runs.  May 2, 2011  RCW

\item Change manual to correct the default PRESTART from 0 to 5 seconds
reflecting recent code changes.  April 1, 2011.  RCW.

\item Upcase the name of a pointing center group so there aren't
case sensitivities in the selection of such groups.  Mar. 18, 2011  RCW.

\item Cause the .sch file to be written when geodetic segments are
requested.  This makes it easy to reproduce segments created when
they are desired in another segement, such as when making files to
test new backends.  The change in frequencies can cause freshly
created segments to be different due to the frequency dependent flagging
of sources close to the Sun.  March 16, 2011  RCW.

\item  Modify the calculations of the pointing offsets due to rotation
changes for ROT patterns.  Those calculations had been based on
incorrect rotation positions.  Feb. 22, 2011  RCW.  Later made some
corrections to the accounting for the circular feed circle.  The
errors had been causing problems with rotation patterns at lower
frequencies.  July 2011  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_9.4}Version 9.4}

This version brings in many new capabilities including support for
multiple phase centers on the DiFX correlator, automatic insertion
of geodetic segments (DELZN), enhancement to {\tt DWELL} to allow
scans to start before the slowest antennas arrive, and support for
the new wideband hardware (RDBE and Mark5C with hooks for the DBBC).
The release will likely be on Jan. 14, 2011.

\begin{itemize}

\item When using the RDBE/MARK5C, make it optional to have the crd
files provide the commands needed for parallel VLBA DAR/MARK5A recordings.
The switch is DOMKA (read DO-MARK5A).  This is expected to be of use
mainly for testing.  A tricky part of this was making the pulse cal
tone detection commands come out right when recording only the center
RDBE channels and only the center part of the bandwidth of each RDBE
channel.  Jan. 11, 2011.  RCW.

\item Doing more to remove the need to match formats, and specifically
track bit rates, at different stations.  Now, for VLBA (non RDBE) and
MKIV formats, the smallest possible fan out will be chosen consistent
with the formatter track bit rate limitations.  This will mean that
many projects will see a reduction in the fan out used.  This should
not be an issue in the disk/DiFX era.  Jan. 7, 2010  RCW.

\item Removing more bits of residual code related to tape.  SETSPD is
gone.  Also removing some items related to the VLBA hardware
correlator, which is now off.  OKMODES is gone.  Jan. 7, 2011 RCW.

\item Change MINPAUSE usage so that it does not get multiplied by the
speedup factor.  The speedup factor concept is mainly for the old
VLBA hardware correlator and no longer makes much sense so it will be
removed soon.  Jan. 7, 2011  RCW.

\item Add examples for use of the RDBE/MARK5C wideband system.  They are
{\sl egrdbe.key} for the PFB personality and {\sl egddc} for the DDC
personality.  Jan. 6, 2011 RCW.

\item The Vex definition calls for the epoch related to site motions
({\tt site\_position\_epoch}) to be given in a date format like
2000y001d, but \schedb has been using the MJD.  A line giving the date
in the approved format has been added, but as a comment.  We need to
get all reading programs that want the MJD to understand the approved
format before switching.  Jan. 5, 2011 RCW.

\item Add checking of setup parameters for RDBE PFB and DDC personalities.
Dec. 30, 2010  RCW

\item Make a few changes to the {\sl v2d} file to make them more
useful for operations.  Dec. 22, 2010  RCW.

\item Wrap {\tt NOTES}, {\tt CORNOTES}, and {\tt COMMENTS} that
overflow the 128 character limit in the Vex file.  They were capable of
generating lines long enough to crash the parsers.  Nov. 21, 2010 RCW.

\item Update source and station location tables.  The standard
sources.vlba now has the sources from the GSFC 2010a\_astro solution
plus additional sources from the Petrov rfc2010c solution and a few
JVAS, VLA and other sources for a total of 5776.  There is also a file
with just the Petrov solution sources - 5198 of them.  The station
locations are based on the GSFC 2010a solution.  Many of the old
mobile VLBI sites have been removed.  Dec. 5, 2010.  RCW.

\item Add flux density data (inputs {\tt FLUX} and {\tt FLUXREF}) to
the source catalog.  Rebuild the catalog to include such information
obtained with the Petrov 2010c release.  So far \schedb does not use
that information, but the option to do so in the future is now there.
Nov. 10, 2010.  RCW.

\item Tweak the way scan timing is handled.  This will provide slightly
improved slew calculations.  One impact is that new schedules can have
scan times that differ from old ones made from the same input file
by and amount that accumulates at a rate of a second or two per scan.
Oct. 2010  RCW.

\item Added second and third arguments to 
{\hyperref[MP:DWELL]{{\tt DWELL}}}
to instruct \schedb not to wait for some number of
antennas.  The second argument says how many antennas to not wait for
while the third gives a minimum integration time for those last antennas.
Adding this capability triggered a considerable reworking of the code
related to scan timing and geometric calculations.  The code is somewhat
cleaner now.  \schedb now removes a station from a scan if the slew is
so long it will not get there before the end.  An exception is for
scans that trigger an azimuth wrap for ALTAZ antennas.  It was found
that, if those scans were dropped, the antenna could get stuck observing
only one source for a while in a phase referencing situation when one
source needs the wrap before the other.  A ``W'' flag was added to the
``UP'' flags to indicate a scan where the antenna will not get to the
source.  Oct-Dec, 2010.  RCW.

\item Increase the number of allowed aliases for source names from
5 to 10.  Sept. 30, 2010.  RCW.

\item Released a beta version on Sept. 27, 2010.  RCW

\item Add axis offsets to the station location parameters shown
in the summary file.  Also add warning if the axis offset is zero
as that is a likely indication that the station locations come
from an inaccurate source and might not be adequate for correlation.
Aug. 19, 2010  RCW.

\item Add the time and date that SCHED was run to the very end of
the summary file.  Note that this will cause there to always
be a two line difference when the Verify script runs the examples
and compares them to standard output.  July 29, 2010  RCW.

\item Removing some tape stuff, including full routines CHKV4REC,
CHKVREC, CHK4REC, CRDNRAO, EGMK2, INDXHEAD, SCHTAPE, SNAP, TAPELFAG,
TPAUTO, TPINI, tpinit.inc, TPMK2, TPPACK, TPREV, TPS2, TPSCH, TPTAPE,
TSYNC, VLBACHG, VLBAEND, VLBATI, VLBATP, VXSCH, VXSCHK and much code
in other routines.  Also removing obsolete output control file formats
SNAP and NRAO.  VLA should go soon as that moves to VEX.  Remove Vex
routines VXSCH, VXSCHK, and modify VXWRPO to remove calls to routines
being eliminated.  Remove the Mark 2 example.  The tapeini section
concept is also removed.  Any TAPEINI section in an input file will
cause \schedb to die.  The end of an era!  But residual tape stuff,
like tracks, cannot be completely removed until Mark5A is gone as
it is a tape emulator.  July 20-23, 2010.  RCW

\item Released a beta version July 19, 2010.  RCW

\item Prevent recording on the Mark5A when FORMAT=NONE for equipment
controlled by the crd files.  Part of the transition to the digital
backends. July 19, 2010. RCW.

\item Write VEX files that describe observations with the RDBE and
Mark5C.  These files are usable for correlation and for the parts of
the telescope system that control the new hardware when running with
the RDBE and Mark5C.  Track assignments are given for Mark5B format
which is what is now used.  Checking is still minimal.  The number of
channels, and properties of the channels should be set appropriate for
the RDBE including frequency settings above 1000 that are not allowed
with the BBCs, but occur with the RDBE.  High channel bandwidths and
sample rates are allowed.

When writing files for the RDBE, the crd files, which control the old
formatter and BBCs, are using FORMAT=NONE so they cannot be used for
recording on the old system.  The internal structure of \schedb would
make it difficult to write both crd files appropriate for the old
backend and Mark5A and RDBE/Mark5C files at the same time.  If
parallel recording is desired, a Mark5A schedule should be written to
control the old hardware and a RDBE/Mark5C schdule should be written
to control that hardware.  Both VEX files will be needed for
correlation.  When writing RDBE/Mark5C schedules, the crd files are
adjusted to set the BBC's to match the RDBE baseband channels as well
as can be done (max freq 1000, max bandwidth 16 MHz, max samplerate 32
MHz).  These BBC settings may be useful for monitor data such as Tsys.
about July 7, 2010.  RCW

\item Implement automatic insertion of geodetic segments, including
parameters {\tt GEOSEG}, {\tt GEOSRCS}, and {\tt GEOPRT}.  There is a
sample schedule egdelzn.key in the examples area.  Infrastructure by
June 1, 2010.  Tweaking algorithm until at least Sept. 27, 2010. RCW.

\item Give CORCHAN a second argument to use for the FFT size.
May 14, 2010.

\item Implement and document multiple phase center specification
for use of that capability on the DiFX correlator.  May 12, 2010. RCW.

\item Update the list in the manual of examples.  May 12, 2010  RCW

\item Make the accounting of scan and baseline time for each
source in the summary file separate for each setup file.
May 5, 2010  RCW.

\item Added {\tt SRCFILE2} to allow a second external source
catalog. This is a step toward supporting multiple phase centers.
May 4, 2010  RCW.

\item Write a template {\sl .v2d} output file to aid in setup for DiFX
correlation.  This is also a step toward support for multiple phase
centers.  May 4, 2010 RCW.

\item  Install the results of measurements of slew rates of VLBA
antennas.  See VLBA Test Memo 70.  They are somewhat slower than
the previously advertised values.  April 30, 2010. RCW

\item  Change default prestart to 5 seconds.  The correlator doesn't
need time to sync up now, but the Mark5A units need about that long
to get going after they are commanded to do so at the stations.  This
will change again with Mark5C.  April 28, 2010  RCW.

\item  Drop trailing blanks for comments written to the VEX file.
DRUDG was having problems.  There will still be problems if someone
uses all 128 allowed characters.  I don't yet know the upper limit.
April 15, 2010  RCW.

\item  Add a bit of tolerance in the check of whether antennas get
to source late.  Round off errors were causing spurious warnings.
April 12, 2010  RCW.

\item  Bug fix for finding right freq.dat entry.  This affected SUN
computers and the binary for the sun version of 9.3 was replaces.
Apr. 8, 2010.  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_9.3}Version 9.3}

This version corrects an error in the reference dates in the
locations.dat file.  There are also some code updates and more
configure scripts for gfortran on Linux.
Version 9.3 was released on March 23, 2010.

\begin{itemize}

\item Add K5 and VERA as allow values for DAR and RECORDER in the
stations catalog.  Add MARK5B as an allowed value for DISK.  \schedb
doesn't actually do anything with these yet.  It just doesn't die
if they are there.  March 25, 2010  RCW.

\item Restrict the cases where the warning for excessive recording
scans is issued to cases where the MARK5A recording system is in use.
The LBA explicitly does not want it.  March 25, 2010.  Cormac Reynolds
and RCW.

\item The CELLS optimization routine is in a state of development so
use at your own risk.  I don't think anyone else is using it so I don't
think this should cause trouble, but I'm leaving this note just in case.
March 25, 2010  RCW.

\item Fixed bug apparent when not all stations have the same epoch for
their station position rates.  When building the table of adjusted positions,
it was using the reference date from the last station.  RCW Mar 23, 2010.

\item Add stations Mizusawa (VERA) \& Yamaguchi to the stations, locations,
and freq files.  RCW Mar. 22, 2010.

\item The GSFC 2009a geodetic solution is based on a different
position reference date from previous solutions.  When the new {\sl
locations.dat} was created, the new date was used for all stations.
But many stations do not have updates from the GSFC solution, so they
then contained incorrect reference dates.  This creates station
position errors when plate techtonics are taken into account.  {\sl
locations.dat} has now been corrected to keep the old reference dates
when the positions are not updated. Also fix typo in Petrov's name in the
{\sl locations.dat} file.  March 18, 2010.  RCW.

\item Scripts to create makefiles for use with gfortran on Linux have
been created for 32 and 64 bit machines.  These do not support satellite
tracking and won't until I obtain a gfortran version of the SPICE code.
March 18, 2010.  RCW

\item The use of gfortran revealed some problems with unSAVEd variables
in some optimization routines.  Apparently g77 retains variable values
between calls and gfortran does not.  Fixed for the CELLS and CSUB
routines.  Note that the CSUB option seems to be broken for now for
reasons that I have not yet tried to chase down.
March 18, 2010  RCW.

\end{itemize}


\subsection{\label{SSEC:VER_9.2}Version 9.2}

This was version 9.1 during development.  Version 9.2 was released
on March 10, 2010.

\begin{itemize}

\item

\item Allow writing of Vex files when there are moving sources in the
project.  Such Vex files were blocked before because the necessary
information for accurate positions cannot be passed through Vex with
the current definition.  But such files are now needed for correlation
so they can now be written, but there will be several warnings that
the positions used in correlation, and in pointing if the motion is
fast, should be obtained elsewhere.  Feb. 28, 2010.  RCW.

\item With disk recordings, when there is a recording scan (period
with no recording gap between source scans) of more than a bit over an
hour, issue a warning and admonition to put in gaps.  Originally I
inserted a gap, but this opened a can of worms so I backtracked.  If
there is a problem with the recording, a whole file is lost so
excessively long scans put large amounts of data at risk.  March 7,
2010, RCW.

\item Support for the Australian LBA was improved and an example was
added.  Cormac Reynolds.  March 2, 2010.

\item Set the default for {\tt PRESTART} to 1 second as it seems that
the Mark5A systems do not start recording instantly.  Feb. 26, 2010.  RCW.

\item Various updates of examples and manual for changes related to
change to the DiFX software correlator on the VLBA.  Feb. 18, 2010. RCW

\item Prevent the Vex section from trying to invent new modes for
skipped scans, which caused a error termination.  Changes are in
routine VXSCNS.  Feb. 17, 2010 RCW.

\item Only print lines as long as needed in listing correlator parameters.
Before trailing blanks were also written out and that became a problem
after lengthening the allowed number of characters for various notes.
Feb. 3, 2010  RCW

\item Change various format specifications to allow printing of
larger numbers for such items as the number of spectral channels.
Feb. 2, 2010  RCW

\item Change the meaning of CORREL=VLBA or SOCORRO to be the DiFX software
correlator.  Add CORREL=FXCORR to mean the old hardware correlator, although
that is about to be shut off for good.  Feb. 2, 2010  RCW

\item Change length of NOTEn, COMMENT and CORNOTEn to 128 from 64.  Users
were going over causing confusion.  Jan. 20, 2010  RCW.

\item Change the VEX file name from xxxx.skd to xxxx.vex.  Dec. 4, 2009 RCW

\item Remove prohibition of different speedup factors (8 Mbps/track bit rate)
for different antennas in a setup file at request of Cormac Reynolds.  Also
changed the correlator output bit rate estimate to be for a speedup of 1
for correlators other than the VLBA hardware correlator.  The real speedup
factor will be hard to estimate for the software correlators.  Dec. 3, 2009, RCW.

\item Make the keyin input insensitive to DOS carriage returns.  There
is no longer a need to convert input to Unix format.  Dec. 1, 2009 RCW.

\item Install the JPLEPH.421 ephemeris in the \$PLANET\_DATA area for
the AOC version for 64 bit Linux.  Test against 405 to be sure there
are no big changes.  Nov. 12, 2009 RCW.

\item Add code from Bill Junor to the satellite tracking to get the
station dependent rates right (or close enough).  Nov. 02, 2009.  RCW

\item Change spelling of {\tt PARALAX} to {\tt PARALLAX}.  Add {\tt PARALAX}
for backward compatability.  This is being used fairly heavily by some
current projects.  Oct. 20, 2009

\item Add warnings for scans with less than half of the antennas reaching
source before the stop time.  Also give a count of scans with less than
half of the antennas on-source at the start time.  Oct. 15, 2009  RCW.

\item Move DSS54 (Robledo 34mBWG) from stations\_JIVE.dat to stations\_EVN.dat.
Oct. 15, 2009  RCW.

\end{itemize}


\subsection{\label{SSEC:VER_9.0}Version 9.0}

This is a beta release available locally in Socorro.  It was released
on Oct. 14, 2009.  Note that beta releases are not necessarily full
releases with all possible binaries and all the documentation fully
updated.  But they are a snapshot of the development version so any
new features will be in the next main release.

\begin{itemize}

\item Add Robledo, Kunming, and Miyun, and modified Shanghai, and
Urumqi in the catalogs.  Friso Olnon, Oct. 6, 2009

\item Make geometry calculation pay attention to moving sources,
especially planets and satellites.  This became an issue with
geostationary satellites for which \schedb assumed a constant RA/Dec
position and so predicted would set.  Oct. 9, 2009.  RCW

\item Further isolation of AUTOTAPE (autoallocate and autoreverse plus
MarkII tape length) to tape observations, which shouldn't still happen
but which I haven't had the nerve to remove from SCHED yet. Oct. 2009.RCW.

\item Add the ability to choose between exact and adjusted average
times as specified by CORAVG.  This is for the DiFX correlator. Also
add more digits to the average time in the OMS file.  Oct. 5, 2009 RCW.

\item Be more careful about the correlator parameters, both in the code
and the documentation.  Many parameters default to sensible values for
non-VLBA correlators but must be set by the user for the VLBA correlators.
Make this clear in the documentation and the code.  Sep. 2009 RCW.

\item Move the decision on whether to write Vex files to a subroutine
from the main sched routine.  It's getting fairly complicated and was
cluttering the main routine.  Vex is not allowed with non-recording
schedules, with configuration tests, and with recording scans on
planets or satellites (VLBA pointing scans are ok - they simply won't
appear in the Vex file). Oct. 2009 RCW

\item Start adding items related to the new VLBA DiFX software
correlator.  Set up to distinguish between the new and old
correlators.  Assume instant correlator synchronization time for DiFX.
Set the minimum FFT size for DiFX to 256 (for smaller spectra, will
channel average) Jul-Oct 2009 RCW

\item Try to make the warnings from the Vex code about the need for
gaps for media changes and for Tsys less confusing to Arecibo users who
might be able to ignore them.  Sept. 15, 2009.

\item Allow more digits for the bandwidth in the Vex channel definition.
RCW Aug. 31, 2009.

\item Allow the use of non-recording planet scans when producing VEX
files.  This is so pointing can be done on the VLBA antennas using
planets.  The scans will be skipped in the VEX file, leaving a gap
for other antennas to use their local procedures.  RCW Aug. 21, 2009.

\item Don't issue warning about poorly estimated data set sizes when
overlapping scans are pointing scans.  RCW Aug. 21, 2009.

\item Change the documentation and the actual behavior of the
correlator parameters to match.  Basically, for the VLBA correlator,
many parameters are required to force the user to think about them.
For other correlators, they have reasonable defaults.  Changed the
default CORTAPE to FTP for non-VLBA correlators.  It is required for
the VLBA.  Removed EXABYTE as a CORTAPE option after learning that it
hasn't been used for a long time.  RCW Aug. 20, 2009

\item Various VLA checking adjustments.  Give warning if two VLA
stations are invoked, like VLA1 and VLA27, because they won't both
get output files.  Warn against using 2 phasing modes (eg VA and VL)
with the same setup files - IFs won't be right.  Allow VS mode scans
at start of schedule without complaint about unphased channels.  Don't
warn about using phasing modes for VLA1 or VS mode for VLA27.
July 9, 2009  RCW.

\item Change the acceleration terms in the slew calculation to allow
for different values for acceleration and deceleration.  This is needed
for the DSN.  June 16, 2009  RCW.

\item Changed a few more messages about "dual tape" modes etc to not
refer to tape.  June 15, 2009  RCW.

\item Change the maximum number of modes in the Vex code to a
lower, but still realistic, value.  Without this, \schedb versions
set up for SKA configuration studies (more than 300 stations) would
not compile on some systems.  Mar. 13, 2009  RCW.

\end{itemize}

\subsection{\label{SSEC:VER_8.1}Version 8.1}

We needed to get the GBT catalog corrections and the Vex file fix
into the wild.


\begin{itemize}

\item Change the way the durations of scans in the Vex file are
calculated to avoid having scans overlap by a second due to
round off of the duration to even seconds.  Feb. 4, 2009  RCW.

\item  Add VLA to VLA1 and VLA27 in freq.dat to support mixed mode
observations.  Feb. 20, 2009 RCW.

\item Add a section to the summary file of correlator blocks to
help the analysts make jobs.  Feb. 4, 2009  RCW.

\item Add calcode to the oms file.  Jan. 26, 2009  RCW.

\item Update some catalog information for the GBT.  There were two GBT
entries for a while which resulted in loss of the axis offset for the
GBT. Also remove the freq\_US.dat master file which is no longer used.
Jan 23, 2009. RCW.

\item Make an svn branch for version 8 support.  Jan. 26, 2009  RCW.

\item Fix spurious blank in time for exper\_nominal\_start and stop in
the Vex output.  Jan. 26, 2009

\item Warn if the rate of creation of record files (blocks of data
between record stoppages - can be several scans) is more than
1000/day.  The actual limit is 1000 per disk module for Mark5A and
Mark5B, but we don't know ahead of time how big the modules will be
and what other observations will be on the module so we can't use that
actual limit.  The limit used is an average of one every 86 seconds so
is unlikely to be reached unless someone is stopping recording every
scan in a fast switching phase referencing observation, which would be
unwise while there are still sync times at the correlator.  All of
this will go away with Mark5C and the software correlator.  Jan. 21,
2009 RCW.

\item No longer warn about short record stops when synchronizing
starts as needed by the current use of Vex.  Disks don't care
Jan. 21, 2009  RCW.

\item Change the number of sources that can be used for optimization
runs from 100 to 1000 (CSUB and CELLS).  Jan. 5 RCW

%  Note:  I think CSUB is not working - check more.

%  Note:  There are temporary settings for the cell boundaries in
%  the code.  These should be made external input.

\end{itemize}



\subsection{\label{SSEC:VER_8.0}Version 8.0}

Released on Dec. 13, 2008.

\begin{itemize}


\item  Warnings issued if source motions are significant when writing Vex
       files.  Vex output does not yet support motions.  Dec. 13, 2008
       RCW

\item  Increase digits in the Vex file specification of station positions,
       station velocities, and axis offsets.  Dec. 12, 2008  RCW.

\item  Increase digits available for items in the summary table.  This
       was driven by some large disk byte counts.  Dec. 12, 2008  AP and
       RCW.

\item  Various catalog updates.

\item  Started adding an indicator of when the Tsys measurements are done
       at each station.  This will eventually control whether to give
       warnings of inadequate gaps when TSCAL=GAP.  Nov. 5, 2008 RCW

\item  Change the distribution tar files.  A 1MB file used to be a problem
       so various schemes were used to keep the tar files small.  That is
       no longer an issue, so the distribution tar file contains everything
       a user should need, including binaries for several architectures.
       Nov. 3, 2008  RCW.

\item  Change the scheme for building makefiles for different architectures.
       There is now one master makefile and some simple scripts that use
       sed to configure that makefile for each target.  Nov. 1, 2008  RCW

\item  Add VLA {\sl freq.dat} entries for Methanol at 6668 MHz and OH at
       6030 and 6035 MHz.  Oct. 29, 2008  RCW.

\item  Warn of scans longer than 40 minutes --- they can cause problems when
       there are mid-scan pack changes or other mid-scan difficulties.
       Oct. 25, 2008  RCW.

\item  Update sources.vlba and locations.dat to current correlator values
       that are based on solution 2008a\_astro from GSFC.  The VLA pad
       positions were note updated from the ones based on 2005f, but the
       changes would have been less than the likely errors.
       Oct. 8, 2008  RCW.

\item  Change SUMITEM defaults to {\tt ELA} (average elevation) and
       {\tt DWELL}  Oct. 2, 2008  RCW.

\item  Add more of the input file names to the list in the summary file,
       including the satellite Spice files.  Sept 20, 2008  RCW

\item  Add a line in the VLA Observe deck ({\sl xxxxobs.y}) file giving
       the reference antenna - which is also the single dish antenna.
       New variable VLARFANT supports this.  Most users should not
       worry about it.  Sept. 20, 2008  RCW

\item  Fix error in elapsed time calculation that caused non-recording
       scans not to be included.  Sept. 10, 2008  RCW

\item  Removed VLAxIF and VLAxROT file specifications.  They are no longer
       used.  The input variables are still read, but not passed to the
       obs.y file.  Sept. 8, 2008 RCW

\item  A wish list item was to allow mixing of VS and VA/VX mode observing,
       for example to do DELZN sections in VS mode.  We believe that this
       is simply a matter of specifying the right mode.  Complications
       will arise at the correlator when the delay needs to change.  Email
       was exchanged about this around May 16-20, 2008.
       RCW  Sept. 10, 2008.

\item  Make {\tt OPSKIP} function during pointing observations.  It was
       blocked for such observations.  Sept. 11, 2008  RCW.

\item  Add VLA integration time (//DS line).  Also remove VLAROT and
       VLAIF names from //LO card.  Sept. 8, 2008  RCW.

\item  Add HSA examples  Aug. 14, 2008.  RCW.

\item  Add note about 2cm frequencies being different in standard
       setups and when {\tt BAND='2cm'}  Aug. 13, 2008

\item  Switch to gfortran on MacOSX 10.5.  Aug. 11, 2008  RCW.

\item  Add warning suggested by Yuri Kovalev is the default RA or Dec
       were used, generally indicating a typo in the catalog.  May 1, 2008 RCW

\item  Remove requirement for autotape for disk. RCW

\item  Remove the Arecibo, GBT, and N140 entries for the S2 recording
       system from the stations catalog.  Add GBT\_COLD.  Mar. 4, 2008. RCW.

\item  Much work on the manual, mainly reducing influence of tape.
       Late Feb. 2008.  RCW

\item  Convert the summary of tape change times into a summary of
       time ranges for recording and total bytes.  Feb. 29, 2008. RCW

\item  Warn if using both satellites and planets that it might cause
       a crash.  Feb. 15, 2008  RCW.

\item  Allow the 2-bit, 8-channel, 32-MHz sample rate MarkIV mode in
       okmodes.f.  Jan. 24, 2008

\item  Much updating of the manual.  Dec. 13-?, 2007  RCW

\item  Remove obsolete examples egiii.key, egmk5vex.key egmk5vlba.key
       Dec. 13, 2007  RCW.

\item  Add parameter {\tt EVLA} to allow the VLA to reach frequencies allowed
       by the EVLA but not the VLA.  Sept. 26, 2007.  RCW.

\item  Convert all stations to Mark5 in the station catalog.  Nov. 8, 2006 RCW

\item  Found and fixed a bug in the calculation of station parallax for
satellite positions.  March 26, 2007. RCW.

\item  Put indicator of continuous recording in .sch file.  May 8, 2007.

\item  Increase maximum number of setups.  June 8, 2007  RCW.

\item  Add setup parameter M4PATCH and subroutine chk4geo.f to support
geodetic type setups.  This is incomplete, but is at least making a
polarization study of the geodetic stations (VLBA providing both polarizations)
possible.  June 2007  RCW.

\item  Add 24GHz band.  Aug 28, 2007

\item  Put \schedb under revision control with SVN.  Adapted Cormac Reynolds
version that had about a 2 year history.  Aug 31, 2007.  RCW.


\end{itemize}







\subsection{\label{SSEC:VER_6.05}Version 6.05}

Version 6.05 is a minor revision from version 6.04.  The main issue
addressed was a problem where sources between 0 and -1 deg dec had the
wrong sign of dec in {\sl sources.vlba}.  There are also a couple of
bug fixes in the plot routines and new Arecibo entries in {\sl
freq.dat}.  It was released on June 8, 2006.

\begin{itemize}

\item Correct sign of declination for many sources in the range 0 to -1 degrees.
June 2, 2006 RCW.

\item Complete update of Arecibo frequency data from Chris Salter  June 5, 2006.

\item Fix plot programs to deal with multiple setups properly and to fix a recent
bug in the setting of plot scales.  Franco Tinarelli, June 7, 2006.

\item Reflect offending line when there is a syntax crror.  June 8, 2006  RCW.

\end{itemize}


\subsection{\label{SSEC:VER_6.04}Version 6.04}

Version 6.04.1 is version 6.04 except that a the {\sl sources.vlba}
catalog has been fixed to remove duplicate aliases and to restore a
very small number of aliases that were lost in 6.04.

The major enhancement in the 6.04 version is the addition of {\tt
OPTMODE=HAS} which can be used to construct certain kinds of schedules
automatically from an input schedule that is basically a source list.
In this mode, \schedb tries to spread the scans on each source in
hour angle subject to various constraints.  In its current form, it is most
useful for scheduling survey type observations.  Future enhancements
will make it more useful for phase referencing and other modes.  For
more information, see the 
{\hyperref[MP:OPTMODE]{{\tt OPTMODE}}} description.

This release includes everything that was in the 6.03 mini-releases
that occurred since 6.02.  Those mini-releases were not sent to the
broader community and were intended mainly to make available the
new {\tt OPTMODE=HAS} for use by the VIPS survey, which started before
we could do a proper SCHED release.

Change log:

Version 6.04.1:

\begin{itemize}

\item Remove duplicate aliases from some sources in the source catalog.  Correct
missing aliases in a small number of sources.   RCW April 2006

\item  Add Sec(z) to the XY plot options.  Franco Tinarelli  Feb. 10, 2006.

\end{itemize}

Version 6.04:

\begin{itemize}

\item If VLA phasing mode scans were {\tt NORECORD}, SCHED warned
about unphased VX mode scans.  Change to recognize non-recording
phasing scans.  8 Aug 2005.

\item Add station motion adjustments to summary file.  5 Aug 2005 Craig.

\item Fix bug that might cause reading beyond the end of a character
string if {\tt CORREL} is specified as blank.  10 Aug Craig based on
information from Cormac.

\item Update Sla/dat.f for the leap second announced for Jan. 1, 2006.
11 Aug. 2005.  Craig.

\item Send first message warning of possible unspecified {\tt OBSTYPE}
to the terminal when \schedb runs.  14 Sept. 2005.

\item Comment a redundant SAVE command in state.f in the Jpl ephemeris
routines.  This gave gfortran a problem.  16 Sept. 2005

\item Change OPMINANT and OPMINEL to be scan dependent.  25 Oct. 2005

\item Fix the sync time discussion in the PRESTART section.  1 Nov. 2005 Craig

\item Fix dealing with sources when loading a plot parms file when the
source list has changed since the parms file was saved.  1 Nov. 2005.

\item Add hour angle based optimization mode {\tt OPTMODE=HAS}.
Initial application is the VLBA Imaging and Polarization Survey
(VIPS).  03 Nov 2005 Craig

\item Add the scan comment to the scan information dumped when certain
errors occur.  14 Nov 2005 Craig

\item Add note to users of tapeini sections that they normally are not
needed and such use betrays the use of ancient templates.  15 Nov 2005 Craig

\item Improve the choice of the maximum separation for the list of
source separations.  14 Nov 2005  Craig.

\item Add scan number to summary listings.  Add optional scan name based
on {\tt SCANTAG} input variable.  18 Nov 2005  Craig.

\item Protect against having a Vex station with no observations after taking
out scans where the source is not up.  This befuddles the Vex writer.  Warn
the user if this happens for any other station.  18 Nov 2005 Craig.

\item Only require shipping address for correlator output if tape is
requested.  08 Jan. 2006  Craig.

\item Warn users when it looks like they might have forgotten to reset
{\tt FREQ} or {\tt BW} when changing setup files.  24 Jan 2006 Craig.

\item Fix bug in overlapped basebands warning when using Doppler calculations.
25 Jan. 2006  Craig.

\item Added {\tt CRDLINE} to aid development of VLBA on-line software.
26 Jan. 2006  Craig.

\item Improve documentation of reconfigure issues.  Jan 27, 2006. Craig.

\item Warn when trying to use 1024 channels, fanout=1, and 16 times
oversample on the VLBA correlator.  It won't work.  Feb. 2006.  Craig.

\item Fix selection of the frequency to use when plotting beams.  Fix
dealing with the save file stations when the station list changes.  Other
minor plot fixes.  Franco Tinarelli and Craig  Feb. 2006

\item Fix bug in correlator resync accounting.  Make more visible
warnings about scans lost to resyncs.  Craig  20 Feb. 2006

\item Prevent short stoppages of recordings for scan boundaries at midnight.
Craig  22 Feb. 2006.

\item Added 11 seconds to TSETTLE for phased VLA (VLA27) as per
recommendation from Jim Ulvestad. He actually recommended 12 sec, but
since his schedule was made, acceleration parameters were changed for
this station adding about a second.  Craig 23 Feb. 2006.

\item Update source catalog to current VLBA correlator data base which
John Benson just updated.  The main change was to the geodetic sources
which are now from the 2005f\_astro solution from GSFC.  Users
are encouraged to reference the original papers when they use sources
from this catalog.  Those references, along with images and uv plots
for many sources, can be found at 
{\href{http://vlbi.gsfc.nasa.gov/solutions/2005f\_astro/2005f\_astro\_cat.html}{at this link.}}
Craig  28 Feb. 2006.

\item Increase maximum number of sources in a schedule to 1000 after
user request.  Craig  2 Mar. 2006.

\item Allow use of modes with FORMAT=NONE with VEX output. Must set parameter
'OVERRIDE' for this to be allowed. Scans with FORMAT=NONE are skipped with a
comment only written to the VEX file.  Cormac 2 Mar. 2006

\item More rigorous testing for frequency of Tsys measurements at VEX
stations with more informative warnings.  Cormac 2 Mar. 2006

\item Add checks for long continuous motion with disks because bank
switches can only occur during gaps at VEX stations.  Cormac  2 Mar. 2006

\item Fixed bug which meant that spurious new modes could be created
where none were required (reported in GB057).  Cormac  2 Mar 2006

\item Updated most station positions to the 2005f\_astro
solution from the GSFC.  March 2006, Craig.

\item Applied update of ATNF freq.dat parameters from Chris Phillips
March 22, 2006 Craig.


\end{itemize}

\subsection{\label{SSEC:VER_6.02}Version 6.02 (Released 29 July 2005)}

\begin{itemize}

\item  Some VLBA control file parameters are not used when
recording to non-tape media such as Mark5.  The parameters {\tt
autoallocate, autoreverse, barrel,} and {\tt track} will no longer
be written in such circumstances.  1 Apr 2005  RCW.

\item Remove option to record on tape at VLBA\_LA and VLBA\_KP.  The
drives have been removed from the stations as part of the conversion to
Mark5.  This revealed some of the problems noted below.  April 2005  RCW.

\item \schedb was claiming, in the summary file, that some setup files
were identical when they were not.  The problem was a typo in the
channel index when comparing channel dependent data such as {\tt
firstlo}.  The typo has been fixed.  The machine readable schedules
produced by \schedb to be sent to the antennas were not affected.
Fixed 3 Apr 2005 RCW.

\item For Mark5 observations, \schedb was complaining when there were
too few tracks even if the setup was only for non-recording scans such
as those meant for reference pointing.  This test is now bypassed for
non-recording situations.  4 Apr. 2005 RCW.

\item  The Mark5 byte count was being accumulated even on non-recording
scans, such as pointing scans.  Corrected  4 Apr 2005 RCW.

\item Change the reaction to the use of less than 8 tracks with Mark5
from an error to a warning on Walter Brisken's advice.  The data will
be recorded but, on the VLBA, extra dummy data will also be recorded
wasting disk space.  13 Apr 2005 RCW.

\item Fix the media specification in crd files for non-recording scans.
14 Apr 2005  RCW

\item Give information in the summary file about number of formatter
reconfigures and time lost to correlator resyncs.  Warn users when the
latter is over 10 percent of the total scan time.  We have seen some
projects lately where unfortunate frequency choices in band switching
projects led to many reconfigures and massive data loss.  In the process,
time lost to resyncs after tape stops is also calculated and a warning
is issued if it is excessive.  19 Apr 2005  RCW.

\item Add {\tt DISK} parameter to the {\sl .oms} file.  It gives the
the number of Gbytes on the disk drive, if that has been calculated.
12 May 2005  RCW.

\item Remove joint tape and disk options even for VLBA. 27 June 2005 RCW

\item Changed TPMODE to TAPEMODE in RECONFIG and SAMESET.  This is a bug
fix that might improve predictions of time lost to formatter reconfigures.
27 June 2005.  RCW.

\item Force TAPEMODE to 1 for disk so that constant track assignments
are kept.  Make some cosmetic modifications to the summary file related
to the conversion to Mark5. 29 June 2005.  RCW


\end{itemize}

\subsection{\label{SSEC:VER_6.01}Version 6.01}

\begin{itemize}


\item Fixed a bug that affected projects with large numbers of correlator
groups, causing a crash on Sun's and probably array overflows on other
machines. 22 Mar 2005 RCW

\item Fixed bug in OMS writing for projects with no setup.  This caused
a crash.  22 Mar 2005 RCW

\item Update Vex information in Mark5 advice section.  29 Mar 2005 from
Cormac.

\end{itemize}

\subsection{\label{SSSEC:MAR2005}Version 6.0 - Released March 8, 2005}

This includes many items that were in the 4 Oct 2004 release made
in the AOC.

\begin{itemize}

\item  Add the Australian LBA to list of recognized correlators.
30 Sept 2003 RCW.

\item  Give the current \schedb version in the top level page
of the manual.  Add a link to the ftp site where the distribution
files are found.  16 Oct. 2003 RCW.

\item  Make the FANOUT default reasonable for non-power-of-two numbers
of channels (before it could be fractional, leading to an error).
27 Oct. 2003 RCW.

\item  Fixed broken html link to {\tt DURation} in the summary list of
\schedb parameters.  4 Nov 2003  RCW.

\item  First Mac OS X installation.  The main difficulty was getting
PGPLOT installed.  Later this became easier if you could get the
as-yet-unreleased version 5.3 of PGPLOT which includes Mac.  Since the
compiler is g77 and the underlying operating system is unix, the only
changes needed to sched were a couple of library pointers in the
makefile.  The code was unchanged.  Dec 2003 RCW.

\item Moved some plot routines from {\sl src/Sched} to {\sl
src/PlotNRAO} so that the plotstub option will actually work.  These
are routines related to configuration searches that I, rather than
Franco, support.  6 Nov 2003 RCW

\item  Fixed some minor compatibility issues found by Patrick Charlot
on a Compaq ALPHA machine.  Most had to do with mixed types in
MIN and MAX arguments.  28 Jan 2004  RCW.

\item  Added complete set of 3mm VLBA frequencies to freq.dat.  Added
program makefreq to the {\sl RELATED PROGRAMS} directory to do this.  That
directory is not included in distributions.  02 Mar 2004  RCW.

\item Fixed the relative source separation printout to use the name used
in the rest of the schedule.  Also upped the minimum separation for
printed pairs to 30 degrees.  16 Mar 2004 RCW

\item Fixed an array overflow (segmentation fault) when a tapeini
section is read more than once.  15 Mar 2004 RCW.

\item  Add scan and baseline time calculation to source list in
summary.  16 Mar 2004  RCW.  Fixed so it would also be written when
Doppler information is written.  3 Feb 2005  RCW

\item  Added satellite tracking.  This was a big change involving
incorporation of the NAIF software from JPL.  However it is not expected
to be of general interest and there is a stub available in the makefile
to avoid needing NAIF.  With this change, \schedb can calculate the
position of spacecraft if a SPICE file is available.  Note that there
is an inconsistency in the handling of diurnal parallax that makes SPICE
planet positions come out somewhat different from positions based on
the JPL ephemeris. 24 Mar 2004 RCW.

\item For {\tt CORTAPE}, remove {\tt 9TRACK} and add {\tt FTP} to the
options.  The correlators can no longer write 9 track tapes! 20 Apr
2004 RCW.

\item Move geodetic (VGEO) setups away from satellite radio which is
at 2320-2345 MHz.  29 Jul 2004. RCW.

\item VLA phasing scans were always phasing mode VA.  Change that to
VL or VR if all channels are LCP or RCP in the following scan. 29 Jul
2004 RCW

\item Update ATNF catalog entries based on info from Chris
Phillips from 12 May 2004. 29 Jul 2004  RCW.

\item Modify DOPINCR to have 2 arguments so that the LO equation becomes
$N \times DOPINCR(1) + DOPINCR(2)$.  Requested for the ATNF by Chris
Phillips.  30 Jul 2004  RCW.

\item Add {\tt DATAPATH, GRABTO, GRABTIME,} and {\tt GRABGAP} for eVLBI
control. 30 July 2004 RCW.

\item Begin support added for Mark5 on the VLBA.  Spring 2004.  RCW.

\item Allow use of {\tt DISC} instead of {\tt DISK} (I still maintain
that DISC is the wrong spelling, but oh well.). 26 Aug 2004 RCW.

\item Extend downward the allowed values for {\tt VLAFEAB} and
{\tt VLAFECD}.  27 Aug 2004 RCW.

\item Change default to tape only if {\tt MEDIA} is not specified and
tape is an option at the station.  Combined tape and disk commands
are causing confusion for the VLBA.  30 Aug. 2004  RCW.

\item Add the {\tt MEDIADEF} option to the station catalog.  13 Sep 2004
RCW.  Also change some station catalog inputs to upper case just in case.

\item Add a version (date) to the station.dat and freq.dat files and
report it in the summary file.  14 Sep 2004 RCW.

\item Add a warning if an unnamed source is found in the catalog.  This
Can mean that someone put in an extra /.  30 Sept. 2004. RCW

\item Don't write track information to VLBA control files for norecord
scans (like pointing).  This was causing a problem when pointing setups
did not match recording scans in bit rate and, because of VEX's
inability to deal with format=none, a format was was specified for the
pointing scan.  30 Sept. 2004. RCW

\item Fix the count of Mark5 disk capacity used when not all stations
are on all the time.  12 Nov. 2004 RCW

\item Don't complain about readbacks and tape stoppages when using disk.
12 Nov. 2004.

\item Remove Mark5 stations from down scans, much like is done for
autoallocate VLBA stations.  Parameter DODOWN added to override this
if desired.  28 Nov. 2004  RCW

\item Allow a slight tolerance when testing if a scan start time was
before the previous scan stop time.  We hit a case where a small rounding
error was causing problems.  9 Dec. 2004  RCW

\item Turn off barrel roll for disk stations.  14 Dec 2004. RCW.

\item Use a separate setup file for every station, including VLBA stations.
This should simplify some transition issues as we upgrade hardware.  But
still maintain a single VLBA setup group in the OMS file when all are the
same - although that won't happen much for a while because the barrel roll
is different with Mark5 hand tape.  Note that this is an internal coding
change. User specified setup files can still use VLBA to mean all VLBA
stations.  19 Dec 2004  RCW

\item Add parameter {\tt MAXSRCHR} to the station catalog to allow the
number of sources per hour to be limited.  The MARK1 telescope at Jodrell
needs to avoid frequent slews to prevent fatigue and will not run
schedules that change sources too often.  19 Dec 2004  RCW

\item Fixed the tape count for VLBA systems in 2 tape, 512 Mbps mode.
It had been low by factor of 2.  19 Dec 1004  RCW.

\item Don't allow fewer than 8 tracks on Mark5A.  27 Dec 2004  RCW.

\item For single polarization MarkIV, default to using both ``normal''
and ``alternate'' IFs to try to keep all channels in the low numbered
video converters.  This was requested by the EVN because some stations
maintain the first 8 VCs better than the rest.  A side effect of the
logic used to accomplish this effect is that dual polarization observations
will only use the ``normal'' IFs.  Of course, any IF and VC (BBC) setting
can be forced to whatever you want in the setup file.  2 Jan 2005  RCW.

\item Switch to numerical \schedb versions plus coarse dates.  The integer
parts will change with major releases.  The fractional parts will change
with bug fixes and minor releases.  3 Feb. 2005  RCW.

\item Add position error bars to the source catalog inputs and write
the values to the printed source lists.  9 Feb 2005  RCW.

\item Fixed a bug that occurred when adding new modes iff the phase
cal tones were off.  Reynolds.  Feb. 2005

\item Prohibit oversampling greater than 4 coming to JIVE.  Reynolds.
24 Feb. 2005

\item Added ftp and evlbi scans (DATAPATH, GRABTO, GRABTIME) for VEX files
Reynolds. 24 Feb 2005

\item Allow scheduling of Mk5 stations in VEX without specifying
VEXTEST (though no entries have been added to the catalogues yet)
Reynolds.  24 Feb 2005.

\item Added several evn examples.  Reynolds 24 Feb 2005.

\end{itemize}



\subsection{\label{SSSEC:18SEP2003}Release of 18 September 2003.}

\begin{itemize}

\item  Add output of velocities for sources in the summary file.
2002aug29 RCW.

\item  Change from assuming that altaz antennas start at the midpoing
of their azimuth range to start at the low end.  This should deal
with some problems seen by Effelsberg.  RCW  24 Jan 2003.

\item  Adding Mark5 for VLBA  RCW Jan 2003.

\item Removed Mark2 RCW 6 Feb 2003.  The end of an era - I thought.
Put it back 14 Feb 2003.  I have been informed by Igor Molotov that
Mark II is still used occasionally in Russia (4 sites), Ukraine,
Latvia, Poland, India, and China and still exists at Noto and
Medicina!  It is used for radar observations that don't need much
bandwidth.  When I tested the reinstallation, I found and fixed a
problem with old and new versions that caused a core dump.
Just before the 18 Sept release I found another problem with the
tape change request handling.

\item  Added the runlog.  This will take most of the output that used
to go to the terminal and put it to a file, where it should be easier
to examine, and to send to someone else when needed.  It will take
a while to convert all the write statements in the code.  Also a
messages.txt file has been added to the catalog with text messages
that can be sent to the runlog by routine WRTMSG.  This makes more
extended explanations of problems much easier to code.  6 Feb. 2003

\item  Added 1024 Mbps capability for MarkIV, 2 head observations.
Basically this means adding the option for 16 Mbps per track.
20 Feb 2003.

\item  Add a plot map option to the configuration search mode.  Activate
by typing ``{\tt p}'' (bw) or ``{\tt P}'' (color) while the map
of station locations is on the screen.  26 Feb 2003  RCW

\item Restructure the sections that set the fan out modes.  This was
a code maintenance issue.  Users should not see a change.  13 Mar 2003 RCW

\item Proper motion and parallax added.  This is much different from the
planetary motion that was already in place.  Note the source catalog
should now use EQUINOX rather than EPOCH.  20 Mar 2002 RCW.

\item Socorro correlator maximum output data rate increased to
1000 kbytes/sec as per announcement from Jon Romney.  9 May 2003 RCW.

\item Added acceleration to the slew calcualations. Sometime early 2003,
RCW.

\item Add warning about possible phase jumps when setting flukes to
frequencies that are not multiples of 10 MHz.  15 May 2003. RCW.

\item Add more information about frequencies etc to the OMS file.  This
was requested by Lorant to aid in automatically assigning calibration
information to channels.  19 May 2003.  RCW.

\item Warn for VLA schedules over 1 day.  This can cause problems with
restarts since the obs file has no day number on each scan.  22 May 2003
RCW.

\item Warn for Socorro correlator requests for more than 1024 spectral
channels.   22 May 2003  RCW.

\item Make tests for which correlator is used consistent.  Sched will
ignore any characters following the recognized correlator specification
which must start in column 1.  4 June 2003 RCW.

\item Add source separations for sources closer than 15 degrees to the
summary.  17 July 2003 RCW.

\item New Vex code with Mark 5 support.  9 Sept 2003 CR.

\end{itemize}


\subsection{\label{SSSEC:15MAY2002}Release of 02 July 2002.}

\begin{itemize}

\item  Die if no location given for a station.  18 Oct 2001 RCW.

\item  Fixed use of un-initialized variable in Vex stuff that caused
problems occasionally on systems that do not automatically initialize
variables.  This was detected by a user doing plots.  18 Oct 2001 RCW
with fix found by Franco and agreed to by Huib.

\item  Improve error message when {\tt OBSTYPE} indicates recording
will be done, but all scans are flagged {\tt NORECORD}.  13 Dec 2001 RCW

\item  Default IATUTC to value from SLA\_DAT.  27 Dec 2001 RCW

\item  Change TSETTLE to 6 for VLBA stations after experience with
a 43 GHz phase referencing run that had 15 second scans.  28 Dec 2001 RCW

\item  When there are between 2 and 24 sources and a UV plot is requested,
make a separate panel for each source.  2 Jan 2002 RCW

\item Add {\tt OBSTYPE = CONFIG} to trigger a UV plotting and
optimizing mode useful for configuration studies.  A map of the
station locations is plotted and stations can be clicked on and off
(and highlighted) for plotting.  An optimizing mode is built in that
tries combinations of available stations and rates them based on the
number of cells filled in a uv grid.  Related parameters include {\tt
MAPLIM}, {\tt GRIDNR}, {\tt GRIDNT}, {\tt GRIDMIN}, {\tt GRIDMAX}, and
{\tt GRIDW0}.  Also added the configuration studies section of this
manual.  Jan-Apr 2002 RCW.

\item Write {\tt extlo} and {\tt extlosideband} parameters to VLBA
control files for non-VLBA antennas whenever that IF channel was
not used in the previous scan in addition to whenever the value
actually changes.  This was needed by Effelsberg.  14 Jan 2002. RCW.

\item Alter 3mm examples to no longer claim that the peaking setup
needs to be similar to the observing setup to avoid formatter
reconfigure.  This is not true if {\tt FORMAT=NONE}.  14 Jan 2002. RCW.

\item Checked the Lat/Long/Ht to XYZ conversion.  Altered the
ellipsoid by 1 meter to conform to current values found on the web.
The conversion now agrees with examples at geodetic sites at the cm
level assuming that everything is in WGS84, which is closely tied to
the ITRF.  29 Jan 2002 RCW.

\item Check that each frequency set is within the IF's specified in
the frequency catalog.  This gives a check after application of
Doppler or schedule specified frequencies.  4 Feb 2002  RCW.

\item Improve the ability to change the maximum number of stations
and some other parameters with only one change in sched.inc.  As a
result, the sched.inc file must be invoked before schset.inc.
2002may01  RCW.

\item Some restrictions on processing 512 Mbps observations at
JIVE have been lifted.  2002may  Huib

\item There have been a number of updates to the catalogs for the EVN
stations, both in capabilities and positions.  Cormac Reynolds 2002may

\item The ``settling time'' ({\tt TSETTLE}) for the VLBA antennas was
increased from 2 seconds to reflect better what is actually seen in
phase referencing observations.  This will lengthen the gap between
scans when using dwell time scheduling.  2001apr RCW.

\item Change the default for {\tt RECORDER, DAR, and CONTROL} to blank,
which gets interpreted as {\tt NONE}.  Should have no effect in
practice because the catalogs have always specified these.  But
with the advent of {\tt DISK} for Mark5, this will change.

\item Add {\tt MINSETUP} to the station catalog to deal with cases
where there is a minimum scan change time regardless of the slew
and settling times, but where this minimum time should not be
added to scan changes with long slews.

\end{itemize}

\subsection{\label{SSSEC:14OCT2001}Release of 16 October 2001.}

\begin{itemize}


\item  Change OK modes to include 512 Mbps modes for VLBA systems.
       Note that such modes for Mark IV processed in Socorro will
       still require {\tt MODETEST} be specified.  This will be
       changed once the modes have been checked out.  Also, there
       are some two head (tape), 256 Mbps that are not yet approved
       but will be.  26 Feb 2001 RCW.

\item  Add the .oms output file type to pass information to the
       VLBA correlator bookkeeping system.   1 March 2001 RCW.

\item  Modify the warnings concerning autoallocation depending
       on which correlator is specified.  There are now 4 cases;
       VLBA where autoallocation is wanted, JIVE where is is
       prohibited, Haystack where it is allowed, and others where
       the user is asked to be sure.  Correlators can be moved
       easily between the cases.
       15 March 2001.

\item  When warning about the first output scan being before the
       first input scan, note that this might be due to a pointing
       scan if AUTOPEAK was requested.  19 Mar 2001  RCW.

\item  Make rotation/focus patterns possible at 13, 6, and 4 cm.
       9 April 2001 RCW.

\item  Clean up some logic in {\tt OPTMODE = SCANS} so that the
       experiment will start at the start time of the first scan
       even if several scans are skipped at the start, as long
       as scan times are allowed to vary.  19 April 2001  RCW.

\item  Add PN3DB pointing, including the {\tt OPMISS} optimization
       parameter.  20 April 2001  RCW.

\item  Move warning about tape kept moving from each page of summary
       to earlier station summary information section.  23 April 2001
       RCW.

\item  Make warning about multiple stations with same code more clear.
       Specifically suggest using station name.  30 April 2001. RCW.

\item  Restrict a Mark IV station to 8 VCs when 1:4 fanout is being
       used because of a hardware restriction.  The BBC (VC) defaulting
       code was changed.  22 May 2001 RCW.

\item  Fix formatting of the two head version of HEAD\_POS section in
       VEX file and relaxed constraints on patching for MkIV
       19 Sept 2001 Huib

\item  Fix problem in scan duplication routine that can prevent proper
       action when explicit tape changes are requested.  4 Oct 2001 RCW.

\item  Made sure a single source can be used with more than one of the
       alias names in the VEX file. Longitudes now show sign part in
       source comment. Fix error handling in CHK4DAR.
       5 Oct 2001 Huib

\item  Fix head positions to use for Mark IV 2 head operation.
       9 Oct 2001  RCW/Huib

\item  Took out warnings on 40 and 66 ips on MkIV receorders 10 Oct
       2001 Huib

\item  Stopped spurious warning about overlapping frequencies when
       Doppler requested on sources with no velocities.  11 Oct 2001 RCW

\item  Fix problem with track assignments when using setup files with
       different normal passes per head position.  Forced all setups
       to use the same number of passes per head position.  This had
       been done before, but in a different way that allowed bad track
       assignments to be made that could overwrite data.  11 Oct 2001 RCW

\item  Added SAVE statement in JPLEP2 to allow planet pointing observations
       scheduled under Linux.  15 Oct 2001 RCW

\end{itemize}

\subsection{\label{SSSEC:09FEB2001}Release of 12 February 2001.}

It seems that we are having teething problems with the new reference
pointing capabilities.  This release makes available some important
fixes required for 3mm VLBA projects.  But it does not have some fixes
for VEX problems that will affect CMVA runs.  So there will be another
release in a couple of weeks.  The changes here are not significant
for users not attempting reference pointing with {\tt AUTOPEAK} or
other mechanism that invokes setup files with {\tt FORMAT=NONE}.  If
you don't need this one right now, it is recommended you wait for
the VEX fixes.


\begin{itemize}

\item  \schedb did not behave gracefully when there was a station listed
       in the peaking command file that is not in the stations catalog.
       Make it die properly with an error message that might allow
       users to understand what was wrong.  07 Feb 2001  RCW

\item  Found another bug relating to looping over scans.  This time
       a loop went from the first output scan to the last input scan,
       which is over no scans if output is not the same as input.
       As with the earlier bugs, this only affects {\tt AUTOPEAK} users
       or users of obscure optimizing modes.  And this time, it only
       affects VEX users.  07 Feb 2001 RCW

\item  Fix problem with initialization of track assignment output when
       the first scan had FORMAT=NONE, such as a pointing scan.  With
       this, only the first station got track assignments.  08 Feb 2001 RCW.

\item  Improve the way readback tests are counted.  The main effects will
       be on what happens at the start of a schedule.  Also, if {\tt DEBUG}
       is set, SCHED will write a line each time it finds a readback
       test slot.  08 Feb 2001  RCW.

\item  Add an {\tt OVERRIDE} input parameter and internal logical that
       can be used by programmers to allow them to exercise code in
       ways now allowed for users.  For example, if users cannot be
       allowed to use some feature because of known bugs, but programmers
       need to test it to fix the bug, {\tt OVERRIDE} can be used to
       provide a ``back door'' in.  09 Feb 2001.  RCW.

\item  Don't allow VEX and FORMAT=NONE.  There are bugs.  This should
       be fixed soon, but we need to get a release out to fix some of
       the above issues for 3mm VLBA observations.  09 Feb 2001  RCW.

\item  Remove the ``*'' from a the names of many pointing sources in
       {\sl sources.pointing} and {\sl peak.cmd}.  These were causing
       problems for other software downstream.  This might cause some
       editing to be needed in existing files in the dynamic scheduling
       queue.  9 Feb 2001.  RCW.

\item  In VEX code, change ``*'' to ``X'' rather than ``?'' in def names.
       We would like to be able to use ``*'' in source names, but users
       should be wary that they might encounter problems in post-processing.
       12 Feb 2001. Huib.

\item  Modify the source list in {\sl peak.cmd} so that the ones
       that are used for reference pointing if the user does not check
       source quality are only those what we trust the most.  Names of
       other possible sources are left in the file in comments.
       12 Feb 2001. RCW.

\item  Make the data rate limit warning sensitive to wide band observations
       where 2 pass processing is required anyway.  In the process separate
       dealing with Socorro correlator parameters from others.  15 Mar 2001 RCW.
\end{itemize}

\subsection{\label{SSSEC:30JAN2001}Release of 30 January 2001.}

This was an emergency release to fix the problem with the Doppler
calculations when using the automatic reference pointing scan
insertion.  This problem would be fatal for schedules using spectral
line sources and {\tt AUTOPEAK}.  Given that most reference pointing
sources are line sources, this means most 86 GHz projects on the VLBA.
Other types of projects are not affected.

\begin{itemize}

\item  Specify in the {\sl sch} files that frequencies are LO sum.

\item  Make {\sc SKEDCONV} available to users in a separate tar
       file.  It seems there are some who still like to use the
       interactive PC-SCHED to set up scans.  22 Jan 2001  RCW.

\item  Replace tape start time with ``Stopped'' in sch file for
       scans with no tape motion.  29 Jan 2001 RCW.

\item  Fix bug where the routine that calculates Doppler frequencies
       was looping over input, not output scans.
       This is an old bug, but would only be noticed in line observations
       using the more obscure OPTMODEs.  But it now affects most users
       of the new {\tt AUTOPEAK} facility.  This will require a SCHED
       update.  29 Jan 2001 RCW

\item  Fix bug in counting of tape stoppages when there are non-recording
       scans.  A variable was indexed to station number, not scan
       number.  30 Jan 2001 RCW

\item  Change the line names in peak.cmd to avoid possible conflict
       with user defined names and make 4 reference frequencies for
       the 4 channels in the pointing setup files.  Two of those
       channels are meant to be off the line so difference power
       can be used for reference pointing some day (it already is
       in pointing test runs).  30 Jan 2001. RCW

\item  Update comments on reference pointing in the 3mm example files.
       Due to an oversite, these were not updated for the 12Jan2001
       release and some of the information was out of date or
       incomplete.  30 Jan 2001. RCW

\item  Accumulate and report both total time in scans and total time
       in recording scans.  30 Jan 2001.  RCW.

\item  Make a number of corrections to the eg3mm examples.  30 Jan 2001
       RCW.

\end{itemize}

\subsection{\label{SSSEC:12JAN2001}Release of 12 January 2001.}

\begin{itemize}

\item Starting to set up satellite pointing.  Not finished for this
      release.  11 May 2000 RCW.

\item Quit if trying to do autoallocate for data going to
      non-VLBA correlators.  14June2000 RCW.

\item Make message concerning mixed LST scheduling and UT day
      specification less intimidating for dynamic schedules.
      13July2000 RCW

\item Small changes to prevent problems during checking of
      setups when reference pointing.  6Aug2000 RCW

\item Add example eg3mm.key  6Aug2000 RCW+Vivek

\item Rationalize the pointing source file and call sources.pointing.
       6Aug2000 RCW

\item Modifications for Mark IV 2 head wide-band mode.  22Aug2000 RCW and Huib.
      Added tapeini parameter HEADMODE.

\item Some clean up of output when a setup error is found.
      22Aug2000 RCW.

\item Make paralactic angle right for each antenna mount.  Assumed
      ALTAZ in all cases before.  31Aug2000 RCW.

\item Get rid of unnecessary overlapping band messages when using
      default frequencies and 62.5 and 125 kHz bandwidths in a setup
      file.  1Sep2000 RCW

\item Implement Locations file as an alternate to the station
      catalog for the source of some station information, especially
      station location and rate.  This simplifies maintenance.
      8sep2000 RCW.

\item Don't worry about changes in TPMODE (passes per head position)
      that only involve scans with FORMAT='NONE'.  10Oct2000 RCW

\item Put the peakchan command, that requests reference pointing on
      the VLBA, in the main scan, not the setup scan.  10Oct2000 RCW.

\item Add error condition for a request for tape autoallocation
      when the processing will be anywhere but Socorro.  11Oct2000 RCW.

\item Update the barrel roll defaults.  11Oct2000 RCW.

\item Allow FORMAT=NONE in non-recording scans.  This is useful for
      reference pointing on the VLBA.  11Oct2000 RCW.

\item Add automatic insertion of reference pointing scans.  This
      works for the VLBA and VLA.  It is aimed
      as simplifying scheduling of high frequency observations.  It
      works on global or CMVA schedules, simply by limiting the stations
      for which the reference pointing scans are requested.
      Instructions for use of the function are in a new section in
      the manual.  Among other impacts, there is a new type of \schedb
      input that gives controls for this function.  There are also
      some new examples that use it.  Dec 2000 RCW.

\item Some significant restructuring of \schedb for general code
      cleanup.  The areas involved in schedule optimization were
      especially impacted.  Oct-Dec 2000  RCW.

\item Add note in summary file to explicitly say when no tapes are
      recorded.  Also issue a warning when the default OBSTYPE of
      NONE is specified along with recording type setup files.
      06Nov2000 RCW

\item There was a change to the tape speed for VLBA format, low
      density tapes with non-VLBA control systems.  But it was
      decided not to keep the change.  But in the process, the
      sections of code involved were rewritten and simplified.
      Dec 2000 RCW.

\item Add flags for horizons and down, not just slewing, in the output
      flag file.  This includes a determination of the rise or set
      time to withing 30 seconds.  22Nov2000 RCW.

\item Add indicator in summary file for whether the scan is a pointing
      scan and whether or not tape is being recorded.  Note that
      anyone with software that parses the summary file scan listing
      will need to make changes for this.  28nov2000 RCW.

\item Programming items:  Add version numbers for the sections of
      code provided by different people.  Modify makefile to make
      sure the linked include files are really links.  05Dec2000 RCW.

\item Add a digit to the format for frequency printouts to avoid
      problems when the frequency is over 100 GHz.  05Dec2000 RCW.

\item Add a scan hours to the summary in addition to the tape hours.
      This will reflect time spent pointing etc.  05Dec2000 RCW.

\item Try to improve the first page of this manual to make it less
      intimidating.  Also improve various sections in the manual
      including the installation instructions.  Dec 2000, RCW.

\item The files used for the distribution have been broken into
      three files, one for source code, one for catalogs, the manual
      etc, and one for the output of the Verify test.  Dec 2000 RCW.

\item Removed {\sc SKEDCONV} from the distribution.  It is still
      available if needed, but it has not been used in years to
      our knowledge.  Dec 2000 RCW.

\item Preparing to change definition of VQ on VLA.  \schedb will use
      the new definition, but will always write LO and IF cards for the
      next few months so there is no confusion about what is months.  We
      will allow a few months for current schedules to flush through the
      system, then the on-line system will change.  Later SCHED will stop
      bothering with LO and IF cards when the standard is used.

\item Implemented writing VEX files with two head recording. Apart from
  changes in a number of places to allow track numbers above 33, this
  included the definition of a passorder with 6 positions, optimized
  for recording with two heads, after consulting Dan Smythe. Aug 2000
  Huib (VEX v68)

\item Relaxed constrains for use of the JIVE correlator. Aug 2000 Huib
  (VEX v68)

\item Dropped all TPNS() dependencies in VEX code Nov 2000 Huib (VEX
  v69)

\item Adjusted the definition of Barrel-rolling according to the latest
  wisdom; the definition is reversed in time with respect to the
  earlier definition. With the pending MkIV formatter fixes this
  becomes important. 512 Mb/s and barrel-rolling can be written for
  VLBA4 and MkIV drives when MODETEST is set. Nov 2000 Huib (VEX v69)

\item All error messages in the VEX writing code were reviewed and
  updated when necessary. Nov 2000 Huib (VEX v69)

\item Checks on readback tests and the necessity to do post-passing was
  added for FS controled sites, other FS timing issues were cleaned
  up. Dec 2000 Huib (VEX v70)

\item Inserted a human readable date in VEX file. Checked that special
  characters are replaced in VEX names and quoted in VEX qualifiers
  (the SGRA* problem). Dec 2000 Huib (VEX v70)

\item Provided an example to write 512 Mb/s schedules eg512.

\item Fixed a problem in writing S2 schedules that used passes on more
  than one groups of S2 transports. Previously Sched would just request
  a complete new set of 8 tapes. As most VSOP projects use all 8
  transports simultaneously, this mode was not tested before. Dec 2000
  Huib.

\end{itemize}

\subsection{\label{SSSEC:20APR2000}Release of 28 April 2000.}

\begin{itemize}

\item  Fixed test of second station in scan in UV plotting routine.  Before
       fix, extra spurious points would be plotted when the first station
       and not the second was in the scan.  14Sep1999 RCW.

\item  When getting the polarization from pol and RCHAN and LCHAN are
       specified, use them to set IFCHAN.  Before RCHAN and LCHAN were
       only used when IFCHAN=R or L.  15Sep1999.

\item  Protect against no scans scheduled.  27sep1999 RCW.

\item  Added catalog plotting capability  Franco and RCW  sep99.

\item  Some tweaks to the tape handling section of the manual.  19oct99.

\item  Check for duplicate channels came before all channel info was
       known in some cases.  Moved SFINFO call to after setup
       parameters are derived.  25oct99 RCW.

\item  Issue warning if there are DOPPLER scans scans with SOURCE
       not the same as DOPSRC and both are line sources.  This
       is probably not wanted.  2 Nov 1999.  RCW.

\item  Change www.nrao.edu/... links to www.aoc.nrao.edu.  9dec99 RCW.

\item Issue warnings about the output data rate through the FIR.
      The limit is 44236-2048 (41188) spectral channels per 0.131 second
      correlator tic (can be longer observing time with speedup).
      The correlator always transfers 2048 spectral channels divided
      by the spectral averaging, even if it is going to throw most
      of them away.  This limit is higher than the output data rate
      limit for 2 or more baseband channels, but can be the limiting
      factor with 1 channel.   Wish list: 13dec99 RCW.
      Warning added 19Jan2000 RCW.

\item Improve warnings when synchronizing tape starts causes short
      tape stoppages.  26Jan2000 RCW.

\item Fix handling of tabs by keyin under Linux.  27Jan2000 RCW.

\item Modify warning when Doppler or freq in schedule move frequency
      outside IF specified in freq.dat.  30Jan2000 RCW.

\item Added subroutine (SCANID) to help warning and error messages
      identify the offending scan.  A few such messages modified.
      Many more needed. 3 feb 2000. RCW.
\item At the requist of Ralph Marson who is writing AIPS++ fillers,
      I have restricted CALCODE to be a letter (which is capitalized
      by SCHED) or a number.  10 Feb 2000  RCW.

\item Added / at end of flag lines in flag file.  22 Mar 2000 RCW.

\item Added USED and VLAVB to SETCOP - were missing. 24 Mar 2000 RCW.

\item Added setup parameter {\tt NOISEFRQ} to control Pie Town noise
      cal switching rate.  It wants to use the VLA rate when the
      Pie Town link is being used.  4 April 2000  RCW.

\item For 512 bit mode, don't complain when autoallocate is not used.
      10 April 2000.  RCW.

\item Add a text capability to pass a cover letter from the schedule
      to the sch and summary files.  11Apr2000 RCW

\item Set time for a readback test in 512 Mbps mode to 4 minutes.
      12 April 2000.  RCW.

\item Beef up the description of CORWTFN in the manual and add a
      warning if 1:4 fan out is requested with the ZEROPAD option.
      19 April 2000.  RCW.

\item Add various enhancements to the interactive RD plotting option.
      19 April 2000.  Franco.

\item Added note for observations with large output data set sizes to
      consider requesting high density output tapes.  19 April 2000 RCW.

\item Added machine readable correlator parameters to end of .sum file
      for observations to be correlated in Socorro.  19 April 2000 RCW.

\item Added support for VLBA4 systems in Vex and in the setup defaulting
      routines.  24 Apr. 2000  RCW and Huib.

\item Vex debugs, changes, and additions from Huib Apr 2000.  Bug fixes
      or enhancements in the logic dealing with narrow filters, the JIVE
      checker and some rounding issues.  Added the cover letter to the
      VEX file.  Added digits to source coordinates.

\end{itemize}

\subsection{\label{SSSEC:1JUL99}Release of 1 July 1999.}

\begin{itemize}

\item  CRDVLA temporarily stored FLUKEA and FLUKEB in single precision
       which led to round off problems in some special cases.  Fixed
       04Jan98  RCW.

\item  Fix translation of VLA bandwidth code into an actual bandwidth.
       Was BW=50/(n+1).  Should be BW=50/2**n.  15jan99 RCW.

\item  Franco fixed a bug that caused improper reinitialization of
       LST plot limits when a RESTART is done.  26jan99.

\item  Got rid of special Plot\_Tinarelli directory.  Franco's stuff
       is now in the Plot directory.  The old, pre GUI, plot stuff
       was tarred and put in the \$SCHED/OLD directory.  26jan99 RCW.

\item  Fixed bug in SETFCAT, the routine that chooses the frequency
       catalog entry to use.  In choosing between two entries with
       good frequencies, it would choose the lower priority (higher
       numerical value of PRIORITY) one if the observing frequency
       was better centered.  28jan99 RCW.

\item  Changed gap required for a readback to 1:45.  For the on-line
       system, it is really 1 minute plus 1 second per track and
       it can't be too close to the start of a pass (\sched does not
       test that).  This change was triggered because the old 2:00
       test, combined with LST scheduling, was causing lots of
       readback warnings that were not needed.  8feb99 RCW.

\item  Blocked the warning about scans crossing 0 hr UT.  This is
       no longer a concern, as far as I can tell.  The Socorro
       correlator will put a job boundary there, but this should be
       benign.  16feb99 RCW.

\item  Allow the use of UT dates (YEAR, MONTH, DAY) for an LST
       schedule.  This might make dynamic scheduling easier.
       Cleaning up code relating to setting scan times (before
       optimization).  17feb99 RCW.

\item  Count the number of times the tape stops.  If it is more
       than 10 times per hour, warn the user about excessive stops
       and point out new parameter MINPAUSE.  17feb99 RCW.

\item  Add parameters MINPAUSE and PRESTART.  PRESTART causes the
       start of tape motion to be moved forward to allow for
       synchronization at playback time.  MINPAUSE causes the
       use of continuous tape motion if the tape stop time would
       between 2 scans would be less than MINPAUSE times the speed
       up factor.  Related to this, there are significant updates
       to the manual, especially the sections on scan times.
       24feb99 RCW.

\item  Add warning for VLBA correlator projects going to the VLBA
       correlator if {\tt AUTOTAPE=2} is not being used.  22feb99 RCW.

\item  Add warning when DOPPLER set freuqencies overlap more than
       20%.  26feb99

\item  Update OK modes.  Now almost all are allowed.  26Feb99 RCW

\item  Remove {\sl UPTIME} from the \schedb distribution.  01Mar99 RCW.

\item  Add concept of frequency sets.  This is to aid bookkeeping
       when the deviations from the setup file frequencies are altered
       with FREQ, BW, or DOPPLER.  Now in the summary file, all
       frequency sets are listed along with the setup file summary.
       2mar99 RCW.

\item  Altered VLBI at VLA example in manual to show full specification
       of VLA parameters.  3Mar99 RCW.

\item  Adding BAND for setups.  This should allow elimination of
       most standard setup files.  4Mar99 RCW

\item  Added pcal sets to organize the pulse cal detector specifications.
       This is mainly to simplify bookkeeping, especially for Vex.
       13Mar99  RCW.

\item  Added a .flag file output that can be used to flag predicted slew
       times with UVFLG.  13Mar99 RCW.

\item  Remove stations from a scan when they are both using autotape=2
       and the source is not up.  This is to help reduce tape
       consumption, especially for MK.  It is only done for automatic
       tape allocation because of the risk of messing up tape
       management in other cases.   18mar99.  RCW.

\item  Add VLBA4 to the DAR options.  Started 24mar99.

\item  Add VLAPEAK parameter.  Could not keep united peakup options
       and allow the various VLA reference pointing options.
       30mar99 RCW.

\item  Don't make a crd.y file when scheduling pure VLA observations.
       31mar99 RCW.

\item  When dwell time scheduling was in use, \schedb would not make
       scans that cross midnight UT.  Don't bother any more --- allow
       scans to cross midnight.  31mar99 RCW.

\item  Stop tape at end of autoallocation projects.  12May1999 RCW.

\item  Updates of the {\tt DUR} and {\tt DWELL} sections of the manual.
       17may99 RCW.

\item  Add a cross check for reasonableness of the tape length and
       density specification for VLBA tapes.  Huib may add same for
       Mark IV.  17may99 RCW.

\item  Prevent missing samplerate in VLBA schedules when first scan
       is pointing.  7jun99 RCW.

\item  While \schedb is running, write out the full time range to help
       when fine tuning to fill a time allocation.  This from Ketan.
       13Jan99.

\item  VEX section upgraded to 1.5.60 21Jun99, Huib\\
       S2 tape changes corrected\\
       Checks use narrow filters in MkIV DAR\\
       Upgraded to much more robust freq change scheme\\
       BW changes now allowed in VEX\\
       Freq/Dop changes in modes with different BBC assignment allowed\\
       Reduced memory use VEX section\\
       Check tape starts synchronous for VEX\\
       Axis offsets, negative Vlsr now reported\\
       Check against high density recording on thick tapes\\

\item  Prevent different tape start times for a scan when a VEX output
       is requested.  RCW 20jun99

\item  Improve the count of scans (remove bug).  RCW 20jun99

\item  Put experiment code in upper case on VLA observe deck.  RCW 20jun99.

\item  Don't die if S2 or other format requested for processing in
       Socorro - allows translators.  29June1999 RCW.
\end{itemize}

\subsection{\label{SSSEC:1DEC98}Release of 1 Dec. 1998.}

\begin{itemize}

\item  Fix bug that affected plotting with planets (SRLSTN not set).
       07apr98 RCW.

\item  Reactivate OPSKIP and OPELPRIO for pointing observations.
       08apr98 RCW.

\item  Fix bug in tape footage accounting for automatic tape handling.
       This put the tape at the wrong end when exactly at one end.
       17apr98 RCW.

\item  Fix bug in number of tapes listed early in summary file when
       autotape is used.  23Apr98.  RCW.

\item  Fix bug that did not allow a setup with two groups, the first
       with stations=' ' and the second with a specified station.
       5may98 RCW.

\item  Change the default for {\tt PRECDATE} to 1979.9, the right
       value for positions determined on the VLA.  Add to the
       documentation about this issue, including pointing out that
       MERLIN positions assume an observe date of 1950.  6may98 RCW.

\item  Beefed up the warnings in this document about different velocity
       definitions.  16may98  RCW.

\item  For AUTOALLOCATE, fixed the number of passes in the summary to
       go to count fractional passes.  20may98 RCW.

\item  SCHED died with complaints about BBC settings and about duplicate
       channels when DAR=NONE.  Added bypass or those tests with that
       DAR type.  05jun98  RCW.

\item  MAXSTA set at 30 to match test stuff Franco is doing.  Keep
       it there?  16Apr98  RCW.  Will keep.  31 Aug 1998. RCW.

\item  Update dat.f in Slalib routines for planned leap second at the
       end of 1998.

\item  Add chkcode.f to check that VLA, VLBA, and global schedules have
       at least 3 digit numbers.  26 Aug. 1998.

\item  Add alternate average time.  26 Aug. 1998.

\item  Add details to the summary about Sun distance.  26 Aug 1998.

\item  Add VDEF and VREF to the source catalog parameters to allow
       different velocity definitions and different reference frames for
       velocity.  10 Sept. 1998. RCW.

\item  Begin support of VLA-Pie Town link by adding PT LO to the
       VLA obs file //LO line.  12Sept 1998.

\item  Some enhancements to the plotting, especially when there are
       large numbers of stations.  various dates.  Franco

\item  Fix bug in rotation pattern where the colimation offset
       adjustments for a rotation were not made for the az part
       of the pointing raster.  28Oct98 RCW.

\item  Update 6.7 and 12.2 GHz methanol frequencies as per email from
       Chris Phillips.  02Nov98 RCW.

\item  Add beam plots.  Oct98 Tinarelli.

\item  Change an incorrect entry in the okmodes.f DATA statements.
       Change egiv.set to a valid mode.  Add text to the error
       message when an unapproved mode is used.  17nov98 RCW.

\item  Set maximum passes per head position to 8 for defaulted
       setups.  Also deal better with cases that use less than
       four tracks.  23Nov98 RCW

\item  Add check of JIVE correlator options.  23Nov98 Huib.

\item  Enhance VEX to deal with more complicated schedules.
       From Huib: ``The main work (and quite a bit) is that the
       VEX writer can now deal with more complex schedules. There
       used to be a type of schedules that used certain stations in
       different setups in different modes, that could not be dealt
       with. That is now all resolved, but the price was that I had
       to maintain a list of stations for every "def", I think the
       memory use has increased a bit.''  23Nov98  Huib.

\item  Default barrel=roll\_8 (or at least not roll\_16) when the
       user wants 1024 channels on the VLBA correlator.  23Nov98. RCW.

\item  Increase by 1 digit the precision to which RA and Dec are
       printed in the summary, crd, and sch files. 23Nov98 RCW.

\item  Fix some bugs in the call to CHKGDAR and in CHKDAR itself.
       30Nov98  RCW.

\end{itemize}

\subsection{\label{SSSEC:06MAR98}Release of 30 March 1998.}

\begin{itemize}

\item Prohibit use of 2 digit year.  Warn, but don't abort with
      year outside 1900 to 2100.  Convert to 4 digit years in
      VLBA control files.  20Nov97.  These are in response
      to Richard Simon's y2k crusade.

\item Fix bug found by Norbert Bartel where a postpass warning goes
      out even on VLBA sites using 1 drive.  5dec97 RCW.

\item Fix bug that appeared when some setups needed the frequency
      catalog and others didn't.  10dec1997  RCW.

\item Add some more variables to SAVE parameters that were missed
      before.  Thanks to Franco Tinarelli for finding them.  15Jan98.

\item From Franco on plot stuff (9Jan98):

  Another problem exists with the PGPLOT libraries and the colours usage.
  In Linux I've recompiled sched with f77 and in the plot window the
  background color of graphics window is black and not gray and the yellow
  border do not appears ( like in the Alpha WS). This is very strange
  because in Linux the problem do not exist with the sched executables compiled
  with g77 and the same pgplot libraries, and in the Alpha WS disappears with
  the pgplot libraries compiled with the shared options.

\item Add routine OPTUPT {(\tt OPTMODE='UPTIME')} to create a long
      sequence (OPDUR) of scans from each
      input scan.  This is meant to be part of allowing SCHED features
      to replace UPTIME.  This is used if OPTMODE=UPTIME is invoked.
      20 Jan 1998  RCW.

\item Franco's plotting stuff is getting pretty good.  I will probably
      use it as the standard plotting section from now on.
      First really useful version installed 21 Jan 98.

\item Added baseline length table to summary file.  10 Feb 98.

\item Fixed vsx-128-4-2.set to really be dual polarization rather
      than RCP only.  17 Feb 98 RCW.

\item Added routine SIDTIM.  Called in CRDVLA - no real change there.
      Mainly this was to help the UPTIME style plotting stuff of
      Franco's.  20 Feb 98  RCW.

\item Changing default format to be correct for S2.  S2's often have
      DAR type of VLBA or MarkIV which triggered the wrong default.
      20 Feb 98  RCW.

\item Restructuring some of tape handling code to separate automatic
      tape handling from other types and to completely separate S2.
      Feb 98.  RCW.

\item Tried to set up multiple line formats as concatenated character
      variables to keep some compilers happy.  Feb 98 RCW

\item Automatic tape allocation only applies to sites with VLBA
      control systems and more than one tape drive.  AUTOALOC and
      AUTOREV made site dependent.  24 Feb 1998. RCW.

\item Fix bug where if POL=L, you actually got RCP.  POL=LCP was ok.
      25 Feb 98  RCW.

\item Do not allow ``!'' in cover information.  They mess up the
      VLBA on-line parsing of the files.

\item Arrange to use position information from the VLBA correlator
      data base in the standard stations.dat catalog.  A new program
      that is very much like {\sl MAKESETUP}, called {\sl MAKESTA}
      is used to merge the information from the correlator data
      base into with the rest of the information about station
      equipment.  25Nov98  RCW.

\item Change tape move time at end of S2 scans from 0.5 min to 0.1 min.
      27Feb98 RCW.  2Mar98 Huib in the Vex stuff.

\item Fix ephemeris routine stub to match new name and call sequence
      of the real one, which changed a few months ago.  2Mar98 RCW.

\item Multiple occurrences of \$PROCEDURES VEX section is fixed.
      2Mar97 Huib.

\item Warning on FS setup times checks that station was actually in
      previous scan.   2Mar97 Huib.

\item Add NOSETUP item to aid in planning with hypothetical stations
      and stations for which setup information is not present.
      5Mar98. RCW.

\item Fix bug that appeared when in-line setup files were placed
      at the end of the schedule.  17Mar98  RCW.

\item Remove the long loops in the ROTPAT section.  The on-line
      system can't do them.  Add warnings about durations of pointing
      and rotpat scans.  25mar98 RCW.

\end{itemize}

\subsection{\label{SSSEC:18NOV97}Release of 18 Nov. 1997.}

\begin{itemize}

\item Fix bug in setting of formats that occurs when VLBA/MarkIV
      modes are mixed with Mark III modes in a schedule.  This caused
      a core dump.  21Aug1997 RCW.

\item Add Mitaka and Pentiction to the valid correlator list.
      8sep97 RCW.

\item Clarify that correlator shipping address is for output.
      8sep97 RCW.

\item Avoid postpass even on last tape of experiment for 1 tape
      stations.  Requested by Dave Graham but make sense to be
      the default.  While at it, changed VLBA stations (2 tape
      stations) to also avoid postpass when the last pass is
      continuous.  9sep97 RCW.

\item Add check that sun distance of a VLA phasing source is greater
      than the nominal limit before issuing a warning.  9sep97 RCW.

\item Green Bank - Remove end of scan calibration.  Change default
      to Ts only, no Ta.  Use the MARKIII proceedure rather than VSST
      and VOBS for most cases.  9sep97 RCW.

\item Implement multiple slew limits for XY antennas.  This is needed
      for Hobart.  10sep97  RCW.

\item Fix a bug in overlapping channel warning.  12sep97 RCW.

\item Make various changes to allow experiments with mixed setups.
      This is mainly to allow some stations to have dual polarization
      and others, that only have single channel receivers, to record
      only those channels with the single polarization.  The concept
      of ``logical'' channel for each setup file was introduced.
      If not all channels match a logical channels, {\tt DOPPLER,
      FREQ, and BW} are not allowed.  Also, those parameters set
      the frequency and bandwidth for the logical channels which
      might not correspond 1-1 with the channels in an individual
      setup group.  Checks of compatibility between stations are
      done by logical channel.  12sep97.  RCW

\item Add setup item PTOFF to allow independent setting of the
      half power distance and the off source position.  This
      is the result of problems notices with the 13cmsx gains that
      were the result of not going far enough off source.
      12sep97  RCW.

\item Make tape autoallocation (AUTOTAPE) apply only to stations
      using VLBA control files.  13sep97 RCW.

\item Add a !NEXT! before the final !QUIT! for the final postpass
      scan.  This may be required to prevent the on-line system
      from ignoring the postpass.  17sep97  RCW.

\item Change documentation and user messages in VLBACHG to reflect
      going to full rewind speed for postpasses. 15sep97 RCW.

\item Update to latest VLA standard band frequencies.  21Oct97 RCW.

\item Fix bug in roll group check for Wrobel mode in CHKSOC.  31Oct97 RCW.

\item Add SETGEO to pick BBCs for DAR=VLBAG stations (geodetic wiring
      of a VLBA rack.  For those racks, pay attention to the
      restrictions on which BBCs can see which IFs and the limits
      on how many BBCs can be used in 2 bit mode.  Modified BBC
      selection routine for MarkIV while at it (simplified).
      4 Nov 1997  RCW.

\item Fix bug in CHKVLBA that caused it to only check the first
      synthesizer frequency.  Unfortunately a couple of experiments
      were lost because of a user error that was not caught and should
      have been.  6 Nov 1997  RCW.

\item Add VLAMODE='VB'.  6 Nov 1997.

\item Fix bug in accounting for logical channels.  10 Nov 1997.

\item Make more obvious warning when a DAY forgotten at midnight.
      10 Nov 1997.

\item Remove many of the TAPEINI sections from the examples.  Leave
      a couple - they might still be needed for EVN only observations.
      10 Nov 1997

\item Remove unused and dangerous DEFAULT option for station in
      setup files.  17 Nov 1997.

\item Add CHKGDAR to check cable restrictions for ``geodetic'' VLBA
      stations.

\item Support x:y mounts like Hobard in VEX.  Nov 97, Huib.

\item Disabled use of modes that would excite the Mark IV BBC 9
      fan-out bug.  Nov 97, Huib

\item Warn against 0 recorders in S2 modes that stopped Hart from
      observing.  Nov 97, Huib.

\item Introduce VLBAG DAR to VEX for stations with geodetic wiring.
      Nov 97, Huib.

\item There have been many catalog updates by RCW, Huib ...

\end{itemize}

\subsection{\label{SSSEC:18AUG97}Release of 18 August 1997.}

\begin{itemize}

\item Calls to jpleph for planet positions wanted East Longitude.  They
      had been getting West Longitude.  Fixed 5 Aug 1997.  RCW.

\item Add PRECDATE - the "observation" date to assume for precession
      from J2000 to B1950 etc.  5 Aug 1997.  RCW.

\item Stop using CHNSTA in the frequency table and comment out the code
      that implements it.  Because of the digital patch panel at the VLA
      and the effort by sched to understand which IFs are needed to support
      the specified phasing modes (VL, VR, and VA), CHNSTA is no longer
      needed.  8Aug97. RCW

\item Add barrel=roll\_off to the vsop setup files.  8Aug97

\item Install better documented versions of the planets software
      from Brian Butler. 8Aug1997.

\item Restructure setup file expansion in SETEXPND to avoid bug when
      the number of setup groups shrinks.  15Aug1997.  RCW.

\item Protect against requesting VLBI in non-VLBI modes at the VLA.
      This would create uncorrelatable data.  15Aug1997. RCW.

\item Fixed bug that lead to negative pcal frequencies in certain narrow
      bandwidth cases.  18Aug1997.  RCW.

\item Fixed keeping track of use of VLA modes.  Before was at time of
      input, but got setup group index wrong.  Now in setup defaulting
      routines.  18Aug1997.  RCW.

\end{itemize}

\subsection{\label{SSSEC:AUG97}Release of 1 Aug. 1997}

\begin{itemize}

\item Add some items to SAVE in tpsch to keep from having problems
      with tape change time warnings.  11Feb97.

\item Set proper S2 default tape speeds. 12Feb97.

\item Put comment to screen when postpassing single tape site. 12Feb97.

\item Fixed bug in telescope position code for XY antennas. 12Feb97.

\item Check that the BBC frequencies for VLBA stations are
      multiples of 10 kHz.  13Feb1997.

\item Remove complaint about more than 2 drives (triggered by S2) and
      chech tape initialization NDRIVES against max given in catalog.
      24mar97 RCW.

\item VEX enhancements by Huib 25mar97 \\
      DAR = NONE works OK, producing VEX files readable by fs9.3.8 \\
      VEX mode name will always be unique. \\
      XYEW and XYNS mounts allowed for VEX output. \\
      Cleared up some warnings that were inappropriate for S2. \\
      Put in a number of warnings when schedule would viloate PCFS capbilities.

\item Split the station and frequency catalogs into portions to
      maintained by huib and I.  There is a script "Update" which
      combines them to form the single catalogs seen by the users.
      RCW 25mar97

\item Add OKMODES routine and MODETEST input to discourage, but allow
      in special cases, the use of untested Mark~IV and VLBA
      recording modes.
      RCW 20may97

\item Protect against too many tracks.  This may need to change
      when we go to 512 mode.  In SETCHAN.  RCW 21may97.

\item Add SETBBC.  This should allow VLBA and Mark IV setups to leave
      the BBC assignments for SCHED to determine.  The defaulting of
      sidebands in SETCHAN was also beefed up to those could be left
      for SCHED to do.   RCW  6jun97.

\item Add routine SETSTDEF to establish default stations for a setup
      file if none are given.  Also it will eliminate stations that
      do not use the setup in the schedule to keep the number of
      setup groups down.  12Jun97  RCW.

\item Add blank default for FORMAT.  If FORMAT = ' ' or FORMAT is not
      given, FORMAT will be set to DAR for the station.  This will
      generally be VLBA or MKIV.  The fanout will then default as
      before, trying to achieve speedup factor 2.  The barrel roll
      will be turned off except for VLBA format stations. 12Jun97 RCW.

\item Fixed warning about missing BBC frequency in SETFREQ.  Before it
      claimed the BBSYN was there regardless of the truth.  25Jun97 RCW.

\item Added ISETSTA to schset.inc to keep a pointer from the setup
      group to the corresponding station catalog entry.  25Jun97.

\item Reorder the NAMES and VALUES arrays in KD in the KEYIN support
      routines.  This allows elimination of the EQUIVALENCE statements
      which works around the new SUN compiler bug.  It also somewhat
      simplifies the use of the routines.   25Jun97 RCW.

\item MAKESETUP, the program that makes the standard setup files from
      the Master\_setups file, has received major revisions.  All
      setup files are now significantly different, taking advantage
      of the new abilities of SCHED to default stations, bbcs etc.
      26jun97 RCW.

\item Made IFCHAN = R, L work with the frequency catalog as an
      alternative to POL.  1 July 97. RCW

\item Set up so default fan outs cause different setups to use the
      same number of tracks.  This should help users trying to mix
      bit rates with two tape modes, not to mention other modes.
      8Jul97 RCW

\item Tape summary in .sum file did not always reflect actual
      tape change times if SCHED was able to start during preceeding
      no-tape-motion scans.  Fixed 8Jul97  RCW.

\item Allowing setup to match with a specified IF that matches ALTIFC.
      (bug fix).  14Jul1997 RCW.

\item Documented SUMITEM=SLEW.  Fixed bug in summary where the "up"
      flag for AZ2 was actually for the start of scan.  Thanks to
      Huib for finding these.  14Jul1997  RCW.

\item Make anything that starts with VLBA in the frequency file
      match any setup file station that starts with VLBA.
      15Jul97 RCW.

\item Block tracks assignments that won't work for polarization
      processing on the Socorro correlator (only if that correlator
      is specified in the header stuff).  Also try to prevent
      16 track barrel roll for data that will want the 2K FFT.
      18 July 1997 RCW.

\item Set up for 512 Mbps mode using 2 tapes at the VLBA or 2 heads
      on Mark IV systems.  The Mark IV implementation is not yet
      complete.  SCHED treats the second tape/head as just more
      heads.  The tapes are kept in sync in an extension of the
      prohibition of changes of numbers of tracks in use.
      17 July 1997.

\item Allow user to only specify one {\tt NETSIDE} if they are all
      the same.  18Jul97 RCW.

\item Allow POL='R' or 'L' in addition to 'RCP' and 'LCP'.
      18Jul1997 RCW.

\item Make thin, high density tape the default for all cases.
      21Jul1997 RCW.

\item When setting the default pcal tone detection frequencies for
      observations with wide channel bandwidths, use the second or
      third one from the upper edge of the band for second one
      selected.  Previously, \schedb chose the highest tone
      available.  But this was often on the steep dropoff part
      of the filters and did not work very well.  21Jul1997 RCW.

\item Fix problem with defaulting of station names in setup files.
      When several were specified per group, and then another
      group with fewer was specified, some names could carry over.
      21Jul1997 RCW.

\item Add to comments in opttim.f to warn that PRESCAN may be the
      problem if the user winds up with a zero length scan.
      21Jul1997 RCW.

\item Abort if the number of spectral channels requested with
      polarization processing exceeds 128 per baseband.
      21Jul1997 RCW.

\item Try to account better for S2 tape needs by adding up to
      3 minutes between scans (2.5 before, 0.5 after).
      22Jul1995

\item Change to new IF scheme for VLA now that the computer controlled
      patch panel is available.  Now VLA IF A is routed to VLBA
      IF A and so forth.  28Jul97  RCW.

\item Upgraded VEX section to 1.5.44. 31Jul97 Huib.\\
      Changed to ``adaptive'' tape modes, enabling continuous tape
      motion (this enhancement can be switched off by setting
      VXADPT=.FALSE. in vxlink.inc and recompile). \\
      Set needed flags to keep FS timing happy. \\
      Support NOREC by seeting drive = 0 in scans. \\
      Give proper message for use of plug-in filters. \\
      Stop identical station codes. \\
      31 July 1997   Huib.

\item Changed maximum correlator output data rate (VLBA correlator) from
      350 kbps to 500 kbps reflecting a recent increase in capability.
      31 July 1997.  RCW.

\end{itemize}

\subsection{\label{SSSEC:FEB97}Release of 10 Feb. 1997}

\begin{itemize}

\item Fix a concatenation problem (Linux only?) in envir.f - related
      to the use of environment variables.  RCW  15 Jan 1997.
      Moved to standard release (14 Jan version).

\item Add some variables to SAVEs.  Required by g77 to fix some
      problems.  21 Jan 1997.

\item Change the order of the examples to try to get people to  use
      the simpler one.  21 Jan 1997.

\item Update Sla/dat.f for July 1, 1997 leap second.  27jan97 RCW.

\item Add comment to crd files giving tape start times. 3feb97 RCW.

\item Incorporate VEX output from Huib.  Debugging and porting
      over next few days.  3feb97 RCW.

\item Prevent mixing planets and VEX.  6feb97 RCW.

\item Fix MST day for VLA obs files when the experiment starts between
      UT and local midnight.  7Feb97 RCW.

\item This should be the most robust release yet in a portability
      sense because of testing on several platforms, much of it
      done by Franco Tinarelli of Bologna.  Numerous small
      non-standard items in the code were corrected.

\end{itemize}

\subsection{\label{SSSEC:JAN97}Release of 14 Jan. 1997}

\begin{itemize}

\item Fixed mistake in frequencies in v6cm-128-4-2-L.set.  Put in
      4 Dec release.  5Dec96

\item Add source qualifier to qualifiers used in pointing pattern.
      This will be used to distinguish scans meant to be processed
      with on-off spectral line observations.  For testers only.
      6 Dec 96 RCW.

\item Fix bug in SLEW that caused slew times to be wrong some
      of the time.  This was introduced in the 4 Dec sched so
      old schedules are ok.  9 Dec 96 RCW.

\item Rick Lively has been doing some clean up in the Makefile,
      especially for machines other than those we have.  The
      9 Dec release has several modifications relative to the
      4 Dec release.

\item I did a mini-release in the evening of 9-Dec-1996  RCW

\item Franco Tinarelli sent information on a number of problems
      detected by his Dec Alpha compiler.  Mostly these are non-serious
      problems with declares (although he is the one who flagged
      the SLEW problem above).  These are fixed. 10 Dec 1996. RCW

\item Block test for different speedups for S2 sites. 13 Dec 96 RCW

\item Make RCHAN and LCHAN have 2 characters.  13 Dec 96  RCW

\item Add setup information to the end of the sch files. 13 Dec 96
      This and the above 2 items were requests from Huib.

\item Alter TFORM so that it does not overflow a small input
      character string.  RCW  18dec96.

\item Start adding SAVE to routines and includes.  Needed with g77.
      RCW  18dec96.  First change in KEYPUT.
      23dec96 --- this turned into a mess.  Putting variable specific
      SAVEs in many routines.  In the process, a few initializations
      were cleaned up.

\item Reinstate postpasses for VLBA format files.  23 dec 96.  RCW.

\item Write {\sl verify} and {\sl check\_results} scripts for checking
      both new code and new installations.  Put ``standard'' output
      files in the {\sl examples/Stdout} subdirectory.  26 Dec 96. RCW.

\item Do various programming cleanups to keep g77 with all warning
      switches turned on happy.  These should make the program more
      robust.

\item Fix several problems for RESTARTs from the plotting section.
      The fixes mainly had to do with the initialization of station
      and frequency catalog reads.  31 Dec 96.

\item Allow single tape stations not to postpass if the tape doesn't
      stop during a pass.  31 Dec 96.

\item Warn if tape change gaps are less than 15 minutes.  13 Jan 97 RCW.

\item If a tape change is preceeded by norecord scans, move the tape
      change time back to as early as possible.  13 Jan 97 RCW.

\end{itemize}

\subsection{\label{SSSEC:DEC96}Release of 4 Dec. 1996}

\begin{itemize}

\item Discourage picking successive scans on same source when using the
      subarrayed sky coverage optimizer (OPTCSUB).  11Sep96 RCW.

\item No longer attempt to space to the end of tape between scans
      when there is going to be a turn-around.  With speed-up on
      the correlator, this can put the correlator badly out of sync.
      12Sep96  RCW

\item Add TAPESYNC to try to force synchronized tape changes.  This
      is especially useful in optimized schedules with subarraying.
      Sep 96 RCW.

\item Made cosmetic changes to sched.inc and some clean up of source
      namehandling, including a bug fix in the planets code.
      1 Oct 96 RCW

\item Added new routine STMSG for startup messages.  1 Oct 96 RCW

\item Added a new routine SHORTN for getting the short source name.
      1 Oct 96 RCW

\item Add ability to use station codes in place of station names
      for the input parameters STATIONS, REWIND, FASTFOR, TAPE, and
      REVERSE.  This had the side effect of requiring that the
      station catalog be read by the time the first scan is
      processed.   4 Oct 1996 RCW

\item Fix calls for planet positions. 4 Oct 1996

\item Print 0 for dwell time if source is down.  4 Oct 96 RCW.

\item Increase the maximum number of channels to 32.  This required
      quite a bit of work as 16 was built in in several places.
      9 Oct 96  RCW.

\item Made various changes to help the Mark IV and VEX support.
      Set the default low density Mark IV tape speeds to the
      same as Mark~III.

\item Set the maximum correlator data rate to 350 kbps.  14Oct96 RCW.

\item Don't allow BW to be specified in the main schedule if VEX
      output is to be written.  This significantly simplifies the
      generation of setups in the VEX file.  15 Oct 96 RCW.

\item Add DOPINCR to allow Doppler frequency setting for systems
      with different frequency setting capabilities from VLBA and
      Mark~III/IV.  For example, VSOP only hits the nearest MHz.
      15 Oct 96 RCW.

\item Require that the user provide many of the cover and correlation
      parameters to give the observatories and correlators the
      information they need.   Internally, put all
      parameters in variables to reduce dependence on the print format.
      Eliminate the parameter TELEX since as far as I know, this
      system is no longer used.  16 Oct 96  RCW.

\item Add a mechanism, and a program, for easy including of examples
      in this manual.  This should make keeping the examples up to
      date and tested easier.  17 Oct 96.

\item Add SLEW to the allowed summary items (SUMITEM).

\item Allow MKIV dar and S2 recorder at the same site.

\item Add the ability to use environment variables in UNIX file names.
      This simplifies specification of catalogs names.  Also adjust
      the default catalog names to work on a UNIX system with the
      standard SCHED directory substructure and with \$SCHED defined
      to point to the SCHED base area.   21 Oct 96  RCW.

\item Add FREQREF to schset.inc to make it easier for other routines
      to get the observing frequency.  Set FREQREF in RDSET and/or
      SETFREQ.

\item Add POL to schset.inc to make it easier to keep track of
      polarization.  Add POL to setup input variables.

\item Changed SPEEDUP in sched.inc to RSPEED and added SPEEDUP to
      schset.inc.  This improved bookkeeping.

\item Prohibit frequency switching when writing VEX.  24 Oct 96.

\item Add MJD to summary output.

\item Restructure writing of summary file and add number of passes,
      tapes, and readback tests.  24 Oct 1996.

\item Extend the leveling scan for pointing observations to twice
      PTDUR to make it long enough to get pcx tests.  24 Oct 1996.

\item Force the Doppler calculations to give the same LO frequency for
      channels sharing a BBC.  This is mainly for Upper/Lower
      sideband pairs.  Added subroutine SBSIDE. 25 Oct 1996 RCW.

\item Add consistency checks across channels and setup groups in
      a setup file in the area of frequency and sideband assignments.
      25 Oct 1996.

\item Protect against scans shorter than one second.  25 Oct 1996.

\item Remove tape stuff from VLAONLY and NOTAPE observations. 28 Oct 96.

\item Set up for defaulting many SETUP parameters based on input from
      a frequency catalog.  This was a major change involving
      considerable additional code and a new input file which is
      called {\sl freq.dat} in the catalogs subdirectory.  If users
      are observing a frequency covered by the frequency catalog, they
      only need to specify generic information like observing
      frequency, polarization, number of bits per sample etc.  \schedb
      can then fill in all the site dependent parameters like
      firstlo, synthesizer settings, channel names etc.  This
      should greatly simplify the process of making setup files.
      See
      \hyperref[SEC:FRQCAT]{the frequency catalog section}      
      for a lot more information.  \schedb also uses
      the frequency catalog information to check any setups provided.
      If it does not recognize the setup, it will complain.  For
      VLBA observations, this probably means there is a problem.
      For other sites with less complete information in the frequency
      catalog, it is just a flag to be careful with what you are
      doing.

      In the process of making these changes, it became possible to
      specify multiple stations for a setup group (SETSTA now has two
      indices).  With only the generic parameters specified, this
      can be useful.  Internally, \schedb expands such a case to
      have a separate group for each input station before adding
      all the LO values etc.  After that, only the first station
      of the list is used.      29 Oct 96.  RCW.

\item Set up defaulting of parameters like NETSIDE and BBC in
      SETCHAN.  This can be a bit risky since different defaults
      require different frequency settings, which aren't defaulted.
      2 Nov 96. RCW.

\item Did some cosmetic reformatting of the summary file.  4 Nov 96 RCW.

\item Clarify VLA vs VLB IF's in sum file.  Warn of special patching.

\item Allow POL=DUAL in setup.  Will cause R/L pairs to be specified.

\item Adding FREQFILE and FREQLIST for frequency defaulting and
      display.  FREQLIST can be used to get a list of possible
      frequency setups from the frequency catalog for a desired
      sky frequency.  \schedb will generate the list, writing it
      to the screen and to a file called {\sl frequencies.list}.
      6 Nov 96 RCW.

\item Put catalog of origen into summary file source list.  Also move
      SRCFILE and STAFILE to sched.inc.  8Nov96 RCW.

\item Allow the setup file to specify generic FORMAT=VLBA or
      FORMAT=MKIV.  \schedb will figure out the appropriate fanout,
      usually trying to obtain a speed up factor on the VLBA
      correlator of two, if possible.  12Nov1996 RCW.

\item Default TPMODE to the actual one so that the user does not
      need to specify it in the setup file.

\item Put FE, SYNTH, and pcal stuff in the setup summary in the
      summary file for VLBA stations.

\item Allow plotting without cover information.  This helps keep
      schedules used for planning purposes simple.  18 Nov 1996.

\item Fix bug that caused OPTMODE='SCANS' to start at input start
      time of first good source (perhaps involving big delay from
      the experiment start time). 18 Nov 1996 RCW.

\item Increase number of scans and number of setup files allowed.
      The program size is now about 15 Mbytes.  The size is
      sensitive to these two parameters which can be altered
      easily in the include files.  18 Nov 96.

\item Allow VSOP control, dar, and recorder types.  Add a stub for
      writing VSOP drudg files.  18 Nov. 96.

\item Activate axis type XYEW (Hobart).  Rewrite XYNS routines while
      at it. 19 Nov 1996.  RCW.

\item Modify all of the standard setup files for new defaulting
      capabilities.  20 Nov 1996

\item Add FOCUS, ROTATION, AZCOLIM, and ELCOLIM as scan inputs.
      These are for VLBA testing only.  20 Nov 1996  RCW

\item Add ROTPAT, FOCOFF, and ROTOFF for focus/rotation test patterns.
      Again these are for VLBA testing (the 3mm receiver has arrived
      at Pie Town!).   25 Nov 1996  RCW

\item Add speedup factor to summary.  27 Nov 1996

\item Add warnings if baseband channels overlap in frequency. 27 Nov 1996.

\item Use the setup frequency for a source for which no velocity was
      specified even if DOPPLER was specified.  27 Nov 1996.

\item Fix data set size calculation --- data rate was ok, but it did not
      allow for the fact that processing happens faster with a
      speed up greater than 1. 3 Dec 1996.

\item Tested and works under Linux.  4 Dec 1996.

\item Added VLBI at the VLA example provided by Joan Wrobel.  4 Dec 1996.

\item Allow norecord scans to count for readback tests and don't
      include them in the tape time calculation.  4 Dec 1996

\end{itemize}

\subsection{\label{SSSEC:JUN96}Release of 26 June 1996}

\begin{itemize}

\item  Some small format and manual changes 14apr96.

\item  Fix bug with FORMAT passed to CHKSPD - problem with mixed modes.
17apr96.

\item  Fix bug with obscode default when tapeini not specified 18apr96.

\item Fix bug with SCANS optimization mode not going full
time. 19apr96.

\item Reverse sign of U in plots for normal convention. 23apr96.

\item Put tapeini and pass times in summary file. 23apr96.

\item Add TSETTLE to station catalog. 25apr96

\item Add INDXHEAD and HEADPOS to simplify VEX additions. 25apr96

\item Alter defaulting of FE to avoid need for 'OMIT'. 25apr96

\item Remove all INTEGER*2 to prevent confusion and because nonstandard.
      26apr96

\item Add much checking of VLA parameters (CHKVLA and BADLO) 29apr96.

\item Get rid of ALLVLBA option (produce VLBA type cards for all
      stations.  01 May 96

\item Split STAFILES out of main routine.  01 May 96.

\item Add calls to VEX routines, DOVEX input, and beginning Mark IV
      support.  01 May 96.

\item Remove MARK3 and VLBATP logicals - add VLBITP.  Make OBSTYP
      local to SCHIN.  02May96

\item Add routine CHKVLBA with checks of FE, SYNTH etc. 3May96

\item Set unused synthesizers to 10.9 GHz for 2 cm observations.

\item Add EARLY and DWELL to SUMITEM options.  6May96.

\item Add correlator parameters.  14 May 96.

\item Add DAR, RECORDER, NBBC, NDRIVEs, NHEADs to station catalog
      17 May 1996.

\item Add much stuff about VLA defaults.  Print to summary.
      22May1996

\item Add planets and JPL ephemeris.  Bryan Butler and RCW 26 Jun 96

\end{itemize}

\subsection{\label{SSSEC:APR96}Release of 13 Apr 1996}

\begin{itemize}

\item Move test of OBSCODE for inline tapeini stuff out to SCHIN.

\item Add TPSPEEDH and TPSPEEDL to setup files.  Make tape speed
default optimally so it doesn't need to be specified.

\item Improve various error checks.

\item Redo handling of DOSTA - don't read stations in first place.

\item Put S instead of F or R for direction in sch filewhen not
recording.

\item Remove TPSPEED from setup files.  Add comments giving tape
speeds and times.

\end{itemize}

\subsection{\label{SSSEC:FEB96}Release of 22 Feb 1996}

This is a slightly modified version of the \schedb that was
released within NRAO in December 1995.

This version included a number of evolutionary changes made up to
November 1995.  In that month, the {\sc VLBA OBSERVE (GNOMES)} project
was cancelled and it became clear that \schedb had much more of a future
than expected.  Many changes, including addition of plotting and dwell time
scheduling, along with massive changes in internal structure for both
maintainability and for eventual Mark IV support, were made.  Also
the help file was renamed the manual, formated for LaTeX and html, and
to a large degree, rewritten.  It is now this document.

The evolutionary changes before November 1995 were:

\begin{itemize}
\item Add {\tt REMARK} to valid parameters in source catalog. Someday,
      print it in the summary file. (1995 May 31)

\item First parallactic angle was PA2, not PA1, in PRTSCH. Fixed.
      (1995 June 4)

\item Added horizons. (1995 June 17)

\item Warn if automatic tape allocation requested. (1995 June 26)

\item Rewrite optimization mode routines for easier modification.
      (1995 June)

\item Increase maximum number of setup files to 50. (1995 June 25)

\item Make cover-like info in VLA observe file look like what
     {\sc VLA OBSERVE} observe makes so observe will read it.
     (1995 July)

\item Fix rounding of F6 numbers for VLA, since did wrong thing when
      negative. (1995 October 3)

\item Change reference pointing at VLA from {\tt IA} to {\tt IR}
      mode. Also, only put pointing request in VLBA control files if
      this is not a DAR-only station (1995 October 4)

\item Update some bits of VLA info in help file. A major review of the
      help file should be done soon. Also put the help file in HTML.
      (1995 October 4)

\item SCHIN had {\tt FASTF} instead of {\tt FASTFOR} as per the
      documentation. Change to {\tt FASTFOR}. (1995 October 30)
\end{itemize}

The big rewrite included:

\begin{itemize}

\item Added plotting.

\item Added dwell time scheduling.

\item Added new subroutines for setting up and reading KEYIN variables.
      It is now much easier to add and remove parameters.  Also,
      the number of inputs for arrays is now sensitive to the parameter
      statements.

\item Much restructuring of code.

\item Can now write telescope output files when optimization used.
      Optimization much better integrated into program.

\item Help file made into a manual and formated for LaTeX.

\item Manual made convertable to html by latex2html.

\item Reduced maximum stations and scans parameters.  Some variables
      with both dimensions were added so this keeps the size down.

\item Convert many time parameters to fractional days from radians
      inside program.  Not visible to user.

\item Allow in-line setup files much like the source and station
      catalogs.

\item Setup files are now required for all projects.

\item Allow a ``default'' station in setup files (eg for Mark II or
      experiment planning).

\item Relative order of ``VLBA'' default station and any specific
      stations in a setup file no longer matters.

\item SCHED no longer takes the number of channels from the main input
      file.  This is set only in the setup file.

\item The bandwidth is no longer required in the main file for
      observations using Doppler calculations --- it is obtained
      from the setup file.  It can still be changed in the main
      file.

\item The formats of the summary and sch files were changed somewhat.

\item SUN proximity warnings no longer overwrite other comments.

\item For dwell time scheduling, more general axis limits and slew
      rates were put in the station catalog.  Parameter HALIM was
      removed.

\item In the summary and sch files, scans below the horizon but
      above the slew limits are marked differently from scans below
      the slew limits

\item Scan timing specification was enhanced.  GAP was added to
      take the place of the usual use of PRESCAN.  PRESCAN is now
      just a tape start offset.  It can be negative for prestarting
      tapes.  The changes are backward compatible

\item \schedb internally calculates XYZ for stations if they are
      needed.  Mainly used in u-v plotting.

\item Put summary file output early enough in program that it is
      done and closed before plotting begins.  It can then be
      examined during plotting.

\item Now, when there is in-stream input such as tape initialization,
      source and station catalogs, line frequencies, or setup information,
      SCHED reads that input and then returns to reading input for
      the current scan.  No scan initialization is done.  Thus these
      in-stream inputs can go anywhere.  The main use of this will
      probably be to put the cover information at the top of the file.
      Another use is to put in-stream setup information in the main
      file at the scan where it is first used.  This is useful
      especially for test observations.

\item Let OPMINANT and OPMINEL apply regardless of optimization.  They
      are useful especially in planning.

\item The TPRATE parameter was removed.

\item Allow program restart from plotting input.

\item Allow setups with different numbers of tracks.  This can waste
      tape because the tape management will be done as if all scans
      used the maximum number of channels.

\item Allow specification of schedule input file name from main input.
      This allows one-time inputs, such as the request to plot, to be
      made before sending SCHED off to get the schedule input.

\item Add DEBUG which turns on some extra printing.

\item VLABAND and VLABW were moved to the setup file.

\item Added a toggle concept for many variables such as RECORD, TSYS,
      DOPPLER, etc.  Now they are paired with a NO... (eg NORECORD)
      that turns them off.

\item Added OPSTYPE=VLA for pure VLA observations.  This helps tell
      SCHED not to worry about tape related stuff.

\item Changed DOPCAL to DOPPLER to avoid the confusion with DO PCAL.
      Added NODOP to turn it off.

\item Got latest SLALIB and updated a couple of places where there were
      changes.  Also got email permission to use it.

\item Add OVERWRIT to allow sched to overwrite old files if desired.
      This is not the default as a safety measure.

\item Adding CSUB optimization mode.  The optimizes sky coverage.
      It includes subarrays.

\item Adding SUMITEM input to allow specification of what is in the
      summary file.

\item Changed {\tt XY} mount type to {\tt XYNS}.  Should add
      {\tt XYEW}.

\item When the station catalog is read, the position both in geodetic
      longitude, latitude, and elevation and in geocentric X,Y,Z
      are determined from the information provided.  The catalog
      should contain one or both of the above coordinates.  The
      conversion is accurate at the cm level for coordinates in
      WGS84.

\item Added Station XYZ to summary listing.

\item Allow vlba and vla defaults in {\tt TAPEINI} section.

\end{itemize}

\subsection{\label{SSSEC:16MAY95}Release of 16 May 1995}

\begin{itemize}
\item {\tt TAVLBA} mode, make second on-source qual 20 and add final
      off. (1994 December 21)

\item Bug fix: if one velocity was given in the source catalog, it
      was not used for other baseband channels. (1994 December 30)
\item Add tape summary to summary file. (1995 January 24)

\item Add setup name to summary listing. (1995 January 24)

\item Add third pcal tone when there are enough detectors.
      (1995 January 25)

\item Fix source name in error message when there are imbedded blanks.
      (1995 April 24)

\item Add to summary file a list of sources in format for transfer to
      the correlator data base. (1995 May 15)

\item Turn on {\tt UNLOAD} between tapes at 1-drive stations.
      (1995 May 16)

\item Fix problem with tape summary for stations excluded by {\tt
      DOSTA}. (1995 May 16)

\item Don't print the ``.set'' in the summary file if the setup file
      name is too long to fit. (1995 May 16)

\item Adding commands to control the 50cm filter.

\item Improved the reliability of writing the {\tt EXTLO} parameter.
      (1995 May 16)
\end{itemize}


Consult the old {\sl sched.hlp} file for changes before 1995.  It
can be obtained from Craig Walker.

%   ==================================================================
%   ==================================================================
%   ==================================================================

\section{\label{SSEC:WISH}Wish List}

This is a list of desired program changes, fixes or enhancements.  Note
that the list is not all that well maintained, so some items may have
been addressed, but not taken out here.


\begin{itemize}

\item Implement VEX2.  VEX2 contains a number of features wanted or 
      needed once antenna control is switched away from the legacy 
      system on the VLBA.  Already there are a number of comments in 
      the VEX file that are actually read by vex2script.  Those will
      become proper parameters.  Implementing VEX2 might not be a 
      very big job if the current VEX code is modified by the minimum
      amount.  But that code was written when the SCHED internal 
      bookkeeping was very poorly matched to the VEX style (it was 
      much more like the crd file or snap file style).  The result is
      an unnecessary level of complexity given the newer SCHED internal
      bookkeeping.   In the interests of code maintainability, it 
      would be a good time to simplify the VEX code.    Mar. 4, 2015 RCW

\item Search through this file for incomplete items, often flagged
      with a line of asterisks.  Generally, go through the manual looking
      for items that are not up to date.  The ongoing switch to RDBE and
      DBBC has caused many changes which may not have found their way into
      all parts of the documentation.  Before March 2015  RCW.
      Also check for broken links in external references.  Such things
      have a habit of changing, especially on the NRAO web site.

\item Allow VLAONLY schedules?  Maybe these don't differ from any other
      single station schedules any more. Before March 2015  RCW.

\item Support the new synthesizers with their 10 kHz tuning steps rather
      than the 200/300 MHz steps of the old units.  The basic valid 
      frequency check is in place but currently requires the user specify
      {\tt MODETEST} in the setup file.  What is not in place is the ability
      to utilize the fine tunability when automatically picking frequencies
      based on the contents of the {\sl freq\_RDBE.dat} file.  This would
      require a significant change in the nature of the frequency file as
      specifying all options would lead to too many.   It would
      be a fairly major job to implement this.  A much easier job, but 
      less capable, would be to use the current frequency file scheme and
      just add a few useful new cases.  If the user wants something else,
      they can just fully specify the setup, an option that has always
      been available.  Support for the new synthesizers will be required
      when they are deployed.  March 4, 2015.

\item Modify the choice of frequencies for the synthesizers that are not in
      use to reflect the capabilities of the new synthesizers.
      It should be easier to find settings whose harmonics won't interact
      with harmonics of the in-use synthesizers to cause internal RFI.
      Support for the new synthesizers will be required when they are 
      deployed.  Before March 2015  RCW.

\item Establish a scheme for obtaining the VLA pad positions based on the
      VLA station data and the locations of the few VLA pads in the geodetic
      data.  Program NEWLOC has that capability, but is not used now that
      we get KEYIN formatted files from the geodesy community.  Set up to
      drive the program based on the new data, which may mean reading the
      KEYIN locations.dat file.  Do some geodesy with 2 or 3 VLA antennas.
      March 4, 2015  RCW.

\item Revisit the whole issue of scan and recording start times.  Take
      into account any delays in start of correlation.  Also revisit 
      schtim.f for tape stoppages, readbacks etc.  The meaning of scan 
      times is now rather different from in the tape days and SCHEDs 
      bookkeeping is no longer all that well matched.  But be carefule 
      that any new scheme match what non-VLBA stations are doing.  This
      is not a critical change.  Before March 2015  RCW.

\item Remeasure VLBA slew rates.  Current ones probably too low.  I
      measured them right after discovering that they were below the VLBA
      specs.  But engineering did some readjustments that are not 
      reflected in the current catalog values. Before March 2015  RCW.

\item Make wideband standard setups for the DDC.  The legacy setups work
      for the DDC but don't go above 512 Mbps, and don't use the wide
      channels.  Currently, people brew their own, or get them from 
      some place other than the standard setups.  March 4, 2015  RCW.

\item Update the station code list. Before March 2015  RCW.

\item Update all examples for no Mark5A at VLBA. Mostly done.  In fact,
      revisit the entire suite of examples - it has grown organically 
      and lacks coherence now.  The number could be reduced.  Many were 
      added to demonstrate one new feature.  Those could be combined.  
      March 4, 2015  RCW.

\item Warn that even MHz frequency settings are poor for pulse cal
      because of aliasing.  Most observations are doing it now because 
      of PFB the restrictions, even though it is not necessary with 
      the DDC.  Before March 2015  RCW.

\item Put more in the summary file about multiple field centers - like 
      for each set, add the number of fields and field of view needed.
      Before March 2015  RCW.

\item Protect 2cm and 3mm better against inappropriate ch1 for filter
      in the IF converter.  We have had failed observations when channel 1
      could be in the wrong filter, so that was picked and the rest of
      the channels got no signal.  Before March 2015  RCW.

\item Allow more then 12 characters for setup name in .sum scan summary.
      Before March 2015  RCW.

\item Protect against excessively long lineset names. Before March 2015  RCW.

\item Need new constraints for VLA on channels per IF. Before March 2015  RCW.

\item Let the user know when sideband inversion is to be used in correlation.
      Before March 2015  RCW.

\item Add automatic alibrator selection.  Nice, but not critical.  Before 
      Mar 2014  RCW.

\item Add calibrator search.  There are other tools for this but so far the
      in-house ones are not being kept up to date.  Petrov has one that is
      more current, and has the large number of sources that are in his 
      catalog.  I have a stand-alone program, SEARCHSRC, in the 
      \$SCHED/RELATED\_CODE area that does a search.  It is particularly 
      useful because you can place a flux limit.  You can, for example, 
      find all sources greater than 5 Jy over the whole sky.  
      It uses the \schedb infrastructure and would likely be fairly easy 
      to incorporate into \sched.

\item Add a SUNAVOID parameter sort of like DODOWN that avoids pointing
      an antenna too close to the Sun.  Request for the CMVA from
      Krischbaum  Mar. 22, 2011.  Note added Feb 6, 2014.  The Sun
      distance is taken into account in the selection of sources for
      geodetic segments.  See GEOCHK.

\item Somehow provide for different VLA positions for single dish
      and phased array in the VEX file when mixing the two.  Dec. 8,
      2009 RCW.

\item Deal with VEX source positions when using satellite position
      calls for every scan/station.  There is an on-going debate in the
      VEX2 world about how to do this.   RCW July 22, 2009, updated
      March 4, 2015.  This item related to VEX2 above.

\item Warn about PCCOR not able to run when there is only 1 tone per 
      band.  Jan 13, 2009.  Requested by Kogan.  Better yet, fix
      PCCOR.  But with the new Pcal detectory, maybe we'll always 
      have more than one.  Updated March 4, 2015  RCW.

\item Have plot option to distinguish sources in XY plots by color.
      Right now, color is only used for stations.  RCW  Sept. 11, 2008.

\item Add aperture array axis type and whatever is needed to support it
      to the station catalog.  July 1, 2008 email request from
      James Anderson.

\item Make sure leap seconds are updated.  For SLALIB, update dat.f.  
      (That takes care of planets too).  For the satellite tracking, 
      update the kerfile (naifnnnn.tls) in the ephemeris area 
      (\$PLANET\_DATA).  If dat.f is updated for SCHED, propagate the
      changes to the pointing/gain programs.  Keep this entry in the 
      Wish List permanently.  Apr 8, 2008 RCW

\item Put information about frequency agility into SCHED. This could
      be fairly complicated as, in some cases, there are groups of
      receivers for which fast switching is possible and between which,
      hardware needs to change on the antenna (Effelsberg, for instance).
      The best scheme I've thought of is to have a matrix of switching
      times.  Dec 06 EVN TOG.  

      Related note from 2001:  Have some scheme to test for allowed 
      band switching at antennas that have partial capabilities.  
      This is coming on the EVN. Also deal with availability of more 
      than one receiver at a band. 21 June 2001  RCW.

      Another related note from 2000:  Model frequency change times 
      now that more antennas are getting multiple band capability.  
      For example, on GBT it is time to
      point to zenith, 1 minute to rotate, and point again - up to
      9 minutes.  Switching from Gregorian to prime focus is about
      5 minutes.  So far \schedb assumes either that it happens so
      fast that is doesn't really matter (VLBA) or so slow that it
      is not done during an observation (manual box change).
      8Dec2000 RCW

\item Warn if DOPPLER is not used when it looks like it should be.
      From Leonia (as contact) Aug 1, 2007.  RCW.

\item Try to name runlog after the observation.  Maybe a rename.  It
      is opened before the input is read so the project code is not yet 
      known.  But could it be renamed later - or a new file opened and the
      contents copied over?  From Amy.  25 Jan 2007.  RCW.

\item Improve optimization when switching bands.  emails from Greg Taylor and
      Steven Tremblay, early October 2006.

\item Write to screen the typing instructions in config mode.  Now uses
      WRTMSG and only goes to runlog.  Nov 29, 2006.  Need encountered again
      in Feb. 2015  RCW

\item Improve specification of multiple pass correlation.  And force
      specification when it is clear that multiple pass will be needed.
      Analysts  May 4, 2006.  See email from lfoley for details.

\item Put the grab time stuff in for Walter.  See \$SCHED/vlbagrab.txt

\item Need new OBSTYPE or get rid of OBSTYPE.  Old note  Jan 26, 2006.
      As of Oct 2008, I've forgotten the reason for this so I don't
      know what should be added.

\item Source dependent elevation limits for configuration studies.
      Request by Pat Crane.  Aug 2. 2004 RCW

\item Put an Az/El raster option in Sched.  Doing actions like measuring
      the horizon is hard with the current system.  From note Jul 2004 RCW

\item Get FIFMIN and MAX for user setups VLA and VLBA.  From note, Jul
      2004 RCW.  This has to do with sensing when you get outside the
      IF.

\item High resolution RD plots of Mars vs orbiters affected by
      diurnal parallax.  Also planet not plotted if start point not on
      field.  From note, Jul 2004  RCW.

\item Calculate range of acceptable dates based on solar distance for
      dynamically scheduled projects.  From Mat Lister 6/17/2004.

\item If PCALs are turned off, then back on, warn that they do not
      return to the same phase.  24 Nov 2003 RCW.  Note Mar 2015 - 
      I thought the problem was only when they powered off, but not
      sure.  RCW.

\item Plotting:  For beam, get beam size and some sidelobe statistics.
      21 Feb 2002 RCW.

\item Allow control of peakup channel when using autopeak.  21nov2001

\item Deal with DSN patching scheme.  Also Mark IV geodetic patching.
      15 Oct 2001  RCW.  May be obsolete in 2015.

\item The various DAR types need better documentation.  19sep2001 RCW.
      For example, VLBAG is not documented.

\item When two aliases are used for the same source in a schedule, there
      are some oddities.  A .vex file ends up with two source sections,
      of which one is empty.  The plotting acts like there are two sources,
      but all the plotted info is under one of them.  4 Apr 2001.  RCW.

\item Calculate data rates with mixed integration times.  Will need
      stations specified.  13dec99 RCW.

\item Make a USUBA input file if there is any subarraying.
      16nov99 RCW.

\item Add LEVEL to scan parameters.  27may98 RCW and Bryan Butler.
      It is already a setup parameter.

\item Warn of times of low fringe rate when the pulse cal tones
      might correlate.  15apr98  RCW.

\item Warn about CALCODE=G meaning the pulsar gate will be used.
      From paper note  8apr98 RCW

\item Networks:  Add checks related to special requirements at many stations.
      An example is the need for time for peaking scans at GB.

\end{itemize}


\appendix

\chapter{\label{APP:APPENDICES}APPENDICES}


\section{\label{APP:STACODES}Station Codes}

The following is the list of station codes used in VLBA and Global
Network scheduling as of Feb 1998.  It is a copy of
{\href{http://www.aoc.nrao.edu/~bclark/stationcodes.html}{BarryClark's file}}.
Note that normally only the two letter code is used for the
scheduling process.  This list clearly needs an update.

\begin{verbatim}
        Suggested 2-letter Observatory codes
(Also indicated are telescope codes for multi-telescope observatories)
Codes are capitals in machine readable usage.  The capital/lowercase
pairing below is used for readable concatenations on schedules, etc.
Table updated 96oct29.
------------------------------------------------------
Code      Location               Normal array   Schedule server
Ap      Algonquin, Canada
Ar      Arecibo, USA                            Socorro
As      Alice Springs, Australia     Sheve
At      Culgoora, Australia (ATCA)
Ba      Bangalore, India
Bl      Bear Lakes, Russia
Br      Brewster, USA                VLBA       Socorro
Ca      Cambridge, UK                MERLIN
Cb      Cambridge, UK (Ryle)
Cd      Ceduna, Australia                       ATNF
Ce      Cebreros, Spain
Ch      Chilbolton, UK
Da      Darnhall, UK                 MERLIN
De      Defford, UK                  MERLIN
Dw      Dwingeloo, Netherlands                  Bologna
Eb      Effelsberg, Germany (VLBA system)EVN        Bologna
Ef      Effelsberg, Germany (MkIV system)EVN        Bologna
Ev      Evpatoriya, Ukraine
Fd      Fort Davis, USA              VLBA       Socorro
Ft      Fortaleza, Brazil
Gb      Green Bank, USA                         Socorro
   GB=140', GBT=100m, GB85=85-3, GBTT=85-1
Gc      Gilcreek, USA
Gg      Goddard, USA
Gm      Narayan Gaon, India (GMRT)
Gn      Green Bank, USA              NAVY
Go      Goldstone, USA               DSN
   GO=70m, DS15=34m, DS12=Venus
Gz      Goldstone, USA               Tracking
Hc      Hat Creek, USA (BIMA)
Hh      Hartebeesthoek, S.Africa     Sheve      ATNF
Hn      Hancock, USA                 VLBA       Socorro
Ho      Hobart, Australia            Sheve      ATNF
Hs      Haystack, USA                CMVA
Hy      Hyderabad, India
It      Itapetinga, Brazil
Jb      Jodrell Bank, UK             EVN, MERLIN Bologna
   JB=Lovell, JB2=Mark2
Ka      Kashima, Japan                          Mitaka
   KA=26m, KB=34m
Kk      Kokee Park, USA              Navy
Kl      Kalyazin, Russia
Kn      Knockin, UK                  MERLIN
Kp      Kitt Peak, USA               VLBA       Socorro
   KP12=NRAO 12m
Ks      Kiruna, Sweden
Ku      Kauai, USA                   Defunct
Kw      Kwajalein, USA
La      Los Alamos, USA              VLBA       Socorro
Ma      Matera, Italy
Mc      Medicina, Italy              EVN        Bologna
Md      Maryland Point, USA          Defunct
Mg      Mount Graham, USA
Mh      Metsaehovi, Finland          EVN        Bologna
   MH=15m, MHGE=Geodetic
Mk      Mauna Kea, USA               VLBA       Socorro
Mm      Mauna Kea, USA               JCMT
Mo      Mojave, USA                  GEO
Mp      Siding Spring, Australia                ATNF
Ms      Mauna Kea, USA (CSO)
Na      Nancay, France
Nb      Nobeyama, Japan (mm array)
Nl      North Liberty, USA           VLBA       Socorro
No      Nobeyama, Japan                         Mitaka
   NO=45m, NO6=6m
Nt      Noto, Italy                  EVN        Bologna
Ny      Ny Alesund, Norway
Nz      Green Bank, USA              Tracking
Oh      O'Higgins, Chile
On      Onsala, Sweden               EVN        Bologna
   ON=20m, ON85=85'
Oo      OVRO 130' USA                CIT
Ot      Ooty, India
Ov      Owens Valley, USA            VLBA       Socorro
   OVMM=OVRO 10m, using OV transports
Pa      Parkes, Australia            Sheve      ATNF
Pb      Plateau de Bure, France
Pe      Penticton, Canada
Pt      Pie Town, USA                VLBA       Socorro
Pu      Pushchino, Russia
Pv      Pico Veleta, Spain
Qb      Quabbin, USA                 CMVA
Ri      Richmond, USA                Defunct
Ro      Robledo, Spain               DSN
   RO=70m, DS61=32m, DS65=High gain 32m
Rz      Robledo, Spain               Tracking
Se      La Silla, Chile (SEST)
Sc      Saint Croix, USA             VLBA       Socorro
Sh      Sheshan (Shanghai), China    EVN        Bologna
Sm      Simeiz (Crimea), Ukraine     EVN        Bolgona
St      Santiago, Chile
Sv      Svetloye, Russia
Ta      Tabley, UK                   MERLIN
Ti      Tidbinbilla, Australia       DSN
   TI=70m, DS45=34m
To      Toulouse, France
Tr      Torun, Poland                EVN        Bologna
Tz      Tidbidbilla, Australia       Tracking
Ud      Usuda,Japan                             Mitaka
Ur      Urumqi, China                EVN        Bologna
Us      Ussuriisk, Russia
Uu      Ulan-Ude, Russia             Defunct
Uz      Usuda, Japan                 Tracking
Wa      Wardle, UK                   Defunct
Wb      Westerbork, Netherlands      EVN        Bologna
   WB=Phased array
Wf      Westford, USA
Wh      Weilheim, Germany
Wz      Wettzell, Germany
Y       VLA, USA                                Socorra
   Y=Phased array, Y1=Standard single ant. other stations = Y-arm-stn#
Yb      Yebes, Spain                 EVN        Bologna
Yk      Yellowknife, Canada
Zc      Zelenchukskaya, Russia
----------------------------------------------------------------

\end{verbatim}



\section{\label{SEC:HIST}Historical Notes}

\schedb was written by R.C.~Walker (RCW) in the late 1970's for Mark~II VLBI
scheduling. It was part of the Caltech VLBI package.  It received a
number of modifications over the following decade by the author and
others, including Tim Pearson, John Benson, and Mark Hodges. Beginning
in 1988, the program was extensively revised by RCW to accommodate
VLBA, and eventually global VLBI, scheduling.  In 1991, a project to
write {\sc VLBA OBSERVE} was been begun by the NRAO with the
programming being done by Wes Young.  \schedb development was at a a
minimal level during this development project as it was thought that
the program would soon be retired.

In the Fall of 1995, the {\sc VLBA OBSERVE} project was cancelled.  An
intensive effort was made then to add many of the features whose need
had become apparent during the period of minimal development.  In the
Spring of 1996, Huib van~Langevelde of JIVE, then stationed at NRAO,
began work on the VEX additions which became a significant part
of the program.  Also, at about that time, Brian Butler provided the
code needed to add the planet capability that is important for single
dish pointing and gain measurements at high frequencies.  Rick Lively
provided systems support including writing makefiles and helping with
interactions with users who were trying to install the programs on
other machines.  In January 1998, Franco Tinarelli of Bologna delivered
the first code for point-and-click control of the \schedb plotting
functions and has been supporting the plot functions ever since.  In
2002, Cormac Reynolds took over support of the Vex portions of the
code from Huib.

\schedb is currently the primary scheduling program used for
astronomical VLBI.  It is also capable of scheduling many types
of observations on the VLA.

\chapter{\label{APP:OBSOLETE}OBSOLETE SECTIONS}

This chapter is a repository of documention of SCHED's capabilities
for systems that are no longer in use.  It will not normally be of
interest for current users.  Much of what is here is details of
handling tape.

\section{\label{SEC:OLDVLA}Old VLA}

Note that much of what is below applies to the old VLA system and 
has changed drastically with the EVLA upgrade. See the
earlier section on VLBI at the VLA for more current information.

\schedb can be used to schedule essentially all types of VLBI
observations on the VLA.  It can also be used instead of {\sc OBSERVE}
to schedule pure VLA observations involving a limited subset of the
special cards that can be in VLA schedules.  This includes most
continuum observations.  This situation is likely to evolve as the EVLA
upgrade, which includes a new control system, comes on line, so stay
tuned.  For more information on the VLA, check out
the VLA from the NRAO home page at 
{\href{http://www.nrao.edu}{{\sl http://www.nrao.edu}}}.
For much detailed
information on VLBI at the VLA, follow the links to
{\href{http://www.vla.nrao.edu/astro/guides/vlbivla/current/}{VLBI at the VLA}}.
The latter document is available in postscript form
from the VLA home page.

All observations at the VLA need an observe file that is used by the
VLA on-line computers to control the antennas and correlator.  In
addition, all VLBI observations at the VLA also require a VLBA-style
control file for the VME that controls the VLBA data aquisition rack
and recorder.  \schedb produces both kinds of files.

The VLBA control file, called {\sl bq001crd.y} by \schedb for an
example project with {\tt EXPCODE=bq001}, is similar to those provided
for VLBA stations, except that some VLBA specific commands for
receivers, etc. are omitted. This file controls BBC settings, when the
recorder starts and stops, and other recording details.

The observe file, called {\sl bq001obs.y} by \schedb in this example,
is the file that is normally created by the NRAO program {\tt OBSERVE}
(can be found from the 
{\href{http://www.nrao.edu}{NRAO home page}})
and given to the VLA on-line system. While
\schedb is intended for VLBI scheduling and this output is provided
mainly for projects that use the VLA for VLBI, there is no reason that
it cannot be used for scheduling pure VLA projects. In fact, a few
parameters of interest only for non-VLBI projects are provided for VLA
observers, including the ability to schedule in LST. However, \schedb
has only limited ability to provide the special setup cards, namely
those that start with ``//''.

\schedb can provide ``//LO'' and ``//FI'' cards with parameters to set
synthesizers to fixed values. The setup file can be used to provide
values for the synthesizer settings. If 
{\hyperref[MP:FREQ]{{\tt FREQ}}}
or 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}} is used, the BBC settings will
be adjusted to try to reach the right frequency for the VLBI
data. Note that this has no effect on the VLA observing
frequency. ``//LO'' and ``//FI'' cards are provided if, and only if,
the required information is present in the setup file or could be
obtained for the setup file by \schedb from the frequency catalog.
\schedb also provides the ``//PM'' cards if proper (or planetary)
motion is present for the source in the source catalog. Since the
epoch of zero offset is given in IAT, IAT-UTC must be provided with
parameter 
{\hyperref[MP:IATUTC]{{\tt IATUTC}}} in the \schedb keyin
file. If other ``//'' cards are needed, or other options are needed on
the ``//LO'' and ``//FI' cards, the regular VLA {\sl OBSERVE} must be
used or they must be edited in by hand. Beware of the fixed formats:
if values are put in the wrong columns, the VLA on-line system will
not behave as expected!

\schedb checks the ranges of the frequency settings given for the
``//LO'' cards.  But the EVLA has made it possible to reach
frequencies far outside the range of the original VLA hardware.  Such
frequencies can be requested using frequency settings in the style of
the VLA, but outside the allowed VLA ranges.  In addition, the
parrameter {\tt EVLA} should be given in the setup
file to turn off some of the checks of frequency ranges.  This is all
at a primitive state as of Fall 2007 and will be updated as the EVLA
matures.

\subsection{\label{SSEC:VLAVLBIOLD}VLBI at the VLA - old system}

Note that many of the details of what is below applies to the old VLA
system which is no longer in use.  

For much detailed information on VLBI at the VLA, follow the links to
the 
{\href{http://www.vla.nrao.edu/astro/guides/vlbivla/current/}{VLBI at the VLA guide}}.

There are two very different modes in which VLBI can be done at the
VLA.  These are single dish and phased array observations.  For single
dish VLBI observations, the IF signals from one antenna of the array
are sent to the VLBI recording equipment (VLBA DAR and recorder).
Other than having to worry about the VLA's rather complicated LO
system, such observations are very similar to observations at other
VLBI observatories.  The phased array observations, on the other hand,
have some very special needs.  For such observations, the signals from
all VLA antennas are summed in the VLA correlator and the summed
signal is sent to the VLBI equipment.  This gives a sensitivity for
the ``antenna'' that is increased by about the number of phased
antennas, {\em if} the array is phased properly.  Array phasing is
accomplished by the on-line control system.  Output phases from the
correlator are used to derive adjustments to the phase of the LO at
each antenna that, when applied, will cause the next correlator phases
to go toward zero.  The system can phase up on a calibrator and then
freeze the phases on a target source when the target source is either
too weak, resolved, or confused for successful phasing.

The type of VLA observation is distinguished by the 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}}.
{\tt VLAMODE = VS} indicates single dish
observing.  {\tt VLAMODE = VX} indicates phased array observing, but
using the phases from a previous phasing scan.  {\tt VLAMODE = VA}
indicates phased array observing with phasing on the VLA {\tt A} and
{\tt D} IFs and is the usual active phasing mode.  {\tt VLAMODE = VB}
is similar, but with phasing on the VLA {\tt B} and {\tt C} IFs.  {\tt
VLAMODE = VR} or {\tt VL} indicates phased array observing using,
respectively, the VLA {\tt A} and {\tt B} or {\tt C} and {\tt D} IFs.
As might be deduced by this, because of hardware limitations, the VLA
can only phase one of the {\tt A} and {\tt C} IFs and one of the {\tt
B} and {\tt D} IFs.  The {\tt VLAMODE} can be changed on a
scan-by-scan basis.  See the description of the setup parameter
{\hyperref[SP:IFCHAN]{{\tt IFCHAN}}} for more information on routing VLA
IFs to VLB IFs.  {\tt VS} mode (single dish) can be mixed with the
phased array modes, but the number of changes back and forth should be
limited.  Normally this would only be done when atmospheric
calibration, geodetic-like (DELZN) sections are included in a phase
referencing project.

The reference antenna can be controlled with parameter 
{\hyperref[MP:VLARFANT]{{\tt VLARFANT}}}.
That will be the antenna from which data are
recorded in single dish mode and the reference antenna (whose phases
are not changed) for the phased array modes.  Normally users should not
worry about setting {\tt VLARFANT} because the default is usually
good, and if not, you will not know in time and the change needs to be
made by operations.

For successful phasing of the array, a source must be greater than
about 0.1 Jy (see the guide referenced above for details) and have a
position that is good to a fraction of the VLA synthesized beam
(enhanced sensitivity is only obtained over this area).  It must have
small structure phases and not have other sources in the primary beam
that might confuse the phasing algorithm.  The position accuracy is
especially important if a calibrator is being used to phase the array
for observations of another source.  Adding phasing sources is tricky,
because it is desirable to spend a minimum amount of time on them, but
if they are missed, the rest of the data will be bad.  It is possible
to try to influence the speed of phasing by using 
{\hyperref[MP:VLAINTEG]{{\tt VLAINTEG}}}
to adjust the correlator integration time.  The default
is 10 seconds.  Use of a shorter time may speed phasing but is done at
the expense of added noise.

There are two ways to deal with VLBI observations that require
phasing on a source different from the target source.  The best
is probably to simply schedule VLBI scans, with the proper 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}},
on the phasing source.  These observations
can then also be used to assist the VLBI calibration, assuming an
appropriate calibrator has been chosen.  The other scheme is to
insert calibration scans into the VLA's schedule file (the OBSERVE
file), but not the VLBI control file, for the phasing operation.
\schedb provides some tools to simplify this operation.  It can
also be done using the {\sc VLA OBSERVE} program.  This is done
by the VLA analysts for some programs.

For VLBI observations at the VLA, both an OBSERVE file and a VLBA
style control file are needed and can be created by \sched.  All of
the controls provided for managing recordings for the VLBA also work
for the VLA.  \schedb also has special capabilities for scheduling VLA
observations as described below.

For observations that require phasing on a calibrator, the array must
be phased in auto-phasing (
{\hyperref[MP:VLAMODE]{{\tt VLAMODE = VA}}})
mode prior to VLBI observations of the target source in
extended-phasing (
{\hyperref[MP:VLAMODE]{{\tt VLAMODE = VX}}}) mode.
These calibrator observations constitute additional scans that must be
in the VLA observe file, but that no other VLBI observatory or the
recorder control file for the VLA needs to know about. (Note that
Westerbork needs something of the sort, but they have never requested
special information in \schedb output files).

If it is desired to add phasing scans on a calibrator on which VLBI
data will not be recorded and that will not be observed at the other
VLBI observatories, the parameter 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}}
can be used.  If a 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}} is given,
\schedb will automatically insert phasing observations in the VLA
OBSERVE file at appropriate times.  Note that 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}}
must be a source in the same catalogs that are searched for 
{\hyperref[MP:SOURCE]{{\tt SOURCE}}} and 
{\hyperref[MP:DOPSRC]{{\tt DOPSRC}}}.
\schedb will add a phasing scan to the observe
file which will end either 1 minute before the main VLBI scan starts,
or 3 minutes after the previous VLBI scan ends, whichever is later.
If the latter option is used, \schedb complains if less than 2 minutes
of the VLBI scan remains.  Also with the latter option, the VLBA-style
control file will still start the recorder when the main VLBI scan
was supposed to start. This keeps recording at the VLA and other
sites synchronized, although it can lead to the need to flag data that
won't have VLBI fringes. \schedb will not add a phasing scan if the
VLBI scan is in 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE=VA}}} or if
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}} is the same as 
{\hyperref[MP:SOURCE]{{\tt SOURCE}}}.
This avoids the need to keep respecifying
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}} whenever a VLBI calibrator is
observed in mode {\tt VA} and prevents the addition of unnecessary
extra scans when the VLBI schedule calls for observations of the
phasing source.

It is highly recommended that the NRAO {\sc OBSERVE} program be used
to check the VLA observe file for slew and dwell times on the phasing
sources. The scan stop times may have to be adjusted with {\sc
OBSERVE} to obtain an adequate amount of on-source time for phasing.
It is especially critical to be careful about slew times for sources
near the zenith where long azimuth slews may be needed to go a short
distance on the sky.  \schedb only recently acquired to ability to
calculate slew times and this has not yet been extended to the VLA
phasing scans.  This is an area of future construction.

\schedb is also able to deal with reference pointing using the
{\hyperref[MP:PEAK]{{\tt PEAK}}} command.  Refer to the description
of {\tt PEAK} for details.  The 
{\hyperref[SSEC:VLAONLY]{VLA-only example}}
below uses this capability.

\subsubsection{\label{SSSEC:VLBIEG}An Example}

Below is an example of a file for a VLBI observation that uses the
phased VLA.  For phasing, a source is used that can also be used as a
VLBI phase or fringe fitting reference.  All antennas are sent to the
reference and VLBI data is taken on it.  This is now the prefered
style for phasing.  Of course the 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC}}}
parameter could also have been used if non-recording scans with only
the VLA on the calibrator had been desired.

Note that the 
{\hyperref[SSEC:EXAMPLE1]{main example}} in the
{\hyperref[SEC:EXAMPLES]{Examples}} section has a single VLA antenna
in it and serves as an example of that type of observing.

% no longer there \verbatiminput{../examples/vla_vlbi.key}

\subsection{\label{SSEC:VLAONLY}VLA-Only Project Example}

\schedb cannot be used for scheduling the EVLA (yet anyway) and the
old VLA system has been turned off.  So the following section is not
of much use now.  Once VLBI at the EVLA has been established, the
capabilities to schedule EVLA runs with \schedb will be revisited.

This second VLA example demonstrates the use of \schedb to schedule a
pure VLA project.  The \schedb input for VLA observations is very much
like that for VLBI observations.  There are some parameters provided,
and listed below, to control some of the input information for which
the VLBI defaults may not be appropriate.  The example is a modified
version of an actual schedule used to make the VLA observations
described.  The modifications were required by changes in the way in
which \schedb handles setup files and the parameters {\tt
VLABAND}, {\tt VLABW}, {\tt
PEAK}, 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE}}} (for pointing
scans), and 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}}.  Some of these
parameters are now read from the setup files, not the main schedule
input.

\verbatiminput{../examples/manual_vla-cc.set}

\subsection{\label{SSEC:VLAPAR}Parameters Specific to the VLA}

The VLA capabilities in SCHED are for the old VLA system that has
been shut down.  Stay tuned for instructions related to running
the EVLA (VLA).

This section gives a brief description of each of the parameters
available to \schedb that are specifically for VLA observations or
are especially useful for VLA observations.  More general purpose
\schedb parameters that are also required for other stations are
not mentioned.  For details on the parameters, consult
the detailed descriptions of each parameter.  The first list
is of parameters in the main schedule input.  The second is of
setup parameters.

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item 
{\hyperref[MP:VLATYPE]{{\tt VLATYPE:}}} Specify the type of observations.
Should be provided for non-VLBI observations. Valid options are {\tt
'VLBI'}, {\tt 'CONTINUUM'} or {\tt 'LINE'}.

\item 
{\hyperref[MP:VLATSYS]{{\tt VLATSYS} and {\tt VLANTSYS}}} These turn on
and off the Tsys corrections made to the correlated VLA data. This
used to be required in order to obtain calibration data for the VLBI
observations. That is no longer true so most observations can be made
with the Tsys corrections turned on which is now the default.

\item 
{\hyperref[MP:VLAPEAK]{{\tt VLAPEAK}}} controls reference pointing
on the VLA.  It is a good idea to do reference pointing when
observing at 7 mm.  See the section on 
{\hyperref[SEC:REFPOINT]{Reference Pointing}}
to see how to get \schedb to insert reference pointing
scans automatically.

\item 
{\hyperref[MP:VLAUSERN]{{\tt VLAUSERN:}}} This gives the VLA user
number. The default of 600 is reasonable for VLBI but the actual user
number should be provided for other types of projects.

\item 
{\hyperref[MP:VLAMODE]{{\tt VLAMODE:}}} Specify the VLA mode.
Common options for VLBI are {\tt ' '}, {\tt VA}, {\tt VX}, or {\tt
VS}. See VLA documentation on the many others that are available
for non-VLBI observations.

\item 
{\hyperref[MP:LST]{{\tt LST:}}} Schedule is assumed to be in LST. {\tt LST}
specified without a value assumes the VLA. A station name can be given
as the argument, in which case the {\tt LST} is for that station. When
{\tt LST} is specified, the {\tt DAY} must be the modified local
sidereal day number as found on VLA monthly schedules.

\item 
{\hyperref[MP:LST]{{\tt DAY:}}} Must be the modified local sidereal
day number as found on VLA monthly schedules if {\tt LST} is
specified. In such cases, {\tt YEAR} and {\tt MONTH} are ignored.

\item 
{\hyperref[MP:IATUTC]{{\tt IATUTC:}}} Difference between IAT and UTC,
which is currently about 30 seconds. This is only used for setting the
zero offset epoch for the ``//PM'' (proper motion) card.

\item 
{\hyperref[MP:SETUP]{{\tt SETUP:}}} Specifies the setup file from
which information for the ``//LO'' and ``//FI'' cards are taken.

\item 
{\hyperref[MP:FREQ]{{\tt FREQ:}}} and 
{\hyperref[MP:DOPPLER]{{\tt DOPPLER}}}
Warning --- these parameters cannot be used for non-VLBI observations
at the VLA since they are only used to adjust the baseband converter
frequencies.

\item 
{\hyperref[MP:RECORD]{{\tt RECord:} and {\tt NORECord}}} These parameters
find one of their main uses in observations that use the VLA, especially
the phased array.  It is often useful, for both phasing scans and for
scans inserted just for calibration of the VLA, to be able to turn the
VLBI recorders off.  {\tt RECord} and {\tt NORECord} can be used
to specify which scans should be recorded on the VLBI drives and which
should not be.

\item 
{\hyperref[MP:VLAPSRC]{{\tt VLAPSRC:}}} Phasing source to use
before a VX mode scan.  This is a convenient way to insert VLA phasing
scans without having to explicitly include extra scans in a VLBI
schedule.

\item 
{\hyperref[MP:VLARFANT]{{\tt VLARFANT:}}} Reference antenna to use
for single dish data source or as phasing reference for phased array.
The default should be good, and, if not, operations is likely to need
a last minute change, so it is unlikely that users should use this
parameter.

\item 
{\hyperref[MP:VLAINTEG]{{\tt VLAINTEG:}}} This parameter gives the
correlator integration time.  It would normally be used to give a
value less than 10 seconds to encourage faster phasing.


\end{list}

The parameters in the setup file that apply only to the VLA are
below. They are used to set the band and bandwidths of the VLA and
for setting up the ``//FI'' and ``//LO''  cards.

The values for all of these parameters, except {\tt FLUKESET, VLAIF,
and VLAROT,}, which are not normally needed, can be determined by
\schedb from the 
{\hyperref[SSEC:FREQLST]{frequency catalog}}.  Therefore
most projects do not require VLA specific parameters in the setup
files.

The setup file parameters are:

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item {\tt FEFILTER:} The front end filters are
normally 50~MHz wide. If there is strong RFI near the observing
frequency, as is common at L and P bands, it may be desirable to use
the 25~MHz or 12.5~MHz front end filters. This parameter is used to
request the filters to use. It goes on the ``//LO'' card.

\item {\tt FLUKESET:} Which flukeset (1 or 2)
to be used. Unfortunately there seems to be no good way to predict
this reliably. Usually Flukeset 1 will be used for phased array and
normal VLA observations while Flukeset 2 will be used for single
antenna VLBI, but this is not always true. The VLA operators should be
alerted that Flukeset specified on the ``//FI'' card might have to be
changed. If it is not specified, or is set to 0, a blank will be given
and the VLA operators will set it.

\item {\tt VLABAND:} Specify the frequency band.
Must be one of the defaults without the //LO and //FI cards.  Some
valid options are {\tt VP, VL, VC, VX, VK, PP, LL, CC, XX, UU, KK,
HH,} or 18.  For complete information on the standard bands, see
the following 
{\hyperref[SSEC:VLASTDBD]{section}}.

\item {\tt VLABW:} Specify the back end bandwidth
for each of the 4 VLA IFs as a 4 digit number in quotes (\schedb
treats it as a character string), with one digit for each IF. The
default is {\tt '0000'} for 50~MHz in each IF. The consequent back end
bandwidth is {\tt 50/(2**n)}~MHz, where {\tt n} is the digit
specified.

\item {\tt FLUKEA:} A Fluke synthesizer frequency.
It is usually near 100~MHz. See the document ``VLBI at the VLA'' for
details on what it should be. See Section~\ref{SEC:LINE} for more
information on the frequency settings.

{\tt FLUKEB:} B Fluke synthesizer frequency.
Actually this is the value for the ``//FI'' card which is twice the
actual synthesizer setting.  To get the same frequency on the AC and
BD IFs, {\tt FLUKEB} should be {\tt FLUKEA} plus 100.0.

{\tt VLAFEAB:} 1st LO for the VLA observations
for the AB (RCP) IFs. For standard VLBI projects, the value should be
-3.2 for L band, 0 for C band, and 17.5 for K band. Again see VLA
documentation for details of other alternatives.

{\tt VLAFECD:} Same as {\tt VLAFEAB} but for
the VLA's C and D (LCP) IFs.

{\tt VLASYNA:} 2nd LO for the VLA A and C IFs.
On the ``//LO card'' this number is rounded to the nearest MHz, but it
should be given here exactly. It is usually near 3900~MHz. It must be
a value of {\tt N * 50 +- 10.1}~MHz.

\item {\tt VLASYNB:} Same as {\tt VLASYNA} but for
the VLA B and D IFs.

\end{list}

\subsection{\label{SSEC:VLASTDBD}VLA Standard Bands.}

All of the below will change with the EVLA, which can reach just about
any frequency.  The following is basically obsolete.

A total of 19 standard observing bands are defined at the VLA.  All
projects should specify one of these bands, even when frequencies will
be modified.  This ensures that various defaults at the VLA get set
properly.  Just pick one with similar properties.  For VLBI, one of the
``V'' bands should be chosen.

The tables below describe the bands.
The first show the band names along with the synthesizer settings.
The column headings are the SCHED names (not necessarily the traditional
names in use at the VLA) for these parameters.  The second table gives
the value that \schedb would want for the VLBI 
{\hyperref[SP:FIRSTLO]{{\tt FIRSTLO}}}
parameter when using the standard setup.  If the
frequencies are modified, {\tt FIRSTLO} would need to be altered.
\schedb will insure that {\tt FIRSTLO} agrees with the frequency
that will be obtained with the settings used.  The other columns
in the second table show the range of sky frequencies covered by
the VLA band.  The observing frequencies must lie in these bands.  Note
that the first frequency is that of the edge converted to DC, and then
to 600 MHz in the signal sent to the VLBI rack.  The other end of the
band can be a lower frequency if there is a net lower sideband at this
point (the BBC's can be used in lower sideband mode to get a final
net upper sideband).

% Note that this table was created from the vla on-line system's
% standard bands file using program VLABANDS.  There were some more
% recent modifications made by hand.

The VLA band {\tt VQ} will be changed a few months into 2001.  The
table below gives the frequencies for the new version.  The old version
was 80 MHz higher in frequency and missed the SiO line at 43.122 GHz.
The current plan is to switch \schedb to the new {\tt VQ} in January
2001, but have \schedb always write {\tt LO} and {\tt IF} cards in
the VLA observe file for 43 GHz observing, even when using the standard
band.  After a few months in which any schedules made with the old
scheme are flushed through the system, the VLA on-line system will
be switch to the new standard.  Some months after that, \schedb will
stop writing the {\tt LO} and {\tt IF} cards for the new standard
{\tt VQ} band.

\begin{verbatim}
          VLA STANDARD BANDS - VLA SYNTHESIZER SETTINGS
VLABAND  VLAFEAB  VLAFECD  VLASYNA   VLASYNB   FLUKEA     FLUKEB  FEFILT
  CC      0.00      0.00    3860.1    3810.1  100.00000  200.00000  0000
  UU     19.60     19.60    3610.1    3660.1  100.00000  200.00000  0000
  KK     17.60     17.60    3860.1    3810.1  100.00000  200.00000  0000
  LL     -3.20     -3.20    3639.9    3560.1  100.00000  200.00000  0000
  XX     13.40     13.40    3939.9    3889.9  100.00000  200.00000  0000
  QQ     51.60     13.00    3689.9    3739.9  100.00000  200.00000  0000
  PP      0.00      0.00    -689.9    -710.1  115.83750  230.10000  1111
  44      0.00      0.00    -939.9    -939.9  112.91875  212.91875  0000
  4P      0.00      0.00    -939.9    -689.9  112.91875  215.83750  1111
  LP     -3.20      0.00    3639.9    -689.9  100.00000  215.83750  0101
  18     -3.20     -3.20    3839.9    3810.1  100.00000  200.00000  0000
  HH     -3.20     -3.20    3589.9    3639.9  115.10000  215.10000  0000
  VP      0.00      0.00    -689.9    -689.9  112.50000  212.50000  1111
  VL     -3.20     -3.20    3839.9    3839.9  100.00000  200.00000  0000
  VC      0.00      0.00    3960.1    3960.1  100.00000  200.00000  0000
  VX     13.00     13.00    3560.1    3560.1  100.00000  200.00000  0000
  VU     19.90     19.90    3510.1    3510.1  100.00000  200.00000  0000
  VK     17.50     17.50    3710.1    3710.1  100.00000  200.00000  0000
  VQ     51.60     13.00    3510.1    3510.1  100.00000  200.00000  0000

          VLA STANDARD BANDS - VLBI FIRSTLO and VLA BANDPASSES
VLABAND FIRSTLO A  FIRSTLO D         BANDPASS A           BANDPASS D
  CC     4260.10     4210.10     4860.10-  4910.10    4810.10-  4860.10
  UU    15589.90    15539.90    14989.90- 14939.90   14939.90- 14889.90
  KK    21860.10    21810.10    22460.10- 22510.10   22410.10- 22460.10
  LL      839.90      760.10     1439.90-  1489.90    1360.10-  1410.10
  XX     9060.10     9110.10     8460.10-  8410.10    8510.10-  8460.10
  QQ    42689.90    42739.90    43289.90- 43339.90   43339.90- 43389.90
  PP  -274.06250     -280.00   325.93750-350.93750     320.00-   345.00
  44  -526.98125  -526.98125    73.01875-123.01875   73.01875-123.01875
  4P  -526.98125  -274.06250    73.01875- 98.01875  325.93750-350.93750
  LP      839.90  -274.06250     1439.90-  1489.90  325.93750-350.93750
  18     1039.90     1010.10     1639.90-  1689.90    1610.10-  1660.10
  HH      805.00      855.00     1405.00-  1455.00    1455.00-  1505.00
  VP     -277.40     -277.40      322.60-   347.60     322.60-   347.60
  VL     1039.90     1039.90     1639.90-  1689.90    1639.90-  1689.90
  VC     4360.10     4360.10     4960.10-  5010.10    4960.10-  5010.10
  VX     9039.90     9039.90     8439.90-  8389.90    8439.90-  8389.90
  VU    15989.90    15989.90    15389.90- 15339.90   15389.90- 15339.90
  VK    21610.10    21610.10    22210.10- 22260.10   22210.10- 22260.10
  VQ    42510.10    42510.10    43110.10- 43160.10   43110.10- 43160.10
 Note that IF A and C are usually at the same frequency as are B and D.

\end{verbatim}


\section{\label{SSEC:TAPEMANAGEMENT}Tape Management}

\subsection{\label{SSSEC:TAPEGEN}GENERAL CONCERNS}

A fact of life with VLBI has been that the data are recorded on tapes
and tapes have various limitations.  Tapes are not infinitely long and
they cannot be stopped and started instantaneously.  Whenever they are
stopped, they must be resynchronized at the correlator, which takes a
few to a few tens of seconds.  Also tapes have finite bandwidth and
capacity.  The instantaneous bandwidth cannot be exceeded.  This
section provides some detail on various aspects of tape management.

Many of the concerns described here do not apply to the disk based
recording systems (mainly Mark5) that began to be deployed in 2003.
The disk systems can start and stop very quickly and take less time to
be synchronized on the correlators.  There still are limitations on
the total bit rate and recording volume.  But disk management is be
much less visible to the user than tape management.  For the rest of
this section, we are talking about tapes.  Hopefully by late 2005,
this whole section can be relegated to a historical appendix to this
manual.

The scheduler always has to worry about not exceeding the amount of
tape that has been allocated for the project.  For projects only
including stations that use automatic tape allocation (eg VLBA, VLA,
and GBT), that should be the only concern other than providing
occasional gaps for readback tests, as described later, and not
stopping the tape too often.  Automatic tape handling is described in
more detail below in the section on 
{\hyperref[SSSEC:AUTOTAPE]{automatic tape allocation}}
and in the description of the
{\hyperref[MP:AUTOTAPE]{{\tt AUTOTAPE}}} input parameter.  If there are
any stations at which automatic tape handling is not being used, the
scheduler has a lot more to worry about.  Tape reversals, without
automatic tape handling, can only occur at scan boundaries.  For
efficient tape usage, the schedule must have scan breaks at
appropriate intervals given the tape type and recording speed.  More
is said about this below, especially in the section on 
{\hyperref[SSSEC:TAPELEN]{tape lengths}}.

The schedules sent to the antennas will also have to specify such
details as track assignments, head positions etc unless automatic
tape allocation is used.  The user, however, should not need to
worry about these details since \schedb has defaults that work fine
in all but odd test observations.  For the masochistic, the details
of the \schedb defaults are given in Appendix \ref{APP:HEAD}.

The maximum bit rate that can be recorded on a VLBA tape is 256 Mbps.
The systems at the VLBA antennas and at the VLA and Green Bank have
two drives and can use both simultaneously to achieve 512 Mbps.
Mark IV systems can have 2 head stacks on a single drive to achieve
512 Mbps.  In addition, they can record at 16 Mbps per track, twice
the normal maximum rate.  With both heads recording at 16 Mbps per
track, the Mark IV systems can reach 1024 Mbps.

When part of an project uses the two drive (VLBA) or two head
(Mark IV) mode, all of that project will be recorded in that mode.
If some scans use narrower bandwidth, the tape drives will be slowed.
This avoids lots of confusion in keeping track of tape usage.

\subsection{\label{SSSEC:TAPESCAN}TAPE HANDLING at SCAN BOUNDARIES}

There are a number of concerns related to tape handling at scan
boundaries.  \schedb provides a variety of ways to specify what is
to be done.  Between scans, tapes can be kept running or can be
stopped.  If they are stopped, they can be started at the nominal
start time, or at some other time, usually earlier.  The actions
taken can strongly influence how well correlation proceeds.  Whenever
a tape is stopped, there is some time lost to resynchronize on
the correlator.  Also, with short segments of tape motions, it is
possible for the VLBA correlator to wind up sufficiently far out
of sync that it does not recover until either the end of the pass
or the end of the correlator job.  Basically, if the schedule consists
of long scans, it doesn't really matter much what is done.  But if
it has many short scans, such as when phase referencing, it can be
highly advantageous to keep the tape moving between scans.

Obviously, tapes must be stopped at the ends of passes so that their
direction of recording can change.  They also must stop when they are
changed.  If there are long gaps (many minutes) between scans, tape
use efficiency is enhanced if the tapes are stopped.  If automatic
tape handling is being used (normally true at the VLBA and VLA, but
not elsewhere), tape stoppage at pass and tape ends will happen
automatically and the user need not worry about them.  The user
should, however, provide occasional tape stoppages of at least 2
minutes (4 min in VLBA 512 Mbps mode) to allow for 
{\hyperref[SSSEC:READBACK]{readback tests.}}
These need not be at the ends of passes.

As the gap between scans gets shorter, or the scans become more
frequent, it becomes advantageous to keep the tapes rolling between
scans, assuming that the correlator does not require that they stop
(the older Mark III system had such a requirement).  One way to do
this is to use 
{\hyperref[MP:DUR]{{\tt DURation}}} rather than 
{\hyperref[MP:DWELL]{{\tt DWELL}}}
to specify scan times and not give any command such as
{\hyperref[MP:GAP]{{\tt GAP}}} that will cause an interval to be scheduled
between scans.  This simply butts the scans together.  If there are gaps
between the scans, such as when 
{\hyperref[MP:DWELL]{{\tt DWELL}}} or
{\hyperref[MP:GAP]{{\tt GAP}}} are used, the default behavior of \schedb
will automatically keep the tape running if the gap is less than
8 seconds times the speed up factor (usually 2).  That interval can
be adjusted with the parameter 
{\hyperref[MP:MINPAUSE]{{\tt MINPAUSE}}}.

One can request, preferably with parameter 
{\hyperref[MP:PRESTART]{{\tt PRESTART}}},
that recordings be started before the nominal start of
a scan.  This can cause the recording medium to keep moving if the gap
is short.  For longer gaps, it can help optimize the amount of
correlator output by providing time for the correlator to synchronize.


\subsection{\label{SSSEC:TAPELEN}TAPE LENGTHS and PASS TIMES}

Tapes for the Mark III and VLBA systems come in two nominal lengths,
9600 ft and 18000 ft.  Actually, nearly all of the shorter tapes have
now been removed from the system so most users will not encounter
them.  The lengths vary plus the usable length is shortened by the
amount of leader needed at each reel.  Experience has shown that it is
best not to count on more than 17600 feet for the long ``thin'' tapes.
Most short ``thick'' tapes are over 9000 feet, but there are a
significant number as short as 8500.  It is probably reasonable to
assume that the short tapes will be 8800 ft, half the length of the
long tapes, for scheduling purposes.

There are three basic recording speeds to consider, at least when
using the VLBA correlator.  The ``normal'' speed it that at which 4
million data bits per second are recorded on each track.  Mark III and
Mark IV format data at low density are recorded at 135 ips (inches per
second).  VLBA format data at low density are recorded at 133.33 ips.
All formats at high density are recorded at 80 ips, which is now the
standard for most observations.  Recording rates of half and twice
these values are used when the number of bits per second per track is
half or twice the 4 Mbps.  High density recordings can only be made on
``thin'' tapes.  The VLBA correlator plays back all observations at a
track bit rate of 8 Mbps, using 160 ips for high density recordings.
Thus there is a speed up factor for recordings made at lower speeds
--- a factor of 2 for 4 Mbps tracks and a factor of 4 for 2 Mbps
tracks.

The following table gives the recording times per pass to expect with
these tape speeds and recording rates:

\begin{verbatim}
 ------------------------------------------------------------------
     RECORDING TIMES for 1 pass on VLBA and Mark III tapes.
 ------------------------------------------------------------------
     Tape length   Format /        Bit rate per track
        (feet)      density     (2 Mbps)   (4 Mbps)   (8 Mbps)
 ------------------------------------------------------------------
        17600      All/High     1:28:00      44:00      22:00
        17600      VLBA/Low       52:48      26:24      13:12
        17600      Mark III/IV    52:08      26:04      13:02
         8800      VLBA/Low       26:24      13:12       6:36
         8800      Mark III/IV    26:04      13:02       6:31
 ------------------------------------------------------------------
\end{verbatim}


When full 
{\hyperref[SSSEC:AUTOTAPE]{automatic tape handling}} is not
being used, scans should be scheduled so that they are in blocks that
constitute a pass.  This is not absolutely necessary, because,
regardless of the scan times, \schedb will make sure that the scan
will fit on the tape and, if not, will reverse the tape.  If a scan
cannot fit, \schedb will complain and die.  Because of these actions,
no data will be lost if the schedule is not in blocks of a tape pass,
but some amount of tape will be wasted --- it is better to be aware of
the pass lengths.  In fact, it is not uncommon for a user to find that,
when he/she deletes a scan, the amount of tape used increases.  This
happens when a schedule that went to the end of tape on each pass
gets out-of-sync and has to reverse the tape before the end.  Once this
starts to happen, it often continues for the rest of the experiment.
Note that it is typical to round down the pass times to, for
example, 13 minutes for those cases where the full number is 13:02 or
13:13.

Scheduling in blocks of tape passes is more complicated if there is a
mixture of thin, high density tape at some sites and thick, low
density tapes at other sites.  For Mark III, the longer tapes will
hold 3.37 times as much data per pass as the shorter tapes.  Probably
the best way to deal with this is to schedule in blocks such that the
2 blocks fit per pass on the thick tapes and 7 blocks fit on the high
density, thin tapes.  The appropriate time for this for Mark III or
VLBA formats is 6:17.  Be careful with scans less than 30 seconds in
such a schedule because the passes could get out of sync.  Mixed
thick and thin tape observations should be rare, especially since
the VLBA correlator refuses to deal with thick tapes.

Note that, if there is a problem at a station and a tape does not
start on time, or a scan is missed, the tape position will be behind
that expected by \sched.  At the end of the pass, the tape will reverse
when the schedule tells it to, which in this case will be some distance
from the end.  For this reason, the next pass is likely to run out of
tape before it is finished and some data will be lost.  The pass after
that will begin at the expected place and there will be no further
problems.

Users of PCFS controled stations (eg EVN) should be aware that during
long scans no Tsys information is acquired. It is necessary to insert
gaps to make sure Tsys measurements are made.

\subsection{\label{SSSEC:NUMPASSES}NUMBER of PASSES}

The amount of data that can fit on a tape depends on the length
of the tape, the tape speed, and on the number of passes.  The
Mark III and VLBA systems make longitudinal recordings using many
heads, all mounted on a head stack.  The width of each head is 38
microns and the ``head pitch'', or spacing between heads, is
698.5 microns.  This difference allows many passes to be recorded
with each head simply by shifting the whole head stack over by
something more than 38 microns between passes (48 microns is used
on the VLBA).  The Mark III systems typically use 12 passes while
the VLBA and Mark IV use 14.

Many recording modes do not use all of the heads at once.  Mark III
systems use 28 heads while VLBA and Mark IV systems use 32 (they all
actually use the same 36 head headstack so the head pitch etc is the
same).  Mark III Mode A uses all heads in a pass.  Modes B and C use
half the heads while Mode E uses a quarter.  There are many VLBA
modes, but they typically use a quarter, half, or all heads, although
lesser options are available.  If not all the heads are used in a
pass, more passes can be made at the same head position, increasing
the total time over which data can be recorded on tape.  The setup
file parameter 
{\hyperref[SP:TPMODE]{{\tt TPMODE}}} gives the number of
passes that can be recorded at each head position.  \schedb will
figure it out if it is not given and will report it in the summary.

If multiple setups are used in a project, \schedb will figure out
which uses the minimum number passes per head position (most
tracks per pass) and will use that number of passes per head position
for all setups.  This wastes tape because some tracks never get
recorded, but the alternative is a bookkeeping mess.  Therefore,
it is strongly recommended that all setups used in a project use
the same number of heads per pass (have the same {\tt TPMODE}).

It is perfectly possible to use setups that record at different speeds
in the same schedule.  As long as they all use the same number of
heads, the tape will be used efficiently.  However, a change of
recording speed causes the VLBA correlator to need a new job.  This is
not a fundamental problem, but there is overhead for each job which
causes work for the correlator staff.  Current guidelines on how often
changes of this sort can be made can be found in the guidelines for
scheduling document found by going to the VLBA home page from the NRAO
home page on the WWW.  As of late 1996, changes more often than every
2 hours are discouraged.  Note that using different tape speeds in
different subarrays at the same time will preclude simultaneous
correlation and will present the current job script making program
with bookkeeping problems it is not equipped to handle.  Don't do it!

The total time that can be recorded on a tape is the time per pass
times the number of passes per head position times the number of head
positions.  The following table gives the total time per tape, and
also the total bit rate, for various combinations of these parameters.


\begin{verbatim}
 ------------------------------------------------------------------
     TOTAL RECORDING TIMES per TAPE
 ------------------------------------------------------------------
  Pass/head   Heads     Track bit   Passes  Tape time  Total bit
   position  recording  rate (Mbps)                   rate (Mbps)
 ------------------------------------------------------------------
       1        1           2         14     20:32:00      64
       1        1           4         14     10:16:00     128
       1        1           8         14      5:08:00     256
       1        2           8         12      4:24:00     512
       1        2          16         12      2:12:00    1024
       2        1           2         28     41:04:00      32
       2        1           4         28     20:32:00      64
       2        1           8         28     10:16:00     128
       4        1           2         56     82:08:00      16
       4        1           4         56     41:04:00      32
       4        1           8         56     20:32:00      64
 ------------------------------------------------------------------
   All tapes are assumed to be 17600 ft long.
   All recordings are assumed to be done at high density.
   Modes with 2 heads are MarkIV only.
   VLBA uses 2 drives at 256 Mbps each for 512 Mbps.
 ------------------------------------------------------------------

\end{verbatim}

For mostly historical interest, below is the old version of the
table which includes the tape times for the low density and/or
thick tapes.  The 512 and 1024 Mbps modes were not available
at the time.

\begin{verbatim}
 ------------------------------------------------------------------
     TOTAL RECORDING TIMES per TAPE (14 Head positions, 32 Heads) *
 ------------------------------------------------------------------
  Tape length   Format/den
  Bit rate per track
     (feet)                  (2 Mbps)   (4 Mbps)   (8 Mbps)
 ------------------------------------------------------------------
  1 Pass/head pos.  Bit rate: 64 Mbps   128 Mbps   256 Mbps
     17600      All/High     20:32:00   10:16:00    5:08:00
     17600      VLBA/Low     12:19:12    6:09:36    3:04:48
     17600  Mark III/IV/Low  12:09:52    6:04:56    3:02:28
      8800      VLBA/Low      6:09:36    3:04:48    1:32:24
      8800  Mark III/IV/Low   6:04:56    3:02:28    1:31:14

  2 Pass/head pos.  Bit rate: 32 Mbps    64 Mbps   128 Mbps
     17600      All/High     41:04:00   20:32:00   10:16:00
     17600      VLBA/Low     24:38:24   12:19:12    6:09:36
     17600  Mark III/IV/Low  24:19:44   12:09:52    6:04:56
      8800      VLBA/Low     12:19:12    6:09:36    3:04:48
      8800  Mark III/IV/Low  12:09:52    6:04:56    3:02:28

  4 Pass/head pos.  Bit rate: 16 Mbps    32 Mbps    64 Mbps
     17600      All/High     82:08:00   41:04:00   20:32:00
     17600      VLBA/Low     49:16:48   24:38:24   12:19:12
     17600  Mark III/IV/Low  48:39:28   24:19:44   12:09:52
      8800      VLBA/Low     24:38:24   12:19:12    6:09:36
      8800  Mark III/IV/Low  24:19:44   12:09:52    6:04:56

 ------------------------------------------------------------------
 *  Systems with Mark III hardware use 28 heads and 12 head positions
    so the recording times are lower.

\end{verbatim}

If the tape allocated is insufficient to record for the whole allocated
time at the desired bit rate, there are several options.  The most
common is to use a duty factor of less than one --- to stop the tape
for some of the time.  Otherwise, it is necessary to cut down the
bit rate or to request more tapes (good luck).  Some periods of stopped
tapes are desirable for 
{\hyperref[SSSEC:READBACK]{readback tests.}}

\subsection{\label{SSSEC:READBACK}READBACK TESTS}

One way in which the performance of the recording system is monitored
is to read back some data from the tapes and check the playback
quality.  On the VLBA and Mark~IV systems, this is done any time there
is a gap of longer than about 2 minutes per tape (actually somewhat
less).  If a really bad head is found, it is possible to make a copy
of the data from that head on one of the system tracks (recall that
the headstacks have 36 heads).  Some day, the correlator will be able
to use this data, although not yet.  On the VLBA, where there are two
tape drives available, it may be possible to switch to the other drive
to avoid the problem.  It is in the interests of both the individual
project and of overall system maintenance for occasional gaps to be
inserted in all projects for readback tests to be done.  These gaps
are often inserted at the ends of passes when automatic tape
allocation is not being used.

Readback tests on the VLBA systems cannot be done on both drives at
once so, when using the 2 tape, 512 Mbps mode, a gap of a bit less
than 4 minutes will be required to complete a set of tests.

\schedb will look for gaps long enough for readback tests.  It will
report the number for each station in the summary file.  If
there are less than one every 2 hours, it will complain, but go ahead
and make schedules anyway.

\subsection{\label{SSSEC:TAPECHANGE}TAPE CHANGES}

If a project is being scheduled that uses stations that have only one
tape drive, it is necessary to schedule in a gap of about 15 minutes
for that tape change to be accomplished.  Some stations can do it
faster, but it is best not to count on it.  The VLBA stations and the
VLA all have 2 tape drives each and the project will switch from one
to the other when the first runs out.  Then the operators can change
the full tape at their leisure.  For these stations, it is not
necessary to schedule tape change times.  \schedb will complain, but
not die, if a single tape station is requested to change tapes in
less than 15 minutes.  The \schedb input parameter 
{\hyperref[MP:TAPE]{{\tt TAPE}}}
is used to force tape changes.  It can take station names
as arguments if you only want to change tapes at a subset of stations.


An additional concern is that postpasses are needed for thin tapes.
This can consume up to 22 minutes.  See the beginning of
{\hyperref[SSEC:TAPEMANAGEMENT]{this section}} for more details.

Sometimes it is a good idea to synchronize tape changes at at least
some of the sites.  For example, at least in late 1996, the VLBA
correlator will not process the time between tape changes at different
sites if they are less than something like 3 minutes apart.  For
optimized schedules, this can present a bit of a problem, so the
input parameter 
{\hyperref[MP:TAPESYNC]{{\tt TAPESYNC}}} is provided to
try to cause all stations that are near the end of their tape to
change when the first reaches the end.  With automatic tape allocation,
the user does not have control of this factor and should not worry
about it, although it might cause some loss of data.

\subsection{\label{SSSEC:POSTPASS}POSTPASSES}

It is now considered necessary to postpass VLBA/MarkIV thin tapes
after recording.  This means winding the tape all the way to the end
and back to the beginning without stopping.  This avoids
irregularities in the tape pack that could otherwise lead to tape
damage in handling and shipping.  These irregularities are caused by
starts and stops.  Since tapes cost over \$1000 each, this is a
serious issue.  \schedb will give the necessary commands to request
postpasses be done at stations that use VLBA control files.

Unfortunately, a postpass takes between 11 and 22 minutes depending on
how far the the tape has to be fast-forwarded to reach the end.  This
is down from a maximum of 33 minutes prior to late 1997 when it was
determined that rewind speed could be used.  For two tape stations,
this is not a problem.  For single tape stations, it is can be serious
since it adds this much to the tape change time.  Also, if there is an
inadequate gap in the schedule, the next tape can be out of the
expected position on the first pass which can cause additional losses
when the first reverse pass runs out of tape early.  \schedb provides
a way to avoid postpasses by keeping track of tape motions.  If the
last pass went from the far end of the tape to the beginning without
stopping, a postpass is not required and is not requested by \sched.
{\em Therefore, users with single tape stations (all except the VLBA
and VLA) who are using more than 1 thin tape per station are advised
to not stop the tape on the last pass before each tape change.}


\subsection{\label{SSSEC:AUTOTAPE}AUTOMATIC TAPE ALLOCATION}

Automatic tape allocation is provided on the VLBA.  In fact, its
use is required for most observations.  With automatic tape
allocation, the only thing the user needs or can worry about is the
total tape consumption.  It much be kept below that allocated for the
experiment.  There are two reasons for the use of automatic tape
allocation.  The first is to relieve the user of all the worry about
tape handling.  It is no longer necessary to schedule everything in
units of passes.  The second is to decouple the tape change times from
the times allocated to each project.  This allows the tape changes at
the stations to be done on a fixed schedule that is the same every
week and which fits well with the work schedule for the site techs.
This does cause tapes to contain data from more than one project, but
the bookkeeping is in place to insure that they don't get erased until
all the projects are correlated.  Recall that the VLBA stations are
unmanned most of the time.  The second reason is why the use of
automatic allocation is required.

Automatic tape allocation is not available for all stations, including
all that use VEX files.  \schedb knows which stations can use it and
schedules accordingly.  For global observations to be correlated on
the VLBA correlator, the scheduler needs to worry about tape handling
at the stations without auto allocation, but can ignore it for the
ones that have it.  For any observations to be correlated on other
correlators (including JIVE), automatic tape allocation cannot be used
and \schedb will not allow it.

Two levels of automatic tape handling are available on the VLBA.  They
are invoked using the parameter 
{\hyperref[MP:AUTOTAPE]{{\tt AUTOTAPE}}}.
The lower level allows the on-line system to decide
where on the tape to start the next scan.  However if the scan runs
out of tape going in the current direction, the recorder will stop and
the rest of the scan will be lost.  After the first forward pass, any
scan starting less than 450 feet from the end of the tape will be
started in the opposite direction.  The first forward pass always runs
to the low tape sense to determine the tape length.  It is the
author's opinion that, because of the variable length of tapes,
projects scheduled with this scheme are very likely to exhibit
unexpected behavior with possible considerable loss of data.  It
should work ok for long scans that intentionally try to drive well
beyond the end of the tape, but this is almost worse than worrying
about specifying the tape behavior at schedule time.  This level of
automation is not recommended.

The higher level of automation is the method of choice for tape
scheduling.  It would be even better if the speed of synchronization
on the correlator were improved, but that project doesn't seem to be
getting any priority.  With this mode, whenever the tape gets to an
end, it stops and reverses.  The minimum time lost is the time
required to reverse the tape at the correlator, which is about 5
seconds times the speed up factor.  However some time to resync after
the reversal is required and the actual time is more like 10 seconds
times the speed up factor and somewhat variable.  For most experiments
the data loss should not be a significant problem.  Scans of arbitrary
length can be scheduled.  The user only need to worry about not
exceeding his/her total tape allotment.  The total amount of tape used
in a schedule is reported in the summary file.  Note that the same
behavior, where scans starting within 450 feet of the expected end of
tape after the first pass will start in the opposite direction, also
applies with this level of automation.  450 feet is 67.5 seconds at
80ips --- the speed that gives a speed up factor of 2 on the VLBA and
is used by a large fraction of observations.

When automatic tape handling is requested, as is required for most
VLBA projects, it is futile to worry about coordinating scans with
tape passes.  Don't bother to try.  There are two reasons for this.
First, the tape position at the start of the project will depend on
where it was left by the previous project.  It will not necessarily be
at an end.  Second, the autoallocation software uses the real length
of the tape as measured on the first pass.  Tapes vary in length by
several hundred feet depending on their history of abuse.  So you
cannot know ahead of time where a scan will be on the tape so there
is no point in trying to schedule passes unless some antennas in the
array are not using autoallocation.

If a station that is using automatic tape allocation is scheduled in a
scan on a source that is below the antenna hardware limits (not just
the horizon), that antenna will be removed from the scan by \sched.
This will not happen when or where automatic allocation is not in
use because the tape management could be messed up.  This action is
provided mainly to help the Mauna Kea site technicians who have a
very long drive to change tapes and whose antenna is often scheduled
in scans for which the source has not yet risen.  Mark5 stations
that are not using tape will also be scheduled in this manner.  This
behavior can be overridden using 
{\hyperref[MP:DODOWN]{{\tt DODOWN}}}

\section{\label{SEC:MKIII}Mark~III Observations}

To schedule Mark~III projects using non-VLBA control file stations or
a Mark~III correlator, it is best to use {\sc PC-SCHED}, written by
Alan Rogers and Dave Schultz at Haystack (unrelated to \sched), or
{\sc SKED}, written by Nancy Vandenberg at Goddard Space Flight
Center.  {\sc PC-SCHED} can read a very basic \schedb keyin file to
get scan times and generate Mark~III schedules.  This is mainly useful
to help get the files needed by a Mark~III correlator to process a
Mark III observation on the VLBA that was scheduled with \sched.  {\sc
PC-SCHED} and {\sc SKED} produce a ``Standard Schedule File Format''
file, which is also known as the ``sked file'', ``.vex file'', ``.drg
file'', or ``drudg file''.  This single file contains a complete
description of the experiment for all stations.

There is a program called {\sc DRUDG}, associated with the Mark~III
systems, that is used to convert the ``.drg file'' into snap files to
control the antennas and tape systems.  {\sc DRUDG} can produce VLBA
control files and is used to do so regularily by the geodetic groups.
It is rarely used to make schedules for non-geodetic projects.  {\sc
PC-SCHED} also is able to produce VLBA control files, but this
capability has not been kept up-to-date and should not be used.

An NRAO program called {\sc SKEDCONV} exists to convert ``.drg files''
files into \schedb keyin files. It is recommended that most VLBA
Mark~III observers send their ``.drg files'' files to the AOC,
where the staff will use {\sc SKEDCONV} and \sched, along with
current setup files, to make the VLBA control files.  Instructions on
how to submit schedules are provided to observers when they are
allocated observing time.

There are no definite plans to support Mark~III observations fully
with \schedb because the system will soon be obsolete.  It will be
replaced by the 
{\hyperref[SSEC:MKIV]{Mark~IV system}}, which is basically
an upgrade that uses the same tape recorders (upgraded) and heads, but
a new formatter and wider bandwidths from the video converters.
\schedb supports the Mark~IV system through the VEX control files.
However, as mentioned elsewhere, the Japanese systems related to VSOP
have been designed around the ``.drg file''.  Hooks have been provided
in \schedb where they can attach routines to write ``.drg file''
output.  If this project is completed, \schedb may acquire at limited
Mark~III capability.

Mark~III observations on stations that use VLBA control files (VLBA,
VLA, and Green Bank) can be scheduled directly with \sched.  The only
difference between Mark~III and VLBA format projects on these antennas
is the data format on the tape (see the setup file input 
{\hyperref[SP:FORMAT]{{\tt FORMAT}}})
and various details in the setup files.  Mark~III
observations have a one-to-one correspondence between tracks and
channels, use one bit samples, and do not barrel roll.  They typically
use 7 or 14 channels, although Mark~III format can be used on any
project with no fan out.  Anyone scheduling Mark~III observations
should either use 
{\hyperref[SSEC:SETSTD]{standard setup files}} or, if
making their own, should start with a standard file as a template.
Such observations can be correlated on the VLBA correlator, but
require production of a ``.drg file'' if sent to a Mark~III correlator.

The PCFS can control Mark~III observations on Mark~III, Mark~IV, and
VLBA hardware.  However, it will only do this with a Mark~III type
``.drg file'' for input.  Since \schedb does not produce such files,
it cannot currently schedule Mark~III format observations on systems
that do not use the VLBA control files (e.g.\ the EVN).  The ``.drg
file'' is also required to control Mark~III correlators, and therefore
\schedb cannot be used to control experiments that are destinated for
such correlators without causing considerable extra effort to generate
such a file later.  A possible future upgrade to the PCFS and \schedb
would allow the use of VEX files to control observations on Mark~III
hardware or configure Mark~III modes on Mark~IV hardware.

The VLBA correlator is capable of correlating VLBA, Mark~IV, and
Mark~III formats against each other as long as the sample rates and
recording speeds were the same.  Therefore the VLBA and Mark~IV
stations of a global observation that also involves Mark~III stations
could be scheduled with \schedb if it were to be processed in Socorro.
Of course, the Mark~III stations would still have to be scheduled
somehow, so one of the other programs would probably be used anyway.


\section{\label{SEC:MKII}Scheduling Mark II Observations}

\schedb was originally written in about 1978 as the Caltech
Package scheduling program for Mark~II VLBI.  Most Mark~II
observations done since then were scheduled with it.  But the
program is outlasting the system that it was designed to
support.  I began the process of removing Mark II from \schedb
when I learned that it is still in use in some parts of the
world.  Therefore, it is being retained for now.

Mark~II recording systems have been removed from most
active VLBI stations and the main Mark~II correlators are no longer
operating.  However, the system is not completely gone.  An old
Caltech correlator is being supported at Medicina and Mark~II
recording systems are being supported at a few places.  For these
reasons, the Mark~II specific features of \schedb have not
yet been removed.

Mark~II observations typically use one of the Mark~III or VLBA data
aquisition system baseband converters (called video converters in the
Mark~III world).  Therefore much of the setup information required
for the wide band systems is also required for Mark~II, although
only for a single channel.  A very few parameters are available that
are only for Mark~II and the descriptions of those parameters should
be consulted.  In the main program input, the only such parameter
is 
{\hyperref[MP:TPREF]{{\tt TPREF}}} which helps get the tape changes
synchronized.  In the tape initialization parameters, parameter
{\tt TPTIME} serves a similar purpose.  The main schedule parameter
{\hyperref[MP:AUTOTAPE]{{\tt AUTOTAPE}}} has special meaning for
Mark~II observations.  Other than these special cases, the parameters
used for a Mark~II project are essentially the same as for a wide
band experiment.  Of course, parameters related to control of the
wide band tape systems are not needed.

Tape management for Mark~II observations is simpler than for wide
band observations.  Normally the tapes are run continuously for
4 hours per tape and then changed, usually by hand.  Correlator
operators normally prefer is all tapes are changed at the same
time, which can be arranged using 
{\hyperref[MP:TPREF]{{\tt TPREF}}}
or {\tt TPTIME}.  The schedule should have scan breaks at the
tape change times (this will be forced by \sched, so tape
changes might be requested at odd times if scan breaks don't occur
at the nominal 4 hour intervals.

\newpage

Below is an example of a simple Mark II schedule.
Be warned that this aspect of \schedb is not being maintained
because Mark 2 is no longer available at most stations.  Also,
this example is not being tested with each release.

\begin{verbatim}
 SIMPLE EXAMPLE
 --------------------------------------------------------------------
     !   Cover information:
 EXPT = 'Mark II, 3C345, May 1986'  ! Any description.
 EXPCODE = 'C85G'                   ! Project code.
 VERSION = 1                        ! Version 1 of schedule
 PINAME = 'Craig Walker'            ! Principal Investigator's name.
 ADDRESS1 = 'National Radio Astronomy Observatory'  ! Address
 ADDRESS2 = 'P. O. Box O'                           ! Up to 4 lines.
 ADDRESS3 = 'Socorro, New Mexico, 87801'
 ADDRESS4 = ' U.S.A. '
 PHONE    = '505 835 7247 '         ! Telephone number
 OBSPHONE = '505 835 7247 '         ! Phone number during observations.
 EMAIL    = 'Internet: cwalker@nrao.edu'   ! Electronic mail address.
 FAX      = '505 835 7027 '         ! Phone number for FAX.
 TELEX    = '910-988-1710 '         ! Telex number.
 OBSMODE  = '6cm  Mark~II Standard Setup'  ! Observing mode.
 CORREL   = 'Caltech'               ! Correlator to ship tapes to.
 NOTE1    = 'You can put any comments you want to in these four lines.'
 NOTE2    = ' More comments '
 NOTE3    = ' More comments '
 NOTE4    = ' Last of the comments'

 !         Now the actual schedule information.
 SRCFILE = sources.obs              ! Source catalog.
 STAFILE = stations.dat             ! Station catalog.
 SETUP   = nug6cm.set               ! Setup file.
 YEAR = 1986  MONTH=5  DAY=11       ! Date of first stop time.
 STATIONS=BONN,BOLOGNA,HSTK,NRAO,
          VLA,VLBA_PT,OVRO          ! Stations list
 VLAMODE='VS'                       ! Required information for VLA
 START = 02:00:00                   ! Start time in UT.
 TPREF = 1::                        ! Control tape change times.
 SOURCE = '3C345'                   ! Source name.
 DUR = 30:00   REP = 8              ! 8 scans of 30 minutes each
 /                                  ! End of first group of scans.
 SOURCE='NRAO512'  DUR=30:00  /     ! One scan on another source.
 SOURCE='3C345'  DUR=30:00 REP 9 /  ! 9 more scans on main source.
 --------------------------------------------------------------------

\end{verbatim}

\newpage

Below is an example setup file for Mark II observations.
This is the standard setup file {\sl nug6cm.set} and contains
the correct information for the VLBA and VLA, which no longer have
Mark II recording equipment.  For a real Mark II observations, the
stations involved would have to be added.

\begin{verbatim}
---------------------------------------------------------------------
 EXAMPLE:   Setup file for Mark~II observations (1 channel) at 6cm.
 --------------------------------------------------------------------
! nug6cm.set
!      Setup file produced by MAKESETUP.
!      Modifications will be lost next time MAKESETUP is run.

nchan = 1  bbfilter = 2.0 format = MARKII
bbc = 1 netside = U
ifchan = L
!    Radio Astronomy allocation: 4990-5000
!    Radio Astnomomy footnote:   4950-4990
!    VLA 50MHz 4960.1 to 5010.1 with VC mode.
!        VLA 6cm receiver falling off at high end.
freqref  = 4990.99  !  Mark II network standard.
fe(1) = '6cm'   fe(3) = '6cm'   synth(2) = 4.1
firstlo  = 4100.00
station  = VLBA   rchan = A  lchan = C   /
firstlo  = 4360.10
station  = VLA1   rchan = B  lchan = D   /
station  = VLA27  rchan = A  lchan = C   /
firstlo  = 4260.0
station  = GB_VLBA  rchan = A  lchan = C  /
station = 'EB_VLBA'
fe(1)='6cm' fe(3)='6cm'
firstlo = 4100.0  rchan=A lchan=C  /


\end{verbatim}
\newpage

END OF OLD TEXT.




\section{\label{APP:HEAD}Head Positions and Track Assignments}

This appendix describes the default track and head assignments used on
the VLBA for projects scheduled using \sched.  These are {\em gory}
details that most users should not need to be concerned about.  Just
let \schedb use its defaults and the observations should be ok.

The VLBA uses 14 head positions.  Both the positions and the order in
which they are used are the same for all projects.
The head position for each index number are in the following
table in microns.

\begin{verbatim}
             HEAD POSITIONS
--------------------------------------------
     Forward Passes      Reverse Passes
     Index   Offset      Index   Offset
--------------------------------------------
       1     -319          2       31
       3     -271          4       79
       5     -223          6      127
       7     -175          8      175
       9     -127         10      223
      11      -79         12      271
      13      -31         14      319
-------------------------------------------
\end{verbatim}

All forward passes are to be written in the negative offset positions
and all reverse passes are to be written in the positive offset
passes.  This ensures that nearly all adjacent tracks are in the same
direction and minimizes the required guard bands.

The following tables give the head index position and the and the set
of heads that are used for each pass for experiments using 1, 2, 4,
and 8 passes per head position:
 Number:           1  2  3  4  5  6  7  8  9 10 11 12 13 14

\begin{verbatim}
             HEAD INDEX and HEAD SET for each PASS
---------------------------------------------------------------
 For 1 Pass Per Head Position:
   Passes 1 - 14
     Head Index    1  2  3  4  5  6  7  8  9 10 11 12 13 14
     Head Set      1  1  1  1  1  1  1  1  1  1  1  1  1  1
---------------------------------------------------------------
 For 2 Passes Per Head Position:
   Passes 1 - 14
     Head Index    1  2  1  2  3  4  3  4  5  6  5  6  7  8
     Head Set      1  1  2  2  1  1  2  2  1  1  2  2  1  1
   Passes 15 - 28
     Head Index    7  8  9 10  9 10 11 12 11 12 13 14 13 14
     Head Set      2  2  1  1  2  2  1  1  2  2  1  1  2  2
---------------------------------------------------------------
 For 4 Passes Per Head Position
   Passes 1 - 14
     Head Index    1  2  1  2  1  2  1  2  3  4  3  4  3  4
     Head Set      1  1  2  2  3  3  4  4  1  1  2  2  3  3
   Passes 15 - 28
     Head Index    3  4  5  6  5  6  5  6  5  6  7  8  7  8
     Head Set      4  4  1  1  2  2  3  3  4  4  1  1  2  2
   Passes 29 - 42
     Head Index    7  8  7  8  9 10  9 10  9 10  9 10 11 12
     Head Set      3  3  4  4  1  1  2  2  3  3  4  4  1  1
   Passes 43 - 56
     Head Index   11 12 11 12 11 12 13 14 13 14 13 14 13 14
     Head Set      2  2  3  3  4  4  1  1  2  2  3  3  4  4

---------------------------------------------------------------
 For 8 Passes Per Head Position
   Passes  1 - 14
     Head Index    1  2  1  2  1  2  1  2  1  2  1  2  1  2
     Head Set      1  1  2  2  3  3  4  4  5  5  6  6  7  7
   Passes 15 - 28
     Head Index    1  2  3  4  3  4  3  4  3  4  3  4  3  4
     Head Set      8  8  1  1  2  2  3  3  4  4  5  5  6  6
   Passes 29 - 42
     Head Index    3  4  3  4  5  6  5  6  5  6  5  6  5  6
     Head Set      7  7  8  8  1  1  2  2  3  3  4  4  5  5
   Passes 43 - 56
     Head Index    5  6  5  6  5  6  7  8  7  8  7  8  7  8
     Head Set      6  6  7  7  8  8  1  1  2  2  3  3  4  4
   Passes 57 - 70
     Head Index    7  8  7  8  7  8  7  8  9 10  9 10  9 10
     Head Set      5  5  6  6  7  7  8  8  1  1  2  2  3  3
   Passes 71 - 84
     Head Index    9 10  9 10  9 10  9 10  9 10 11 12 11 12
     Head Set      4  4  5  5  6  6  7  7  8  8  1  1  2  2
   Passes 85 - 98
     Head Index   11 12 11 12 11 12 11 12 11 12 11 12 13 14
     Head Set      3  3  4  4  5  5  6  6  7  7  8  8  1  1
   Passes 99 - 112
     Head Index   13 14 13 14 13 14 13 14 13 14 13 14 13 14
     Head Set      2  2  3  3  4  4  5  5  6  6  7  7  8  8
---------------------------------------------------------------
\end{verbatim}

The following give the lists of the first track (head) for each
channel for experiments using all heads in a pass.  Channels using
multiple tracks because of fan out and/or 2 bit mode use the listed
track plus successive even or odd tracks.  For the multiple pass per
head position modes, the listed tracks are divided into groups and
successive passes (at a head position) use the successive groups.

\begin{verbatim}
              FIRST HEAD per CHANNEL
---------------------------------------------------------------
    Tracks Per Channel:    8
    Modes:                 (VLBA1:4, 2 bit)
    First Heads:           2 18 3  19
---------------------------------------------------------------
    Tracks Per Channel:    4
    Modes:                 (VLBA1:4, 1 bit), (VLBA1:2, 2 bit)
    First Heads:           2 10 18 26 3 11 19 27
---------------------------------------------------------------
    Tracks Per Channel:    2
    Modes:                 (VLBA1:2, 1 bit), (VLBA1:1, 2 bit)
    First Heads:           2 6 10 14 18 22 26 30
                           3 7 11 15 19 23 27 31
---------------------------------------------------------------
    Tracks Per Channel:    1
    Modes:                 (VLBA1:1, 1 bit)
    First Heads:           2  4  6  8 10 12 14 16
                          18 20 22 24 26 28 30 32
                           3  5  7  9 11 13 15 17
                          19 21 23 25 27 29 31 33
---------------------------------------------------------------
    Mark~III Mode B with channels in ascending frequency order.
    Sidebands should alternate.
    First Heads:  18  4 20  6 22  8 24 10 26 12 28 14 30 16 32 2
                  19  5 21  7 23  9 25 11 27 13 29 15 31 17 33 3
---------------------------------------------------------------
    Mark~III mode E with channels in ascending frequency order.
    First Heads:  4   6   8  10  12  14  16   2
                 18  20  22  24  26  28  30  32
                  5   7   9  11  13  15  17   3
                 19  21  23  25  27  29  31  33
---------------------------------------------------------------
\end{verbatim}

    Mark~III mode A is not normally used with VLBA systems because
the gain of only 2 tracks over mode A is not worth the extra
tape usage.  When it is used, the assignments are special because
a decision has to be made about what subset of tracks to use.

Perhaps an example will help clarify all of this.  Consider an
experiment that uses 2 passes per head position and 4 tracks per
channel.  There will be 4 channels and the following pattern is used
for the first few passes.

\begin{verbatim}
Pass Head  Dir             Heads.
      pos        Chan 1       Chan 2        Chan 3       Chan 4
 1   -319  For | 2 4 6 8 | 10 12 14 16 | 18 20 22 24 | 26 28 30 32 |
 2     31  Rev | 2 4 6 8 | 10 12 14 16 | 18 20 22 24 | 26 28 30 32 |
 3   -319  For | 3 5 7 9 | 11 13 15 17 | 19 21 23 25 | 27 29 31 33 |
 4     31  Rev | 3 5 7 9 | 11 13 15 17 | 19 21 23 25 | 27 29 31 33 |
 5   -271  For | 2 4 6 8 | 10 12 14 16 | 18 20 22 24 | 26 28 30 32 |
 6     79  Rev | 2 4 6 8 | 10 12 14 16 | 18 20 22 24 | 26 28 30 32 |
 7   -271  For | 3 5 7 9 | 11 13 15 17 | 19 21 23 25 | 27 29 31 33 |
 8     79  Rev | 3 5 7 9 | 11 13 15 17 | 19 21 23 25 | 27 29 31 33 |
 etc.
\end{verbatim}

Note that when there is both fan out and 2 bits per sample, the ``sign''
bits are fanned out over the first n tracks (eg 4 for VLBA1:4),
and then the ``magnitude'' bits are fanned out over the next n tracks.



\section{\label{SSEC:S2}S2}

The S2 system is no longer in use.  This subsection of the recording
systems section has been moved here for historical reasons.

The S2 system has been developed in Canada to support
the Orbiting VLBI missions VSOP and Radioastron, in addition to ground
based astronomy.  It is based on VCR technology and is relatively
inexpensive.  It is being used in Australia on the AT and at a number
of other sites around the world.

\schedb supports observations on telescopes that have S2
recorders and are controlled through the Field System (FS9.3.7 or
higher). This is also done by creating a {\tt *.vex} file in the VEX
format (see section on 
{\hyperref[SSEC:MKIV]{{\tt MkIV}}}).

The telescopes are characterized by {\tt RECORDER = S2} and {\tt
  CONTROL = VEX}. Currently {\tt DAR = VLBA} is completely supported
(it could be possible to also implement {\tt DAR = MKIV}). For any
other {\tt DAR} \schedb will attempt to schedule the observation with
a ``standard'' S2 mode, not using any knowledge on the content of the
``user signal''.

The modes supported for {\tt DAR = VLBA} can be derived from a
document ``Compatibility of S2 and VSOPT recordings at S2 and VSOPT
Correlators'' by R.\ Wietfeldt, available at
ftp::s2.sgl.ists.ca:pub/s2/svlbi/s2vsop\_compat\_memo\_v*.ps.Z.

%maybe need to give the modes, it's a long list and the memo above
%is black belt and not written for this purpose.

Because the S2 recorders work in a way conceptually different from
VLBA (or MkIV) recorders, the user should bear the following in mind
when scheduling for S2 recorders.

Please note that no operational tests with \schedb and S2 recorders
have been completed yet, except for VSOP recording. Recently (Dec 2000)
it was discovered that observations that use more than 1 group of
transports (thus not VSOP modes) would not switch groups. This should
have been fixed.

\begin{list}{}{\parsep 0em  \itemsep 0em }

\item The S2 recorder internally works with a number of recorders
  which each have one head and track. The S2 box uses 1, 2, 4 or 8
  recorders depending of the mode. In \schedb this is characterized by
  setting {\tt TPMODE} to the number of groups will be used by the S2
  recorder.

\item The concept of fan--in or fan--out does not apply to S2 recorders
  in \sched.

\item Tape lengths for S2 tapes are specified as the length for
  standard {\sl US VCR} recording in seconds. Thus, when the VCR
  cassette has 120 (minutes) on the label the tape lengths is 7200
  (ft) in \sched.  European buyers should be careful; a ST-120 tape
  presumably is labeled SE-180, but should still be scheduled with
  TPLENGTH = 7200.  The S2 LP is obtained by using low density for
  which the {\tt TPSPEEDL = 6.3} (ips) and SLP by using {\tt TPSPEEDH
   = 4.2} (ips).  These speeds are chosen in order to simulate that a
  120 minute cassette will last for 7200*12/(6.3*60)=229
  minutes, consistent with the S2 documentation. For high
   density the same tape lasts for 343 minutes per group (multiply by
  {\tt TPMODE} to get the total time).

% I know math mode should be used above, but latex2html puts the
% NRAO logo there! YUK.

\item S2 tape motion is supposed to be ``adaptive''. The S2 recorders
  should start 2.5 minutes before a scan, stop only 0.1 minutes after
  the scan and generally continue to spin if any gaps are shorter than
  2.6 minutes. This is the default and only mode of control for S2
  recorders through \sched.

\end{list}

\section{\label{SSEC:GB}Green Bank 140'.}

The NRAO 140 foot antenna is no longer in use.  The GBT will be used
for VLBI, but has not been tested as of January 2001. (But it has been
in use by 2007 for a while and there is now a GBT section).  This section
will need a lot of work when it starts being used.  It is expected
that the Green Bank card type of output is now obsolete.

BELOW IS OLD INFORMATION ON USING THE 140'.

Frank Ghigo (email of 25 Mar 1997) asks VLBI and VSOP observers of
the 140-foot at Green Bank to please allow enough time for pointing
checks to be done during the schedule.  For C-band (5 GHz) schedule 10
minutes of no observing about once every three hours.  At K-band (22
Ghz) allow 10 minutes every two hours.  At frequencies below 5 GHz no
extra pointing checks are necessary.

Note that pointing can be specified through the use of the
{\hyperref[MP:PEAK]{{\tt PEAK}}}.  However it is also possible for the
local staff to insert the pointing observations if adequate gaps
are left and the user's intentions are made clear in the cover
letter.  Actually it is a good idea to make the user's intentions
clear in the cover information regardless.

Green Bank (140') is the only station for which \schedb can still
request automatic measurements of the antenna temperature of a
source.  The parameters 
{\hyperref[MP:TANT1]{{\tt TANT1}}} and
{\hyperref[MP:TANTSTA1]{{\tt TANTSTA1}}} are used to control this
capability.  Note that a Tant measurement takes about a minute
and the antenna is off source part of the time so such measurements
should be done before a recording scan starts.

Green Bank (140') does not have computer control of the pcal
injection.  Therefore do not expect the pulse cal to be turned on and
off on a per-scan basis.  The support people will try to determine
from your schedule or cover information if the pulse cal is desired
and set it accordingly.  It is wise to make your desires clear in the
cover notes, especially if you want pcal off.  Note that the pcal
tones are injected in the IF, not at the receiver as at most sites.


\section{\label{APP:Mac2003}Installation on Mac OSX 10.3 in 2003.}

For those with older systems, here are a few details for Mac OS X
users based on my experience installing \schedb on a Mac iBook G4
system in Dec 2003 with OS X version 10.3 (Panther).  Note that, for
OSX 10.5, the installation was somewhat smoother with the main issue
being a need to switch from g77 to gfortran.  PGPLOT could be
downloaded from the Fink.  For OSX 10.3, before installing \sched, the
code tools had to be installed (the installation package was already
on disk, but not yet installed) and X windows had to be installed from
the OS X installation CD 3 (not CD 2 as some documentation stated).
The code tools include gcc, but not g77 (why?).  A binary version of
g77 compatible with Panther was obtained from hpc.sourceforge.net.  It
installed itself on download and simply worked.  PGPLOT was installed.
There was no PGPLOT configuration file ({\sl .conf} file) provided for
OS X (there probably is one now).  I made a {\sl local.conf} file
starting with the one from {\sl ../src/sys\_bsd/g77\_gcc.conf}. The
following two lines were different: 
\begin{verbatim}
 FFLAGD="-fno-backslash"
 LIBS="-L/usr/lib -lgcc -L/usr/X11R6/lib -lX11"
\end{verbatim}

The routine that makes the font file (pgpack) caused some trouble
while I was messing with various variants on the above, but eventually
worked.  I suspect problems with big vs little endian byte orders, but
I'm not sure. Note that pgplot version 5.3 has OS X as a standard OS
type.  This version was not released as of Aug 2008 (may never be), but
might be available if you ask nicely.

Once the X windows environment, gcc/g77, and PGPLOT were ready, SCHED
compiled and ran with the Makefile set up for Linux/g77 and the
and the following two modified lines (one just depends on the location
of PGPLOT and the other helps it find the gcc libraries):
XLD = -L/usr/lib -lgcc -L/usr/X11R6/lib -lX11 \# Mac OS X (ie DARWIN)
LPGPLOT = /usr/local/pgplot
The architecture still claimed to be LINUX and the g77 compiler flags
were the same.  That's all it took!  It compiled and passed the
verification tests.  If you are using FINK, some details may be different.

If you run into problems with some missing .h files, you might have a
mismatched OS version and XCODE version, as I did.

I now have \schedb on a Powerbook G4 (OSX 10.3 still) and that is now
one of the \schedb development platforms.


\end{document}

