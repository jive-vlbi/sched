!  Example sched input for a simple VLBA observation.
!  This is egvlba.key modified to use the RDBE with the
!  DDC personality.
!
! ==========================================================
! =================  Cover Information  ====================
! ==========================================================
!
 version = 1
 expt    = 'RDBE_DDC test'
 expcode = egddc

 piname   = 'Craig Walker'    
 address1 = 'National Radio Astronomy Observatory'  
 address2 = 'P. O. Box O'                           
 address3 = 'Socorro, New Mexico, 87801'
 address4 = ' U.S.A. '
 phone    = '505 835 7247 '    
 obsphone = '505 835 7247 '     
 email    = cwalker@nrao.edu  
 fax      = '505 835 7027 '   
 obsmode  = '6cm 128-4-2 '
 obstype  = VLBA
 note1    = ' ' 
! ==========================================================
! ==============  Correlator Information  ==================
! ==========================================================
 
correl   = Socorro
coravg   = 4
corchan  = 16
cornant  = 10
corpol   = on
corwtfn  = uniform
corsrcs  = standard
cortape  = FTP
corship1 = 'Craig Walker'
corship2 = 'P. O. Box O'
corship3 = 'Socorro NM 87801'

! ==========================================================
! ==================  Program control  =====================
! ==========================================================
!    Normally SCHED will not overwrite preexisting files. 
!    If you want this protection, comment this following line.
 overwrit

 sumitem  = el1, az1, disk, tpstart

! ==========================================================
! ======= Standard Source and Station Catalogs  ============
! ==========================================================
!  These are sched defaults so they are not really needed.

stafile  = $SCHED/catalogs/stations_RDBE.dat
srcfile  = $SCHED/catalogs/sources.vlba
freqfile = $SCHED/catalogs/freq_RDBE.dat

! ==========================================================
! =======================  Setup file  =====================
! ==========================================================
!
!   The baseband frequencies have to be chosen so that the 
!   channel band does not cross one of the "crossover" frequencies
!   of 640 and 896 MHz in the IF.  Those are boundaries between the 
!   output bands from the initial polyphase filter that is used to get 
!   to a clock rate the FPGA in the RDBE can handle.  They are
!   fixed and cannot be moved.  \schedb will warn of attempts
!   to cross them.

!   Note that the DDC characteristics are not yet final as of
!   when this was written (Jan. 2011).  It is possible that 
!   64 MHz bandwidths will not be allowed, while 128, 32, 16 ...0.125
!   will be allowed.

!   The DDC can set frequencies that are 1024 MHz (the sample rate)
!   divided by powers of 2.  The finest setting is 0.0596046 Hz.
!   But any frequency that does not have an integer number of cycles
!   in one second can cause big problems with carrying phase over
!   various events like frequency switches.  So the settings should
!   be limited to multiples of 15.625 kHz - the smallest setting that
!   has an integer number of cycles in a second.  This can be looked
!   at as N*125 kHz + 0, 15.625, 31.250, 46.875, 62.500, 78.125, 
!   93.750, or 109.375 kHz.  Sched will not accept settings that
!   are not multiples of 15.625 kHz.  Note that any crd files (old system)
!   written for some of these settings will have BBC frequencies 
!   rounded to the nearest 10 kHz.

setini = egvlba.6cm /
  band   = '6cm'    !  Observing band.  SCHED had frequency.
  nchan  = 8        !  Number of baseband channels.
  bbfilt = 64.0     !  Bandwidth per baseband channel (MHz)
  pol    = dual     !  RCP, LCP, or DUAL.
  bits   = 2        !  Bits per sample
  dbe = rdbe_ddc    !  Use the DDC personality of the RDBE.
  netside = L       !  Use lower sidebands in the RDBE (required).
  freqref = 4612.0  !  RF = freqref + freqoff
  freqoff = 128.0, 128.0, 192.0, 192.0, 256.0, 256.0, 320.0, 320.0 /
  /
endset /

setini = egvlba.2cm /
  band='2cm'  nchan=4  bbfilt=8.0  pol=DUAL  bits=2
  freqref = 15112.0  dbe = rdbe_ddc  sideband = L   netside = L
  freqoff = 192.0, 192.0, 256.0, 256.0, 320.0, 320.0, 384.0, 384.0 /
endset /

setini = egddc.7mm /
  band='3mm'  nchan=4  bbfilt=8.0  pol=DUAL  bits=2
  freqref = 42912.0  dbe = rdbe_ddc  sideband = U   netside = U
  freqoff = 192.0, 192.0, 256.0, 256.0, 320.0, 320.0, 384.0, 384.0 /
endset /

setini = egddc.90cm /
  band='90cm'  nchan=8  bbfilt=8.0  pol=DUAL  bits=2
  freqref = 0.0  dbe = rdbe_ddc  sideband = U   netside = U
  freqoff = 312.0, 312.0, 320.0, 320.0, 328.0, 328.0, 607.0, 607.0 /
endset /

! ==========================================================
! =================  Initial Scan Information  =============
! ==========================================================

year     = 1995
month    = 7
day      = 5
start    = 16:00:00

! ==========================================================
! ========================  The Scans  =====================
! ==========================================================
!  This file accumulates uv coverage in 4 bands.
!  In the process, it tests the on-line setting of IF, LO, etc
!  switches by exercizing the various special cases:
!      Receiver has an interal mix (1cm, 7mm, 3mm)
!      IF converter has internal filters (6cm new, 2cm)
!      IF converter has an optional narrow filter (50cm)
!      Also test normal case.

!  When not using DWELL, leave time for long slews with GAP.
!  Allow a readback test occasionally.
!  Only things that change need to be specified.

!  MK is not up at the start.
stations = VLBA_SC, VLBA_HN, VLBA_NL, VLBA_FD, VLBA_LA,
           VLBA_PT, VLBA_KP, VLBA_OV, VLBA_BR

group 4 rep 2
setup = egvlba.6cm  source='4C39.25'  dwell=4:00  /
setup = egvlba.2cm  

!  
!  The following sets up a valid frequency that the DDC can
!  use but that requires more digits in the output files than
!  the old standard of the nearest 10 kHz. It is here to test
!  that the extra digits are printed where needed.  Note that
!  the old system (crd files) cannot set beyond 10 kHz, so 
!  fewer digits are still used there.  Note also that odd 
!  frequencies such as these could be put in the setup files.
!  Choose freq=(15301000.+4*0.125+0.062.50)=15301.5625
freq(1) = 15304.5625  freq(2) = 15304.5625  /
setup = egddc.90cm  freq(1)=0 freq(2)=0 /
setup = egddc.7mm     /

!  This scan for a readback.  Needs 2:20 because of PRESTART
rep = 1 
setup = egvlba.6cm  source='4C39.25'  gap=2:20 dwell=4:00  /
setup = egvlba.2cm                    gap=0:00  /
group 4 rep 5
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /


stations = VLBA_SC, VLBA_HN, VLBA_NL, VLBA_FD, VLBA_LA,
           VLBA_PT, VLBA_KP, VLBA_OV, VLBA_BR, VLBA_MK

!  For one of the following scans, try the label SCANTAG

group 28 rep 2
setup = egvlba.6cm  source='DA193'    gap=4:00 dwell=4:00 /
setup = egvlba.2cm                    gap=0  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  source='4C39.25' /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /

group 28 rep 1
setup = egvlba.6cm  source='OQ208'    gap=4:00 dwell=4:00 /
setup = egvlba.2cm                    gap=0  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  source='4C39.25' /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /
setup = egvlba.6cm  /
setup = egvlba.2cm  /
setup = egddc.90cm  /
setup = egddc.7mm   /


