
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>inelpl</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>inelpl</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      INELPL ( Intersection of ellipse and plane )
 
      SUBROUTINE INELPL ( ELLIPS, PLANE, NXPTS, XPT1, XPT2 )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find the intersection of an ellipse and a plane.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ellipses.html">ELLIPSES</a>
     <a href="../req/planes.html">PLANES</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSE
     GEOMETRY
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               UBEL
      PARAMETER           ( UBEL = 9 )
 
      INTEGER               UBPL
      PARAMETER           ( UBPL = 4 )
 
      DOUBLE PRECISION      ELLIPS ( UBEL )
      DOUBLE PRECISION      PLANE  ( UBPL )
      INTEGER               NXPTS
      DOUBLE PRECISION      XPT1   ( 3 )
      DOUBLE PRECISION      XPT2   ( 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     ELLIPS     I   A SPICELIB ellipse.
     PLANE      I   A SPICELIB plane.
     NXPTS      O   Number of intersection points of plane and ellipse.
     XPT1,
     XPT2       O   Intersection points.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     ELLIPS         is a SPICELIB ellipse. The ellipse is allowed to 
                    be degenerate: one or both semi-axes may have
                    zero length.

     PLANE          is a SPICELIB plane.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     NXPTS          is the number of points of intersection of the
                    geometric plane and ellipse represented by PLANE
                    and ELLIPS. NXPTS may take the values 0, 1, 2 or
                    -1.  The value -1 indicates that the ellipse
                    consists of more than one point and lies in the
                    plane, so the number of intersection points is
                    infinite.

                    When the ellipse consists of a single point and
                    lies in the plane, NXPTS is set to 1.

     XPT1,
     XPT2           are the points of intersection of the input plane
                    and ellipse. If there is only one intersection
                    point, both XPT1 and XPT2 contain that point. If
                    the number of intersection points is zero or
                    infinite, the contents of XPT1 and XPT2 are
                    undefined.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  The input plane must be a SPICE plane: the normal vector must
         be non-zero and the constant must be non-negative.
         If the input plane is invalid, the error SPICE(INVALIDPLANE)
         will be signaled.

     2)  If the input ellipse has non-orthogonal axes, the error 
         SPICE(INVALIDELLIPSE) will be signaled.

     3)  The input ellipse is allowed to be a line segment or a point;
         these cases are not considered to be errors. If the ellipse
         consists of a single point and lies in the plane, the number
         of intersection points is set to 1 (rather than -1) and
         the output arguments XPT1 and XPT2 are assigned the value
         of the ellipse's center.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine computes the intersection set of a non-degenerate 
     plane with a possibly degenerate ellipse. The ellipse is allowed
     to consist of a line segment or a point.
     
     A plane may intersect an ellipse in 0, 1, 2, or infinitely many
     points. For there to be an infinite set of intersection points,
     the ellipse must lie in the plane and consist of more than one
     point.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  If we want to find the angle of some ray above the limb of an
         ellipsoid, where the angle is measured in a plane containing
         the ray and a `down' vector, we can follow the procedure
         given below.  We assume the ray does not intersect the
         ellipsoid.  The result we seek is called ANGLE, imaginatively
         enough.

         We assume that all vectors are given in body-fixed
         coordinates.

            C
            C     Find the limb of the ellipsoid as seen from the
            C     point OBSERV.  Here A, B, and C are the lengths of
            C     the semi-axes of the ellipsoid.
            C
                  CALL <a href="edlimb.html">EDLIMB</a> ( A, B, C, OBSERV, LIMB )

            C
            C     The ray direction vector is RAYDIR, so the ray is the
            C     set of points
            C
            C        OBSERV  +  t * RAYDIR
            C
            C     where t is any non-negative real number.
            C
            C     The `down' vector is just -OBSERV.  The vectors
            C     OBSERV and RAYDIR are spanning vectors for the plane
            C     we're interested in.  We can use <a href="psv2pl.html">PSV2PL</a> to represent
            C     this plane by a SPICELIB plane.
            C
                  CALL <a href="psv2pl.html">PSV2PL</a> ( OBSERV, OBSERV, RAYDIR, PLANE )

            C
            C     Find the intersection of the plane defined by OBSERV
            C     and RAYDIR with the limb.
            C
                  CALL <b>INELPL</b> ( LIMB, PLANE, NXPTS, XPT1, XPT2 )

            C
            C     We always expect two intersection points, if DOWN
            C     is valid.
            C
                  IF ( NXPTS .LT. 2 ) THEN

                     [ do something about the error ]

                  ENDIF

            C
            C     Form the vectors from OBSERV to the intersection
            C     points.  Find the angular separation between the
            C     boresight ray and each vector from OBSERV to the
            C     intersection points.
            C
                  CALL <a href="vsub.html">VSUB</a>   ( XPT1, OBSERV, VEC1 )
                  CALL <a href="vsub.html">VSUB</a>   ( XPT2, OBSERV, VEC2 )

                  SEP1 = <a href="vsep.html">VSEP</a> ( VEC1, RAYDIR )
                  SEP2 = <a href="vsep.html">VSEP</a> ( VEC2, RAYDIR )

            C
            C     The angular separation we're after is the minimum of
            C     the two separations we've computed.
            C
                  ANGLE = MIN ( SEP1, SEP2 )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 3.0.0, 07-OCT-2011 (NJB)

        Relaxed ellipse semi-axes orthogonality test limit
        SEPLIM from 1.D-12 TO 1.D-9 radians. The angular
        separation of the axes of the input ellipse must not
        differ from pi/2 radians by more than this limit.

    SPICELIB Version 2.0.0, 14-JAN-2008 (NJB)

        Bug fix: the routine's specification and behavior have been
        updated so the routine now returns a meaningful result for the
        case of an ellipse consisting of a single point.

        Bug fix: in the degenerate case where the input ellipse is a
        line segment of positive length, and this segment intersects
        the plane, the number of intersection points is set to 1
        rather than 2.

        Invalid input planes and ellipses are now diagnosed.

    SPICELIB Version 1.2.0, 25-AUG-2005 (NJB)

        Updated to remove non-standard use of duplicate arguments
        in <a href="vsub.html">VSUB</a> call.

    SPICELIB Version 1.1.0, 24-MAR-1992 (NJB) (WLT)

        Output arguments XPT1, XPT2 are now correctly declared
        with length 3.  Comment section for permuted index source
        lines was added following the header.

    SPICELIB Version 1.0.0, 02-NOV-1990 (NJB)</PRE>
<h4>Link to routine INELPL source file <a href='../../../src/spicelib/inelpl.f'>inelpl.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:28 2014</pre>

</body>
</html>

