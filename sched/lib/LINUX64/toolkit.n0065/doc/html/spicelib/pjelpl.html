
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>pjelpl</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>pjelpl</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      PJELPL ( Project ellipse onto plane )
 
      SUBROUTINE PJELPL ( ELIN, PLANE, ELOUT )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Project an ellipse onto a plane, orthogonally.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ellipses.html">ELLIPSES</a>
     <a href="../req/planes.html">PLANES</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSE
     GEOMETRY
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               UBEL
      PARAMETER           ( UBEL    =  9 )
 
      INTEGER               UBPL
      PARAMETER           ( UBPL    =  4 )
 
      DOUBLE PRECISION      ELIN  ( UBEL )
      DOUBLE PRECISION      PLANE ( UBPL )
      DOUBLE PRECISION      ELOUT ( UBEL )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     ELIN       I   A SPICELIB ellipse to be projected.
     PLANE      I   A plane onto which ELIN is to be projected.
     ELOUT      O   A SPICELIB ellipse resulting from the projection.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     ELIN,
     PLANE          are, respectively, a SPICELIB ellipse and a
                    SPICELIB plane.  The geometric ellipse represented
                    by ELIN is to be orthogonally projected onto the
                    geometric plane represented by PLANE.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     ELOUT          is a SPICELIB ellipse that represents the geometric
                    ellipse resulting from orthogonally projecting the
                    ellipse represented by INEL onto the plane
                    represented by PLANE.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If the input plane is invalid, the error will be diagnosed
         by routines called by this routine.

     2)  The input ellipse may be degenerate--its semi-axes may be
         linearly dependent.  Such ellipses are allowed as inputs.

     3)  The ellipse resulting from orthogonally projecting the input
         ellipse onto a plane may be degenerate, even if the input
         ellipse is not.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Projecting an ellipse orthogonally onto a plane can be thought of
     finding the points on the plane that are `under' or `over' the
     ellipse, with the `up' direction considered to be perpendicular
     to the plane.  More mathematically, the orthogonal projection is
     the set of points Y in the plane such that for some point X in
     the ellipse, the vector Y - X is perpendicular to the plane.
     The orthogonal projection of an ellipse onto a plane yields
     another ellipse.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  With  CENTER  = ( 1.D0,  1.D0,  1.D0 ),
               VECT1   = ( 2.D0,  0.D0,  0.D0 ),
               VECT2   = ( 0.D0,  1.D0,  1.D0 ),
               NORMAL  = ( 0.D0,  0.D0,  1.D0 ),

         the code fragment

               CALL <a href="nvc2pl.html">NVC2PL</a> ( NORMAL,  0.D0,    PLANE           )
               CALL <a href="cgv2el.html">CGV2EL</a> ( CENTER,  VECT1,   VECT2,   ELIN   )
               CALL <b>PJELPL</b> ( ELIN,    PLANE,   ELOUT           )
               CALL <a href="el2cgv.html">EL2CGV</a> ( ELOUT,   PRJCTR,  PRJMAJ,  PRJMIN )

         returns

               PRJCTR  = ( 1.D0,  1.D0,  0.D0 )
               PRJMAJ  = ( 2.D0,  0.D0,  0.D0 )
               PRJMIN  = ( 0.D0,  1.D0,  0.D0 )


     2)  With  VECT1   = ( 2.D0,  0.D0,  0.D0 ),
               VECT2   = ( 1.D0,  1.D0,  1.D0 ),
               CENTER  = ( 0.D0,  0.D0,  0.D0 ),
               NORMAL  = ( 0.D0,  0.D0,  1.D0 ),

         the code fragment

               CALL <a href="nvc2pl.html">NVC2PL</a> ( NORMAL,  0.D0,    PLANE           )
               CALL <a href="cgv2el.html">CGV2EL</a> ( CENTER,  VECT1,   VECT2,   ELIN   )
               CALL <b>PJELPL</b> ( ELIN,    PLANE,   ELOUT           )
               CALL <a href="el2cgv.html">EL2CGV</a> ( ELOUT,   PRJCTR,  PRJMAJ,  PRJMIN )

         returns

               PRJCTR  = ( 0.D0,  0.D0,  0.D0 )

               PRJMAJ  = ( -2.227032728823213D0,
                           -5.257311121191336D-1,
                            0.D0                  )

               PRJMIN  = (  2.008114158862273D-1,
                           -8.506508083520399D-1,
                            0.D0                  )



     3)    An example of actual use:   Suppose we wish to compute the
           distance from an ellipsoid to a line.   Let the line be
           defined by a point P and a direction vector DIRECT; the
           line is the set of points

              P   +   t * DIRECT,

           where t is any real number.  Let the ellipsoid have semi-
           axis lengths A, B, and C.

           We can reduce the problem to that of finding the distance
           between the line and an ellipse on the ellipsoid surface by
           considering the fact that the surface normal at the nearest
           point to the line will be orthogonal to DIRECT; the set of
           surface points where this condition holds lies in a plane,
           and hence is an ellipse on the surface.  The problem can be
           further simplified by projecting the ellipse orthogonally
           onto the plane defined by

              &lt; X, DIRECT &gt;  =  0.

           The problem is then a two dimensional one:  find the
           distance of the projected ellipse from the intersection of
           the line and this plane (which is necessarily one point).
           A `paraphrase' of the relevant code is:


              C     Step 1.   Find the candidate ellipse CAND.
              C               NORMAL is a normal vector to the plane
              C               containing the candidate ellipse.  The
              C               ellipse must exist, since it's the
              C               intersection of an ellipsoid centered at
              C               the origin and a plane containing the
              C               origin.  For this reason, we don't check
              C               <a href="inedpl.html">INEDPL</a>'s `found flag' FOUND below.
              C
                    NORMAL(1)  =  DIRECT(1) / A**2
                    NORMAL(2)  =  DIRECT(2) / B**2
                    NORMAL(3)  =  DIRECT(3) / C**2

                    CALL <a href="nvc2pl.html">NVC2PL</a> ( NORMAL, 0.D0, CANDPL )

                    CALL <a href="inedpl.html">INEDPL</a> ( A, B, C, CANDPL, CAND, FOUND )

              C
              C     Step 2.   Project the candidate ellipse onto a
              C               plane orthogonal to the line.  We'll
              C               call the plane PRJPL and the
              C               projected ellipse PRJEL.
              C
                     CALL <a href="nvc2pl.html">NVC2PL</a> ( DIRECT,  0.D0,   PRJPL )
                     CALL <b>PJELPL</b> ( CAND,    PRJPL,  PRJEL )

              C
              C     Step 3.   Find the point on the line lying in the
              C               projection plane, and then find the
              C               near point PJNEAR on the projected
              C               ellipse.  Here PRJPT is the point on the
              C               input line that lies in the projection
              C               plane.  The distance between PRJPT and
              C               PJNEAR is DIST.

                    CALL <a href="vprjp.html">VPRJP</a>  ( LINEPT,  PRJPL,  PRJPT         )
                    CALL NPEDPT ( PRJEL,   PRJPT,  PJNEAR,  DIST )

              C
              C     Step 4.  Find the near point PNEAR on the
              C              ellipsoid by taking the inverse
              C              orthogonal projection of PJNEAR; this is
              C              the point on the candidate ellipse that
              C              projects to PJNEAR.  Note that the output
              C              DIST was computed in step 3.
              C
              C              The inverse projection of PJNEAR is
              C              guaranteed to exist, so we don't have to
              C              check FOUND.
              C
                    CALL <a href="vprjpi.html">VPRJPI</a> ( PJNEAR, PRJPL, CANDPL, PNEAR, FOUND )


           The value of DIST returned is the distance we're looking
           for.

           The procedure described here is carried out in the routine
           <a href="npedln.html">NPEDLN</a>.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 02-NOV-1990 (NJB)</PRE>
<h4>Link to routine PJELPL source file <a href='../../../src/spicelib/pjelpl.f'>pjelpl.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:45 2014</pre>

</body>
</html>

