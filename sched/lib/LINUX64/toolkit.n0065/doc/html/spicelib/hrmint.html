
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>hrmint</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>hrmint</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 HRMINT ( Hermite polynomial interpolation  )
 
      SUBROUTINE HRMINT ( N,  XVALS,  YVALS,  X,  WORK,  F,  DF )
      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Evaluate a Hermite interpolating polynomial at a specified
     abscissa value.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     INTERPOLATION
     POLYNOMIAL
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      INTEGER               N
      DOUBLE PRECISION      XVALS (   N )
      DOUBLE PRECISION      YVALS ( 2*N )
      DOUBLE PRECISION      X
      DOUBLE PRECISION      WORK  ( 2*N, 2 )
      DOUBLE PRECISION      F
      DOUBLE PRECISION      DF
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     N          I   Number of points defining the polynomial.
     XVALS      I   Abscissa values.
     YVALS      I   Ordinate and derivative values.
     X          I   Point at which to interpolate the polynomial.
     WORK      I-O  Work space array.
     F          O   Interpolated function value at X.
     DF         O   Interpolated function's derivative at X.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     N              is the number of points defining the polynomial.
                    The arrays XVALS and YVALS contain N and 2*N
                    elements respectively.

     XVALS          is an array of length N containing abscissa values.

     YVALS          is an array of length 2*N containing ordinate and
                    derivative values for each point in the domain
                    defined by FIRST, STEP,  and N.  The elements

                       YVALS( 2*I - 1 )
                       YVALS( 2*I     )

                    give the value and first derivative of the output
                    polynomial at the abscissa value

                       XVALS(I)

                    where I ranges from 1 to N.


     WORK           is a work space array.  It is used by this routine
                    as a scratch area to hold intermediate results.  


     X              is the abscissa value at which the interpolating
                    polynomial and its derivative are to be evaluated.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     F, 
     DF             are the value and derivative at X of the unique
                    polynomial of degree 2N-1 that fits the points and 
                    derivatives defined by XVALS and YVALS.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If two input abscissas are equal, the error 
         SPICE(DIVIDEBYZERO) will be signaled.  

     2)  If N is less than 1, the error SPICE(INVALIDSIZE) is
         signaled.   

     3)  This routine does not attempt to ward off or diagnose
         arithmetic overflows.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Users of this routine must choose the number of points to use
     in their interpolation method.  The authors of Reference [1] have
     this to say on the topic:

        Unless there is solid evidence that the interpolating function
        is close in form to the true function f, it is a good idea to
        be cautious about high-order interpolation.  We
        enthusiastically endorse interpolations with 3 or 4 points, we
        are perhaps tolerant of 5 or 6; but we rarely go higher than
        that unless there is quite rigorous monitoring of estimated
        errors.

     The same authors offer this warning on the use of the
     interpolating function for extrapolation:

        ...the dangers of extrapolation cannot be overemphasized:
        An interpolating function, which is perforce an extrapolating
        function, will typically go berserk when the argument x is
        outside the range of tabulated values by more than the typical
        spacing of tabulated points.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1)  Fit a 7th degree polynomial through the points ( x, y, y' )

             ( -1,      6,       3 )
             (  0,      5,       0 )
             (  3,   2210,    5115 )
             (  5,  78180,  109395 )

         and evaluate this polynomial at x = 2.


            PROGRAM TEST_HRMINT

            DOUBLE PRECISION      ANSWER
            DOUBLE PRECISION      DERIV
            DOUBLE PRECISION      XVALS (4)
            DOUBLE PRECISION      YVALS (8)
            DOUBLE PRECISION      WORK  (8,2)
            INTEGER               N

            N         =   4

            XVALS(1)  =      -1.D0
            XVALS(2)  =       0.D0
            XVALS(3)  =       3.D0
            XVALS(4)  =       5.D0

            YVALS(1)  =       6.D0
            YVALS(2)  =       3.D0
            YVALS(3)  =       5.D0
            YVALS(4)  =       0.D0
            YVALS(5)  =    2210.D0   
            YVALS(6)  =    5115.D0   
            YVALS(7)  =   78180.D0   
            YVALS(8)  =  109395.D0   

            CALL <b>HRMINT</b> ( N, XVALS, YVALS, 2.D0, WORK, ANSWER, DERIV )

            WRITE (*,*) 'ANSWER = ', ANSWER
            WRITE (*,*) 'DERIV  = ', DERIV
            END


        The returned value of ANSWER should be 141.D0, and the returned
        derivative value should be 456.D0, since the unique 7th degree 
        polynomial that fits these constraints is

                     7       2
           f(x)  =  x   +  2x  + 5
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     [1]  &quot;Numerical Recipes---The Art of Scientific Computing&quot; by
           William H. Press, Brian P. Flannery, Saul A. Teukolsky,
           William T. Vetterling (see sections 3.0 and 3.1).

     [2]  &quot;Elementary Numerical Analysis---An Algorithmic Approach&quot;
           by S. D. Conte and Carl de Boor.  See p. 64.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.2.1, 28-JAN-2014 (NJB) 

        Fixed a few comment typos.

    SPICELIB Version 1.2.0, 01-FEB-2002 (NJB) (EDW)

        Bug fix:  declarations of local variables XI and XIJ
        were changed from DOUBLE PRECISION to INTEGER.
        Note:  bug had no effect on behavior of this routine.

    SPICELIB Version 1.1.0, 28-DEC-2001 (NJB)

        Blanks following final newline were truncated to 
        suppress compilation warnings on the SGI-N32 platform. 
      
    SPICELIB Version 1.0.0, 01-MAR-2000 (NJB)</PRE>
<h4>Link to routine HRMINT source file <a href='../../../src/spicelib/hrmint.f'>hrmint.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:27 2014</pre>

</body>
</html>

