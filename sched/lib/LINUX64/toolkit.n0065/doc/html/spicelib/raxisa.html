
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>raxisa</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>raxisa</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      RAXISA ( Rotation axis of a matrix )
 
      SUBROUTINE RAXISA ( MATRIX, AXIS, ANGLE )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Compute the axis of the rotation given by an input matrix
     and the angle of the rotation about that axis.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/rotation.html">ROTATION</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ANGLE,  MATRIX,  ROTATION
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      DOUBLE PRECISION    MATRIX ( 3, 3 )
      DOUBLE PRECISION    AXIS   (    3 )
      DOUBLE PRECISION    ANGLE
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     MATRIX     I   3x3 rotation matrix in double precision.
     AXIS       O   Axis of the rotation.
     ANGLE      O   Angle through which the rotation is performed.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     MATRIX     is a 3x3 rotation matrix in double precision.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     AXIS       is a unit vector pointing along the axis of the
                rotation.  In other words, AXIS is a unit eigenvector
                of the input matrix, corresponding to the eigenvalue
                1.  If the input matrix is the identity matrix, AXIS
                will be the vector (0, 0, 1). If the input rotation is
                a rotation by <a href="pi.html">PI</a> radians, both AXIS and -AXIS may be
                regarded as the axis of the rotation.

     ANGLE      is the angle between V and MATRIX*V for any non-zero
                vector V orthogonal to AXIS.  Angle is given in
                radians.  The angle returned will be in the range from
                0 to <a href="pi.html">PI</a>.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the input matrix is not a rotation matrix (where a fairly
        loose tolerance is used to check this) a routine in the
        call tree of this routine will signal an error indicating
        the problem.

     2) If the input matrix is the identity matrix, this routine
        returns an angle of 0.0, and an axis of ( 0.0, 0.0, 1.0 ).
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Every rotation matrix has an axis A such any vector, V, parallel
     to that axis satisfies the equation

        V = MATRIX * V

     This routine returns a unit vector AXIS parallel to the axis of
     the input rotation matrix.  Moreover for any vector W orthogonal
     to the axis of the rotation

        AXIS  and  W x MATRIX*W

        (where &quot;x&quot; denotes the cross product operation)

     will be positive scalar multiples of one another (at least to
     within the ability to make such computations with double
     precision arithmetic, and under the assumption that the MATRIX
     does not represent a rotation by zero or Pi radians).

     The angle returned will be the angle between W and MATRIX*W for
     any vector orthogonal to AXIS.

     If the input matrix is a rotation by 0 or <a href="pi.html">PI</a> radians some choice
     must be made for the AXIS returned.  In the case of a rotation by
     0 radians, AXIS is along the positive z-axis. In the case of a
     rotation by 180 degrees, two choices are
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     This routine can be used to numerically approximate the
     instantaneous angular velocity vector of a rotating object.

     Suppose that R(t) is the rotation matrix whose columns represent
     the inertial pointing vectors of the bodyfixed axes of an object
     at time t.

     Then the angular velocity vector points along the vector given
     by:
                             T
         limit  AXIS( R(t+h)R )
         h--&gt;0

     And the magnitude of the angular velocity at time t is given by:

                             T
         d ANGLE ( R(t+h)R(t) )
         ----------------------   at   h = 0
         dh

     Thus to approximate the angular velocity vector the following
     code fragment will do

            Load t      into the double precision variable T
            Load h      into the double precision variable H
            Load R(t+h) into the 3 by 3 double precision array RTH
            Load R(t)   into the 3 by 3 double precision array RT
               .
               .
               .
            compute the infinitesimal rotation R(t+h)R(t)**T

            CALL <a href="mxmt.html">MXMT</a>   ( RTH,    RT,   INFROT )

            compute the AXIS and ANGLE of the infinitesimal rotation

            CALL <b>RAXISA</b> ( INFROT, AXIS, ANGLE  )

            scale axis to get the angular velocity vector

            CALL <a href="vscl.html">VSCL</a>   ( ANGLE/H, AXIS, ANGVEL )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     1) If the input matrix is not a rotation matrix but is close
        enough to pass the tests this routine performs on it, no error
        will be signaled, but the results may have poor accuracy.

     2) The input matrix is taken to be an object that acts on
        (rotates) vectors---it is not regarded as a coordinate
        transformation.  To find the axis and angle of a coordinate
        transformation, input the transpose of that matrix to this
        routine.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     W.L. Taber      (JPL)
     F.S. Turner     (JPL)
     N.J. Bachman    (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 2.1.2, 02-JAN-2008 (EDW)

        Minor edit to the ANGLE declaration strictly
        identifying the constant as a double.

        From: 

           ANGLE = 2.0 * DATAN2( <a href="vnorm.html">VNORM</a>(Q(1)), Q(0) )

        To:

           ANGLE = 2.D0 * DATAN2( <a href="vnorm.html">VNORM</a>(Q(1)), Q(0) )

    SPICELIB Version 2.1.1, 05-JAN-2005 (NJB)

        Minor edits and formatting changes were made.

    SPICELIB Version 2.1.0, 30-MAY-2002 (FST)

        This routine now participates in error handling properly.

    SPICELIB Version 2.0.0, 19-SEP-1999 (WLT)

        The routine was re-written so as to avoid the numerical
        instabilities present in the previous implementation for
        rotations very near zero or 180 degrees.

    SPICELIB Version 1.1.0, 29-FEB-1996 (KRG)

        The declaration for the SPICELIB function <a href="pi.html">PI</a> is now
        preceded by an EXTERNAL statement declaring <a href="pi.html">PI</a> to be an
        external function. This removes a conflict with any
        compilers that have a <a href="pi.html">PI</a> intrinsic function.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 31-JAN-1990 (WLT)</PRE>
<h4>Link to routine RAXISA source file <a href='../../../src/spicelib/raxisa.f'>raxisa.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:48 2014</pre>

</body>
</html>

