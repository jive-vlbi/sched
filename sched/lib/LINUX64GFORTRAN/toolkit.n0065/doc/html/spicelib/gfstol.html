
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>gfstol</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>gfstol</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 GFSTOL ( GF, set a tolerance value for GF )

      SUBROUTINE GFSTOL ( VALUE )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Override the default GF convergence value used in the high
     level GF routines.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/gf.html">GF</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     GEOMETRY
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
      IMPLICIT NONE

      INCLUDE               'zzholdd.inc'

      DOUBLE PRECISION      VALUE
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     ZZPUT      P   ZZHOLDD stores a DP value.
     GF_TOL     P   ZZHOLDD acts on the GF subsystem tolerance.
     VALUE      I   Double precision value returned or to store.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     VALUE       The scalar double precision value to use as the GF
                 subsystem convergence tolerance. This value will
                 override the default tolerance, CNVTOL, defined in
                 gf.inc. Units are TDB seconds.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  The error SPICE(INVALIDTOLERANCE) signals if VALUE is not
         strictly greater-than-zero.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     The high level GF routines (see gf.req for a listing) use a
     default value for the convergence tolerance, CNVTOL, defined in
     gf.inc. It may occur that a GF search run needs a different
     convergence tolerance. <b>GFSTOL</b> programmatically changes the
     tolerance used by those routines.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

        Use the meta-kernel shown below to load the required SPICE
        kernels.

           KPL/MK

           File name: <a href= "standard.html">standard.tm</a>

           This meta-kernel is intended to support operation of SPICE
           example programs. The kernels shown here should not be
           assumed to contain adequate or correct versions of data
           required by SPICE-based user applications.

           In order for an application to use this meta-kernel, the
           kernels referenced here must be present in the user's
           current working directory.

           The names and contents of the kernels referenced
           by this meta-kernel are as follows:

              File name                     Contents
              ---------                     --------
              de421.bsp                     Planetary ephemeris
              pck00009.tpc                  Planet orientation and
                                            radii
              naif0009.tls                  Leapseconds

           \begindata

              KERNELS_TO_LOAD = ( 'de421.bsp',
                                  'pck00009.tpc',
                                  'naif0009.tls'  )

           \begintext

        Example:

        Perform a search for occultation events of the sun by earth as
        observed from the Moon center. Search during the interval from
        14 A.D. SEP 1 to 14 A.D. SEP 30 (Julian).

           PROGRAM GFSTOL_T

           IMPLICIT NONE

           INTEGER               <a href="wncard.html">WNCARD</a>

           CHARACTER*(*)         TIMFMT
           PARAMETER           ( TIMFMT =
          .                   'YYYY ERA MON DD HR:MN:SC.#### ::JCAL' )

           INTEGER               MAXWIN
           PARAMETER           ( MAXWIN = 2 * 100 )

           INTEGER               TIMLEN
           PARAMETER           ( TIMLEN = 40 )

           INTEGER               LBCELL
           PARAMETER           ( LBCELL = -5 )

           CHARACTER*(TIMLEN)    WIN0
           CHARACTER*(TIMLEN)    WIN1
           CHARACTER*(TIMLEN)    BEGSTR
           CHARACTER*(TIMLEN)    ENDSTR

           DOUBLE PRECISION      CNFINE ( LBCELL : MAXWIN )
           DOUBLE PRECISION      RESULT ( LBCELL : MAXWIN )
           DOUBLE PRECISION      ET0
           DOUBLE PRECISION      ET1
           DOUBLE PRECISION      LEFT
           DOUBLE PRECISION      RIGHT
           DOUBLE PRECISION      STEP

           INTEGER               I

           LOGICAL               OK


     C
     C     Load kernels.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( '<a href= "standard.html">standard.tm</a>' )

     C
     C     Use an SPK covering year 14 AD.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( 'de408.bsp' )

     C
     C     Initialize the confinement and result windows.
     C
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, CNFINE )
           CALL <a href="ssized.html">SSIZED</a> ( MAXWIN, RESULT )

     C
     C     Obtain the TDB time bounds of the confinement
     C     window, which is a single interval in this case.
     C
           WIN0 = '14 A.D. SEP 1  00:00:00'
           WIN1 = '14 A.D. SEP 30 00:00:00'

           CALL <a href="str2et.html">STR2ET</a> ( WIN0, ET0 )
           CALL <a href="str2et.html">STR2ET</a> ( WIN1, ET1 )

     C
     C     Insert the time bounds into the confinement
     C     window.
     C
           CALL <a href="wninsd.html">WNINSD</a> ( ET0, ET1, CNFINE )

     C
     C     Select a 3-minute step. We'll ignore any occultations
     C     lasting less than 3 minutes.
     C
           STEP = 180.D0

     C
     C     Perform the search. ET0 and ET1 have values ~-6*10^10,
     C     CNVTOL has value 10^-6, so double precision addition or
     C     subtraction of ET0 and ET1 with CNVTOL returns a result
     C     indistinguishable from ET0 and ET1.
     C
     C     Reduce the GF convergence tolerance by an order of
     C     magnitude to resolve this condition.
     C
           CALL <b>GFSTOL</b> ( 1D-5 )

           CALL <a href="gfoclt.html">GFOCLT</a> ( 'ANY',
          .              'EARTH', 'ellipsoid', 'IAU_EARTH',
          .              'SUN',   'ellipsoid', 'IAU_SUN',
          .              'LT',    'MOON',       STEP,
          .               CNFINE,  RESULT  )


           IF ( <a href="wncard.html">WNCARD</a>(RESULT) .EQ. 0 ) THEN

              WRITE (*,*) 'No occultation was found.'

           ELSE

              DO I = 1, <a href="wncard.html">WNCARD</a>(RESULT)

     C
     C           Fetch and display each occultation interval.
     C
                 CALL <a href="wnfetd.html">WNFETD</a> ( RESULT, I, LEFT, RIGHT )

                 CALL <a href="timout.html">TIMOUT</a> ( LEFT,  TIMFMT, BEGSTR )
                 CALL <a href="timout.html">TIMOUT</a> ( RIGHT, TIMFMT, ENDSTR )

                 WRITE (*,*) 'Interval ', I
                 WRITE (*,*) '   Start time: '//BEGSTR
                 WRITE (*,*) '   Stop time:  '//ENDSTR

              END DO

           END IF

           END

    The program outputs:

       Interval            1
          Start time:   14 A.D. SEP 27 05:02:02.8250
          Stop time:    14 A.D. SEP 27 09:33:31.6995
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     E.D. Wright    (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0  18-APR-2014 (EDW)</PRE>
<h4>Link to routine GFSTOL source file <a href='../../../src/spicelib/gfstol.f'>gfstol.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:26 2014</pre>

</body>
</html>

