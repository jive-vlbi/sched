
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spkw18</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spkw18</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      SPKW18 ( Write SPK segment, type 18 )
 
      SUBROUTINE SPKW18 (  HANDLE,  SUBTYP,  BODY,    CENTER,  
     .                     FRAME,   FIRST,   LAST,    SEGID,   
     .                     DEGREE,  N,       PACKTS,  EPOCHS  )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Write a type 18 segment to an SPK file.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/naif_ids.html">NAIF_IDS</a>
     <a href="../req/spc.html">SPC</a>
     <a href="../req/spk.html">SPK</a>
     <a href="../req/time.html">TIME</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EPHEMERIS
     FILES
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE 

      INCLUDE 'spk18.inc'
      
      INTEGER               HANDLE
      INTEGER               SUBTYP
      INTEGER               BODY
      INTEGER               CENTER
      CHARACTER*(*)         FRAME
      DOUBLE PRECISION      FIRST
      DOUBLE PRECISION      LAST
      CHARACTER*(*)         SEGID
      INTEGER               DEGREE
      INTEGER               N
      DOUBLE PRECISION      PACKTS ( * )
      DOUBLE PRECISION      EPOCHS ( * )
 
      INTEGER               MAXDEG
      PARAMETER           ( MAXDEG = 15 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     HANDLE     I   Handle of an SPK file open for writing.
     SUBTYP     I   SPK type 18 subtype code.
     BODY       I   NAIF code for an ephemeris object.
     CENTER     I   NAIF code for center of motion of BODY.
     FRAME      I   Reference frame name.
     FIRST      I   Start time of interval covered by segment.
     LAST       I   End time of interval covered by segment.
     SEGID      I   Segment identifier.
     DEGREE     I   Degree of interpolating polynomials.
     N          I   Number of packets.
     PACKTS     I   Array of packets.
     EPOCHS     I   Array of epochs corresponding to packets.
     MAXDEG     P   Maximum allowed degree of interpolating polynomial.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE         is the file handle of an SPK file that has been
                    opened for writing.

     SUBTYP         is an integer code indicating the subtype of the
                    the segment to be created.  

     BODY           is the NAIF integer code for an ephemeris object
                    whose state relative to another body is described
                    by the segment to be created.

     CENTER         is the NAIF integer code for the center of motion
                    of the object identified by BODY.

     FRAME          is the NAIF name for a reference frame
                    relative to which the state information for BODY
                    is specified.

     FIRST,
     LAST           are, respectively, the start and stop times of
                    the time interval over which the segment defines
                    the state of BODY.

     SEGID          is the segment identifier.  An SPK segment
                    identifier may contain up to 40 characters.

     DEGREE         is the nominal degree of the polynomials used to
                    interpolate the states contained in the input
                    packets.  All components of the state vectors are 
                    interpolated by polynomials of the specified
                    degree, except near the segment boundaries, 
                    or if the total number of states in the segment
                    is too few to allow interpolation using the
                    specified degree.

                    If the actual interpolation degree is reduced,
                    the highest degree feasible degree valid for 
                    the interpolation type is used.

     N              is the number of packets in the input packet
                    array.

     PACKTS         contains a time-ordered array of data packets
                    representing geometric states of BODY relative 
                    to CENTER, specified relative to FRAME.  The 
                    packet structure depends on the segment subtype
                    as follows:

                       Type 0 (indicated by code S18TP0):

                           x,  y,  z,  dx/dt,  dy/dt,  dz/dt,
                           vx, vy, vz, dvx/dt, dvy/dt, dvz/dt
                    
                       where x, y, z represent Cartesian position
                       components and  vx, vy, vz represent Cartesian
                       velocity components.  Note well:  vx, vy, and
                       vz *are not necessarily equal* to the time
                       derivatives of x, y, and z.  This packet 
                       structure mimics that of the Rosetta/MEX orbit
                       file from which the data are taken.
                      
                       Type 1 (indicated by code S18TP1):

                           x,  y,  z,  dx/dt,  dy/dt,  dz/dt
                    
                       where x, y, z represent Cartesian position
                       components and  vx, vy, vz represent Cartesian
                       velocity components.

                    Position units are kilometers, velocity units 
                    are kilometers per second, and acceleration units
                    are kilometers per second per second.
 

     EPOCHS         is an array of epochs corresponding to the members
                    of the packets array.  The epochs are specified as
                    seconds past J2000, TDB.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.  See $Particulars for a description of the effect of this
     routine.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     MAXDEG         is the maximum allowed degree of the interpolating
                    polynomial.  If the value of MAXDEG is increased,
                    the SPICELIB routine <a href="spkpv.html">SPKPV</a> must be changed
                    accordingly.  In particular, the size of the
                    record passed to SPKRnn and SPKEnn must be
                    increased, and comments describing the record size
                    must be changed.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     If any of the following exceptions occur, this routine will return
     without creating a new segment.

     1) If FRAME is not a recognized name, the error
        SPICE(INVALIDREFFRAME) is signaled.

     2) If the last non-blank character of SEGID occurs past index 40,
        the error SPICE(SEGIDTOOLONG) is signaled.

     3) If SEGID contains any nonprintable characters, the error
        SPICE(NONPRINTABLECHARS) is signaled.

     4) If DEGREE is not at least 1 or is greater than MAXDEG, the
        error SPICE(INVALIDDEGREE) is signaled.

     5) If the window size implied by DEGREE is odd, the error 
        SPICE(INVALIDDEGREE) is signaled.

     6) If the number of packets N is not at least 2, 
        the error SPICE(TOOFEWSTATES) will be signaled.

     7) If FIRST is greater than or equal to LAST then the error
        SPICE(BADDESCRTIMES) will be signaled.

     8) If the elements of the array EPOCHS are not in strictly
        increasing order, the error SPICE(TIMESOUTOFORDER) will be
        signaled.

     9) If the first epoch EPOCHS(1) is greater than FIRST, the error
        SPICE(BADDESCRTIMES) will be signaled.

    10) If the last epoch EPOCHS(N) is less than LAST, the error
        SPICE(BADDESCRTIMES) will be signaled.

    11) If the subtype code is not recognized, the error
        SPICE(INVALIDVALUE) will be signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     A new type 18 SPK segment is written to the SPK file attached
     to HANDLE.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine writes an SPK type 18 data segment to the open SPK
     file according to the format described in the type 18 section of
     the SPK Required Reading. The SPK file must have been opened with
     write access.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose that you have states and are prepared to produce
     a segment of type 18 in an SPK file.

     The following code fragment could be used to add the new segment
     to a previously opened SPK file attached to HANDLE. The file must
     have been opened with write access.

        C
        C     Create a segment identifier.
        C
                  SEGID = 'MY_SAMPLE_SPK_TYPE_18_SEGMENT'

        C
        C     Write the segment.
        C
              CALL <b>SPKW18</b> (  HANDLE,  BODY,    CENTER,  FRAME,
             .               FIRST,   LAST,    SEGID,   DEGREE,
             .               N,       STATES,  EPOCHS          )
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 21-DEC-2012 (NJB)

        Increased the minimum packet count from 1 to 2.

    SPICELIB Version 1.0.1, 29-APR-2003 (NJB)

        Description of error condition arising from invalid window
        size was corrected.

    SPICELIB Version 1.0.0, 13-MAY-2002 (NJB)</PRE>
<h4>Link to routine SPKW18 source file <a href='../../../src/spicelib/spkw18.f'>spkw18.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:25:10 2014</pre>

</body>
</html>

