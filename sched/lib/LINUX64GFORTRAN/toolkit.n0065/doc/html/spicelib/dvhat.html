
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>dvhat</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>dvhat</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 DVHAT ( Derivative and unit vector &quot;V-hat&quot; of a state)

      SUBROUTINE DVHAT ( S1, SOUT )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find the unit vector corresponding to a state vector and the
     derivative of the unit vector.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     VECTOR
     DERIVATIVE
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
      DOUBLE PRECISION   S1   ( 6 )
      DOUBLE PRECISION   SOUT ( 6 )
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     S1        I     State to be normalized.
     SOUT      O     Unit vector S1 / |S1|, and its time derivative.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     S1       This is any double precision state. If the position
              component of the state is the zero vector, this routine
              will detect it and will not attempt to divide by zero.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     SOUT     SOUT is a state containing the unit vector pointing in
              the direction of position component of S1 and the
              derivative of the unit vector with respect to time.

              SOUT may overwrite S1.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.

     1) If S1 represents the zero vector, then the position
        component of SOUT will also be the zero vector.  The
        velocity component will be the velocity component
        of S1.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Let S1 be a state vector with position and velocity components P
     and V respectively.  From these components one can compute the
     unit vector parallel to P, call it U and the derivative of U
     with respect to time, DU.  This pair (U,DU) is the state returned
     by this routine in SOUT.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
   Any numerical results shown for this example may differ between
   platforms as the results depend on the SPICE kernels used as input
   and the machine specific arithmetic implementation.

   Suppose that STATE gives the apparent state of a body with
   respect to an observer.  This routine can be used to compute the
   instantaneous angular rate of the object across the sky as seen
   from the observers vantage.

           PROGRAM DVHAT_T
           IMPLICIT NONE

           DOUBLE PRECISION      ET
           DOUBLE PRECISION      LT
           DOUBLE PRECISION      OMEGA
           DOUBLE PRECISION      STATE  (6)
           DOUBLE PRECISION      USTATE (6)

           DOUBLE PRECISION      <a href="vnorm.html">VNORM</a>

           CHARACTER*(32)        EPOCH
           CHARACTER*(32)        TARGET
           CHARACTER*(32)        FRAME
           CHARACTER*(32)        ABCORR
           CHARACTER*(32)        OBSRVR

     C
     C     Load SPK, PCK, and LSK kernels, use a meta kernel for 
     C     convenience.
     C
           CALL <a href="furnsh.html">FURNSH</a> ( '<a href= "standard.html">standard.tm</a>' )

     C
     C     Define an arbitrary epoch, convert the epoch to ephemeris 
     C     time.
     C
           EPOCH = 'Jan 1 2009'
           CALL <a href="str2et.html">STR2ET</a> ( EPOCH, ET )

     C
     C     Calculate the state of the moon with respect to the 
     C     earth-moon barycenter in J2000, corrected for light time
     C     and stellar aberration at ET.
     C
           TARGET   = 'MOON'
           FRAME    = 'J2000'
           ABCORR   = 'LT+S'
           OBSRVR   = 'EARTH BARYCENTER'

           CALL <a href="spkezr.html">SPKEZR</a> ( TARGET, ET, FRAME, ABCORR, OBSRVR, STATE, LT )

     C
     C     Calculate the unit vector of STATE and the derivative of the
     C     unit vector.
     C
           CALL <b>DVHAT</b> ( STATE, USTATE )

     C
     C     Calculate the instantaneous angular velocity from the
     C     magnitude of the derivative of the unit vector.
     C
     C          v = r x omega
     C
     C          ||omega|| = ||v||  for  r . v = 0
     C                      -----
     C                      ||r||
     C
     C          ||omega|| = ||v||  for  ||r|| = 1
     C
           OMEGA = <a href="vnorm.html">VNORM</a>( USTATE(4) )

           WRITE(*,*) 'Instantaneous angular velocity, rad/sec', OMEGA

           END

   The program outputs:

       Instantaneous angular velocity, rad/sec  2.48106658E-06
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman    (JPL)
     W.L. Taber      (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.1, 06-MAY-2010 (EDW)

        Expanded the code example into a complete program.

        Reordered header sections to proper NAIF convention.
        Removed Revision section, it listed a duplication of a 
        Version section entry. 

    SPICELIB Version 1.1.0, 02-SEP-2005 (NJB)

        Updated to remove non-standard use of duplicate arguments
        in <a href="vperp.html">VPERP</a> and <a href="vscl.html">VSCL</a> calls.

    SPICELIB Version 1.0.0, 15-JUN-1995 (WLT)</PRE>
<h4>Link to routine DVHAT source file <a href='../../../src/spicelib/dvhat.f'>dvhat.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Tue Jul 15 14:24:13 2014</pre>

</body>
</html>

